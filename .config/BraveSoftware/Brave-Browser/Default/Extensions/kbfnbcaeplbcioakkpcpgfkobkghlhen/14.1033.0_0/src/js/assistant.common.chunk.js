(self.webpackChunk=self.webpackChunk||[]).push([[8721],{51897:(e,t,i)=>{var a=i(25682),s="chrome-extension://__MSG_@@extension_id__/",r="moz-extension://__MSG_@@extension_id__/",n="safari-web-extension://__MSG_@@extension_id__/",o=self.GR_RESOURCE_ROOT||s,l=self.GR_RESOURCE_ROOT||r,c=self.GR_RESOURCE_ROOT||n;e.exports={__css:a.toString().replace(new RegExp(s,"g"),o).replace(new RegExp(r,"g"),l).replace(new RegExp(n,"g"),c),...a.locals}},16037:(e,t,i)=>{i.d(t,{t:()=>B});var a=i(57050),s=i(40273),r=i(90361),n=i(36991);var o=i(34311),l=i(62337),c=i(95384),d=i(63919),p=i(30067),m=i(74850),u=i(32952),h=i(85985),g=i(77176),f=i(93508);class v{constructor(){this._mapByHighlightId=new Map,this._mapByAlertId=new Map,this._highlightDataChanged=new u.xQ,this.highlightDataChanged=this._highlightDataChanged}getByHighlightId(e){return this._mapByHighlightId.get(e)}getByAlertId(e){const t=this._mapByAlertId.get(e)||new Set;return Array.from(t).map((e=>this._mapByHighlightId.get(e))).filter((e=>!!e))}get(e){return this._mapByHighlightId.get(e)}has(e){return this._mapByHighlightId.has(e)}set(e,t){this._mapByHighlightId.set(e,t);const i=this._mapByAlertId.get(t.alertId)||new Set;i.add(e),this._mapByAlertId.set(t.alertId,i),this._highlightDataChanged.next(e)}delete(e){const t=this._mapByHighlightId.get(e);if(t){const i=this._mapByAlertId.get(t.alertId);void 0!==i&&(i.delete(e),0===i.size&&this._mapByAlertId.delete(t.alertId)),this._mapByHighlightId.delete(e)}this._highlightDataChanged.next(e)}forEach(e){this._mapByHighlightId.forEach(e)}getHighlightDataObs(e){return this._highlightDataChanged.pipe(h.h((t=>t===e)),g.U((()=>this.getByHighlightId(e))),f.O(this.getByHighlightId(e)))}}class w{constructor(e,t,i,a,s=(()=>d.E9.zero),r=m.Y.create(w.name)){this._denaliHighlights=e,this._getFluidHighlights=t,this._getTextMap=i,this._getParentRect=a,this._getParentScroll=s,this._log=r}register(e,t,i,a){if(null!==e){if(this._denaliHighlights.has(e))return this.update(e,t,i,a);{const s=new c.Fd(e,t,this._getFluidHighlights(),this._getParentRect,this._getParentScroll),r={id:e,alertId:a.alertId,mark:s,visualization:i};this._denaliHighlights.set(e,r);const n=this._getTextMap().getPlainText();return this._getFluidHighlights().addHighlight(e,(0,p.rX)((0,p.mp)(s.range),n),a),r}}return null}remove(e){this._denaliHighlights.has(e)?(this._getFluidHighlights().removeHighlights([e]),this._denaliHighlights.delete(e)):this._log.warn(`can't remove mark #${e}, doesn't exist`)}update(e,t,i,a){const s=this._denaliHighlights.get(e);if(s){this._denaliHighlights.set(e,{...s,visualization:i});const r=this._getTextMap().getPlainText();return this._getFluidHighlights().updateHighlight(e,(0,p.rX)(t.meta.range(),r),a),s}return this._log.warn("cannot update not existing highlight",e),null}clearAll(){this._denaliHighlights.forEach((e=>{this._getFluidHighlights().removeHighlights([e.id])}))}}var _=i(55073),b=i(5817),y=i(25938),S=i(64450),k=i(59443),A=i(24645),E=i(51374),C=i(45586),I=i(24209),T=i(40151),M=i(76974),x=i(95300),F=i(77150),R=i(80900),L=i(50628),P=i(22232),V=i(95574),O=i(5114),N=i(71249),H=i(95195);class B{constructor(e,t,i,s,r,n,d=m.Y.create(B.name),p,f){this._highlights=e,this._textObserver=t,this._replacementService=i,this._layout=s,this._scroller=r,this._selectedHighlightsTracker=n,this._log=d,this._requestAwaitService=p,this._formattingService=f,this._subs=new C.w.Keeper,this._disposed=!1,this._highlightedAlertId=null,this._marks=new Map,this._highlightsDataStore=new v,this._highlightUpdater=new w(this._highlightsDataStore,(()=>this._highlights),(()=>this._textObserver.getTextSource()),(()=>{const e=this._layout.textField.rect.getApproximate();return l.Pf.create({...e.client,...e.size})}),(()=>this._layout.textField.scroll.getApproximate())),this.highlightHoverProvider={getHoveredStateBehavior:e=>this._highlightsDataStore.getHighlightDataObs(e).pipe(g.U((e=>e&&e.visualization.type===c.sO.Change.VisualState.Type.highlighted?{[c.sO.Change.VisualState.Source.sidebar]:o.pc.hovered_needs_attention,[c.sO.Change.VisualState.Source.text]:o.pc.hovered,[c.sO.Change.VisualState.Source.api]:this._highlightedAlertId===e.alertId?o.pc.hovered:o.pc.none}[e.visualization.source]:o.pc.none)))},this._updateContentsBuffer=new u.xQ,this._flushUpdater=new u.xQ,this.getContents=(e,t)=>{if(this._log.trace(`getContents, ${e}, ${t}`),this._formattingService){const i=this._textObserver.getTextSource().getRichText();return y.RI.unsafeRes(void 0!==e?i.slice(e,void 0!==t?e+t:void 0):i)}{const i=void 0!==e?this.getText().slice(e,void 0!==t?e+t:void 0):this.getText();return y.RI.resFromText(i)}},this.changes=I.T((0,a.pipe)(y.RI.res(this.getContents().delta),H.fold((()=>T.E),(e=>M.of(e)))),this._textObserver.contentChanges.async.pipe(h.h((e=>e.changes.length>0)),g.U((({deltaChange:e})=>e)))),this.activeMarks=new x.X(O.none),this.contentUpdated=new u.xQ,this.hoveredMarks=new x.X(O.none),this.textChangedAfterPaste=new u.xQ,this.activeWord=new x.X(O.none),this.clickedWord=new x.X(O.none),this.ongoingSelection=new x.X(!1),this._log.info(`${B.name} created`),this._subs.push(this._subscribeToContentUpdates(),this._subscribeToSelectedHighlight(),this._trackFocusedAlert())}_trackFocusedAlert(){return this._highlightsDataStore.highlightDataChanged.pipe(g.U((e=>this._highlightsDataStore.getByHighlightId(e))),h.h((e=>!!e))).subscribe((e=>{this._highlightedAlertId===e.alertId||e.visualization.type!==c.sO.Change.VisualState.Type.highlighted||e.visualization.source!==c.sO.Change.VisualState.Source.text&&e.visualization.source!==c.sO.Change.VisualState.Source.sidebar?e.alertId===this._highlightedAlertId&&e.visualization.type===c.sO.Change.VisualState.Type.visible&&(this._highlightedAlertId=null,this._log.trace(`Mark ${e.id} unfocused - alertId ${e.alertId}`)):(this._highlightedAlertId=e.alertId,this._log.trace(`Mark ${e.id} focused - alertId ${e.alertId}`))}))}pushChanges(e,t){this._log.trace("pushChanges",{change:e,source:t}),y.RI.isFlush(e)?this._flushUpdater.next():y.RI.isReset(e)?this._log.warn("Got unknown reset"):this._updateContents(e.delta,t)}getText(){return this._log.trace("getText"),this._formattingService?(0,_.l)(this._textObserver.getTextSource().getRichText(),""):this._textObserver.getTextSource().getPlainText()}getTextLength(){return this._log.trace("getTextLength"),this.getText().length}flushChanges(){this._log.trace("flushChanges")}getCursor(){return this._log.trace("getCursor"),k.Y1.empty}setCursor(e,t,i){return this._log.trace("setCursor",{_index:e,_length:t,_source:i}),H.right(void 0)}getLastPossibleCursorPosition(){return this._log.trace("getLastPossibleCursorPosition"),0}_doMarkAction(e){const t=o.y$.Id.createFromMark(e.id),i=e.meta.capiAlertId;switch(e.action){case A.v.Change.ActionType.create:const a=this._highlightUpdater.register(t,e,e.meta.visualState,{alertId:i,highlightId:t,highlightColor:e.meta.highlightColor,highlightDisplayFormat:e.meta.highlightDisplayFormat,highlightDisappearOnHoverDelay:e.meta.highlightDisappearOnHoverDelay}),s=(null==a?void 0:a.mark)||null;return s&&this._marks.set(s.id,s),s;case A.v.Change.ActionType.update:const r=this._highlightUpdater.update(t,e,e.meta.visualState,{alertId:i,highlightId:t,highlightColor:e.meta.highlightColor,highlightDisplayFormat:e.meta.highlightDisplayFormat,highlightDisappearOnHoverDelay:e.meta.highlightDisappearOnHoverDelay}),n=(null==r?void 0:r.mark)||null;return n&&this._marks.set(n.id,n),n;case A.v.Change.ActionType.remove:return this._highlightUpdater.remove(t),this._marks.delete(e.id),null;default:(0,P.vE)(e)}}changeMarks(e){return this._disposed?(this._log.debug("changeMarks called after disposed, returning empty result"),A.v.Change.Result.getEmpty()):(this._log.trace("changeMarks",{rawMarks:e}),e.reduce(((e,t)=>{switch(t.action){case A.v.Change.ActionType.create:e.created.set(t.id,H.fromNullable(new Error("Cannot create mark"))(this._doMarkAction(t)));break;case A.v.Change.ActionType.update:e.updated.set(t.id,H.fromNullable(new Error("Cannot update mark"))(this._doMarkAction(t)));break;case A.v.Change.ActionType.remove:this._doMarkAction(t),e.removed.set(t.id,H.right(void 0))}return e}),A.v.Change.Result.getEmpty()))}scrollToMark(e,t){var i;const a=null!==(i=this._marks.get(e))&&void 0!==i?i:null;return this._log.trace("scrollToMark",{markId:e,mark:a,opts:t}),a?this._scroller.scrollToMark(a,t):(this._log.warn(`Tried to scroll to nonexistent mark with id: ${e}`),T.E)}_subscribeToContentUpdates(){return this._updateContentsBuffer.pipe(F.R((()=>I.T(R.H((0,b.Xd)(20)),this._flushUpdater).pipe(L.P()))),h.h((e=>e.length>0)),g.U((e=>e.reduce(((e,t)=>e.compose(t)),new S.Delta)))).subscribe((e=>{const t=this._replacementService.performBatchReplacements((i=e,i.reduce((({actions:e,index:t},i)=>{const a=e[0];return n.s.isInsertString(i)?(e.unshift({pos:{start:t,end:t},value:i.insert}),{actions:e,index:t}):n.s.isInsertEmbed(i)?{actions:e,index:t+1}:n.s.isRetain(i)?{actions:e,index:t+i.retain}:n.s.isDelete(i)?(a&&a.pos.start===a.pos.end&&a.pos.end===t?a.pos={...a.pos,end:a.pos.end+i.delete}:e.unshift({pos:{start:t,end:t+i.delete},value:""}),{actions:e,index:t+i.delete}):void(0,r.vE)(i)}),{actions:[],index:0}).actions.reduce(((e,t)=>(e.length&&e[e.length-1].value&&e[e.length-1].pos.start===t.pos.start?e[e.length-1].value=`${t.value}${e[e.length-1].value}`:e.push(t),e)),[]))).then((()=>{const t=(e=>e.reduce((({formattings:e,index:t},i)=>s.m.hasFormatting(i)?n.s.isInsertString(i)?(e.push({range:{start:t,end:"\n"===i.insert?t:t+i.insert.length},formatting:i.attributes}),{formattings:e,index:t+i.insert.length}):n.s.isInsertEmbed(i)?{formattings:e,index:t+1}:n.s.isRetain(i)?(e.push({range:{start:t,end:t+i.retain},formatting:i.attributes}),{formattings:e,index:t+i.retain}):{formattings:e,index:t}:n.s.isInsertString(i)?{formattings:e,index:t+i.insert.length}:n.s.isInsertEmbed(i)?{formattings:e,index:t+1}:n.s.isRetain(i)?{formattings:e,index:t+i.retain}:n.s.isDelete(i)?{formattings:e,index:t}:void(0,r.vE)(i)),{formattings:[],index:0}).formattings)(e);this._formattingService&&t.length&&(this._log.trace("Have formattings, applying",t),t.forEach((e=>{this._formattingService&&this._formattingService.apply(e.range,e.formatting)})))}),(()=>{this._log.warn("Failed to apply batch replacements")}));var i;this._requestAwaitService&&this._requestAwaitService.addRequest(t)}))}_subscribeToSelectedHighlight(){return this._selectedHighlightsTracker.pipe(g.U((0,a.flow)(N.map((e=>{var t;return(0,a.pipe)(O.fromNullable(null===(t=this._highlightsDataStore.get(e))||void 0===t?void 0:t.mark),O.filter((e=>(0,a.pipe)(e.range(),H.fold(a.constTrue,(0,a.not)(E.x.isEnclosingView))))))})),N.compact))).subscribe((e=>this.activeMarks.next(O.some(e))))}_updateContents(e,t){this._updateContentsBuffer.next((0,_.AQ)(e))}getSelectionRect(){throw this._log.trace("getSelectionRect"),Error("not implemented")}setContents(e){this._log.trace("setContents",{_value:e})}getHTML(){return this._log.trace("getHTML"),""}getPossibleCursorPosition(e,t){return this._log.trace("getPossibleCursorPosition",{_x:e,_y:t}),V.tryCatchError((()=>{throw new Error("Not implemented")}))}dispose(){this._highlightUpdater.clearAll(),this._subs.dispose(),this._log.info(`${B.name} disposed`),this._disposed=!0}}},25913:(e,t,i)=>{i.d(t,{Y:()=>m,q:()=>u});var a=i(57050),s=i(41398),r=i(77176),n=i(93508),o=i(46861),l=i(40033),c=i(10720),d=i(66896),p=i(5114);const m=(e,t)=>{const i=(0,c.ux)(e.lensState,e.cardsListScrollManager,e.capabilities),a=Math.max(600,t.size.height+o.O.headerHeight+o.O.panelHeight);return i.pipe((0,s.M)(e.predictionsPreviewViewModel.previewState),(0,r.U)((([e,t])=>{if(t.kind!==l.fA.visible)return e;const i=[t.readersAttention,t.tone].filter(p.isSome).length;return i>0?e+o.O.predictionsPreviewHeaderHeight+o.O.predictionInsightHeight*i+o.O.predictionInsightBottomMargin:e})),(0,n.O)(0),(0,r.U)((e=>Math.max(e+o.O.headerHeight,a))),(0,r.U)((e=>Math.min(e,750))))},u=(e,t,i)=>s=>{const r=e(),n=e=>e*i(),o=n(1),l=n(2.25);return(0,a.pipe)(t(),p.map((e=>e-(0,c.US)(r))),p.map((e=>d.R.isMainLens(r)&&s?e-l-o:e-o)),p.map((e=>e-n(1))),p.filter((e=>e>0)))}},18126:(e,t,i)=>{i.d(t,{f:()=>o});var a=i(95300),s=i(2844),r=i(66310),n=i(34311);class o{constructor(e){this._originalHoverProvider=e,this._assistantHoverProviderSbj=new a.X(null)}setAssistantHover(e){this._assistantHoverProviderSbj.next(e)}removeAssistantHover(){this._assistantHoverProviderSbj.next(null)}getHoveredStateBehavior(e){const t=this._originalHoverProvider.getHoveredStateBehavior(e);return this._assistantHoverProviderSbj.pipe((0,r.w)((i=>null==i?t:(0,s.aj)(t,i.getHoveredStateBehavior(e),((e,t)=>t!==n.pc.none?t:e)))))}}},54702:(e,t,i)=>{i.d(t,{H:()=>s});var a=i(8467);class s{constructor({layout:e}){this._scroller=(0,a.t)({scrollToMarkRect(t,i){const a=e.textField.visibleRect.getApproximate();let s=(i&&i.paddingTop||0)-a.client.top;(s<=0||s>=a.size.height)&&(s=a.size.height/2);const r=t.top-s-a.client.top,n=t.right-t.left,o=Math.max(0,(a.size.width-n)/2);t.left,a.client.left;requestAnimationFrame((()=>e.textField.scroller.scrollBy({top:r,left:void 0})))},scrollToRange(){}})}scrollToMark(e,t){return this._scroller.scrollToMark(e,t)}}},8467:(e,t,i)=>{i.d(t,{t:()=>c});var a=i(40327),s=i(30067),r=i(95384),n=i(91402),o=i(44586),l=i(95195);function c({scrollToMarkRect:e,scrollToRange:t}){return{scrollToMark:(i,c)=>(0,a.pipe)(r.Fd.getMarkRect(i),l.orElse((()=>(t((0,s.mp)(i.range)),r.Fd.getMarkRect(i)))),l.fold((e=>n._(new Error(`Cannot get mark's rect: ${i.id}: ${e.message}`))),(t=>new o.y((i=>{i.next(void 0),e(t,c)})))))}}},3004:(e,t,i)=>{i.r(t),i.d(t,{AssistantController:()=>ys,AssistantControllerInjectedParams:()=>a.AssistantControllerInjectedParams,AssistantService:()=>Fs,AssistantServiceInjectedParams:()=>s.AssistantServiceInjectedParams,LocalAssistantHighlightCollection:()=>n.c});var a={};i.r(a),i.d(a,{e:()=>ys});var s={};i.r(s),i.d(s,{e:()=>Fs});var r,n=i(45662),o=i(40327),l=i(27378),c=i(74850),d=i(523),p=i(25913),m=i(57050),u=i(17404),h=i(50622),g=i(9671),f=i(5178),v=i(75003),w=i(59456),_=i(31536),b=i(68654),y=i(35214),S=i(29913),k=i(16797),A=i(84313),E=i(20594),C=i(16892),I=i(48521),T=i(75316),M=i(35416),x=i(25975),F=i(8125),R=i(5114),L=i(73975),P=i(45701),V=i(31881);!function(e){function t(e){return M.nL.Items.mapper((e=>e.kind),{[A.X.Kind]:e})}function i(e){return e.kind===A.X.Kind}function a(){return{viewState:(e,t)=>t=>({view:t,isLastCard:e,kind:"alertCard",visibleViewportHeight:R.none})}}e.isSelectableWithAlertItem=i,e.getActiveItemWithAlert=M.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveAlignableItem=M.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveFocusableItem=M.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.checksFeedItemsMapper=t,e.isAlertCard=i,e.defaultOrd=(0,y.fold)(P.getMonoid())([(0,o.pipe)(P.ordBoolean,P.contramap(i)),A.X.ord]),e.item=e=>V.UI.Union.make("kind",{alertCard:S.X.View(e)}),e.viewState=a,e.createCardListFlow=k.p,e.listItemOrd=e=>P.contramap((e=>e.cell.item.view))(e).compare;const s={equals:(e,t)=>e.kind===t.kind&&C.s.eqById.equals(e,t)},r=e=>({equals:(t,i)=>{const a={[A.X.Kind]:e};return s.equals(t,i)&&function(e,t){return(i,a)=>t[e(i)].equals(i,a)}((e=>e.kind),a)(t,i)}}),n=(0,y.fold)(L.getMonoid())([I.o.eq,C.s.verticalPositionEq,s]);function l(e){const i=A.X.Capabilities.getChangePosition(e);return{changePosition:e=>t(i.changePosition(e))}}function c(e){const i=A.X.Capabilities.getAnimatable(e);return{completeTransition:e=>t(i.completeTransition(e)),transitionTo:e=>t(i.transitionTo(e)),changeVisualState:e=>t(i.changeVisualState(e))}}function d(e){const i=A.X.Capabilities.getSelect(e);return{select:(e,a,s)=>t(i.select(e,a,s)),selectByAlert:(e,a,s,r)=>t(i.selectByAlert(e,a,s,r)),unselect:(e,a)=>t(i.unselect((0,m.unsafeCoerce)(e),a))}}function p(e){return{removeAlertFromItem:(a,s)=>t((t=>A.X.Capabilities.getRemoveAlerts(e,s.itemsOrd)(a,M.In.getActiveItemOfType(i)(s))(t)))}}function u(e){const i=A.X.Capabilities.getRemove(e);return{remove:(e,a)=>t(i.remove(e,a))}}function h(e){const i=A.X.Capabilities.getUpdateWithAlert(e);return{updateWithAlerts:e=>t(i.updateWithAlerts(e))}}e.equatable={structEq:r(A.X.eq),idEq:r(s),visualStateEq:r(n)},e.cloneable=()=>({clone:t(A.X.Capabilities.getCloneable().clone)}),e.changePosition=l,e.disposable={isScheduledToDispose:t((e=>T.C.willBeDisposed(e,e.removedAlertsIds)))},e.hidable={isHidden:t(I.o.isHidden)},e.animatableItem=c,e.hasAlertsQueries={isSelectableByAlert:e=>t(T.C.hasAlert(e.alert.id)),hasAlert:e=>t(T.C.hasAlert(e)),hasActiveAlert:t((e=>R.some(e.activeAlert)))},e.changePositionStrategyQueries={useReferenceHeightOnRemove:t(m.constFalse)},e.select=d,e.removeAlert=p,e.remove=u,e.updateWithAlert=h,e.releaseAlert=t=>x.v.Capabilities.getAlertReleaser({...p(t),...e.disposable}),e.unselectable=e=>x.v.Capabilities.getUnselectable(M.In.getActiveItem,d(e)),e.selectableByAlert=t=>x.v.Capabilities.getSelectableByAlert(M.In.getActiveItem,{...e.hasAlertsQueries,...d(t),...x.v.Capabilities.getHasChecksFeed()}),e.selectableById=e=>x.v.Capabilities.getSelectableById(M.In.getActiveItem,d(e)),e.updateMeta=()=>({updateMeta:x.v.Capabilities.getMetaUpdatable().updateMeta}),e.animatableFeed=e=>x.v.Capabilities.getAnimatable(e,{...p(e),...c(e),...x.v.Capabilities.getHasChecksFeed()}),e.hasPriorityToggle=t=>x.v.WithPriority.getHasPriorityToggle({...c(t),...e.hasAlertsQueries,...e.disposable});function g(e){const i=E.Mq.getCardSelections(e);return{nextAlert:t(i.nextAlert),prevAlert:t(i.prevAlert)}}function f(){return{updateUserInput:e=>t(A.X.updateUserInput(e))}}e.alignable={isValidToAlign:t((t=>["focused","expanded"].includes(t.visualState.transition.type)&&!e.disposable.isScheduledToDispose(t)))},e.alertIterator=g,e.itemReleaser=()=>x.v.Capabilities.getItemReleaser(),e.hasAlerts=x.v.Capabilities.getHasAlerts,e.getDefaultNextAlertItemFilter=t=>(0,F.W9)(e.isSelectableWithAlertItem,(i=>!e.disposable.isScheduledToDispose(i)&&(0,o.pipe)(i,e.hasAlertsQueries.hasActiveAlert,R.map((e=>t.isRegistered(e.id))),R.getOrElse(m.constFalse)))),e.hasUserInput=f,e.verifiable=()=>x.v.Capabilities.getVerifiable(e.disposable),e.getCapabilities=function(t,i){return{...a(),...e.disposable,...e.hidable,...e.equatable,...f(),...e.cloneable(),...l(t),...c(t),...d(t),...u(t),...p(t),...h(t),...e.hasAlertsQueries,...e.changePositionStrategyQueries,...e.alignable,...e.releaseAlert(t),...e.unselectable(t),...e.selectableByAlert(t),...e.selectableById(t),...e.updateMeta(t),...e.animatableFeed(t),...e.hasPriorityToggle(t),...e.itemReleaser(),...e.verifiable(),...e.hasAlerts(g(i),e.hasAlertsQueries,(()=>e.getDefaultNextAlertItemFilter(i)))}}}(r||(r={}));var O=i(51838),N=i(85985),H=i(15646);class B extends v.D${constructor(e,t,i,a,s,r){super(t,i,{type:v.aH.Type.default},new Set([v.aH.Type.emogenie]),a),this._sub.add(this._activeView.subscribe((t=>{switch(t.type){case v.aH.Type.settings:return void e.assistantSettingsShow();default:return}}))),this._sub.add(s.pipe(N.h(H.lY.isSDUICardAction)).subscribe((({actions:e})=>{e.forEach((e=>{e.type===O.zx.ActionType.closeCard?r():e.type===O.zx.ActionType.openSettings?this.pushActiveView({type:v.aH.Type.settings}):e.type===O.zx.ActionType.openToneDetector&&this.pushActiveView({type:v.aH.Type.emogenie})}))})))}pushActiveView(e){this.replaceActiveView(e)}}var U=i(77394),D=i(86620),W=i(16868),j=i(51540),G=i(40081),q=i(62346),z=i(92783),Z=i(90361),Y=i(44618),K=i(84966),Q=i(66896),X=i(40018),$=i(13313),J=i(29317),ee=i(21619),te=i(54216),ie=i(83436),ae=i(48052),se=i(83167),re=i(35607),ne=i(4890),oe=i(73841),le=i(89770),ce=i(39920),de=i(74364),pe=i(98403),me=i(76974),ue=i(32952),he=i(77176),ge=i(28043),fe=i(40151),ve=i(83078),we=i(95574),_e=i(95195),be=i(38983),ye=i(81531);var Se,ke=i(8043),Ae=i(2844),Ee=i(30763),Ce=i(88056),Ie=i(35407),Te=i(19429);!function(e){e.Context=l.createContext(Ce.Y.invariantContent("AssistantTextResources")),e.holder=Te.VF((()=>({setGoalsTooltip:"Set goals to get tailored writing suggestions",proofitTooltip:"Expert writing help"})))}(Se||(Se={}));const Me=Ie.createFrom(Ie.composeS({denali:Ee.m.holder,assistant:Se.holder}))((()=>({denali:{}})));var xe=i(18756),Fe=i(38152),Re=i(80864),Le=i(20855),Pe=i(79073),Ve=i(53112),Oe=i(12187),Ne=i(57398);const He=l.memo((({width:e,strokeWidth:t,generalScore:i,componentStyle:a,fontSize:s=9,isLoading:r})=>{const n=e/2,o=n-t/2,c=2*o*Math.PI,d=(r?75:i)/100*c,p=c-d,m=(e=>{const{red40:t,yellow50:i,green50:a}=Ve.Z;return e<65?t:e<95?i:a})(i);return l.createElement("div",{...(0,Oe.Sh)(Ne.scoreRing,r&&Ne.loading),style:a},l.createElement("svg",{width:e,height:e,viewBox:`0 0 ${e} ${e}`},l.createElement("circle",{fill:"white",r:o,cx:n,cy:n}),l.createElement("circle",{stroke:Ve.Z.neutral20,fill:"transparent",strokeWidth:t,style:{strokeDashoffset:d},r:o,cx:n,cy:n}),l.createElement("circle",{stroke:m,fill:"transparent",strokeWidth:t,strokeDasharray:`${c} ${c}`,style:{strokeDashoffset:p},r:o,cx:n,cy:n}),l.createElement("text",{className:Ne.scoreText,x:"50%",y:"-35%",fontSize:s,fill:"black",textAnchor:"middle",transform:"rotate(90)"},i>0&&!r?i:"")))}));var Be=i(87667),Ue=i(5739),De=i(75039),We=i(93756),je=i(35327);const Ge=e=>{const t=V.Z.animatingFlow((()=>e.summaryVM.summary),qe);return l.createElement("div",{...(0,Oe.Sh)(je.summary_wrapper,e.className)},V.UI.mount(Ye,t))},qe=(e,t)=>(0,o.pipe)(e,R.filter((e=>e.content!==t.content)),R.map((()=>We.Hk("fadeout","fadein")))),ze=V.UI.Node.make((({view:e})=>l.createElement(Ue.F.div,{className:je.summary_heading,"data-grammarly-part":"assistant-summary-header"},e("content")))),Ze=V.UI.Transition.make({fadein:je.summary_fadein},{fadeout:je.summary_fadeout}),Ye=V.UI.Animated.make(Ze,ze),Ke=({headerVM:e,experiments:t})=>l.createElement(Ue.F.div,{style:{visibility:e.visibility}},!(null==t?void 0:t.assistantHeaderRemoval)&&l.createElement("div",{className:De.panel},l.createElement(Ge,{summaryVM:e}),l.createElement(Ue.F.div,{className:De.score_container,"data-grammarly-part":"assistant-score"},(0,o.pipe)(e.score,he.U(R.map((({capiScore:e,isLoading:t})=>l.createElement(l.Fragment,null,l.createElement(He,{generalScore:e,strokeWidth:3,width:38,fontSize:e<100?16:14,isLoading:t,componentStyle:{margin:"-3px -3px 0 0",cursor:"default"}}),l.createElement(Le.u,{message:`Text score: ${e} out of 100. This score represents the quality of writing.`},l.createElement("div",{className:De.info_icon},l.createElement(Pe.s,{color:Ve.Z.neutral40,size:9}))))))),he.U(ve.orNull)))),!(null==t?void 0:t.disablePriorityLens)&&l.createElement("div",{className:De.lens_switch,"data-grammarly-part":"assistant-lens-switch"},V.UI.mount(Qe,e.lensSwitchFlow))),Qe=V.UI.Union.asOption(Be.n.Switch);var Xe=i(40033),$e=i(68340),Je=i(10720),et=i(24606),tt=i(46547),it=i(79921),at=i(86705),st=i(93820),rt=i(49468);const nt=({emoji:e,title:t,upgradeTitle:i,browser:a,onClose:s,onUpgrade:r,onShow:n})=>(l.useEffect((()=>{null==n||n()}),[t,i,e]),l.createElement(tt.Z,{dataPartName:"smart-phrases-premium-card",kind:"assistant-priority-lens"},l.createElement("div",{className:rt.smartPhrasesPremiumCard},l.createElement(it.dy,{className:rt.smartPhrasesPremiumCardEmoji,unicodeHexArray:null,unicodeLiteral:e}),l.createElement("div",{className:rt.smartPhrasesPremiumCardHeader},l.createElement("div",{className:rt.smartPhrasesCardContentTitle},t),l.createElement(at.v,{browser:a})),i,l.createElement("div",{className:rt.smartPhrasesPremiumCardButtons},l.createElement(et.z,{kind:"success",className:rt.smartPhrasesPremiumCardUpgradeButton,onClick:r},l.createElement(st.n,{width:12,color:Ve.Z.neutral0}),"Upgrade now"),l.createElement(et.z,{style:{color:Ve.Z.neutral50,fontWeight:"normal"},kind:"transparent-hoverable",onClick:s},"Dismiss")))));var ot=i(61903),lt=i(41398),ct=i(93508),dt=i(19962),pt=i(33751),mt=i(89379),ut=i(28378),ht=i(60797),gt=i(62513);const ft=l.forwardRef((({successView:e},t)=>{const i=l.useContext(Ee.m.Context),a=(0,mt.hM)((0,mt.JT)((0,o.pipe)(e,ht.oA),i));return l.createElement("div",{className:gt.compactSuccessLens,ref:t},l.createElement("div",{className:gt.compactSuccessLensContainer},V.UI.mount(ut.q,a)))})),vt=l.forwardRef((({viewModels:e},t)=>l.createElement("div",{className:pt.mainView},l.createElement(_t,{ref:t,state:e.lensState,cardsViewModel:e.cardsViewModel,upgradeViewModel:e.upgradeViewModel,cardsListScrollManager:e.cardsListScrollManager,assistantCardListViewModel:e.assistantCardListViewModel,predictionsPreviewViewModel:e.predictionsPreviewViewModel,assistantFeedbackViewModel:e.assistantFeedbackViewModel,headerViewModel:e.assistantHeaderViewModel,layoutViewModel:e.assistantLayoutViewModel,capabilities:e.capabilities,readersAttentionItemViewModel:e.readersAttentionItemViewModel,experiments:e.user.view("experiments").get()})))),wt=({position:e,isSuccess:t,children:i})=>l.createElement(Ue.F.Fragment,null,e.pipe(ge.x(((e,t)=>e.offset===t.offset&&e.visible===t.visible)),he.U((e=>e.visible?l.createElement(Ue.F.div,{...(0,Oe.Sh)(pt.cardListFooterStatic,e.animationInProgress?pt.cardListFooterAnimate:void 0,t?void 0:pt.cardListFooterDynamic),style:t?{}:{transform:dt.CSS.translateY(e.offset)}},i):null)))),_t=l.forwardRef((({state:e,assistantCardListViewModel:t,cardsViewModel:i,upgradeViewModel:a,cardsListScrollManager:s,capabilities:r,readersAttentionItemViewModel:n,experiments:c,...d},p)=>{const m=pe.jw((e=>{let t=7;return t=31*t+(0,xe.AC)(e.currentLens.id),t=31*t+(x.v.WithSuccess.State.isInSuccess(r)(e)?1231:1237),t}),e),u=(0,o.pipe)(m,he.U((e=>{const t=e.get();return x.v.WithSuccess.State.isInSuccess(r)(t)}))),h=(0,o.pipe)((0,Je.ux)(e,s,r),lt.M(e),he.U((([e,t])=>({visible:!M.nL.hasCards(t)||R.isNone(t.currentLens.items.find((e=>!e.positionState.isHeightValid))),offset:e+6,animationInProgress:!0}))),ct.O({visible:!1,offset:0,animationInProgress:!0}));return l.createElement($e.C,{className:pt.cardList,onClick:e=>{e.target.getAttribute("class")===pt.cardList&&t.assistantActions.next({type:Fe.lo.Type.clickOnEmpty})},footer:l.createElement(Ue.F.Fragment,null,(0,o.pipe)(u,he.U((e=>l.createElement(wt,{position:h,isSuccess:e},l.createElement(Xe.pL,{predictionsVM:d.predictionsPreviewViewModel})))))),ref:e=>{t.cardListViewportHeight.set(R.fromNullable(null==e?void 0:e.offsetHeight))}},(a=>l.createElement(Ue.F.Fragment,null,(0,o.pipe)(Ae.aj(u,t.havePremiumAlerts,t.premiumSmartPhraseAlert),he.U((([m,u,h])=>{var g;const{intent:f="",upgradeTitle:v="",emoji:w=""}=(0,o.pipe)(null!==(g=null==h?void 0:h.extraProperties.smartPhrasesPremium)&&void 0!==g?g:R.none,R.getOrElse((()=>({intent:"",upgradeTitle:"",emoji:""}))));return m&&!u?l.createElement(l.Fragment,null,l.createElement(Ke,{headerVM:d.headerViewModel,experiments:c}),l.createElement(ft,{successView:t.successView,ref:p})):l.createElement(Je.hz,{state:e,cardsViewModel:i,cardsListScrollManager:s,connectorElements:a,ref:p,header:l.createElement(l.Fragment,null,l.createElement(Ke,{headerVM:d.headerViewModel,experiments:c}),h?l.createElement("div",{className:pt.upgradeHookWrapper,role:"uphook-wrapper"},l.createElement(nt,{emoji:w,title:f,upgradeTitle:v,browser:d.layoutViewModel.browser,onShow:t.onSmartPhrasesUpgradeHookShown,onClose:()=>t.dismissSmartPhrasesUpgradeHook(h),onUpgrade:t.onSmartPhrasesUpgradeHookClick})):u?l.createElement("div",{className:pt.upgradeHookWrapper,role:"uphook-wrapper"},V.UI.mount(ot.n.TogglablePanel,t.upgradeHookFlow)):null),comparator:Re.O.listItemOrd,capabilities:r,readersAttentionItemViewModel:n})}))))))})),bt=l.forwardRef((({viewModels:e,header:t,footer:i,className:a},s)=>l.createElement($e.C,{ref:t=>{"function"==typeof s?s(t):s&&(s.current=t),e.assistantCardListViewModel.cardListViewportHeight.set(R.fromNullable(null==t?void 0:t.offsetHeight))},className:a},(a=>l.createElement(Je.hz,{state:e.lensState,cardsViewModel:e.cardsViewModel,cardsListScrollManager:e.cardsListScrollManager,connectorElements:a,header:t,footer:i,comparator:Re.O.listItemOrd,capabilities:e.capabilities,readersAttentionItemViewModel:R.none})))));var yt=i(88326),St=i(73008);const kt=({children:e,layoutVM:t,panelClassName:i,contentClassName:a,footer:s,onClickBack:r,hideBackButton:n=be.h.create(!1),dataPartName:o})=>l.createElement("div",{className:St.viewOverlay,"data-grammarly-part":"assistant-view-overlay"},l.createElement(Ue.F.Fragment,null,n.view((e=>!e&&l.createElement(yt.M,{className:St.viewOverlayGoBack,clickHandler:()=>r?r():t.popActiveView(),dataGrammarlyPart:"assistant-go-back"},"<- Back")))),l.createElement("div",{className:i||St.defaultViewOverlayPanel},l.createElement("div",{className:a||St.content,"data-grammarly-part":o},e),s&&l.createElement("div",{className:St.footer},s)));var At=i(41263),Et=i(79461),Ct=i(80895),It=i(24394),Tt=i(32275),Mt=i(16118),xt=i(66310),Ft=i(80900),Rt=i(17343),Lt=i(8471);const Pt=({emotion:e,isBrandTonesEnabled:t,emotionPollValue:i,index:a,onReportEmotionFeedback:s})=>{const r=l.createElement(Le.u,{message:`${e.prevalence} intensity`,showDelay:300},l.createElement("div",{className:Lt.emogenieReportItemEmotionIntensity},[0,1,2,3,4].map((t=>{const i=t/5<=e.confidence;return l.createElement("div",{key:`${e.name}-intensity-${t}`,...(0,Oe.Sh)(Lt.emogenieReportItemEmotionIntensityDot,i&&Lt.emogenieReportItemEmotionIntensityDotActive)})})))),n=e.brandToneLabel?l.createElement(Ct.C,{className:Lt.emogenieReportItemEmotionBrandToneBadge,title:`${e.brandToneLabel}-BRAND`,kind:"off"===e.brandToneLabel?"error":"primary",boldTitle:!0}):r,o=t?t=>{const i=e.brandToneLabel||"neutral";t===It.x.YES?s({emotionName:e.name,feedbackType:"EMOTION_LIKE",brandTone:i}):s({emotionName:e.name,feedbackType:"EMOTION_DISLIKE",brandTone:i})}:t=>{t===It.x.YES?s({emotionName:e.name,feedbackType:"EMOTION_LIKE"}):t===It.x.OFFENSIVE?s({emotionName:e.name,feedbackType:"EMOTION_OFFENSIVE"}):t===It.x.INCORRECT?s({emotionName:e.name,feedbackType:"EMOTION_INCORRECT",skipSendingToCAPI:!0}):s({emotionName:e.name,feedbackType:"EMOTION_DISLIKE"})},c=l.createElement(l.Fragment,null,n,l.createElement(It.A,{onDropdownPress:t?void 0:()=>{s({emotionName:e.name,feedbackType:"EMOTION_DISLIKE",skipTracking:!0})},voteNoWithDropdown:!t,ariaLabel:`Does the emotion "${e.name}" seem correct?`,voteYesAriaLabel:"This seems right",voteNoAriaLabel:"This seems wrong",voteYesTooltipMessage:"This seems right",voteNoTooltipMessage:"This seems wrong",onVote:o,irrevocable:!0,voteValue:i===Et.b.dislike||i===Et.b.offensive?It.x.NO:i===Et.b.like?It.x.YES:void 0})),d=e=>t?e===Et.b.dislike:e===Et.b.incorrect||e===Et.b.offensive,p=(0,Tt.K)(i).pipe(Mt.G(),he.U((([e,t])=>e===Et.b.none&&d(t))),ct.O(!1),xt.w((e=>e?Ft.H(3e3).pipe(Rt.h(!1),ct.O(!0)):me.of(!1)))),m=l.createElement("div",{className:Lt.emogenieReportItemFeedback},l.createElement("div",{className:Lt.emogenieReportItemFeedbackIcon}),l.createElement("div",{className:Lt.emogenieReportItemFeedbackText},"Your feedback helps us improve ",l.createElement("br",null)," our accuracy."));return l.createElement(Ue.F.div,{...(0,Oe.Sh)(Lt.emogenieReportItem,t?Lt.emogenieReportItemBrandTone:null)},p.pipe(he.U((e=>e?m:null))),d(i)?null:l.createElement("div",{role:`emotion-${a}-${e.name}`},l.createElement("div",{className:Lt.emogenieReportItemEmotion},l.createElement("div",{className:Lt.emogenieReportItemEmotionEmojiAndName},l.createElement(it.dy,{size:"medium",unicodeHexArray:[e.emojiId],unicodeLiteral:e.emoji,className:Lt.emogenieReportItemEmotionEmoji}),l.createElement("span",{className:Lt.emogenieReportItemEmotionName},e.name)),c),t?l.createElement("div",{className:Lt.emogenieReportItemDescription},e.brandToneDescription):null))};var Vt=i(95888),Ot=i(12266);const Nt=({emotions:e,emotionsPoll:t,showEmojiForDetectedTones:i,isBrandTonesEnabled:a,browser:s,onMount:r,onChangeShowEmojiForDetectedTones:n,onReportEmotionFeedback:o})=>{let c,d;switch(l.useEffect(r,[]),!0){case e.some((e=>e.brandToneLabel&&"off"===e.brandToneLabel&&e.confidence>.75)):c="Your tone sounds off";break;case e.some((e=>e.brandToneLabel&&"off"===e.brandToneLabel)):c="Something sounds slightly off...";break;case e.some((e=>e.brandToneLabel&&"on"===e.brandToneLabel)):c=a?"You're on-brand! Great job!":"Your writing sounds clear and aligned. Great job!";break;default:c="How this may sound to readers:"}switch(!0){case a&&e.some((e=>e.brandToneLabel&&"off"===e.brandToneLabel)):d=l.createElement("div",{className:Ot.emogenieReportHeaderBrandOffSubTitle},"Consider revising your message to align with your brand.");break;case a&&e.some((e=>e.brandToneLabel&&"on"===e.brandToneLabel)):d="Read about the tones below to learn more.";break;case a:d="Check your writing to see if the tone is what you had in mind.";break;default:d=null}return l.createElement("div",{className:Ot.emogenieReport,"data-grammarly-part":"emogenie-report"},l.createElement("div",{className:Ot.emogenieReportHeader},l.createElement("div",{className:Ot.emogenieReportHeaderTitle},c),l.createElement("div",{className:Ot.emogenieReportHeaderSubTitle},d)),l.createElement("div",{className:Ot.emogenieReportItems},e.map(((e,i)=>l.createElement(Pt,{onReportEmotionFeedback:o,key:e.name,index:i,emotion:e,emotionPollValue:t[e.name]||Et.b.none,isBrandTonesEnabled:a})))),l.createElement("div",{className:Ot.emogenieReportBetaDisclaimer},l.createElement(at.v,{browser:s}),l.createElement("div",{className:Ot.emogenieReportBetaDisclaimerText},"Help us improve by providing your feedback above.")),!a&&l.createElement(Vt.J,{onChange:n,labelId:"emogenie-always-show-emoji-for-detected-tones-checkbox",checked:i,className:Ot.emogenieReportCheckbox,dataGrammarlyPart:"emogenie-always-show-emoji-for-detected-tones-checkbox"},"Always show emoji for detected tones"))},Ht=({emogenieService:e,browser:t})=>l.createElement(Ue.F.Fragment,null,e.viewState.view((({report:i,emotionsPoll:a,settings:s,isBrandTonesEnabled:r})=>i&&Array.isArray(i.emotions)&&l.createElement(Nt,{emotions:i.emotions,showEmojiForDetectedTones:s.showEmoji,emotionsPoll:a,isBrandTonesEnabled:r,browser:t,onMount:()=>e.actions.trackReportShow(r),onChangeShowEmojiForDetectedTones:t=>e.actions.setShowEmojiState(t),onReportEmotionFeedback:t=>e.actions.reportEmotionFeedback(t)}))));var Bt=i(40145);const Ut=l.lazy((()=>i.e(2826).then(i.bind(i,73684)).then((({BrandTonesActivationUphookView:e})=>({default:e}))))),Dt=l.forwardRef((({emogenieService:e,viewModels:t},i)=>{const a=l.createElement(l.Fragment,null,l.createElement(Wt,{isBrandTonesEnabled:e.viewState.view("isBrandTonesEnabled"),institutionLogo:e.viewState.view("report").view((e=>null==e?void 0:e.institutionLogo)),institutionName:e.viewState.view("institutionName")}),l.createElement(Ht,{emogenieService:e,browser:t.assistantLayoutViewModel.browser}),l.createElement(Ue.F.Fragment,null,e.viewState.view((t=>!t.isBrandTonesEnabled&&!t.settings.hideBrandTonesActivationUphook&&t.settings.shouldShowBrandTonesActivationUphook&&l.createElement(l.Suspense,{fallback:l.createElement(l.Fragment,null)},l.createElement(At.L,{chunkName:"brandTonesActivationUphook"},l.createElement(Ut,{trackShow:e.actions.trackBrandToneActivationUphookShow,onActivateClick:e.actions.brandToneActivationUphookCTAClick,onDismissClick:e.actions.brandToneActivationUphookDismissClick})))))));return l.createElement(kt,{dataPartName:"emogenie-view-overlay",layoutVM:t.assistantLayoutViewModel,panelClassName:St.gradientViewOverlayPanel,hideBackButton:t.user.view((e=>e.isAnonymous))},l.createElement(Ue.F.Fragment,null,t.lensPreviewViewModel.getLens(Q.R.SpecialId.PredictionEmogenie).pipe(he.U((e=>e.count>0)),ge.x(),he.U((e=>e?l.createElement(bt,{key:"emogeniePredictionCardList",viewModels:t,ref:i,header:l.createElement(l.Fragment,null,a,l.createElement("div",{className:Bt.relatedSuggestionsTitle},"RELATED SUGGESTIONS"))}):l.createElement("div",{className:St.gradientViewOverlayContent},a))))))})),Wt=({isBrandTonesEnabled:e,institutionLogo:t,institutionName:i})=>l.createElement(Ue.F.Fragment,null,be.h.combine(e,t,i,((e,t,i)=>l.createElement("div",{className:St.defaultViewOverlayHeader},e?l.createElement("div",null,t?l.createElement("img",{className:St.logo,src:t}):null,i," Tone detector"):"Tone detector"))));var jt=i(53844);const Gt=({feedbackVM:e,layoutVM:t})=>{const i=e.entryPoint===f.Q.smartPhrases;return l.createElement(kt,{dataPartName:"feedback-view-overlay",layoutVM:t,panelClassName:St.gradientViewOverlayPanel},l.createElement("div",{className:St.gradientViewOverlayContent},l.createElement("div",{className:St.defaultViewOverlayHeader},"Product Feedback"),l.createElement(jt.q,{domain:e.getDomain(),onClose:()=>t.popActiveView(),align:"left",style:{height:"calc(100% - 48px)"},title:i?l.createElement("span",null,"How do you like ",l.createElement("br",null)," this feature?"):void 0,onSubmit:t=>e.submitFeedback(t),withScore:!0,fixSubmitButtonOverflowBottomPadding:!0,hideLogo:!0})))};var qt=i(22667),zt=i(78846);const Zt=e=>{const t=V.Z.animatingFlow((()=>e.headerVM.logoScore),Yt);return l.createElement("div",{className:zt.logo_score},V.UI.mount(Jt,t))},Yt=(e,t)=>(0,o.pipe)(e,R.filter((e=>e.type!==t.type)),R.map((()=>We.Hk("fadeout","fadein")))),Kt=V.UI.Node.make((()=>l.createElement(qt.K,{className:zt.grammarly_logo,size:22}))),Qt=V.UI.Node.make((({view:e})=>l.createElement(Ue.F.div,{className:zt.score_container,"data-grammarly-part":"assistant-score"},(0,o.pipe)(e("score"),(0,he.U)((({capiScore:e,isLoading:t})=>l.createElement(l.Fragment,null,l.createElement(He,{generalScore:e,strokeWidth:2,width:22,fontSize:e<100?11:9,isLoading:t,componentStyle:{transform:"translate(2px, -2px) rotate(-90deg)",cursor:"default"}})))))))),Xt=V.UI.Union.make("type",{logo:Kt,score:Qt}),$t=V.UI.Transition.make({fadein:zt.logoscore_fadein},{fadeout:zt.logoscore_fadeout}),Jt=V.UI.Animated.make($t,Xt);var ei=i(22679),ti=i(3860),ii=i(1620),ai=i(75100),si=i.n(ai);const ri=({enableTooltip:e=!1,...t})=>l.createElement(Le.u,{message:"Settings",showDelay:ei.gk,disabled:!e},l.createElement(ti.h,{...t},l.createElement("div",{className:si().settingsButton}))),ni=e=>{const[t,i]=l.useState(!1),[a,s]=l.useState(!1),r=e.viewModels.assistantLayoutViewModel,n=e.viewModels.assistantHeaderViewModel,c=l.useContext(Se.Context),d=(0,o.pipe)(e.viewModels.assistantProofitViewModel,R.map((e=>e.feature)),R.map((e=>l.createElement(Ue.F.Fragment,null,Ae.aj([e.layoutCreated,r.activeView.view((t=>t.type===e.assistantViewType()))]).pipe(he.U((([t,i])=>t?l.createElement(Le.u,{message:c.proofitTooltip,showDelay:ei.gk,disabled:i},l.createElement(ti.h,{onClick:()=>i?r.popActiveView():r.pushActiveView({type:e.assistantViewType()}),dataGrammarlyPart:"assistant-header-action-btn-proofit"},l.createElement("div",{className:zt.headerActionBtnProofitIcon}))):null)))))),R.toNullable),p=l.createElement(ii.P,{onClick:n.close,tooltipMessage:"Close panel",dataGrammarlyPart:"assistant-header-action-btn-close"});return l.createElement(Le.u,{message:"Grab and drag to move panel",showDelay:ei.gk,disabled:t},l.createElement("div",{...(0,Oe.Sh)(zt.header,a&&zt.actions_hovered),ref:e.draggableRef,onMouseDown:()=>i(!0),onMouseOut:()=>i(!1)},l.createElement(Zt,{headerVM:n}),l.createElement(oi,null),l.createElement(Ue.F.div,{className:zt.headerActions,onMouseOver:()=>s(!0),onMouseOut:()=>s(!1)},r.isHeaderNavigationEnabled.view((e=>e?l.createElement(l.Fragment,null,d,l.createElement(Ue.F.Fragment,null,n.showSetGoalsActionButton.view((e=>e&&l.createElement(Le.u,{message:c.setGoalsTooltip,showDelay:ei.gk},l.createElement(ti.h,{onClick:()=>n.open("setGoals"),dataGrammarlyPart:"assistant-header-action-btn-set-goals"},l.createElement("div",{className:zt.headerActionBtnGoalsIcon})))))),l.createElement(Ue.F.Fragment,null,be.h.combine(n.showSettingsActionButton,r.activeView,((e,t)=>{const i=t.type===v.aH.Type.settings;return e&&l.createElement(ri,{onClick:()=>i?r.popActiveView():r.pushActiveView({type:v.aH.Type.settings}),enableTooltip:!i,dataGrammarlyPart:"assistant-header-action-btn-settings"})}))),p):p)))))},oi=()=>l.createElement("div",{className:zt.draggableWrapper,"data-grammarly-part":"assistant-draggable-handler"},l.createElement("div",{className:zt.draggable})),li=()=>null;var ci=i(55364);const di=({layoutVM:e,onClickBack:t,children:i})=>{const[a,s]=l.useState(!1);return l.createElement(kt,{dataPartName:"proofit-view-overlay",layoutVM:e,panelClassName:ci.proofitViewOverlayPanel,onClickBack:t},l.createElement("div",{className:ci.proofitViewOverlayContent,tabIndex:-1,ref:e=>{null===e||a||(e.focus(),s(!0))}},l.createElement("div",{className:St.defaultViewOverlayHeader},l.createElement("div",{className:ci.proofitViewOverlayHeader},"Expert Writing Help",l.createElement(at.v,{browser:e.browser,className:ci.proofitViewOverlayHeaderBetaBadge}))),i))};var pi=i(10247),mi=i(2027),ui=i(81108),hi=i(2682),gi=i(18208),fi=i(59e3),vi=i(41063),wi=i(17487);const _i=({turnaroundTime:e})=>l.createElement("div",{className:vi.proofitHowItWorksSteps},l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStep,vi.proofitHowItWorksStepOne)},"Your draft will be minimized and shared with writing experts.",l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumberContainer,vi.proofitHowItWorksStepOneNumberContainer)},l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumber,vi.proofitHowItWorksStepOneNumber)},"1"))),l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStep,vi.proofitHowItWorksStepTwo)},"You will see progress indication. The average turnaround is ",e," seconds.",l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumberContainer,vi.proofitHowItWorksStepTwoNumberContainer)},l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumber,vi.proofitHowItWorksStepTwoNumber)},"2"))),l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStep,vi.proofitHowItWorksStepThree)},"Your draft will re-open with revisions highlighted.",l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumberContainer,vi.proofitHowItWorksStepThreeNumberContainer)},l.createElement("div",{...(0,Oe.Sh)(vi.proofitHowItWorksStepNumber,vi.proofitHowItWorksStepThreeNumber)},"3")))),bi=({turnaroundTime:e,freeTrialQuota:t,onSubmit:i,disabledInfo:a=null,isLoading:s=!1,style:r,onTogglePrivacyInfo:n,showPrivacyInfo:o,disableHowItWorksInfo:c=!1,onDisableHowItWorksInfo:d,showHowItWorksInfo:p,onShowHowItWorksInfo:m})=>{const[u,h]=l.useState(null!=o&&o),[g,f]=l.useState(null!=p&&p),v=t>0?t:0;l.useEffect((()=>{null==n||n(u)}),[u]),l.useEffect((()=>{h(null!=o&&o)}),[o]),l.useEffect((()=>{f(null!=p&&p)}),[p]),(0,hi.V)((()=>null==m?void 0:m()),g);const w=l.useCallback((()=>{c||g?i():f(!0)}),[c,g,i]);return l.createElement("div",{"data-grammarly-part":"proofit-request-form",style:{width:"100%",height:"100%",...r}},l.createElement("div",{className:wi.proofitRequestForm},u?l.createElement(l.Fragment,null,l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoTitle},"How we protect you"),l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescription},l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItem},l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItemText},"Our writing experts will see only your current email draft—no prior messages or contact details.")),l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItem},l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),l.createElement("div",{className:wi.proofitRequestFormPrivacyInfoDescriptionItemText},"We will not sell, rent, or make public any of your personal data."))),l.createElement(et.z,{kind:"outlined",onClick:()=>h(!1)},"Continue")):l.createElement(l.Fragment,null,g?l.createElement(_i,{turnaroundTime:e}):l.createElement(l.Fragment,null,l.createElement("div",{className:wi.proofitRequestFormImg}),l.createElement("div",{className:wi.proofitRequestFormTitle},"Get instant writing help"),l.createElement("div",{className:wi.proofitRequestFormDescription},"Our writing experts are standing by to review your email."),l.createElement("div",{className:wi.proofitRequestFormCostAndTime},l.createElement("div",{className:wi.proofitRequestFormCost},l.createElement("div",{className:wi.proofitRequestFormCostAndTimeTitle},v," free ",gi.pluralize(v,"review","reviews")),l.createElement("div",{className:wi.proofitRequestFormCostAndTimeSubtitle},"left this month",l.createElement("sup",null,"*"))),l.createElement("div",{className:wi.proofitRequestFormTime},l.createElement("div",{className:wi.proofitRequestFormCostAndTimeTitle},e," seconds"),l.createElement("div",{className:wi.proofitRequestFormCostAndTimeSubtitle},"average turnaround")))),l.createElement(et.z,{kind:"primary",className:wi.proofitRequestFormRequestBtn,disabled:Boolean(a||s),onClick:w},s?l.createElement("div",{className:fi.proofitRequestFormBtnLoadingSpinner}):c||g?"Start review":"Request now"),a||s?a?l.createElement("div",{className:wi.proofitRequestFormUnavailableMsg},l.createElement(ui.Q,{info:a})):null:l.createElement(et.z,{kind:"link",onClick:()=>h(!0)},"Learn how we protect your privacy"),l.createElement("div",{...(0,Oe.Sh)(wi.proofitRequestFormFootnote,g?wi.proofitRequestFormFootnoteHowItWorksDontShowAgainCheckbox:wi.proofitRequestFormFootnoteFreeTrial)},g?l.createElement(Vt.J,{labelId:"proofit-request-form-how-it-works-dont-show-again",onChange:d},"Don't show this again"):l.createElement("span",null,l.createElement("sup",null,"*")," included with your Premium subscription")))))},yi=({layoutVM:e,proofitVM:t})=>{const i=(0,mi.fW)(),[a,s]=l.useState(!1),[r,n]=l.useState(!1);return l.createElement(di,{layoutVM:e,onClickBack:()=>{a?s(!1):r?n(!1):e.popActiveView()}},l.createElement(Ue.F.Fragment,null,(0,Ae.aj)([t.feature.layoutCreated,t.feature.requestInfo,t.feature.turnaroundTime,t.feature.quotaRemaining,t.feature.requestDisabledInfo,t.feature.disableHowItWorksInfo]).pipe((0,he.U)((([e,o,c,d,p,m])=>e&&o.status!==pi.eE.REVIEWING?l.createElement(bi,{turnaroundTime:c,freeTrialQuota:d,onSubmit:()=>t.onSubmitRequest(i),style:{height:"calc(100% - 48px)"},disabledInfo:p,isLoading:o.status===pi.eE.PREPARING||o.status===pi.eE.PRE_SUBMIT,showPrivacyInfo:a,onTogglePrivacyInfo:s,disableHowItWorksInfo:m,onDisableHowItWorksInfo:e=>t.feature.onDisableHowItWorksInfo(e),showHowItWorksInfo:r,onShowHowItWorksInfo:()=>n(!0)}):null)))))};var Si=i(8400);const ki=({suggestionsMade:e,onAccept:t,onFeedbackFormSubmitted:i})=>l.createElement("div",{className:Si.proofitReviewForm,"data-grammarly-part":"proofit-review-form"},l.createElement("div",{className:Si.proofitReviewFormTitle},"Our experts made ",e," ",gi.pluralize(e,"suggestion","suggestions")),l.createElement("div",{className:Si.proofitReviewFormDescription},"Are you satisfied with the suggestions that our experts provided?"),l.createElement("div",{className:Si.proofitFeedbackForm},l.createElement(jt.q,{hideLogo:!0,hideTitle:!0,hideTextBoxTitle:!0,withScore:!0,placeholderText:"How can we improve?",onSubmit:i,showPostSubmitScreen:!1})),l.createElement("div",{className:Si.proofitDoneButton},l.createElement(et.z,{kind:"link",onClick:t},"Done"))),Ai=({layoutVM:e,proofitVM:t})=>{const i=(0,mi.fW)();return l.createElement(di,{layoutVM:e},l.createElement(Ue.F.Fragment,null,(0,Ae.aj)([t.feature.layoutCreated,t.feature.requestInfo]).pipe((0,he.U)((([e,a])=>e&&a.status===pi.eE.REVIEWING?l.createElement(ki,{suggestionsMade:a.suggestionsMade,onAccept:()=>t.onCompleteRequest(i),onFeedbackFormSubmitted:e=>{t.onSubmitFeedback(e),t.onCompleteRequest(i)}}):null)))))};class Ei extends l.Component{render(){return this._idSuffix=this._idSuffix||"readersAttentionOnboardingBanner_"+Ei._nextIdSuffix++,l.createElement("svg",{className:this.props.className,viewBox:"0 2 296 144",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("g",{clipPath:`url(#clip0_${this._idSuffix})`},l.createElement("rect",{width:"296",height:"144",fill:"#4A6EE0"}),l.createElement("path",{d:"M-5.5 -3.5H261.5V47.5H-5.5V-3.5Z",fill:"#6E66DE",stroke:"#1F243C"}),l.createElement("path",{d:"M-2.79293 -197.5L429.5 234.793V-197.5H-2.79293Z",fill:"#15C39A",stroke:"#1F243C"}),l.createElement("path",{d:"M219.057 33C222.992 33 226.182 29.8101 226.182 25.875C226.182 21.94 222.992 18.7501 219.057 18.7501C215.122 18.7501 211.932 21.94 211.932 25.875C211.932 29.8101 215.122 33 219.057 33Z",fill:"#1F243C",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M221.477 31.0899C225.92 31.0899 229.522 27.4881 229.522 23.045C229.522 18.6018 225.92 15 221.477 15C217.033 15 213.432 18.6018 213.432 23.045C213.432 27.4881 217.033 31.0899 221.477 31.0899Z",fill:"#41D9B5",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M220.188 27.045C220.009 27.045 219.841 26.9778 219.717 26.8434L216.927 24.0646C216.67 23.8069 216.67 23.3811 216.927 23.1122C217.185 22.8545 217.611 22.8545 217.88 23.1122L220.188 25.4204L225.353 20.2662C225.611 20.0085 226.037 20.0085 226.306 20.2662C226.563 20.5239 226.563 20.9497 226.306 21.2186L220.67 26.8546C220.535 26.9778 220.367 27.045 220.188 27.045Z",fill:"white"}),l.createElement("path",{d:"M68.125 57C72.06 57 75.25 53.8101 75.25 49.875C75.25 45.94 72.06 42.7501 68.125 42.7501C64.19 42.7501 61 45.94 61 49.875C61 53.8101 64.19 57 68.125 57Z",fill:"#1F243C",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M70.545 55.0899C74.9881 55.0899 78.5899 51.4881 78.5899 47.045C78.5899 42.6018 74.9881 39 70.545 39C66.1018 39 62.5 42.6018 62.5 47.045C62.5 51.4881 66.1018 55.0899 70.545 55.0899Z",fill:"#41D9B5",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M69.2564 51.045C69.0771 51.045 68.909 50.9778 68.7858 50.8434L65.9958 48.0646C65.7381 47.8069 65.7381 47.3811 65.9958 47.1122C66.2535 46.8545 66.6793 46.8545 66.9482 47.1122L69.2564 49.4204L74.4217 44.2662C74.6794 44.0085 75.1052 44.0085 75.3741 44.2662C75.6318 44.5239 75.6318 44.9497 75.3741 45.2186L69.7382 50.8546C69.6037 50.9778 69.4357 51.045 69.2564 51.045Z",fill:"white"}),l.createElement("rect",{x:"132",y:"38",width:"39",height:"24",rx:"2",fill:"#1F243C",stroke:"#1F243C"}),l.createElement("rect",{x:"135",y:"35",width:"39",height:"24",rx:"2",fill:"#F8C6DA",stroke:"#1F243C"}),l.createElement("path",{d:"M135 58.3296L149.303 47.4857L153.298 44.4591C154.007 43.923 154.993 43.923 155.702 44.4591L159.697 47.4857L174 58.3296",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M173.914 35.5L159.698 47.6583L155.806 50.9962C155.063 51.6361 153.956 51.6361 153.212 50.9962L149.303 47.6583L135.087 35.5",fill:"#F8C6DA"}),l.createElement("path",{d:"M173.914 35.5L159.698 47.6583L155.806 50.9962C155.063 51.6361 153.956 51.6361 153.212 50.9962L149.303 47.6583L135.087 35.5",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("rect",{x:"135",y:"35",width:"39",height:"24",rx:"2",stroke:"#1F243C"}),l.createElement("rect",{y:"32",width:"296",height:"112",fill:`url(#paint0_linear_${this._idSuffix})`}),l.createElement("path",{d:"M185.5 22C185.5 18.961 183.039 16.5 180 16.5C183.039 16.5 185.5 14.039 185.5 11C185.5 14.039 187.961 16.5 191 16.5C187.965 16.5 185.5 18.9651 185.5 22Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),l.createElement("path",{d:"M239.5 128C239.5 124.961 237.039 122.5 234 122.5C237.039 122.5 239.5 120.039 239.5 117C239.5 120.039 241.961 122.5 245 122.5C241.965 122.5 239.5 124.965 239.5 128Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),l.createElement("path",{d:"M24.5 63C24.5 59.961 22.039 57.5 19 57.5C22.039 57.5 24.5 55.039 24.5 52C24.5 55.039 26.961 57.5 30 57.5C26.9651 57.5 24.5 59.9651 24.5 63Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),l.createElement("rect",{x:"263",y:"76",width:"63",height:"77",rx:"2",fill:"#1F243C",stroke:"#1F243C"}),l.createElement("rect",{x:"267",y:"72",width:"63",height:"77",rx:"2",fill:"#F9FAFF",stroke:"#1F243C"}),l.createElement("path",{d:"M318.759 89.7112H278",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M318.759 101.227H278",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M318.759 112.743H278.095",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("path",{d:"M318.759 124.259H278",stroke:"#1F243C",strokeMiterlimit:"10"}),l.createElement("g",{style:{mixBlendMode:"multiply"},opacity:"0.4"},l.createElement("path",{d:"M318.759 101.227H278",stroke:"#41D9B5",strokeWidth:"10",strokeMiterlimit:"10"})),l.createElement("g",{style:{mixBlendMode:"multiply"},opacity:"0.4"},l.createElement("path",{d:"M305.43 112.743H278.095",stroke:"#41D9B5",strokeWidth:"10",strokeMiterlimit:"10"}))),l.createElement("defs",null,l.createElement("linearGradient",{id:`paint0_linear_${this._idSuffix}`,x1:"148",y1:"32",x2:"148",y2:"144",gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#26307D",stopOpacity:"0"}),l.createElement("stop",{offset:"1",stopColor:"#26307D",stopOpacity:"0.5"})),l.createElement("clipPath",{id:`clip0_${this._idSuffix}`},l.createElement("rect",{width:"296",height:"144",fill:"white"}))))}}Ei._nextIdSuffix=0;var Ci=i(44715);const Ii=({layoutVM:e})=>l.createElement(kt,{dataPartName:"readers-attention-help-overlay",layoutVM:e,panelClassName:Ci.helpPanel,contentClassName:Ci.helpPanelContent},l.createElement("div",{className:Ci.helpBanner},l.createElement(Ei,{className:Ci.helpBannerImage}),l.createElement("div",{className:Ci.helpHeader},"Reader′s attention",l.createElement(Ct.C,{title:"NEW",kind:"gold"})),l.createElement("div",{className:Ci.helpBannerMessage},"Get your important information across")),l.createElement("div",{className:Ci.helpContent},l.createElement("div",null,"Grammarly predicts which parts of your email will be read.",l.createElement("ul",null,l.createElement("li",null,l.createElement("span",{className:Ci.heatmap},l.createElement("b",null,"Highlighted text is most likely to be read."))),l.createElement("li",null,"The rest of the text may be skimmed or skipped.")),"Follow Grammarly’s suggestions to keep your reader’s attention.")));var Ti=i(49197),Mi=i(47960),xi=i(90282);const Fi=({feedbackVM:e,className:t,entryPoint:i})=>l.createElement(Le.u,{showDelay:ei.gk,message:"Leave feedback"},l.createElement("div",{className:null!=t?t:xi.feedbackButton,onClick:()=>e.openFeedback(i),"data-grammarly-part":"assistant-feedback-btn"},l.createElement(Mi.A,{color:Ve.Z.blue50}),"Anything we can improve?"));var Ri=i(35501),Li=i(21474),Pi=i(28706),Vi=i(32821),Oi=i(82318);const Ni=l.forwardRef((({viewModels:e,readersAttentionVM:t,checklistVM:i,headerVM:a},s)=>l.createElement(kt,{dataPartName:"readers-attention-view-overlay",layoutVM:e.assistantLayoutViewModel,panelClassName:St.gradientViewOverlayPanel},l.createElement(bt,{key:"takeawaysPredictionCardList",ref:s,viewModels:e,className:Oi.cardList,header:l.createElement(Hi,{readersAttentionVM:t,checklistVM:i,headerVM:a,layoutVM:e.assistantLayoutViewModel}),footer:l.createElement(Fi,{feedbackVM:e.assistantFeedbackViewModel,entryPoint:f.Q.readersAttention})})))),Hi=({readersAttentionVM:e,headerVM:t,checklistVM:i,layoutVM:a})=>{const s=t.message.view((e=>({content:e})));return l.createElement(l.Fragment,null,l.createElement("div",{className:St.defaultViewOverlayHeader},l.createElement("div",{className:Oi.headerGroup},"Reader′s attention",l.createElement("div",{onClick:()=>e.showHelp(v.aH.ReadersAttentionHelp.Caller.headerButton),className:Oi.questionMarkButton,"data-grammarly-part":"readers-attention-question-mark-button"},l.createElement(Li.JO.QuestionMark,{width:12,className:Oi.questionMarkIcon}))),l.createElement(at.v,{browser:a.browser})),l.createElement(Ge,{summaryVM:{summary:s},className:Oi.summaryWrapper}),l.createElement("div",{className:Oi.message},Vi.UI.mount(Di,Wi(t.attentionScoreInfo,e))),l.createElement(Ue.F.div,{...(0,Oe.Sh)(Bt.relatedSuggestionsTitle,Oi.relatedSuggestionsTitle)},i.checklist.view((e=>`${(0,Ti.z)(e)} OF ${e.size} COMPLETED`))))},Bi=Vi.UI.Node.make((({notify:e})=>l.createElement(l.Fragment,null,"Grammarly"," ",l.createElement("div",{onClick:Pi.hz(e("showHelp")),className:Oi.inlineButton,"data-grammarly-part":"readers-attention-help-link"},"highlights sentences")," ","that are likely to be read. If important sentences aren’t highlighted, state them earlier in the message or make them shorter."))),Ui=Vi.UI.Composite.make(Vi.UI.Grid.make((({slots:e})=>l.createElement(Ue.F.Fragment,null,e.content))),Ri.r),Di=Vi.UI.Union.make("kind",{withScore:Ui,withoutScore:Bi}),Wi=(e,t)=>Vi.Z.composeUnion({withScore:()=>e.pipe(ht.oA),withoutScore:Vi.Z.fromSideEffect((e=>{"showHelp"===e&&t.showHelp(v.aH.ReadersAttentionHelp.Caller.descriptionLink)}),null)},(()=>e.pipe(he.U((0,m.flow)(ji,(e=>({kind:e})))))));function ji(e){return(0,m.pipe)(e,R.fold((()=>"withoutScore"),(()=>"withScore")))}var Gi=i(73582),qi=i(19106),zi=i(17324),Zi=i(99446);const Yi=()=>l.createElement("svg",{width:"11",height:"12",viewBox:"0 0 11 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M4 1H2.5C1.39543 1 0.5 1.89543 0.5 3V9C0.5 10.1046 1.39543 11 2.5 11H8.5C9.60457 11 10.5 10.1046 10.5 9V7.5M5.5 6L10.5 1M10.5 1H6.5M10.5 1V5",stroke:"#4A6EE0",strokeLinecap:"round"}));var Ki=i(5872),Qi=i(26485),Xi=i(68089);const $i=({children:e,blocked:t,wrapperClassName:i})=>t?l.createElement(Le.u,{message:"Sign in to use this feature",position:"top"},l.createElement("div",{className:i},l.createElement("div",{className:Xi.hover_blocker,onClick:Z.EI,onDoubleClick:Z.EI},e))):l.createElement(l.Fragment,null,e);class Ji extends l.Component{constructor(){super(...arguments),this.handleChange=e=>{(this.props.skipTrustedCheck||e.isTrusted)&&this.props.onChange(e)}}render(){return l.createElement("div",{...(0,Oe.Sh)(this.props.extraClassName,Qi.setting_item,this.props.disabled&&Qi.disabled)},l.createElement("label",{className:(0,Ki.cs)(Qi.select_checkbox,this.props.centered?Qi.centered:void 0),"data-grammarly-part":this.props.dataGrammarlyPart},l.createElement("div",{className:Qi.select_children},this.props.children,this.props.beta&&l.createElement("span",{className:(0,z.G6)()?Qi.new:Qi.beta})),l.createElement($i,{wrapperClassName:Qi.checkbox_control_wrapper,blocked:this.props.disabled}),l.createElement("input",{className:Qi.checkbox,onChange:this.props.disabled?Z.EI:this.handleChange,checked:this.props.checked,type:"checkbox"}),l.createElement("div",{...(0,Oe.Sh)(Qi.checkbox_check,this.props.grayOut&&Qi.grayOut,this.props.checked?Qi.on:Qi.off)},l.createElement("div",{...(0,Oe.Sh)(Qi.on_off)},this.props.checked?"ON":"OFF"),l.createElement("div",{className:Qi.checkbox_check_round}))))}}var ea=i(62111),ta=i(47740);const ia=({showTitle:e,openGBLanding:t})=>l.createElement("div",{className:ta.container},l.createElement("div",{className:ta.contant},e&&l.createElement("div",{className:ta.title},"Grammarly for your team"),l.createElement("div",null,"Help your team make your business look great with top-notch writing."),l.createElement("div",{className:ta.spacer}),l.createElement(et.z,{size:"medium",onClick:()=>{t((0,z.Um)().businessEHomepage),(0,ea.T)().gGbUpHookClick()}},"Explore Grammarly Business")));var aa=i(1005);const sa=({heading:e,enabled:t,children:i})=>t?l.createElement(l.Fragment,null,l.createElement("div",{className:aa.heading},e),l.createElement("div",null,i)):l.createElement(l.Fragment,null,i);var ra=i(4120),na=i(24372);class oa extends l.Component{constructor(){super(...arguments),this.onEnableDefsClick=e=>{const{toggleDefs:t}=this.props,i=e.target.checked;t(i),na.J.definitionToggleClick(i?"on":"off"),(0,ea.T)().toggleExtensionDefs(i)}}render(){const{enabledDefs:e,disabled:t}=this.props;return l.createElement(Ji,{onChange:this.onEnableDefsClick,checked:e,extraClassName:zi.def_switcher,dataGrammarlyPart:"definitionAndSynonymsSwitcher",disabled:t,skipTrustedCheck:this.props.skipTrustedCheck},"Show definitions and synonyms ",l.createElement("br",null),"via double clicks (all sites)")}}var la=i(6304),ca=i(66402);const da=()=>l.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.createElement("path",{d:"M13.9207 15L15.5 17.2562L17.0793 15H13.9207Z",stroke:"#6D758D",strokeWidth:"2"}));var pa=i(7046),ma=i(95286),ua=i(71527);const ha={american:l.createElement((()=>l.createElement("div",{className:ca.american,role:"presentation"})),null),australian:l.createElement((()=>l.createElement("div",{className:ca.australian,role:"presentation"})),null),british:l.createElement((()=>l.createElement("div",{className:ca.british,role:"presentation"})),null),canadian:l.createElement((()=>l.createElement("div",{className:ca.canadian,role:"presentation"})),null)},ga=["british","american","australian","canadian"],fa=e=>{return l.createElement(l.Fragment,null,ha[e.dialect],l.createElement("span",{"data-test-attr":`dialect_${e.dialect}`,className:ua.label},(t=e.dialect).charAt(0).toUpperCase()+t.slice(1)+" English"));var t};class va extends l.Component{render(){const e=this.props.dropdownOnTop?{customPosition:{top:"-100px",left:"0"},vAlign:"top"}:{customPosition:{top:"36px",left:"0"}};return l.createElement(ma.L,{...e,showDelay:0,closeDelay:150,appearanceBehavior:"mouseClick",name:"dialect",label:l.createElement(pa.zx.White,{name:"dialect.box",style:{padding:"0"}},l.createElement("div",{className:ua.selected},l.createElement(fa,{dialect:this.props.dialect}),l.createElement(da,null)))},ga.filter((e=>e!==this.props.dialect)).map((e=>l.createElement(pa.zx.Flat,{name:e,key:e,onClick:t=>(null==t?void 0:t.isTrusted)&&this.props.onSetDialect(e)},l.createElement("div",{className:ua.option},l.createElement(fa,{dialect:e}))))))}}class wa extends l.Component{constructor(){super(...arguments),this.setDialect=e=>{const{changeStrongDialect:t,dialectWeak:i}=this.props;t(e);const a=e+"English";na.J.languageSettingUpdate(a,"user",i&&e===i)}}render(){var e;const t=this.props.dialectStrong||this.props.dialectWeak||"american";return l.createElement("div",{...(0,Oe.Sh)(la.line,this.props.disabled&&la.disabled,!(null!==(e=this.props.withoutMaxWidth)&&void 0!==e&&e)&&la.withMaxWidth)},l.createElement("div",null,"I write in"),l.createElement($i,{blocked:this.props.disabled},l.createElement("div",{className:la.dialectPicker},l.createElement(va,{dialect:t,onSetDialect:this.setDialect,dropdownOnTop:!!this.props.dropdownOnTop}))))}}const _a=e=>{const t="docs.google.com"===e.domain,i=t?"Google Docs":e.domain,a=t&&!(0,z.Am)(),{enabledInConfig:s,siteSwitcherChecked:r,favicon:n}=e,o=r.checked&&s,c=s?"Check for writing suggestions":"Checking is not supported";return l.createElement(Ji,{grayOut:!s,onChange:e=>r.update(e.target.checked),checked:o,extraClassName:zi.site_switcher,dataGrammarlyPart:"siteSwitcher",skipTrustedCheck:e.skipTrustedCheck,centered:!!e.centeredToggle},l.createElement("div",{"data-test-attr":"siteControlsLabelText"},c,l.createElement("br",null)," ",l.createElement("span",{...(0,Oe.Sh)(zi.domain,e.centeredToggle&&zi.centered)},l.createElement("span",{className:zi.thin_text},"on")," ",n&&l.createElement("span",{className:zi.favicon},l.createElement("img",{width:"16px",height:"16px",src:n})),i,a&&l.createElement("span",{className:Qi.beta}))))};var ba=i(56542),ya=i(37896),Sa=i(23345);const ka=l.createContext({}),Aa=e=>{const t=l.useContext(ka),{registrationDate:i}=e.user,a=(0,ya.p6)(i);return l.createElement("div",{className:Sa.line},l.createElement("div",{className:Sa.content},a&&l.createElement("div",{"data-test-attr":"checked_since"},"Grammarly has been correcting your text since ",a,"."),l.createElement("div",{className:Sa.upgrade,onClick:()=>{e.openSubscriptionDialog({utmSource:"upHook",utmCampaign:"extensionSettingsToolbar"}),na.J.getPremiumButtonClick(e.isAssistant?"assistantSettings":"settingsToolbar","GoPremiumToEnableAdvancedFixes"),(0,ea.T)().userUpgradeClick("settingsToolbar")},style:{fontSize:t.ctaFontSize}},"Go Premium to Enable Advanced Fixes")))},Ea=e=>l.createElement(Ji,{onChange:t=>{e.toggle(t.target.checked)},checked:e.enabled,extraClassName:zi.def_switcher},"Correct spelling automatically"),Ca=e=>l.createElement(Ji,{checked:!e.enabled,extraClassName:zi.def_switcher,onChange:t=>{e.toggle(!t.target.checked)},dataGrammarlyPart:"disableDesktopIntegrationToggle"},l.createElement("div",{className:zi.llamaTitle},"Check text with browser extension"),l.createElement("div",{className:zi.llamaDescription},"Grammarly's browser extension was deactivated since you're using Grammarly's Desktop integration.")),Ia=e=>l.createElement(Ji,{onChange:t=>{e.toggle(t.target.checked)},beta:!0,checked:e.enabled,extraClassName:zi.def_switcher},"Show phrasal predictions"),Ta=e=>{var t;const{actions:i,activeTab:a,config:s,settings:r,user:n,siteCategory:o,openSubscriptionDialog:c,openGBLanding:d,showGBUpHook:p,placement:m,showAutocorrectToggle:u,dynamicConfig:h,enableRenderingHack:g=!1,isAssistant:f,isSingleCardAssistant:v=!1}=e;g&&l.useEffect((()=>{(0,z.CB)()&&(self.screenLeft<0||self.screenTop<0||self.screenLeft>self.screen.width||self.screenTop>self.screen.height)&&chrome.runtime.getPlatformInfo((e=>{if("mac"===e.os){const e=new CSSStyleSheet;e.insertRule("\n            @keyframes redraw {\n              0% {\n                opacity: 1;\n              }\n              100% {\n                opacity: .99;\n              }\n            }\n          "),e.insertRule("\n            html {\n              animation: redraw 1s linear infinite;\n            }\n          "),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}}))}),[]);const{premium:w,experiments:_,anonymous:b}=n,y=p&&w&&!ra.n5.doesUserBelongToInstitution(n),S=w||b,k=e.siteSwitcherChecked||{checked:!!r.enabled,update:t=>{const{siteCategory:a}=e;i.toggleSite(t,s.domain),na.J.checkingToggleClick("toolbar",a,t?"on":"off"),(0,ea.T)().toggleExtension(t,"toolbar")}},A=!1;return l.createElement("div",{...(0,Oe.Sh)(ba.settingsContent,v?ba.singleCardAssistant:null)},l.createElement("div",{...(0,Oe.Sh)(ba.heading,v?ba.singleCardAssistant:null)},l.createElement("div",null,"Quick Settings"),l.createElement(et.z,{kind:"link",onClick:()=>{e.openUrl((0,z.Um)().allSettings),na.J.allSettingsButtonClick(m)}},l.createElement("div",{className:ba.allSettings},l.createElement("span",null,"All Settings"),l.createElement(Yi,null)))),Zi.q.showSettingPopupToggle(r,h,_,null==a?void 0:a.url)&&l.createElement(sa,{heading:"DESKTOP INTEGRATION SETTING",enabled:A},l.createElement(Ca,{toggle:e=>{i.setDesktopIntegration(e),na.J.desktopIntegrationToggleClick(e?"on":"off")},enabled:r.isDesktopIntegrationEnabled}),l.createElement("div",{className:ba.separator})),l.createElement(sa,{heading:"SITE SETTINGS",enabled:A},l.createElement(_a,{domain:s.domain,enabledInConfig:s.enabled,siteSwitcherChecked:k,favicon:null==a?void 0:a.favIconUrl,siteCategory:o,experiments:_}),l.createElement("div",{className:ba.separator})),l.createElement(sa,{heading:"FEATURES (ALL SITES)",enabled:A},l.createElement(oa,{disabled:b,enabledDefs:r.enabledDefs,toggleDefs:i.toggleDefs}),u&&l.createElement(l.Fragment,null,l.createElement("div",{className:ba.separator}),l.createElement(Ea,{enabled:r.autocorrectEnabled||!1,toggle:e=>{i.toggleAutocorrect(e),na.J.autocorrectToggleClick(e?"on":"off")}})),(null===(t=n.experiments)||void 0===t?void 0:t.autocompleteEnabled)&&l.createElement(l.Fragment,null,l.createElement("div",{className:ba.separator}),l.createElement(Ia,{enabled:r.autocompleteEnabled||!1,toggle:e=>{i.toggleAutocomplete(e),na.J.autocompleteFeatureToggleClick("popup",e?"on":"off")}}))),l.createElement(sa,{heading:"CUSTOMIZE GRAMMARLY",enabled:A},l.createElement(wa,{changeStrongDialect:i.changeStrongDialect,dialectStrong:r.dialectStrong,dialectWeak:r.dialectWeak,dropdownOnTop:S,disabled:b,withoutMaxWidth:v}),A),!S&&l.createElement(Aa,{user:n,openSubscriptionDialog:c,isAssistant:null!=f&&f}),y&&l.createElement(ia,{openGBLanding:d,showTitle:"popup"===m}))};var Ma=i(32138),xa=i(82785),Fa=i(91574);const Ra=({viewModels:e,children:t})=>{const{domain:i,actions:a,state:s}=e.assistantSettingsViewModel,[r,n]=l.useState(!!s.view("commonSettings","enabled").get()),o={checked:r,update:n};return t({content:l.createElement("div",{className:e.isSingleCardAssistant?void 0:St.gradientViewOverlayContent},l.createElement(Ue.F.Fragment,null,s.view((({user:t,commonSettings:r,dynamicConfig:n})=>{var c;return l.createElement(ka.Provider,{value:{ctaFontSize:13}},l.createElement(Ta,{actions:a,config:{enabled:!0,domain:i},settings:r,user:t,dynamicConfig:n,siteCategory:xa.y.other,openSubscriptionDialog:()=>e.isSingleCardAssistant?null:e.upgradeViewModel.openUpgradeUrl(Gi.L.Place.extensionSettingsAssistant),openGBLanding:e=>{const t=(0,Ma.Z4)(e,"gbExtensionSettingsAssistant");self.open(t),qi.J.getGBButtonClick("gbExtAssistantSettings","ExploreGrammarlyBusiness")},openUrl:e=>self.open(e),showGBUpHook:(0,z.i7)(),placement:"assistant",showAutocorrectToggle:(0,z.i7)()||!!(null===(c=s.view("user","experiments").get())||void 0===c?void 0:c.autoCompleteCorrectAllBrowsers),siteSwitcherChecked:o,isAssistant:!0,isSingleCardAssistant:e.isSingleCardAssistant}))}))),l.createElement(Fi,{feedbackVM:e.assistantFeedbackViewModel,entryPoint:f.Q.settings,className:e.isSingleCardAssistant?xi.singleCardAssistantFeedbackButton:void 0})),onDone:()=>{a.toggleSite(r,i),qi.J.checkingToggleClick("assistant",xa.y.other,r?"on":"off"),(0,ea.T)().toggleExtension(r,"assistant"),e.assistantLayoutViewModel.popActiveView()}})},La=({viewModels:e})=>l.createElement(Ra,{viewModels:e},(({content:t,onDone:i})=>l.createElement(kt,{dataPartName:"settings-view-overlay",layoutVM:e.assistantLayoutViewModel,panelClassName:St.gradientViewOverlayPanel,footer:l.createElement(et.z,{className:Fa.settingsDoneButton,kind:"success",type:"submit",onClick:i},"Done")},t)));var Pa=i(62727),Va=i(80550),Oa=i(92132),Na=i(70091),Ha=i(63544),Ba=i(17161),Ua=i(67521),Da=i(5817),Wa=i(71284),ja=i(41046),Ga=i(41488),qa=i(97528),za=i(71860),Za=i(85089),Ya=i(2834),Ka=i(83401),Qa=i(52342),Xa=i(78674),$a=i(50628),Ja=i(8313);const es=l.memo((({viewModels:e,emogenieService:t,height:i,ready:a,OuterElementsPortalSource:s})=>{const r=new D.C;(0,F.iR)("viewModels",e);const n=(0,mi.IQ)(),c=(0,mi.e8)(),d=l.useContext(mi.Dg).state.pipe(N.h((e=>!e.dragging)),ct.O(Ha.zM)),p=l.useContext(Ba.Y),m=be.h.create(dt.Rect.empty),{initialPositionOffset:u}=e.positionViewModel;(0,Ua.A)((0,Ae.aj)([d,p]).pipe(he.U((([e,t])=>({height:t.height,width:t.width,top:t.top+e.translate.y+u.top,left:t.left+e.translate.x+u.left,bottom:t.top+t.height+e.translate.y,right:t.left+t.width+e.translate.x}))),Ya.b(pe.wW(m)))),(0,Ua.A)(d.pipe(Ya.b((t=>e.positionViewModel.onDrag(t))))),(0,Ua.A)(e.assistantLayoutViewModel.activeView.pipe(Mt.G(),Ya.b((([t,i])=>{t.type!==i.type&&v.aH.isDefault(i)&&e.cardsListScrollManager.paddingTop.set(0)}))));const h=l.useRef(null);return l.useEffect((()=>{e.assistantCardListViewModel.cardListContext.next(R.fromNullable(h.current));const t=h.current?Za.rl(h.current,{subtree:!0,childList:!0}):Ka.C,i=m.view((e=>({top:e.top,left:e.left}))),s=(0,o.pipe)(t,Qa.V((0,Da.m9)(1)),Xa.b(10),$a.P()).subscribe((()=>a(i,n)),(()=>{a(i,n,!0)}));return()=>{s.unsubscribe()}}),[]),l.createElement(ts,{remSize:e.remSize,environment:r,viewport:p.pipe(he.U((e=>({height:e.height,width:e.width,top:e.top,left:e.left,bottom:e.top+e.height,right:e.left+e.width}))))},l.createElement(Ue.F.div,{"data-grammarly-part":"assistant-popup-content",...(0,Oe.Sh)(pt.assistant,n.pipe(ct.O(!1),he.U((e=>e&&pt.dragging)))),style:{height:i,maxHeight:"90vh"}},l.createElement(ni,{viewModels:e,draggableRef:c}),e.assistantLayoutViewModel.activeView.view((i=>v.aH.isDefault(i)?l.createElement(vt,{viewModels:e,ref:h,key:"default-view"}):v.aH.isEmogenie(i)?l.createElement(Dt,{emogenieService:t,viewModels:e,key:"emogenie-view",ref:h}):v.aH.isReadersAttention(i)?l.createElement(Ni,{viewModels:e,readersAttentionVM:e.readersAttentionViewModel,checklistVM:e.readersAttentionChecklistViewModel,headerVM:e.readersAttentionHeaderViewModel,key:"readers-attention-view",ref:h}):v.aH.isReadersAttentionHelp(i)?l.createElement(Ii,{layoutVM:e.assistantLayoutViewModel,key:"readers-attention-help"}):v.aH.isFeedback(i)?l.createElement(Gt,{feedbackVM:e.assistantFeedbackViewModel,layoutVM:e.assistantLayoutViewModel,key:"feedback-view"}):v.aH.isSettings(i)?l.createElement(La,{viewModels:e,key:"settings-view"}):v.aH.isProofitRequest(i)&&R.isSome(e.assistantProofitViewModel)?l.createElement(yi,{layoutVM:e.assistantLayoutViewModel,proofitVM:e.assistantProofitViewModel.value,key:"proofit-request-view"}):v.aH.isProofitReview(i)&&R.isSome(e.assistantProofitViewModel)?l.createElement(Ai,{layoutVM:e.assistantLayoutViewModel,proofitVM:e.assistantProofitViewModel.value,key:"proofit-review-view"}):v.aH.isPopup(i)?l.createElement(li,{key:"popup-view",viewModels:e}):null))),l.createElement(s,null,l.createElement(Na.jv,null,l.createElement(Va.L,{modalManager:e.assistantModalManager}))),l.createElement(za.X,null))})),ts=({environment:e,viewport:t,children:i,remSize:a})=>{var s;const r=l.useRef(Me(Ee.m.getConfig(e.has(D.U.Flag.isAppleSystem)?"mac":"windows"))),n=null===(s=l.useContext(Pa.n.Context))||void 0===s?void 0:s.host;return l.createElement(Oa.Q,{remSize:a,setter:e=>ja.u.setRootCssVar(n||document.documentElement,e)},l.createElement(D.U.Context.Provider,{value:e},l.createElement(Wa.a.Context.Provider,{value:e},l.createElement(Se.Context.Provider,{value:r.current.assistant},l.createElement(Ee.m.Context.Provider,{value:r.current.denali},l.createElement(Ja.TG.ContextMock,null,l.createElement(Ga.l.RootVirtualContainer,{viewport:t,name:"draggable"},l.createElement(qa.G.DefaultProvider,null,l.createElement(Na.jv,null,i)))))))))};var is=i(53447);const as=({assistantLayout:e,textFieldRect:t,viewModels:i,dataGrammarlyPart:a,children:s})=>{const{initialPositionOffset:r}=i.positionViewModel,n={...t.client,...t.size},o=(0,is.C7)();return l.createElement(mi._l,{bounds:o,hasDragHandle:!0},(({translate:t})=>l.createElement(Ba.s,{anchorRect:n,viewportRect:o,anchorOrigin:e.anchorOrigin,elementOrigin:e.assistantOrigin,anchorMargin:e.anchorMargin,repositioning:e.repositioningStrategy,stickToTarget:!1,viewportMargin:0,postRepositioningOffset:{horizontal:r.left,vertical:r.top}},(({top:e,left:i})=>l.createElement("div",{"data-grammarly-part":a,style:{position:"fixed",top:e,left:i,transform:`translate(${t.x}px, ${t.y}px)`,zIndex:ei.Eq}},s)))))};var ss=i(87889),rs=i(12267);const ns=l.forwardRef((({icon:e,name:t,onClick:i},a)=>l.createElement("span",{ref:a},l.createElement(ss.k.button.secondary,{text:l.createElement(ss.k.icon[e]),name:t,state:O.zx.State.enabled,tooltip:void 0,onClick:i})))),os=({onClick:e})=>l.createElement(Le.u,{message:"Settings",showDelay:ei.gk},l.createElement(ns,{icon:"gear",name:"Settings",onClick:e})),ls=({onClick:e})=>l.createElement(Le.u,{message:"Close panel",showDelay:ei.gk},l.createElement(ns,{icon:"close",name:"Close",onClick:e})),cs=l.forwardRef((({draggableRef:e,onClickSettings:t,onClickClose:i,onClickBack:a,overlapContentWithHeader:s=!1,headerContent:r,className:n,children:o,includeContentPadding:c=!1},d)=>{const[p,m]=l.useState(!1),[u,h]=l.useState(!1),[g,f]=l.useState(!1),[v,w]=l.useState(!1),[_,b]=l.useState(!1);return l.useEffect((()=>{h(v||g)}),[v,g]),l.useEffect((()=>{a||w(!1)}),[a]),l.createElement("div",{...(0,Oe.Sh)(rs.singleCardAssistant,n),"data-grammarly-part":"single-card-assistant",ref:d},l.createElement(Le.u,{disabled:!e||_,message:"Grab and drag to move panel",showDelay:ei.gk},l.createElement("div",{...(0,Oe.Sh)(rs.singleCardAssistantHeader,e?rs.singleCardAssistantHeaderDraggable:null,s?rs.singleCardAssistantHeaderWithOverlappingContent:rs.singleCardAssistantHeaderWithoutOverlappingContent,u?rs.singleCardAssistantHeaderWithButtonHovered:null),ref:e,onMouseDown:()=>b(!0),onMouseOver:()=>{u||m(!0)},onMouseOut:()=>{m(!1),b(!1)}},l.createElement("div",{className:rs.singleCardAssistantHeaderButtons,onMouseEnter:()=>{m(!1),f(!0)},onMouseLeave:()=>f(!1)},t?l.createElement(os,{onClick:t}):null,i?l.createElement(ls,{onClick:i}):null),l.createElement("div",{className:rs.singleCardAssistantHeaderContent},e?l.createElement("div",{className:rs.singleCardAssistantHeaderDraggableIcon}):null,a?l.createElement(Le.u,{message:"Back to all alerts",showDelay:ei.gk},l.createElement(ti.h,{kind:"neutral",className:rs.singleCardAssistantHeaderBackButton,onClick:a,onMouseEnter:()=>{m(!1),w(!0)},onMouseLeave:()=>w(!1)},l.createElement("div",{className:rs.singleCardAssistantHeaderBackButtonIcon}))):null,r?l.createElement("div",{className:rs.singleCardAssistantHeaderContentInner},r):null))),e&&s&&p?l.createElement("div",{className:rs.singleCardAssistantHeaderDraggableHoveredBackground}):null,l.createElement("div",{...(0,Oe.Sh)(rs.singleCardAssistantContent,s?rs.singleCardAssistantContentWithOverlappingHeader:null,c?rs.singleCardAssistantContentWithPadding:null)},o))}));var ds=i(17208);const ps=({acceptedSuggestionsCount:e,wordsCount:t})=>l.createElement("div",{className:ds.successReport},l.createElement("div",{className:ds.successReportIcon}),l.createElement("div",{className:ds.successReportTitle},t<2?"Looking good so far":e>0?`${e} ${gi.pluralize(e,"issue addressed","issues addressed")}`:"Nice job!"),l.createElement("div",{className:ds.successReportSubtitle},t<2?"Keep writing to see suggestions.":e>0?"All clear!":"You made that look easy!"));var ms=i(29758),us=i(43314),hs=i(40656);const gs=l.memo((({viewModels:e,emogenieService:t,height:i,ready:a})=>{const s=new D.C;(0,F.iR)("viewModels",e);const n=(0,mi.IQ)(),o=(0,mi.e8)(),c=l.useContext(mi.Dg).state.pipe(N.h((e=>!e.dragging)),ct.O(Ha.zM)),d=l.useContext(Ba.Y),p=be.h.create(dt.Rect.empty),{initialPositionOffset:m}=e.positionViewModel;(0,Ua.A)(Ae.aj([c,d]).pipe(he.U((([e,t])=>({height:t.height,width:t.width,top:t.top+e.translate.y+m.top,left:t.left+e.translate.x+m.left,bottom:t.top+t.height+e.translate.y,right:t.left+t.width+e.translate.x}))),Ya.b(pe.wW(p)))),(0,Ua.A)(c.pipe(Ya.b((t=>e.positionViewModel.onDrag(t))))),l.useEffect((()=>{const e=p.view((e=>({top:e.top,left:e.left})));a(e,n)}),[]);const u=l.useRef(null),h=l.useRef(null);l.useEffect((()=>{var e;return u.current&&(null===(e=h.current)||void 0===e||e.disconnect(),h.current=ms.N.getResizeObserver(g),h.current.observe(u.current)),()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.disconnect()}}),[u.current]);const g=()=>{u.current&&i.set(u.current.getBoundingClientRect().height)},f=e.lensState.lens(M.nL.Prism.getLens()),w=e.lensState.pipe(he.U((t=>x.v.WithSuccess.State.isInSuccess(e.capabilities)(t)))),_=e.assistantLayoutViewModel.activeView.view(v.aH.isDefault),b=l.createElement(Ue.F.Fragment,null,e.assistantLayoutViewModel.activeView.view((e=>v.aH.isEmogenie(e)?l.createElement(Ue.F.Fragment,null,t.viewState.view((e=>{var t;return e.isBrandTonesEnabled?l.createElement("div",{className:hs.singleCardAssistantEmogenieReportHeaderBrandTones},(null===(t=e.report)||void 0===t?void 0:t.institutionLogo)?l.createElement("img",{className:hs.singleCardAssistantEmogenieReportHeaderBrandTonesLogo,src:e.report.institutionLogo}):null,e.institutionName," Tone Detector"):"Tone Detector"}))):v.aH.isSettings(e)?"Settings":v.aH.isFeedback(e)?"Product Feedback":null)));return l.createElement(ts,{remSize:e.remSize,environment:s,viewport:d.pipe(he.U((e=>({height:e.height,width:e.width,top:e.top,left:e.left,bottom:e.top+e.height,right:e.left+e.width}))))},l.createElement(Ue.F.Fragment,null,Ae.aj([_,w]).pipe(he.U((([i,a])=>{const s=i&&!a;return l.createElement(cs,{className:hs.singleCardAssistant,draggableRef:o,onClickSettings:s?void 0:()=>e.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.settings}),onClickClose:s?void 0:e.closeAssistant,onClickBack:i?void 0:()=>e.assistantLayoutViewModel.popActiveView(),headerContent:b,overlapContentWithHeader:s,includeContentPadding:!s,ref:u},l.createElement(Ue.F.Fragment,null,e.assistantLayoutViewModel.activeView.view((i=>v.aH.isDefault(i)?l.createElement(Ue.F.Fragment,null,w.pipe(he.U((t=>t?l.createElement(Ue.F.Fragment,null,be.h.combine(e.statisticsService.sessionStats,e.statisticsService.wordsCount,((e,t)=>{var i;return l.createElement(ps,{acceptedSuggestionsCount:null!==(i=null==e?void 0:e.alertsStats.accepted.total)&&void 0!==i?i:0,wordsCount:t})}))):Vi.UI.mount(us.c.assistant(r.item(e.cardsViewModel.actionEvents)),r.createCardListFlow(f,e.capabilities)))))):v.aH.isEmogenie(i)?l.createElement(Ht,{emogenieService:t,browser:e.assistantLayoutViewModel.browser}):v.aH.isSettings(i)?l.createElement(Ra,{viewModels:e},(({onDone:e,content:t})=>l.createElement(l.Fragment,null,t,l.createElement(et.z,{kind:"primary",type:"submit",onClick:e,className:Fa.settingsDoneButton},"Done")))):v.aH.isFeedback(i)?l.createElement(jt.q,{domain:e.assistantFeedbackViewModel.getDomain(),hideDomainHelpText:!0,onClose:()=>e.assistantLayoutViewModel.popActiveView(),align:"left",title:l.createElement("span",null,"How do you like Grammarly?"),onSubmit:t=>e.assistantFeedbackViewModel.submitFeedback(t),withScore:!0,hideLogo:!0,hideTextBoxTitle:!0,placeholderText:"How can we improve?",compactDisplay:!0,submitButtonKind:"primary"}):null))))})))))}));var fs=i(63919),vs=i(39485),ws=i(45586),_s=i(49708),bs=i(2768);(0,vs.C)();class ys{constructor(e,t){this._params=e,this._felog=t,this._log=c.Y.create(ys.name),this._integration=null,this._viewModels=be.h.create(null),this._assistantPopupIsReady=new ue.xQ,this._initPerformance=void 0,this._openMeasure=void 0,this._height=be.h.create(0),this.openState=be.h.create("closed"),this._subs=new ws.w.Keeper,this.open=(e,t)=>{var i,a;const s=this._params.contentScriptState.view("user").view((e=>({isPremium:e.premium,isAnonymous:e.anonymous,experiments:e.experiments,customFields:e.customFields}))),n=s.view("experiments").view((e=>null==e?void 0:e.singleCardAssistant)).get(),l=this._viewModels.get();if(null!==l)Ss(!0,l,t);else{this._openMeasure=this._felog.openTime.startMeasure();const l=this._felog.initTime.startMeasure();this.openState.set("opening");const c=this._params.assistantService,d=c.createIntegration();if(!d)return this._log.warn("tried to open assistant with checking service not initialized"),l.cancelMeasure(),void this._openMeasure.cancelMeasure();null===(a=(i=this._params).onOpen)||void 0===a||a.call(i,d),this._integration=d;const p=n?((e,t,i,a,s,n,o,l,c,d,p,y,S,k,A,C,I,T,F,L)=>{const P=ye.Monitoring.Logging.getLogger("single_card_assistant_view_modes"),V=be.h.create($.A.defaultState),O=te.t.create(te.t.defaultLensFilters,{...te.t.defaultTextFilters,[Q.R.SpecialId.Closed]:m.constFalse,[Q.R.SpecialId.AllAlerts]:X.bZ.belongsToAllAlerts}),H=$.A.get(e.alertsList.state,e.alertsList.lensesScores,O).subscribe(pe.wW(V)),Se=new G.t(V.view("lenses"),O,e.sessionModel.scoreStatus),ke=(0,ae.$y)((0,Y.a)(t).getContents),Ae={features:new Set([E.IG.Features.showCardLabelInOutcomes]),cardLayoutDensityMode:ne.j.Density.minimal,shouldAnimateAlertApply:E.IG.Default.shouldAnimateAlertApply},Ee=(0,E.Ls)(ke,e.alertsReader,Ae,(()=>me.of(R.none)),e.mutingAlertsReader),Ce=be.h.create(16),Ie=r.getCapabilities(Ee,e.alertsReader),Te=new le.oq(e.alertsList.state,e.alertsReader,V.view("lenses"),e.positionManager,Se,new ce.gi(r.equatable.structEq,r.defaultOrd),(0,ce.is)(Ee,Ie),Ie,O);i.set(Q.R.SpecialId.AllAlerts);const Me=i.get(),xe=be.h.create(Te.emptyState(Me).patch({alertSource:X.l$.sidebar}));a.next({kind:U.R.ChangeLens,selectedLens:"all"});const Fe=(0,se.u0)((()=>t.getCursor().index),Te),Re=new ie.Xx({flush:()=>t.flushChanges()},new ue.xQ,Ee,e.alertsService,e.sduiService,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,m.pipe)(e.mutedAlertsCategoriesModel,R.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,z.Um)().suggestionsSettings)})))),R.none,(()=>!1),r.getActiveItemWithAlert,Ie,xe,new D.C),Le=new B(c,S,k,F,Re.actionEvents,y),Pe=new ue.xQ,Ve=xe.pipe(he.U((e=>e.currentLens.id))),Oe=Le.activeView.pipe(he.U((e=>{switch(e.type){case v.aH.Type.default:return i.get();case v.aH.Type.emogenie:return Q.R.SpecialId.PredictionEmogenie;default:return null}})),N.h(Z.fQ),ge.x(),he.U((e=>[e,e===Q.R.SpecialId.AllAlerts]))).subscribe((([e,t])=>Pe.next({lensId:e,focusFirstCard:t}))),Ne=new f._(Le,d,c),He=new g.y(Re.actionEvents,c,e.alertsReader,p),Be=new re.o((()=>_e.right(void 0))),Ue=new q.o(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,xe,O,fe.E,r.getActiveItemWithAlert,p.view("experiments"),s,!0),De=(0,W.hp)(xe,Ue,Ce,Be,t,P),We=new ee.mN(t,xe,Ue,e.alertsReader,r.getActiveItemWithAlert,(t=>{const i=t.reduce(((t,i)=>(0,m.pipe)(e.alertsReader.getById(i.alert.id),R.chain(X.bZ.getRawId),ve.tap((e=>t.set(e,i))),R.fold((()=>t),(()=>t)))),new Map),a=Array.from(i.keys()).map(C.alerts.getAlertById).filter(Z.fQ);if(a.length){const e=a.reduce(((e,t)=>u.S.ordering.greaterThanOrEqual(t,e)?t:e));return R.fromNullable(i.get(K.wQ.Id.create(e.id)))}return R.none})),je=be.h.create((0,m.pipe)(n,R.fold((()=>W.CV.skip),(()=>X.l$.text)),R.some)),Ge=[(0,j.A7)(We,xe),(0,m.pipe)(de.EQ.focusMarkByActiveAlert(xe,Ue,e.alertsReader,r.getActiveFocusableItem,P.getLogger("MarksEffects.focusMarkByActiveAlert")),M.nL.Effect.Producer.delayed(s)),(0,b.yS)(Ue.events,Ie,P.getLogger("createOnAlertApplySideEffect")),...Re.getApplicatorEffects(),(0,m.pipe)((0,W.k9)(xe,De,je,r.getActiveAlignableItem,Ie),M.nL.Effect.Producer.delayed(s)),(0,b.qS)(Pe,Ve),ie.dv.createSendActiveAlertFeedbacksEffect(xe,r.getActiveItemWithAlert,e.alertsService,e.alertsReader,P.getLogger("CardsViewModelEffects.createSendActiveAlertFeedbacksEffect")),J.N.PrevNextNavigation.sideEffect(J.N.PrevNextNavigation.Events.fromCardActions(Re.actionEvents),xe,Ie)],qe=be.h.create(Q.R.SpecialId.AllAlerts),ze=(0,se.VC)(Te,Fe,qe,r.getActiveItemWithAlert,Ie),Ze=(0,se.Dv)(M.nL.is(Q.R.SpecialId.AllAlerts),ze,Ie),Ye=se.Py.getAlwaysFocusBehavior(),Ke=se.Py.getStateTransformer(Ye,Ze,e.alertsReader,Ie,(e=>"text"!==e.alertSource),m.constVoid,qe),Qe=x.v.Items.getSingleItemFeedPositionsUpdateTransformer(Ie),Xe=(0,m.flow)(Ke,we.chainLeft(Qe)),$e=new oe.l(xe,Te,e.alertsReader,e.alertsService,Ge,r.getActiveItemWithAlert,Xe),Je=new _.X(o,l,d),et=(0,w.W)(A),tt=Re.actionEvents.subscribe((0,m.flow)((0,h.JH)(e.alertsReader,h.SV.Source.assistant),ve.tap((e=>T.next(e)))));return{lensState:xe,cardsViewModel:Re,lensPreviewViewModel:Se,cardsListScrollManager:Be,alertProcessor:C,checkingService:I,assistantLayoutViewModel:Le,assistantFeedbackViewModel:Ne,assistantSettingsViewModel:Je,marksViewModel:Ue,gnar:c,positionViewModel:et,user:p,capabilities:Ie,remSize:Ce,isSingleCardAssistant:!0,statisticsService:L,closeAssistant:y,dispose:()=>{tt.unsubscribe(),Re.dispose(),Le.dispose(),$e.dispose(),Ue.dispose(),H.unsubscribe(),He.dispose(),Oe.unsubscribe()}}})(d.engine,d.denaliViewAdapter,d.document.settings.lens("selectedLens"),c.sidebarEvents,this._assistantPopupIsReady,(0,o.pipe)(R.fromNullable(e),R.map(K.wQ.Id.create)),this._params.contentScriptState,this._params.contentScriptActions,this._params.gnar,this._params.domain,s,this.close,this._params.assistantService.selectedHighlightsTracker,this._params.assistantService.isTextFieldEmpty,this._params.assistantService.positionModel,this._params.alertProcessor,this._params.checkingService,this._params.cardEvents,this._params.browser,this._params.statisticsService):(0,ke.n)(d.engine,d.denaliViewAdapter,d.document.settings.lens("selectedLens"),this._params.emogenieService,R.fromNullable(this._params.readersAttentionFeature),this._params.shortenItFeature,this._params.smartPhrasesFeature,R.fromNullable(this._params.sentenceLevelBrandTonesFeature),this._params.toneAIFeature,this._params.ethicalAIFeature,this._params.snippetsFeature,R.fromNullable(this._params.proofitFeature),c.sidebarEvents,this._assistantPopupIsReady,(0,o.pipe)(R.fromNullable(e),R.map(K.wQ.Id.create)),this._params.contentScriptState,this._params.contentScriptActions,this._params.gnar,this._params.statisticsService,this._params.domain,s,this.close,this._params.assistantService.selectedHighlightsTracker,this._params.assistantService.isTextFieldEmpty,this._params.assistantService.positionModel,this._params.experimentClient,this._params.alertProcessor,this._params.checkingService,this._params.cardEvents,this._params.browser);Ss(!1,p,t),this._initPerformance=l.endMeasure(),this._viewModels.set(p)}},this.close=()=>{var e,t,i,a;null!==this._viewModels.get()&&(this._trackAssistantClose(),null===(t=(e=this._params).onClose)||void 0===t||t.call(e),this.openState.set("closed"),null===(i=this._integration)||void 0===i||i.dispose(),this._integration=null,null===(a=this._viewModels.get())||void 0===a||a.dispose(),this._viewModels.set(null))},this._getReadyFn=()=>{const e=this._felog.renderTime.startMeasure();return(t,i,a)=>{const s=e.endMeasure();a&&this._openMeasure.cancelMeasure();const r=this._openMeasure.endMeasure();r&&r.duration>500&&this._log.warn("assistant popup took too long to open:",{init:this._initPerformance.duration,render:s.duration,total:r.duration}),setTimeout((()=>{this.openState.set("open"),this._assistantPopupIsReady.next(),this._trackAssistantOpen(t,null==r?void 0:r.duration),this._trackAssistantDrag(t,i)}),0)}},this._applyIframeOffset=e=>{var t,i;const a=null===(i=(t=this._params).getCustomOffset)||void 0===i?void 0:i.call(t);return a?{...e,size:{width:a.width,height:a.height},client:{...e.client,left:a.left+e.client.left,top:a.top+e.client.top},offset:{...e.offset,left:a.left+e.offset.left,top:a.top+e.offset.top},page:{...e.page,left:a.left+e.page.left,top:a.top+e.page.top}}:e}}get view(){return this._viewModels.pipe(xt.w((e=>null===e?me.of(null):_s.R(self,"resize").pipe(ct.O(null),lt.M(this._params.layout.textField.rect.behavior),he.U((([t,i])=>{const a=this._applyIframeOffset(i),s=this._getReadyFn();return l.createElement(as,{textFieldRect:a,assistantLayout:this._params.layout.assistant,viewModels:e,dataGrammarlyPart:e.isSingleCardAssistant?"single-card-assistant-popup":"assistant-popup"},e.isSingleCardAssistant?l.createElement(gs,{viewModels:e,emogenieService:this._params.emogenieService,height:this._height,ready:s}):l.createElement(es,{viewModels:e,emogenieService:this._params.emogenieService,height:(0,p.Y)(e,a).pipe(bs.R(this._assistantPopupIsReady.asObservable()),Ya.b(pe.wW(this._height))),ready:s,OuterElementsPortalSource:this._params.OuterElementsPortalSource}))}))))))}get activeView(){return this._viewModels.pipe(xt.w((e=>{var t;return null!==(t=null==e?void 0:e.assistantLayoutViewModel.activeView)&&void 0!==t?t:me.of(null)})))}dispose(){this.close(),this._subs.dispose()}_trackAssistantOpen(e,t){const i=this._viewModels.get();if(null!==i){const{initialPositionOffset:a}=i.positionViewModel,{statisticsService:s}=this._params,r=s.alertCounts.get(),n=0===a.top&&0===a.left?"default"===this._params.layout.assistant.name?"smart":"hardcoded":"sticky",o=i.assistantLayoutViewModel.activeView.get();this._params.gnar.assistantPopupShow(o.type,this._height.get(),e.get().left,e.get().top,r.expandedViewSupported,r.freeClarity,r.critical,r.filter((e=>"priority"===e.assistantView)).expandedViewSupported,s.wordsCount.get(),n,o.type===v.aH.Type.popup?o.popupType:void 0,t,s.generalScore.get())}}_trackAssistantClose(){var e;const{statisticsService:t}=this._params,i=t.alertCounts.get(),a=(null===(e=this._viewModels.get())||void 0===e?void 0:e.assistantLayoutViewModel.activeView.get())||{type:v.aH.Type.default};this._params.gnar.assistantPopupCloseButtonClick(a.type,i.expandedViewSupported,i.freeClarity,i.critical,i.filter((e=>"priority"===e.assistantView)).expandedViewSupported,a.type===v.aH.Type.popup?a.popupType:void 0)}_trackAssistantDrag(e,t){const i=e.get();let a=i;this._subs.push(t.pipe(Mt.G(),N.h((([e,t])=>e&&!t))).subscribe((()=>{const t=e.get();fs.E9.l1Distance(t,a)<10||(this._params.gnar.assistantPopupDrag(t.left,t.top,this._height.get(),i.left,i.top),a=t)})))}}function Ss(e,t,i){i.caller===d.Rx.emogenie?t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.emogenie}):t.isSingleCardAssistant?t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.default}):t.isSingleCardAssistant||(i.caller===d.Rx.proofitRequest?t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.proofitRequest}):i.caller===d.Rx.proofitReview?t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.proofitReview}):e||i.caller!==d.Rx.popupOpener?t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.default}):t.assistantLayoutViewModel.pushActiveView({type:v.aH.Type.popup,popupType:i.popupType}))}var ks=i(18126),As=i(16037),Es=i(64213),Cs=i(14568),Is=i(99015);class Ts{constructor(e,t,i,a,s,r,n,o,l,c){this.connectionState=e,this.pageState=t,this.gnar=i,this.user=a,this._hoverProvider=s,this.document=r,this.formattingService=n,this.denaliViewAdapter=o,this.capiProxy=l,this.engine=c,s.setAssistantHover(o.highlightHoverProvider)}static create(e){var t,i;const a=new As.t(e.highlights,e.textObserver,e.replacementService.get(),e.layout,e.scroller,e.selectedHighlightsTracker,void 0,e.requestAwaitService,null===(t=e.formattingService)||void 0===t?void 0:t.get()),s=Cs.p.create(e.checkingService.get(),e.checkingServiceInitialState,e.alertsTransformer,e.alertProcessor,e.sidebarEvents),r=(0,Is.r)(s,a,e.document.settings.lens("context"),(()=>{var t,i;return null!==(i=null===(t=e.getExistingAlerts)||void 0===t?void 0:t.call(e))&&void 0!==i?i:(0,Es.q)(e.alertProcessor)}),e.textObserver,(()=>e.checkingServiceInitialState.value.lastStart),e.smartPhrasesFeature,e.readersAttentionFeature,e.shortenItFeature,e.sentenceLevelBrandTonesFeature,e.snippetsFeature,Boolean(null===(i=e.user.experiments)||void 0===i?void 0:i.singleCardAssistant));return new Ts(e.connectionState,e.pageState,e.gnar,e.user,e.hoverProvider,e.document,e.formattingService,a,s,r)}dispose(){this.capiProxy.dispose(),this.denaliViewAdapter.dispose(),this.engine.shutdown(),this._hoverProvider.removeAssistantHover()}}var Ms=i(54702),xs=i(53783);class Fs{constructor(e){this._params=e,this.sidebarEvents=new ue.xQ,this.hoverProvider=new ks.f(this._params.hoverProvider),this.selectedHighlightsTracker=this._params.highlights.getSelectedHighlightsTracker({textField:this._params.originalTextField,selectionService:this._params.selectionService}),this.positionModel=(0,xs.j)(this._params.originalTextField,this._params.state,this._params.actions),this.isTextFieldEmpty=this._params.textObserver.contentChanges.async.pipe(he.U((e=>""===e.newText.trim())),ge.x()),this._checkingService=null}setCheckingService(e){this._checkingService=e}getCheckingServiceState(){var e;return null===(e=this._checkingService)||void 0===e?void 0:e.state.value}createIntegration(){const{layout:e,highlights:t,textObserver:i,replacementService:a,alertProcessor:s,state:r,gnar:n,alertsTransformer:o,document:l,requestAwaitService:c,formattingService:d,getCheckingServicePreviousState:p,createAssistantScroller:m=(()=>new Ms.H({layout:e})),getExistingAlerts:u}=this._params;if(null==this._checkingService)return null;const h=null==p?void 0:p();h&&(this._checkingService.state.value=h);const g=m(),{user:f}=r.get();return Ts.create({layout:e,alertProcessor:s,connectionState:r.view((e=>e.connection)),pageState:r.view((e=>e.page)),highlights:t,textObserver:i,replacementService:a,checkingService:this._checkingService.lazyCheckingService,checkingServiceInitialState:this._checkingService.state,gnar:n,user:{isPremium:f.premium,isAnonymous:f.anonymous,experiments:f.experiments,customFields:f.customFields},hoverProvider:this.hoverProvider,selectedHighlightsTracker:this.selectedHighlightsTracker,scroller:g,sidebarEvents:this.sidebarEvents,document:l,alertsTransformer:o,requestAwaitService:c,formattingService:d,getExistingAlerts:u,smartPhrasesFeature:this._params.smartPhrasesFeature,readersAttentionFeature:this._params.readersAttentionFeature,shortenItFeature:this._params.shortenItFeature,sentenceLevelBrandTonesFeature:this._params.sentenceLevelBrandTonesFeature,snippetsFeature:this._params.snippetsFeature})}dispose(){var e;null===(e=this._checkingService)||void 0===e||e.state.dispose()}}},99015:(e,t,i)=>{i.d(t,{r:()=>x});var a=i(57050),s=i(35214),r=i(40327),n=i(73353),o=i(21729),l=i(83078),c=i(51072),d=i(5114),p=i(38983);var m=i(80358),u=i(84966),h=i(6488),g=i(79227),f=i(21311),v=i(95362),w=i(5008),_=i(43320),b=i(35301),y=i(85654),S=i(72720),k=i(55360),A=i(45586),E=i(98403),C=i(2834),I=i(78674),T=i(77176),M=i(71249);const x=(e,t,i,x,F,R,L,P,V,O,N,H)=>{const B=new A.w.Keeper,U=function(e,t,i){const s=p.h.create(d.none),m=p.h.create(d.none);return{score:p.h.create(d.none),scoreStatus:p.h.create(d.none),title:p.h.create(void 0),textInfo:p.h.create(d.none),checkingState:p.h.create(e.checkingState),asyncChecksState:p.h.create(e.asyncChecksState),context:i,contextCompleteness:i.view(o.j.calculateCompleteness),updateContext:e=>{const t=!n.R$.equals(i.get(),e);return i.set(e),t},defaultContext:s,updateDefaultContext:e=>{const t=!(0,r.pipe)((0,a.tuple)([s.get(),e],l.map2(n.R$.equals)));return s.set(e),t},documentText:t.getText(),documentLength:p.h.create({full:t.getTextLength(),trimmed:t.getTextLength()}),counters:p.h.create(o.dM.group.empty),calculateStats:()=>c.toPromise(e.requestDocStats).then((e=>(m.set(d.some(e)),e))),recentDocumentStats:m}}(e,t,i),D=H?d.some(new S.Q(e)):d.none;B.push(e.events.pipe(C.b((t=>{U.checkingState.set(e.checkingState),m.h.is("text_info")(t)?U.textInfo.set(d.some(t.data)):m.h.is("finish")(t)?(U.score.set(t.score),U.scoreStatus.set(t.scoreStatus)):m.h.is("feedback_ack")(t)?((0,r.pipe)(t,d.fromPredicate(m.h.isUserFeedbackWithGeneralScore),d.map((e=>e.outcomeScores.GeneralScore)),d.map((e=>Math.trunc(100*e))),l.tap((e=>U.score.modify((0,a.flow)(d.map((t=>({...t,rank:e}))),l.orElse(d.some({errorRateScore:0,rank:e}))))))),(0,r.pipe)(t,d.fromPredicate(m.h.isUserFeedbackWithScoreStatus),d.map((e=>e.scoreStatus)),l.tap((e=>U.scoreStatus.set(d.some(e)))))):m.h.is("session_started")(t)&&U.updateDefaultContext(t.defaultDocumentContext)}))).subscribe(),F.contentChanges.async.pipe(I.b(300),T.U((e=>e.newText)),T.U((e=>({full:e.length-1,trimmed:e.trim().length}))),C.b(E.wW(U.documentLength))).subscribe()),(0,r.pipe)(R(),d.map((e=>{U.updateDefaultContext(n.R$.parseDefault(e.defaultDocumentContext))})));const W=new k.Xr,j=new v.Ek,G=(0,s.fold)((0,s.getEndomorphismMonoid)())(M.compact([d.some((e=>(0,r.pipe)(L.get(),d.fold((()=>e),(t=>t.addStateToRawAlertTransformer(e)))))),d.fromNullable(null==P?void 0:P.addFeedbackToRawAlertTransformer),d.fromNullable(null==O?void 0:O.addFeedbackToRawAlertTransformer),d.some((e=>(0,r.pipe)(V.get(),d.fold((()=>e),(t=>t.addStateToRawAlertTransformer(e)))))),d.some((e=>(0,r.pipe)(N.get(),d.fold((()=>e),(t=>t.addSnippetsTriggerToAlert(e))))))])),q=new f.SC(W,j,(()=>t.getContents().delta),e.events,e,U.counters,G),z=h.e.create(q.state),Z=new g.k(z,q._ops);B.push(_.R.init(_.R.UserTextChangesSync.create(t),e.events,w.n.ignoreTEResult(e),w.n.ignoreResult(W),j,w.A.merge([q])).subscribe()),e.loadAlerts(x()),q.flushAlerts();const Y=d.some(b.J.CategoriesModel.create(e.events,e,q.state,Z,u.JW.ScopeType.GLOBAL)),K=d.some(y.k.create(z));return{alertsList:q,alertsReader:z,alertsService:Z,positionManager:W,sessionModel:U,mutedAlertsCategoriesModel:Y,mutingAlertsReader:K,sduiService:D,shutdown:()=>{q.dispose(),B.dispose()}}}},8043:(e,t,i)=>{i.d(t,{aU:()=>pt,X5:()=>mt,n:()=>ut});var a,s=i(57050),r=i(35214),n=i(5114),o=i(40327),l=i(17404),c=i(50622),d=i(25913),p=i(9671),m=i(38152),u=i(80864),h=i(5178),g=i(17771),f=i(2844),v=i(75003),w=i(40033),_=i(81301),b=i(66896),y=i(87667),S=i(45586),k=i(77176),A=i(57091),E=i(28043),C=i(85985),I=i(24713),T=i(16118),M=i(22232),x=i(83078),F=i(38983),R=i(31881);!function(e){e.equals=(e,t)=>"score"in e&&"score"in t?e.score===t.score:e.type===t.type}(a||(a={}));class L{constructor(e,t,i,r,l,c,d,p,m,u,h){this._sessionModel=e,this._layoutVM=t,this._predictionsVM=i,this._modalManager=r,this._lensPreviewVM=l,this._currentLensId=c,this._lensChanged=d,this._cardsListScrollManager=p,this._user=m,this._gnar=u,this._closeAssistant=h,this.showSetGoalsActionButton=F.h.create(!0),this.showSettingsActionButton=F.h.create(!0),this.close=()=>{this._closeAssistant()},this.score=(0,o.pipe)(this._sessionModel.score.view(n.map((e=>e.rank))),k.U((e=>(0,g.Y)(n.option)({capiScore:e}))),A.a(this._sessionModel.checkingState,((e,t)=>(0,o.pipe)(e,n.map((e=>({...e,isLoading:"idle"!==t}))))))),this.summary=this._sessionModel.textInfo.view((0,s.flow)(n.chain((e=>e.messages)),n.map((e=>e.assistantHeader)),n.getOrElse((()=>"Looking good so far")),(e=>({content:e})))),this.logoScore=(0,f.aj)([this._cardsListScrollManager.scrollTop,this._layoutVM.activeView,this.score,this._user.view("experiments")]).pipe(k.U((([e,t,i,a])=>(0,o.pipe)(i,n.fold((()=>({type:"logo"})),(i=>!(null==a?void 0:a.assistantHeaderRemoval)&&e<66||t.type!==v.aH.Type.default?{type:"logo"}:{type:"score",score:i}))))),E.x(a.equals)),this.visibility=this._layoutVM.activeView.view((e=>e.type===v.aH.Type.default?"visible":"hidden")),this.lensSwitchFlow=R.Z.fromSideEffect((e=>{switch(e.action.action){case y.n.Actions.switchToAll:this._lensChanged.next({lensId:b.R.SpecialId.AllAlerts,focusFirstCard:!0}),this._gnar.assistantPriorityDropdownClick("all");break;case y.n.Actions.switchToPriority:this._lensChanged.next({lensId:b.R.SpecialId.Priority,focusFirstCard:!0}),this._gnar.assistantPriorityDropdownClick("priority");break;case y.n.Actions.openSetGoals:break;default:(0,M.vE)(e.action.action)}}),f.aj(this._currentLensId.pipe(C.h((e=>e!==b.R.SpecialId.Premium)),k.U((e=>e===b.R.SpecialId.Priority?"priority":"all")),E.x()),this._lensPreviewVM.getLens(b.R.SpecialId.AllAlerts).pipe(I.j("count"),E.x()),this._lensPreviewVM.getLens(b.R.SpecialId.Priority).pipe(I.j("count"),E.x()),this._predictionsVM.previewState,((e,t,i,a)=>(0,o.pipe)({allAlertsCount:t,priorityAlertsCount:i,selectedLens:e},n.fromPredicate((()=>a.kind!==w.fA.hidden)))))),this._subs=new S.w.Keeper,this._trackHeaderMessageChanges(),this._trackToShowActionButtons()}open(e){switch(e){case"setGoals":this._subs.push(this._modalManager.show(_.Iy.setGoals("user")).subscribe());break;default:(0,M.vE)(e)}}_trackHeaderMessageChanges(){const e=this.summary.pipe(T.G()).subscribe((([e,t])=>{var i,a;this._gnar.assistantHeaderMessageUpdate(e.content,t.content,null===(i=(0,o.pipe)(this._sessionModel.textInfo.get(),n.toUndefined))||void 0===i?void 0:i.wordsCount,null===(a=(0,o.pipe)(this._sessionModel.score.get(),x.orUndefined))||void 0===a?void 0:a.rank)}));this._subs.push(e)}_trackToShowActionButtons(){const e=(0,f.aj)([this._layoutVM.activeView,this._user]).subscribe((([e,t])=>{t.isAnonymous||e.type===v.aH.Type.popup?(this.showSetGoalsActionButton.set(!1),this.showSettingsActionButton.set(!1)):(this.showSetGoalsActionButton.set(!0),this.showSettingsActionButton.set(!0))}));this._subs.push(e)}dispose(){this._subs.dispose()}}var P=i(59456),V=i(98403);class O{constructor(e,t,i,a,s,r,l){this._lensPreviewVM=e,this._layoutVM=t,this._readersAttentionVM=i,this._emogenieService=a,this._session=s,this._readersAttentionPredictionCardState=r,this._gnar=l,this._subs=new S.w.Keeper,this.previewState=F.h.create({kind:w.fA.hidden}),this.previewFlow=R.Z.fromSideEffect((e=>{switch(e.action.key){case"tone":const t=this._emogenieService.viewState.view("prevalentEmotion").get();return t&&this._gnar.emogeniePredictionButtonClick(t.name),this._layoutVM.pushActiveView({type:v.aH.Type.emogenie});case"readersAttention":return this._readersAttentionVM.open({type:v.aH.ReadersAttention.Caller.Type.predictionWidget});default:(0,M.vE)(e.action)}}),this.previewState),this._previewState=(0,o.pipe)(f.aj([this._emogenieService.viewState.view((e=>n.fromNullable(e.settings.hiddenReport?void 0:e.prevalentEmotion))),this._emogenieService.viewState.view("brandToneOffImageUrl"),this._readersAttentionPredictionCardState,this._session.documentLength,this._lensPreviewVM.getLens(b.R.SpecialId.PredictionEmogenie),this._lensPreviewVM.getLens(b.R.SpecialId.PredictionTakeaways)]),k.U((([e,t,i,a,s,r])=>(n.isSome(e)||n.isSome(i))&&a.trimmed>0?{kind:w.fA.visible,tone:(0,o.pipe)(e,n.map((e=>({emotion:e,alertsCount:s.count,brandToneOffImageUrl:t})))),readersAttention:(0,o.pipe)(i,n.map((e=>({...e,alertsCount:(0,o.pipe)(i,n.chain((e=>e.alertsCount)),n.getOrElse((()=>r.count)))}))))}:a.trimmed>0?{kind:w.fA.zero}:{kind:w.fA.hidden}))),this._subs.push(this._previewState.subscribe(V.wW(this.previewState)))}dispose(){this._subs.dispose()}}var N=i(74197),H=i(15646),B=i(76024);class U{constructor(e,t,i,a,s,r,o){this._csState=e,this._csActions=t,this._gnar=i,this._experimentClient=a,this._cardActions=s,this._getAlertById=r,this._browser=o,this._subs=new S.w.Keeper,this._acceptedPremiumOnboardingSuggestion=!1,this._subs.push(this._cardActions.pipe(C.h(H.lY.isAlertApplyAction),k.U((e=>this._getAlertById(e.alertId))),C.h((e=>n.isSome(e)&&!e.value.isFree))).subscribe((e=>{this._acceptedPremiumOnboardingSuggestion=!0,N.D.isEligible(this._browser,this._csState.get(),this._experimentClient)&&this._gnar.premiumOnboardingSuggestionAccept()})))}get shouldShowStartNotification(){var e;const t=this._csState.get(),i=null===(e=t.page.billingSubscriptionStatus)||void 0===e?void 0:e.billing_subscription_first_premium_date,a=i?new Date(i).getTime():void 0;return!!(N.D.isEligible(this._browser,t,this._experimentClient)&&this._acceptedPremiumOnboardingSuggestion&&!t.page.seenPremiumOnboardingStartNotificationTimestamp&&a&&Date.now()<=a+6*B.MS_IN_DAY)}get shouldShowCompleteNotification(){var e;const t=this._csState.get(),i=null===(e=t.page.billingSubscriptionStatus)||void 0===e?void 0:e.billing_subscription_first_premium_date,a=i?new Date(i).getTime():void 0;return!!(N.D.isEligible(this._browser,t,this._experimentClient)&&this._acceptedPremiumOnboardingSuggestion&&!t.page.seenPremiumOnboardingCompleteNotificationTimestamp&&a&&Date.now()>=a+7*B.MS_IN_DAY)}trackShowNotification(e){this._csActions.seenPremiumOnboardingNotification(e),this._gnar.premiumOnboardingNotificationShow(e)}dispose(){this._subs.dispose()}}var D=i(77843),W=i(41398),j=i(2768),G=i(10247);class q{constructor(e,t,i,a){this.feature=t,this._closeAssistant=i,this._gnar=a,this._subs=[],this._subs.push(this.feature.requestInfo.view("status").pipe((0,E.x)(),(0,T.G)(),(0,W.M)(e.activeView)).subscribe((([[t,i],a])=>{t===G.eE.REVIEWING&&a.type===v.aH.Type.proofitReview&&e.popActiveView()}))),this._subs.push(this.feature.layoutCreated.pipe((0,W.M)(e.activeView)).subscribe((([t,i])=>{i.type!==v.aH.Type.proofitRequest&&i.type!==v.aH.Type.proofitReview||t||e.popActiveView()})))}onSubmitRequest(e){this.feature.submitRequest(),this._gnar.proofitRequestFormSubmit();const t=this.feature.requestInfo.lens("status").pipe((0,C.h)((e=>e===G.eE.ACCEPTED)));(0,D.F)(100).pipe((0,j.R)(t)).subscribe({complete:()=>this._closeAssistant(e)})}onCompleteRequest(e){this.feature.resetRequest(),this._gnar.proofitOrderDone(),this._closeAssistant(e)}onSubmitFeedback(e){this._gnar.proofitFeedbackFormSubmit(e.text,e.score)}dispose(){this._subs.forEach((e=>e.unsubscribe()))}}var z=i(90361),Z=i(40018),Y=i(14601),K=i(35416);class Q{constructor(e,t,i,a,s){this._feature=e,this._assistantLensState=t,this._assistantCardActions=i,this._getAlertById=a,this._getActiveAlert=s,this._subs=new Y.w,(0,o.pipe)(this._feature,x.tap((e=>{this._subs.add(this._trackTakeawayUserActions(e.tracking)),this._subs.add(this._trackTakeawayCardShow(e.tracking))})))}_trackTakeawayUserActions(e){return this._assistantCardActions.pipe(C.h(H.lY.isTakeawayFeedbackAction)).pipe(k.U((e=>(0,o.pipe)(this._getAlertById(e.alertId),n.chain((t=>g.Y(n.option)({id:n.some(t.id),rawId:Z.bZ.getRawId(t),isLikelyToRead:(0,o.pipe)(t.extraProperties.takeaway,n.map((e=>e.isLikelyToBeRead))),score:(0,o.pipe)(t.extraProperties.takeaway,n.map((e=>e.score))),textRange:n.fromNullable(t.getHighlightRanges()[0]),action:n.some(e)}))),n.getOrElse(s.constUndefined)))),C.h(z.fQ)).subscribe((t=>{e.onTakeawayUserAction(t.isLikelyToRead,t.score,t.action,t.textRange)}))}_trackTakeawayCardShow(e){return this._assistantLensState.pipe(k.U(K.nL.getActiveAlert(this._getActiveAlert)),k.U(n.map((e=>e.id)))).pipe(k.U(n.getOrElse(s.constUndefined)),C.h(z.fQ),E.x(),k.U((0,s.flow)(this._getAlertById,n.chain((e=>(0,o.pipe)(e.extraProperties.takeaway,n.map((({score:t})=>({score:t,textRange:e.getHighlightRanges()[0]})))))),n.getOrElse(s.constUndefined))),C.h(z.fQ)).subscribe((t=>{e.onKeyTakeawayCardShow(t.score,t.textRange)}))}dispose(){this._subs.unsubscribe()}}class X{constructor(e){this._readersAttentionFeature=e,this.message=(0,o.pipe)(this._readersAttentionFeature,n.map((e=>e.messages)),n.getOrElse((()=>F.h.create(n.none)))).view((0,s.flow)(n.map((e=>e.headerMessage)),n.getOrElse((()=>"")))),this.attentionScoreInfo=(0,o.pipe)(this._readersAttentionFeature,n.fold((()=>F.h.create(n.none)),(e=>e.attentionScoreInfo)))}}var $=i(23518),J=i(49197),ee=i(41034),te=i(31536),ie=i(68654),ae=i(5920),se=i(16892),re=i(48521),ne=i(25975),oe=i(55415),le=i(95195),ce=i(65060);const de=(e,t)=>i=>(0,s.pipe)(t,n.fold((()=>n.some({lens:i,newItem:n.none})),(t=>(0,s.pipe)(e,n.fold((()=>n.some({lens:i,newItem:n.some(ce.g.create(t,se.s.PositionState.empty,re.o.VisualState.initial({type:"rendered",clockwise:!0},!1)))})),(e=>(0,s.pipe)(ce.g.create(t,e.positionState,e.visualState),n.fromPredicate((t=>ce.g.hashCodeOwnFields(t)!==ce.g.hashCodeOwnFields(e))),n.map((e=>({lens:i,newItem:n.some(e)}))))))))));var pe=i(2291),me=i(19751),ue=i(32952),he=i(8125),ge=i(73975),fe=i(74850),ve=i(71249),we=i(16314);const _e=fe.Y.create("ReadersAttentionItemSideEffects");function be(e){return e.pipe(k.U((()=>s.identity)))}function ye(e,t){return e.pipe(C.h(we.Vl),k.U((e=>i=>i.patch({currentLens:(0,o.pipe)(i.currentLens.items.find((t=>t.id===e.id)),n.fold((()=>(_e.error("Cannot focus non-existing ReadersAttentionItem."),i.currentLens)),(()=>(0,s.unsafeCoerce)((0,o.pipe)(i.currentLens,t.selectItemById(e.id,[]))))))}))))}class Se{constructor(e,t,i,a,r,o,l,c,d,p){this._cardActions=e,this._readersAttentionItemInfo=t,this._attentionScoreInfo=i,this._assistantLensState=a,this._checksFeedCapabilities=r,this._heatmapVisible=o,this._layoutViewModel=l,this._onDismiss=c,this._gnar=d,this._statistics=p,this._subs=new Y.w,this.actions=new ue.xQ,this._relayBaseActions=this.actions.pipe(C.h((0,he.Kg)(H.eI.isStartTransitionTo,H.eI.isCompleteTransitionTo))).subscribe((e=>this._cardActions.next(e))),this._goToReadersAttentionView=this.actions.pipe(C.h(we.Q)).subscribe((e=>{this._gnar.attentionScoreFullCardSeeSuggestionsButtonClick(),this._layoutViewModel.pushActiveView({type:v.aH.Type.readersAttention,caller:{type:v.aH.ReadersAttention.Caller.Type.readersAttentionItem,item:e.item}})})),this._goToFeedbackView=this.actions.pipe(C.h(we.RJ)).subscribe((()=>{this._layoutViewModel.pushActiveView({type:v.aH.Type.feedback})})),this._dismissItem=this.actions.pipe(C.h(we.l9)).subscribe((()=>{this._gnar.attentionScoreFullCardDismissButtonClick(),this._onDismiss()})),this._toggleHeatmapVisibility=this._assistantLensState.pipe(k.U((e=>(0,s.pipe)(le.fromPredicate(K.nL.hasItems,(()=>e.currentLens.id))(e),le.map(K.nL.Prism.getLens().get),le.chain((e=>(0,s.pipe)(e,K.In.getActiveItemOfType(ce.m),le.fromOption((()=>e.id)),le.map((e=>e.id)))))))),me.$f(le.getEq(ge.eqString,ge.eqString))).subscribe(le.fold((e=>{e!==b.R.SpecialId.PredictionTakeaways&&this._heatmapVisible.set(!1)}),(()=>this._heatmapVisible.set(!0)))),this._activeCardOpenStats=null,this._trackOpenClose=this._assistantLensState.pipe(k.U((e=>(0,s.pipe)(n.fromPredicate(K.nL.hasItems)(e),n.map(K.nL.Prism.getLens().get),n.chain(K.In.getActiveItemOfType(ce.m)),n.fold(s.constFalse,s.constTrue)))),E.x()).subscribe((e=>{(0,s.pipe)(this._attentionScoreInfo.get(),n.map((e=>pe.T.prism.reverseGet(e.attentionScore))),x.tap((t=>{const i=this._statistics.wordsCount.get();e?(this._gnar.attentionScoreFullCardShow(i,t),this._activeCardOpenStats={numWords:i,attentionScore:t}):this._activeCardOpenStats&&(this._gnar.attentionScoreFullCardHide(i,t,this._activeCardOpenStats.numWords,this._activeCardOpenStats.attentionScore),this._activeCardOpenStats=null)})))})),this._subs.add(this._relayBaseActions),this._subs.add(this._toggleHeatmapVisibility),this._subs.add(this._goToReadersAttentionView),this._subs.add(this._goToFeedbackView),this._subs.add(this._dismissItem),this._subs.add(this._trackOpenClose)}getApplicatorEffects(){return e=this._readersAttentionItemInfo,t=this.actions,i=this._checksFeedCapabilities,(0,o.pipe)([[be(e),"newReadersAttentionInfo"],[ye(t,i),"focusReadersAttentionItem"]],ve.map((([e,t])=>({id:`readersAttentionFeedItem.effects.${t}`,when:b.R.isMainLens,what:K.nL.Effect.Applicator.create(e)}))));var e,t,i}dispose(){if(this._activeCardOpenStats){const e=this._activeCardOpenStats.numWords,t=this._activeCardOpenStats.attentionScore;(0,s.pipe)(this._attentionScoreInfo.get(),n.map((e=>pe.T.prism.reverseGet(e.attentionScore))),x.tap((i=>{this._gnar.attentionScoreFullCardHide(this._statistics.wordsCount.get(),i,e,t)}))),this._heatmapVisible.set(!1),this._activeCardOpenStats=null}this._subs.unsubscribe()}}var ke,Ae=i(20153),Ee=i(83436);!function(e){const t=(e,t)=>e.pipe(C.h(H.lY.isCreateSnippetAction),k.U((({id:e})=>i=>{const a=(0,s.pipe)(i.currentLens.items.update(e,t({type:"success",clockwise:!0})),le.fold((()=>i.currentLens.items),s.identity));return Ee.sU.itemsLens.set(a,i)})));e.applicatorEffects=e=>(0,s.pipe)([[t(e,Ae.uL),"suggestedSnippetSuccessEffect"]],ve.map((([e,t])=>({id:`cardsViewModel.effects.${t}`,when:b.R.isWithAlertsId,what:K.nL.Effect.Applicator.create(e)}))))}(ke||(ke={}));var Ce=i(77394),Ie=i(86620),Te=i(16868),Me=i(51540),xe=i(40081),Fe=i(62346),Re=i(71962),Le=i(73582),Pe=i(92783),Ve=i(44618),Oe=i(84966),Ne=i(13313),He=i(21619),Be=i(54216),Ue=i(48052),De=i(91549),We=i(83167),je=i(20594),Ge=i(35607),qe=i(20291),ze=i(34383),Ze=i(33806),Ye=i(86775),Ke=i(11245),Qe=i(4890),Xe=i(73841),$e=i(89770),Je=i(39920),et=i(88772),tt=i(74364),it=i(93508),at=i(68425),st=i(24209),rt=i(17343),nt=i(76974),ot=i(66310),lt=i(40151),ct=i(95574),dt=i(81531);const pt=e=>e.view((e=>(0,o.pipe)(n.fromPredicate(K.nL.hasItems)(e),n.map((e=>e.currentLens.items)),n.map((e=>e.filter((0,he.Kg)(u.O.isAlertCard,u.O.isAlertsBundle)))),n.map((e=>e.filter((e=>"rendered"===e.visualState.transition.type)))),n.fold((()=>null),(e=>e.values()))))).pipe(it.O([]),C.h(z.Nf),T.G(),k.U((([e,t])=>{const i=new Set(e.map((e=>e.id)));return t.filter((e=>!i.has(e.id)))})),at.J()),mt=(e,t)=>e.alertClicked.pipe(k.U((e=>(0,o.pipe)(e,n.fold(s.constNull,(e=>e.alert))))),C.h(z.fQ),W.M((e=>e.pipe(k.U((e=>K.nL.hasCards(e)&&b.R.isMainLens(e.currentLens.id)?u.O.getActiveItemWithAlert(e.currentLens):n.none)),k.U((e=>(0,o.pipe)(e,n.fold((()=>null),(e=>e.activeAlert)))))))(t)),C.h((([e,t])=>e.id!==(null==t?void 0:t.id))),k.U((([e,t])=>e))),ut=(e,t,i,a,g,f,w,y,S,A,I,M,R,B,D,W,j,G,Y,se,re,pe,me,ge,fe,ve,we,_e,be,ye)=>{var Ae;const at=dt.Monitoring.Logging.getLogger("view_models"),ut=F.h.create(Ne.A.defaultState),ht=F.h.create(s.constFalse),gt=F.h.create(!1),ft=F.h.create(!1),vt=e=>(0,he.W9)((()=>!gt.get()),(0,he.W9)((e=>!ft.get()||Z.bZ.isInline(e)),e)),wt=Be.t.create({...Be.t.defaultLensFilters,[b.R.SpecialId.Priority]:Z.bZ.belongsToPriorityLens,[b.R.SpecialId.AllAlerts]:(0,he.W9)(Z.bZ.belongsToAllAlerts,(0,s.not)(Z.bZ.isTakeaway))},{...Be.t.defaultTextFilters,[b.R.SpecialId.Closed]:s.constFalse,[b.R.SpecialId.Priority]:vt(Z.bZ.belongsToPriorityLens),[b.R.SpecialId.AllAlerts]:vt((0,he.W9)(Z.bZ.belongsToAllAlerts,(0,s.not)(Z.bZ.isTakeaway))),[b.R.SpecialId.PredictionTakeaways]:e=>ht.get()(e)}),_t=st.T(ht,gt,ft).pipe(rt.h(V.PU)),bt=Ne.A.get(e.alertsList.state,e.alertsList.lensesScores,wt).subscribe(V.wW(ut)),yt=new xe.t(ut.view("lenses"),wt,e.sessionModel.scoreStatus),St=(0,Ue.$y)((0,Ve.a)(t).getContents),kt={features:new Set([je.IG.Features.showCardLabelInOutcomes,...N.D.isEligible(ye,W.get(),ve)?[je.IG.Features.showPremiumOnboarding]:[]]),cardLayoutDensityMode:Qe.j.Density.minimal,shouldAnimateAlertApply:je.IG.Default.shouldAnimateAlertApply,isPremiumOnboarding:W.view((e=>(0,o.pipe)(N.D.isEligible(ye,e,ve))))},At=(0,je.Ls)(St,e.alertsReader,kt,(()=>nt.of(n.none)),e.mutingAlertsReader),Et=De.R.ItemFactory.create(St,e.mutingAlertsReader,kt,(()=>nt.of(n.none))),Ct=(0,Ke.U)(St,e.alertsReader,kt,ze.T.ordAlert),It=F.h.create(ze.D.empty()),Tt=F.h.create(n.none),Mt=F.h.create(16),xt=(0,d.q)((()=>Ot.get().currentLens.id),(()=>Tt.get()),(()=>Mt.get())),Ft=u.O.getCapabilities(At,Et,Ct,e.alertsReader,St,It,(()=>Ot.get().currentLens.id),(null===(Ae=re.get().experiments)||void 0===Ae?void 0:Ae.cardExpansionInAssistant)?xt:(0,s.constant)(n.none)),Rt=new Je.gi(u.O.equatable.structEq,u.O.defaultOrd),Lt=(0,Je.is)(At,Ft),Pt=new $e.oq(e.alertsList.state,e.alertsReader,ut.view("lenses"),e.positionManager,yt,new Je.ad((e=>e.id===b.R.SpecialId.Priority),new Ze.c(Ct,It,e.alertsReader,(e=>e.id===b.R.SpecialId.PredictionTakeaways),Rt,u.O.equatable.structEq),u.O.equatable.structEq,u.O.bundlesOrd),(0,Je.kn)(Et,kt,(e=>e===b.R.SpecialId.Priority),(0,Ze.E)(Ct,It,e.alertsReader,(e=>e===b.R.SpecialId.PredictionTakeaways),Lt,Ft),Ft),Ft,wt),Vt=i.get(),Ot=F.h.create(Pt.emptyState(Vt).patch({alertSource:Z.l$.sidebar})),Nt=Ot.view((e=>(0,o.pipe)(n.fromPredicate(K.nL.hasItems)(e),n.map(K.nL.Prism.getLens().get),n.filter((e=>e.id===b.R.SpecialId.PredictionTakeaways)),n.chain(K.In.getActiveItem)))).view(n.fold((()=>s.constFalse),(e=>t=>Ft.hasAlert(t.id)(e)))).subscribe(V.wW(ht)),Ht=Ot.view((e=>(0,o.pipe)(n.fromPredicate(K.nL.hasItems)(e),n.map(K.nL.Prism.getLens().get),n.chain(K.In.getActiveItem),n.filter(ce.m),n.fold(s.constFalse,s.constTrue)))).subscribe(V.wW(gt));R.next({kind:Ce.R.ChangeLens,selectedLens:Vt===b.R.SpecialId.Priority?"priority":"all"});const Bt=(0,We.u0)((()=>t.getCursor().index),Pt),Ut=new Le.x(e.alertsList,Ot,3),Dt=new _.EQ(new Re.o(e.sessionModel,Ut,re.get().isPremium,G)),Wt=new Ee.Xx({flush:()=>t.flushChanges()},new ue.xQ,At,e.alertsService,n.none,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,o.pipe)(e.mutedAlertsCategoriesModel,n.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,Pe.Um)().suggestionsSettings)})))),n.none,(()=>!1),u.O.getActiveItemWithAlert,Ft,Ot,new Ie.C),jt=new p.y(Wt.actionEvents,G,e.alertsReader,re),Gt=new Ge.o((()=>le.right(void 0))),qt=new Fe.o(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,Ot,wt,_t,u.O.getActiveItemWithAlert,re.view("experiments"),B,!0),zt=(0,Te.hp)(Ot,qt,F.h.create(16),Gt,t,at),Zt=new v._z(G,me,ge,ye),Yt=new ue.xQ,Kt=Ot.pipe(k.U((e=>e.currentLens.id))),Qt=(0,ee.a)(e.alertsList.state),Xt=new $.X(g,It,Zt,e.alertsList.state,e.alertsReader,Ot,Qt),$t=new J.a(g,e.alertsList.state,e.alertsService,Ot,Qt),Jt=$t.checklist.subscribe(V.wW(It)),ei=new O(yt,Zt,Xt,a,e.sessionModel,Xt.predictionCardState,G),ti=new L(e.sessionModel,Zt,ei,Dt,yt,Kt,Yt,Gt,re,G,pe),ii=new U(W,j,G,ve,Wt.actionEvents,e.alertsReader.getById,ye),ai=new m.WY(Ot,ei,we,_e,Ut,Ft,ii,G),si=Zt.activeView.pipe(k.U((e=>e.type)),it.O(v.aH.Type.startupPlaceholder),T.G(),k.U((([e,t])=>e===v.aH.Type.startupPlaceholder&&t===v.aH.Type.proofitRequest))).subscribe(V.wW(ft)),ri=ai.cardListViewportHeight.subscribe(V.wW(Tt)),ni=new h._(Zt,se,G),oi=(0,o.pipe)(M,n.map((e=>new q(Zt,e,pe,G))));(0,o.pipe)(y,x.tap((t=>t.initCardActionsProcessing(Wt.actionEvents,e.alertsReader))));const li=new He.mN(t,Ot,qt,e.alertsReader,u.O.getActiveItemWithAlert,(t=>{const i=t.reduce(((t,i)=>(0,o.pipe)(e.alertsReader.getById(i.alert.id),n.chain(Z.bZ.getRawId),x.tap((e=>t.set(e,i))),n.fold((()=>t),(()=>t)))),new Map),a=Array.from(i.keys()).map(we.alerts.getAlertById).filter(z.fQ);if(a.length){const e=a.reduce(((e,t)=>l.S.ordering.greaterThanOrEqual(t,e)?t:e));return n.fromNullable(i.get(Oe.wQ.Id.create(e.id)))}return n.none})),ci=pt(Ot),di=mt(li,Ot),pi=w.pipe(ot.w(n.fold((()=>lt.E),(t=>t.initCardActionsProcessing(Wt.actionEvents,e.alertsReader,ni,ai,Ot,ci))))).subscribe(),mi=S.pipe(ot.w(n.fold((()=>lt.E),(t=>t.initCardActionsProcessing(Wt.actionEvents,e.alertsReader,Ot,ci,di))))).subscribe(),ui=A.pipe(ot.w(n.fold((()=>lt.E),(t=>t.initCardActionsProcessing(Wt.actionEvents,e.alertsReader,ci,di,Ot))))).subscribe(),hi=I.pipe(ot.w(n.fold((()=>lt.E),(t=>t.initCardActionsProcessing(Wt.actionEvents,e.alertsReader,ci,Ot))))).subscribe(),gi=F.h.create((0,o.pipe)(D,n.fold((()=>Te.CV.skip),(()=>Z.l$.text)),n.some)),fi=(0,o.pipe)(g,n.map((e=>new Se(Wt.actionEvents,e.feedItemInfo,e.attentionScoreInfo,Ot,Ft,e.heatmapVisible,Zt,(()=>e.onDismissFeedItem()),G,Y)))),vi=[(0,Me.A7)(li,Ot),(0,o.pipe)(tt.EQ.focusMarkByActiveAlert(Ot,qt,e.alertsReader,u.O.getActiveFocusableItem,at.getLogger("MarksEffects.focusMarkByActiveAlert")),K.nL.Effect.Producer.delayed(B)),(0,ie.yS)(qt.events,Ft,at.getLogger("createOnAlertApplySideEffect")),(0,ie.fM)(Wt,Ot,e.alertsReader,At,at),(0,ie._2)(Ot,gi,ai.autoFocusEnabled),...Wt.getApplicatorEffects(),ai.applicatorEffects,qe.R7(Ot,Gt,Ft,(0,s.unsafeCoerce)(Wt.actionEvents),{cardsAroundActive:10,cardsBeyondViewport:10}),(0,o.pipe)((0,Te.k9)(Ot,zt,gi,u.O.getActiveAlignableItem,Ft),K.nL.Effect.Producer.delayed(B)),(0,ie.XU)(Ot,Gt,Ft),(0,ie.qS)(Yt,Kt),Ee.dv.createSendActiveAlertFeedbacksEffect(Ot,u.O.getActiveItemWithAlert,e.alertsService,e.alertsReader,at.getLogger("CardsViewModelEffects.createSendActiveAlertFeedbacksEffect")),Ye.G.getChecklistHandlerSideEffect(Ct,$t.checklist,e.alertsReader,u.O.getActiveItemWithAlert,(e=>e===b.R.SpecialId.PredictionTakeaways)),...(0,o.pipe)(fi,n.fold((()=>[]),(e=>e.getApplicatorEffects()))),...ke.applicatorEffects(Wt.actionEvents,Ft.transitionTo)],wi=F.h.create(b.R.SpecialId.AllAlerts),_i=Ot.view((e=>e.currentLens.id)).pipe(C.h((e=>e===b.R.SpecialId.Priority||e===b.R.SpecialId.AllAlerts))).subscribe(V.wW(wi)),bi=(0,We.VC)(Pt,Bt,wi,u.O.getActiveItemWithAlert,Ft),yi=F.h.create(D),Si=(0,We.Dv)((e=>b.R.isPriority(e.currentLens.id)),bi,Ft),ki=new We.vM(e.sessionModel.checkingState,Ot),Ai=(0,o.pipe)([(0,o.pipe)((e=>We.Py.whenShouldVerifyCurrentLens(u.O.getActiveItemWithAlert,Ft)(e)&&e.currentLens.id!==b.R.SpecialId.PredictionTakeaways),We.Py.behaviorToEffect((()=>n.some(K.nL.Effect.FocusBehavior.focusNext)))),(0,o.pipe)((0,he.W9)((()=>n.isSome(yi.get())),We.Py.whenNoActiveCard),We.Py.behaviorToEffect((e=>(0,o.pipe)((e=>{const t=(0,n.fromPredicate)((0,he.Kg)(u.O.isAlertCard,u.O.isAlertsBundle));return(0,o.pipe)(yi.get(),n.chain((i=>(yi.set(n.none),K.nL.hasCards(e)?(0,o.pipe)(e.currentLens.items.reduce(((e,a)=>(0,o.pipe)(e,n.alt((()=>(0,o.pipe)(a,t,n.chain((e=>n.fromNullable(e.alerts.find((e=>e.id.startsWith(i+"_"))))))))))),n.none),n.map((t=>({alert:t,highlightIndex:0,lensId:e.currentLens.id})))):n.none))))})(e),n.map((e=>K.nL.Effect.FocusBehavior.focusAlert(e))))))),(0,o.pipe)((0,he.W9)((()=>ai.autoFocusEnabled.get()),(0,he.W9)(We.Py.whenFirstOpeningDocumentWithAlerts(ki),We.Py.whenNoActiveCard)),We.Py.behaviorToEffect((()=>n.some(K.nL.Effect.FocusBehavior.focusFirst))))],(0,r.fold)((0,r.getFunctionMonoid)(n.getFirstMonoid())())),Ei=We.Py.getStateTransformer(Ai,Si,e.alertsReader,Ft,(e=>ai.autoFocusEnabled.get()&&"text"!==e.alertSource),s.constVoid,wi),Ci=ne.v.Items.getItemsPositionsUpdateTransformer(Ft),Ii=(0,o.pipe)(g,n.fold((()=>et.t.nothing),(e=>{return t=e.feedItemInfo,({state:e,metadata:i})=>{if(!K.nL.hasItems(e)||!b.R.isMainLens(e.currentLens.id)||!K.nL.isLensview(e))return le.left({state:e,metadata:i});const a=(0,s.pipe)(ae.l.find(e.currentLens.items,ce.m),n.map(oe.pick("value")));return(0,s.pipe)(e,K.nL.getLens,n.chain(de(a,t.get())),n.map((({lens:t,newItem:i})=>K.nL.Prism.getLens().compose(ne.v.Prism.items).set((0,s.pipe)(a,n.fold((()=>t.items),(e=>t.items.remove(e.id))),(e=>(0,s.pipe)(i,n.fold((()=>e),(t=>e.add(t)))))),e))),n.getOrElse((()=>e)),(e=>le.left({state:e,metadata:i})))};var t}))),Ti=(0,s.flow)(Ei,ct.chainLeft(Ci),ct.chainLeft(Ii)),Mi=new Xe.l(Ot,Pt,e.alertsReader,e.alertsService,vi,u.O.getActiveItemWithAlert,Ti),xi=Yt.pipe(k.U((({lensId:e})=>e)),C.h((e=>e===b.R.SpecialId.AllAlerts||e===b.R.SpecialId.Priority)),E.x()).subscribe((e=>{i.set(e),R.next({kind:Ce.R.ChangeLens,selectedLens:e===b.R.SpecialId.Priority?"priority":"all"})})),Fi=Zt.activeView.pipe(k.U((e=>{switch(e.type){case v.aH.Type.default:return i.get();case v.aH.Type.emogenie:return b.R.SpecialId.PredictionEmogenie;case v.aH.Type.readersAttention:return b.R.SpecialId.PredictionTakeaways;case v.aH.Type.readersAttentionHelp:return b.R.SpecialId.Closed;case v.aH.Type.proofitReview:return b.R.SpecialId.RealTimeProofit;default:return null}})),C.h(z.fQ),E.x(),k.U((e=>[e,e===b.R.SpecialId.AllAlerts||e===b.R.SpecialId.Priority]))).subscribe((([e,t])=>Yt.next({lensId:e,focusFirstCard:t}))),Ri=new te.X(W,j,se),Li=new Q(g,Ot,Wt.actionEvents,(t=>e.alertsReader.getById(t)),u.O.getActiveItemWithAlert),Pi=new X(g),Vi=f.pipe(ot.w(n.fold((()=>lt.E),(t=>t.initAssistantSession(Wt.actionEvents,e.alertsReader,Ot,e.alertsService,e.alertsList.state))))).subscribe(),Oi=Wt.actionEvents.pipe(C.h(H.lY.isOpenIdeasGallery)).subscribe((()=>self.open((0,Pe.Um)().grammarlyIdeasSales,"_blank"))),Ni=(0,P.W)(fe),Hi=Wt.actionEvents.subscribe((0,s.flow)((0,c.JH)(e.alertsReader,c.SV.Source.assistant),x.tap((e=>be.next(e)))));return{lensState:Ot,cardsViewModel:Wt,lensPreviewViewModel:yt,cardsListScrollManager:Gt,upgradeViewModel:Ut,alertProcessor:we,checkingService:_e,assistantHeaderViewModel:ti,assistantLayoutViewModel:Zt,assistantCardListViewModel:ai,lensChanged:Yt,predictionsPreviewViewModel:ei,assistantFeedbackViewModel:ni,assistantSettingsViewModel:Ri,assistantProofitViewModel:oi,readersAttentionViewModel:Xt,readersAttentionChecklistViewModel:$t,readersAttentionHeaderViewModel:Pi,readersAttentionItemViewModel:fi,assistantModalManager:Dt,marksViewModel:qt,gnar:G,positionViewModel:Ni,user:re,capabilities:Ft,remSize:Mt,isSingleCardAssistant:!1,dispose:()=>{Hi.unsubscribe(),Li.dispose(),Nt.unsubscribe(),Jt.unsubscribe(),$t.dispose(),Wt.dispose(),Mi.dispose(),qt.dispose(),ei.dispose(),xi.unsubscribe(),bt.unsubscribe(),Fi.unsubscribe(),ti.dispose(),ai.dispose(),Dt.hideAll(),Xt.dispose(),_i.unsubscribe(),ri.unsubscribe(),ii.dispose(),Vi.unsubscribe(),pi.unsubscribe(),Ht.unsubscribe(),si.unsubscribe(),Oi.unsubscribe(),ui.unsubscribe(),hi.unsubscribe(),mi.unsubscribe(),(0,o.pipe)(oi,x.tap((e=>e.dispose()))),(0,o.pipe)(fi,x.tap((e=>e.dispose()))),jt.dispose()}}}},9671:(e,t,i)=>{i.d(t,{y:()=>o,t:()=>l});var a=i(15090),s=i(15646),r=i(77176),n=i(85985);class o{constructor(e,t,i,s){this._cardActions=e,this._gnar=t,this._alertsReader=i,this._user=s,this._subs=[l(this._cardActions,this._gnar,"assistant"),a.g.createSubscription(this._cardActions,this._gnar,this._alertsReader.getById,this._user.get())]}dispose(){this._subs.forEach((e=>e.unsubscribe()))}}const l=(e,t,i)=>e.pipe(r.U((e=>e.type)),n.h((e=>e===s.lY.Type.muteAlertCategory||e===s.lY.Type.undoMuteAlertCategory||e===s.lY.Type.mutedAlertSuggestionManagementClick||e===s.lY.Type.mutedAlertSuccessShow))).subscribe((e=>{switch(e){case s.lY.Type.muteAlertCategory:t.mutedAlertsCardTurnOffButtonClick(i);break;case s.lY.Type.undoMuteAlertCategory:t.mutedAlertsTurnBackOnButtonClick(i);break;case s.lY.Type.mutedAlertSuggestionManagementClick:t.suggestionManagementClick(i);break;case s.lY.Type.mutedAlertSuccessShow:t.categoryDeactivatedShow(i)}}))},38152:(e,t,i)=>{i.d(t,{lo:()=>a,WY:()=>Z});var a,s=i(57050),r=i(40327),n=i(80864),o=i(40033),l=i(73582),c=i(90361),d=i(74850),p=i(84966),m=i(66896),u=i(40018),h=i(70023),g=i(61903),f=i(45586),v=i(77176),w=i(97884),_=i(80900),b=i(41398),y=i(93508),S=i(76974),k=i(95300),A=i(28043),E=i(2834),C=i(95093),I=i(32952),T=i(16782),M=i(85985),x=i(24209),F=i(78674),R=i(60797),L=i(57091),P=i(50628),V=i(66310),O=i(85089),N=i(16118),H=i(35416),B=i(25975),U=i(27125),D=i(5114),W=i(83078),j=i(8125),G=i(38983),q=i(31881);!function(e){let t;!function(e){e.clickOnEmpty="clickOnEmpty",e.clickOnFakeCard="clickOnFakeCard"}(t=e.Type||(e.Type={}))}(a||(a={}));const z={"Saying happy birthday?":"happy_birthday","Saying thank you?":"thank_you","Declining an invite?":"decline","Asking for help?":"help","Following up?":"follow_up","Congratulating someone?":"congratulate","Making an introduction?":"introduce"};class Z{constructor(e,t,i,Y,K,Q,X,$,J=d.Y.create(Z.name)){this._lensState=e,this._predictionsVM=t,this._alertProcessor=i,this._checkingService=Y,this._upgradeViewModel=K,this._capabilities=Q,this._premiumOnboardingViewModel=X,this._gnar=$,this._log=J,this._subs=new f.w.Keeper,this.activeAlert=this._lensState.pipe(v.U((e=>H.nL.hasCards(e)&&m.R.isMainLens(e.currentLens.id)?n.O.getActiveItemWithAlert(e.currentLens):D.none)),v.U((e=>(0,r.pipe)(e,D.fold((()=>null),(e=>e.activeAlert)))))),this._successType=G.h.combine(this._lensState,this._predictionsVM.previewState,((e,t)=>B.v.WithSuccess.State.isInSuccess(this._capabilities)(e)?this._premiumOnboardingViewModel.shouldShowStartNotification?D.some(U.g.SuccessType.premiumOnboardingStart):this._premiumOnboardingViewModel.shouldShowCompleteNotification?D.some(U.g.SuccessType.premiumOnboardingComplete):t.kind===o.fA.visible?D.some(U.g.SuccessType.applied):D.some(U.g.SuccessType.small):D.none)),this.successView=this._successType.pipe(v.U(W.orUndefined),w.z((e=>e===U.g.SuccessType.premiumOnboardingStart||e===U.g.SuccessType.premiumOnboardingComplete?_.H(1e3).pipe(b.M(this._successType),v.U((([e,t])=>t)),y.O(D.some(e))):S.of(D.fromNullable(e))))),this._premiumAlertsCount=this._upgradeViewModel.advancedAlerts.view((0,s.flow)(D.map((e=>e.count)),D.getOrElse((()=>0)))),this.premiumSmartPhraseAlert=this._upgradeViewModel.smartPhrasesPremiumAlert.view(D.getOrElse(s.constNull)),this.havePremiumAlerts=this._premiumAlertsCount.view((e=>e>0)),this._upgradeHookExpanded=new k.X(!1),this.upgradeHookExpanded=(0,r.pipe)(this._upgradeHookExpanded,A.x()),this.onSmartPhrasesUpgradeHookClick=()=>{this._upgradeViewModel.openUpgradeUrl(l.L.Place.assistantCardList),this._gnar.assistantSmartPhrasesUphookClick()},this.onSmartPhrasesUpgradeHookShown=()=>{const e=this.premiumSmartPhraseAlert.get(),t=(0,r.pipe)(null==e?void 0:e.extraProperties.smartPhrasesPremium,D.map((({intent:e})=>z[e])),D.getOrElse(s.constUndefined));this._gnar.assistantSmartPhrasesUphookShow(t)},this.dismissSmartPhrasesUpgradeHook=()=>{const e=this.premiumSmartPhraseAlert.get();this._gnar.assistantSmartPhrasesUphookDismiss(),e?(0,r.pipe)(u.bZ.getRawId(e),W.tap((e=>{this._alertProcessor.removeAlert(e),this._checkingService&&this._checkingService.onAlertIgnored({id:e},p.e3.Sidebar)}))):this._log.warn("Trying to dismiss SmartPhrases premium alert that does not exist.")},this.upgradeHookFlow=(0,r.pipe)((0,h.d)(this._upgradeViewModel.advancedAlerts),q.Z.extendActions(E.b((e=>{e.key===g.n.State.expanded?"upgrade"===e.action.kind?(this._upgradeViewModel.openUpgradeUrl(l.L.Place.assistantCardList),this._gnar.getPremiumButtonClick("assistantList","SeeWhatsInPremium")):"onUpgradeButtonMount"===e.action.kind&&this._onUpgradeButtonMount.next(e.action.element):e.key===g.n.State.minimized&&"onClick"===e.action.action&&this._upgradeHookExpandReason.next("click")}))),q.Z.patchState(C.T(this._autoOpenUpgradeHook())),q.Z.patchState(E.b((e=>this._onUpgradeHookShown.next(function(e){switch(e){case"hidden":return g.n.State.hidden;case"expanded":return g.n.State.expanded;case"minimized":return g.n.State.minimized;default:(0,c.vE)(e)}}(e.kind))))),q.Z.patchState(E.b((e=>this._upgradeHookExpanded.next("expanded"===e.kind))))),this.cardListContext=new k.X(D.none),this.assistantActions=new I.xQ,this.autoFocusEnabled=G.h.create(!0),this.cardListViewportHeight=G.h.create(D.none),this._onUpgradeButtonMount=new T.t,this._upgradeHookExpandReason=new T.t,this._onUpgradeHookShown=new I.xQ,this._unselectActiveAlert=this.assistantActions.pipe(M.h((e=>e.type===a.Type.clickOnEmpty||e.type===a.Type.clickOnFakeCard)),E.b((()=>this.autoFocusEnabled.set(!1))),v.U((()=>e=>e.patch({currentLens:(0,r.pipe)(H.In.getActiveItem(e.currentLens),D.fold((()=>e.currentLens),(t=>H.nL.hasItems(e)?this._capabilities.unselectItem()(e.currentLens):e.currentLens))),switchOrder:"lensOrder",alertSource:u.l$.sidebar})))),this.applicatorEffects={id:"assistantCardListViewModel.effects",when:m.R.isWithAlertsId,what:H.nL.Effect.Applicator.create(x.T(this._unselectActiveAlert))},this._subs.push(this._onUpgradeHookShown.pipe(F.b(1),A.x(),M.h((e=>e===g.n.State.minimized))).subscribe((()=>this._gnar.assistantCollapsedUpgradeHookShow())),this._onUpgradeButtonMount.pipe(R.oA,L.a(this.cardListContext.pipe(R.oA,P.P())),V.w((([e,t])=>O.n(e,{root:t}).pipe(P.P()))),M.h(j.Dw),v.U((e=>Math.trunc(100*e[0].intersectionRatio))),b.M(this._upgradeHookExpandReason,this._premiumAlertsCount)).subscribe((([e,t,i])=>this._gnar.assistantExpandedUpgradeHookShow(i,t,e))),this._lensState.pipe(M.h(H.nL.hasCards),v.U((e=>H.In.getActiveItem(e.currentLens))),N.G(),M.h((([e,t])=>D.isNone(e)&&D.isSome(t)))).subscribe((e=>{this.autoFocusEnabled.set(!0)})),this.successView.pipe(R.oA).subscribe((e=>{e===U.g.SuccessType.premiumOnboardingStart?this._premiumOnboardingViewModel.trackShowNotification("start"):e===U.g.SuccessType.premiumOnboardingComplete&&this._premiumOnboardingViewModel.trackShowNotification("complete")})))}dispose(){this._subs.dispose()}_autoOpenUpgradeHook(){return this._lensState.pipe(M.h((e=>(0,r.pipe)(e.currentLens.id,(0,j.Kg)(m.R.isPriority,m.R.isAllAlerts)))),v.U(B.v.WithSuccess.State.isInSuccess(this._capabilities)),L.a(this.havePremiumAlerts,((e,t)=>e&&t)),A.x(),E.b((e=>{e&&this._upgradeHookExpandReason.next("alertsAddressed")})),b.M(this._upgradeViewModel.advancedAlerts),v.U((([e,t])=>(0,r.pipe)(t,D.fold((()=>({kind:g.n.State.hidden})),(t=>e?{kind:g.n.State.expanded,showCloseButton:!0,alertsState:{count:t.count,alerts:t.alerts()}}:{kind:g.n.State.minimized,alertsCount:t.count}))))))}}},80864:(e,t,i)=>{i.d(t,{O:()=>q});var a=i(57050),s=i(35214),r=i(40327),n=i(54483),o=i(31820),l=i(35108),c=i(77176),d=i(40151),p=i(2834),m=i(55415),u=i(22232),h=i(5114),g=i(32821),f=i(27378),v=i(30763),w=i(7046),_=i(21474),b=i(3656),y=i(28706),S=i(84313),k=i(15646),A=i(74754),E=i(66346),C=i(76974),I=i(5739),T=i(16314),M=i(35501),x=i(35630),F=i(32585);const R=g.UI.Node.make((({state:e,notify:t})=>{const i=f.useContext(v.m.Context);return f.createElement(I.F.Fragment,null,e.pipe(c.U((e=>(0,a.pipe)(e.details,h.fold((()=>f.createElement("div",null)),(()=>f.createElement(w.zx.Tertiary,{key:"toggle-more",name:(0,E.hC)(e.visualState,i),title:(0,E.hC)(e.visualState,i),onClick:y.hz(t({type:k.eI.Kind.startTransitionTo,id:e.id,transition:{type:S.X.isCardOpen(e.visualState)?"focused":"expanded",clockwise:!0}}))},S.X.isCardOpen(e.visualState)?f.createElement(_.JO.Arrow,{key:"more",className:F.lessIcon}):f.createElement(_.JO.QuestionMark,{key:"expand"}),(0,E.hC)(e.visualState,i)))))))))})),L=g.UI.Node.make((({notify:e})=>f.createElement(w.zx.Tertiary,{name:"dismiss",title:"Dismiss",onClick:y.hz(e({type:T.Dy.ignoreButtonClick}))},f.createElement(_.JO.Ignore,null)))),P=g.UI.Node.make((({state:e})=>f.createElement(I.F.Fragment,null,e.pipe(c.U((e=>(0,a.pipe)(e.details,h.fold(a.constNull,(t=>f.createElement(E.G3,{key:"card-actions-details",visualState:e.visualState,className:F.more},f.createElement(b.XY,{className:F.minimalDescription,...A.y.renderToHtml(t)}))))))))))),V=g.UI.Node.make((({notify:e})=>f.createElement(w.zx.Flat,{className:F.feedbackFooter,name:"attention-score-card-open-feedback-form",onClick:y.hz(e({type:T.Dy.feedbackButtonClick}))},f.createElement("span",null,"Anything we can improve?"),f.createElement(_.JO.SmartPhrases.OpenFeedbackFormArrow,null)))),O=g.UI.Node.make((({state:e,notify:t})=>f.createElement(I.F.Fragment,null,e.pipe(c.U((e=>f.createElement(w.zx.Primary,{name:"readersAttentionItem-view-more",onClick:y.hz(t({type:T.Dy.viewMoreButtonClick,item:e})),className:F.viewMoreButton},"See suggestions"))))))),N=g.UI.Knot.make(g.UI.Grid.make((({slots:e})=>f.createElement(I.F.div,{className:x.card,"data-name":"attention-score-card-full"},e.header,f.createElement(I.F.div,{className:F.cardBody},e.content,e.details,f.createElement("div",{className:F.actions},e.viewMoreButton)),f.createElement(I.F.div,{className:F.actionsFooter},e.expandButton,e.dismissButton),e.feedbackFooter))),{header:(0,M.h)("full"),content:M.r,details:P,expandButton:R,dismissButton:L,viewMoreButton:O,feedbackFooter:V}),H=e=>g.Z.composeKnot({header:()=>e,content:()=>e.pipe(c.U((e=>({attentionScore:e.attentionScore,description:e.description})))),details:()=>e,expandButton:()=>e,dismissButton:()=>C.of(null),viewMoreButton:g.Z.fromSideEffect(a.constVoid,e),feedbackFooter:()=>C.of(null)});var B=i(12187),U=i(65060),D=i(11510);const W=g.UI.Knot.make(g.UI.Grid.make((({slots:e,notify:t})=>f.createElement(I.F.div,{"data-name":"attention-score-card-mini",onClick:y.hz(t({type:T.Dy.miniCardClick,id:U.g.id})),...(0,B.Sh)(x.card,D.miniCard)},e.header))),{header:(0,M.h)("mini")}),j=e=>g.Z.composeKnot({root:g.Z.fromSideEffect(a.constVoid,null),header:()=>e});var G;!function(e){const t=g.UI.Union.make("kind",{mini:W,full:N,hidden:g.UI.Node.empty}),i=e=>({mini:j(e.pipe(c.U((e=>({title:e.view.title,attentionScore:e.view.attentionScore,density:e.density}))))),full:H(e.pipe(c.U(m.pick("view")))),hidden:()=>d.E}),s=n.G.make(t);function r(e){switch(e){case"added":case"rendered":return"mini";case"focused":case"expanded":return"full";case"hidden":case"removed":return"hidden";case"presuccess":case"success":case"feedback_form":case"muted":throw new Error(`${e} is not supported for ReadersAttentionCard`);default:(0,u.vE)(e)}}e.Card=g.UI.Node.make((({state:e,notify:t})=>g.UI.mount(s,(0,a.pipe)(o.g.flow(e.pipe(c.U(m.pick("view"))),(0,a.pipe)((e=>g.Z.composeUnion(i(e),(()=>e.pipe(c.U((e=>({kind:r(e.view.visualState.transition.type)})))))))(e),g.Z.extendActions(p.b((e=>t(e.action.action)())))),(e=>g.Z.composeUnion(i(e),(()=>e.pipe(c.U((e=>({kind:(0,a.pipe)(e.view.visualState.from,h.fold((()=>"mini"),r))})))))))(e),m.pick("id"),l.CE.toOption(l.a)),o.g.extend((e=>t(e)()))))))}(G||(G={}));var q,z=i(20153),Z=i(66896),Y=i(52741),K=i(7910),Q=i(49978),X=i(84974),$=i(98752),J=i(17594),ee=i(91549),te=i(20594),ie=i(86775),ae=i(75316),se=i(16892),re=i(48521),ne=i(15215),oe=i(70100),le=i(47306),ce=i(35416),de=i(25975),pe=i(8125),me=i(83078),ue=i(73975),he=i(45701),ge=i(31881);!function(e){function t(e,t,i,a,s){return ce.nL.Items.mapper((e=>e.kind),{[S.X.Kind]:e,[ee.R.Kind]:t,[oe.X.kind]:i,[le.J.kind]:a,[U.g.kind]:s})}function i(e){return e.kind===S.X.Kind}function n(e){return e.kind===ee.R.Kind}function o(e){return i(e)&&ae.C.isEthicalAIItem(e)}function l(e){return n(e)&&ae.C.isEthicalAIItem(e)}function c(e,i){return{viewState:(a,s)=>t((t=>({view:t,isLastCard:a,kind:"alertCard",visibleViewportHeight:e(s)})),(t=>({view:t,isLastCard:a,kind:"alertsBundle",visibleViewportHeight:e(s)})),(e=>({view:e,kind:"checklistItemEmpty"})),(t=>({view:t,kind:"checklistItemWithAlerts",isLastCard:a,visibleViewportHeight:e(s)})),(e=>({density:i()===Z.R.SpecialId.AllAlerts?"normal":"compact",view:e,kind:"readersAttentionItem"})))}}e.isSelectableWithAlertItem=(0,pe.Kg)(i,n,ne.d.isChecklistItemWithAlerts),e.getActiveItemWithAlert=ce.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveAlignableItem=ce.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveFocusableItem=ce.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.checksFeedItemsMapper=t,e.isAlertCard=i,e.isAlertsBundle=n,e.isEthicalAIAlertCard=o,e.isEthicalAIAlertsBundle=l,e.defaultOrd=(0,s.fold)(he.getMonoid())([(0,r.pipe)(he.ordBoolean,he.contramap((0,pe.ff)(o))),(0,r.pipe)(he.ordBoolean,he.contramap(U.m)),he.fromCompare(((e,t)=>i(e)&&i(t)?S.X.ord.compare(e,t):0))]),e.bundlesOrd=(0,s.fold)(he.getMonoid())([(0,r.pipe)(he.ordBoolean,he.contramap((0,pe.ff)(l))),(0,r.pipe)(he.ordBoolean,he.contramap(U.m)),he.fromCompare(((e,t)=>n(e)&&n(t)?ee.R.ord.compare(e,t):0))]),e.item=e=>ge.UI.Union.make("kind",{alertCard:Y.p.Card(e),alertsBundle:Q.Q.Card(e),checklistItemEmpty:X.z.Card(e),checklistItemWithAlerts:$.fw.Card(e),readersAttentionItem:G.Card}),e.viewState=c,e.createCardListFlow=e=>(0,K.sJ)((t=>(0,r.pipe)(e,me.tap((e=>e.actions.next(t.action)))))),e.listItemOrd=e=>he.contramap((e=>e.cell.item.view))(e).compare;const d={equals:(e,t)=>e.kind===t.kind&&se.s.eqById.equals(e,t)},p=(e,t,i,a,s)=>({equals:(r,n)=>{const o={[S.X.Kind]:e,[ee.R.Kind]:t,[oe.X.kind]:i,[le.J.kind]:a,[U.g.kind]:s};return d.equals(r,n)&&function(e,t){return(i,a)=>t[e(i)].equals(i,a)}((e=>e.kind),o)(r,n)}}),m=(0,s.fold)(ue.getMonoid())([re.o.eq,se.s.verticalPositionEq,d]);function u(e,i){const a=S.X.Capabilities.getChangePosition(e);return{changePosition:e=>t(a.changePosition(e),ee.R.changePosition(e),oe.X.changePositionState(e),i.changePositionState(e),z.n$(e))}}function g(e,i,a){const s=S.X.Capabilities.getAnimatable(e),r=ee.R.Capabilities.getAnimatable(a);return{completeTransition:e=>t(s.completeTransition(e),r.completeTransition(e),oe.X.completeTransition(e),i.completeTransition(e),z.Xw(e)),transitionTo:e=>t(s.transitionTo(e),r.transitionTo(e),oe.X.transitionTo(e),i.transitionTo(e),z.uL(e)),changeVisualState:e=>t(s.changeVisualState(e),r.changeVisualState(e),oe.X.changeVisualState(e),i.changeVisualState(e),z.pR(e))}}function f(e,i,s,r,n){const o=ee.R.getCardHydrator(n),l=ee.R.getSelect(s,r,o),c=ee.R.getSelectByAlert(s,r,o),d=S.X.Capabilities.getSelect(e);return{select:(e,s,r)=>t(d.select(e,s,r),l(e,s),oe.X.select(e),i.selectFirstAlert((0,a.unsafeCoerce)(e),s),z.Ys(e,s)),selectByAlert:(e,s,r,n)=>t(d.selectByAlert(e,s,r,n),c(s,e,r),oe.X.select(e),i.selectByAlert(s,(0,a.unsafeCoerce)(e),r),a.identity),unselect:(e,s)=>t(d.unselect((0,a.unsafeCoerce)(e),s),ee.R.unselect((0,a.unsafeCoerce)(e),s),oe.X.unselect(e),i.unselect((0,a.unsafeCoerce)(e),s),z.hF(e,s))}}function v(e,s,r,o,l,c){return{removeAlertFromItem:(d,p)=>t((t=>S.X.Capabilities.getRemoveAlerts(e,p.itemsOrd)(d,ce.In.getActiveItemOfType(i)(p))(t)),(e=>ee.R.Capabilities.getRemoveAlertsCapability(o,l,c,p.itemsOrd)(d,ce.In.getActiveItemOfType(n)(p))(e)),a.identity,(e=>ie.G.getRemoveAlert(s,r,o).removeAlertFromItem(d,p)(e)),a.identity)}}function w(e,i,s,r){const n=S.X.Capabilities.getRemove(e);return{remove:(e,o)=>t(n.remove(e,o),(t=>e(t)?ee.R.Capabilities.getRemove(s,r)([t.activeAlert],o(t))(t):t),a.identity,(t=>e(t)?i.removeAlerts(t.alerts,o(t))(t):t),a.identity)}}function _(e,i,s,r){const n=S.X.Capabilities.getUpdateWithAlert(e),o=ee.R.Capabilities.getUpdatableWithAlertsCapability(i,r);return{updateWithAlerts:e=>t(n.updateWithAlerts(e),o(e),a.identity,s.updateWith(e),a.identity)}}e.equatable={structEq:p(S.X.eq,ee.R.eq,oe.X.eq,le.J.eq,U.g.eq),idEq:p(d,d,d,d,d),visualStateEq:p(m,m,m,m,m)},e.cloneable=()=>{const e=se.s.Capabilities.getPojoCloneable().clone;return{clone:t(S.X.Capabilities.getCloneable().clone,e,e,e,e)}},e.changePosition=u,e.disposable={isScheduledToDispose:t((e=>ae.C.willBeDisposed(e,e.removedAlertsIds)),(e=>ae.C.willBeDisposed(e,e.removedAlertsIds)),a.constFalse,(e=>ae.C.willBeDisposed(e,e.removedAlertsIds)),a.constFalse)},e.hidable={isHidden:t(re.o.isHidden,re.o.isHidden,re.o.isHidden,re.o.isHidden,re.o.isHidden)},e.animatableItem=g,e.hasAlertsQueries={isSelectableByAlert:e=>t(ae.C.hasAlert(e.alert.id),ae.C.hasAlert(e.alert.id),a.constFalse,ae.C.hasAlert(e.alert.id),a.constFalse),hasAlert:e=>t(ae.C.hasAlert(e),ae.C.hasAlert(e),a.constFalse,ae.C.hasAlert(e),a.constFalse),hasActiveAlert:t((e=>h.some(e.activeAlert)),(e=>h.some(e.activeAlert)),(()=>h.none),(e=>h.some(e.activeAlert)),(()=>h.none))},e.changePositionStrategyQueries={useReferenceHeightOnRemove:t(a.constFalse,a.constFalse,a.constFalse,a.constTrue,a.constFalse)},e.select=f,e.removeAlert=v,e.remove=w,e.updateWithAlert=_,e.releaseAlert=(t,i,a,s,r,n)=>de.v.Capabilities.getAlertReleaser({...v(t,i,a,s,r,n),...e.disposable}),e.unselectable=(e,t,i,a,s)=>de.v.Capabilities.getUnselectable(ce.In.getActiveItem,f(e,t,i,a,s)),e.selectableByAlert=(t,i,a,s,r)=>de.v.Capabilities.getSelectableByAlert(ce.In.getActiveItem,{...e.hasAlertsQueries,...f(t,i,a,s,r),...de.v.Capabilities.getHasChecksFeed()}),e.selectableById=(e,t,i,a,s)=>de.v.Capabilities.getSelectableById(ce.In.getActiveItem,f(e,t,i,a,s)),e.updateMeta=()=>({updateMeta:de.v.Capabilities.getMetaUpdatable().updateMeta}),e.animatableFeed=(e,t,i,a,s,r)=>de.v.Capabilities.getAnimatable(e,{...v(e,t,i,a,s,r),...g(e,t,r),...de.v.Capabilities.getHasChecksFeed()}),e.hasPriorityToggle=(t,i,a)=>de.v.WithPriority.getHasPriorityToggle({...g(t,i,a),...e.hasAlertsQueries,...e.disposable});const b=t=>["focused","expanded"].includes(t.visualState.transition.type)&&!e.disposable.isScheduledToDispose(t);function y(e,i){const a=te.Mq.getCardSelections(i);return{nextAlert:t(a.nextAlert,a.nextAlert,(()=>h.none),e.nextAlert,(()=>h.none)),prevAlert:t(a.prevAlert,a.prevAlert,(()=>h.none),e.prevAlert,(()=>h.none))}}function k(){return{updateUserInput:e=>t(S.X.updateUserInput(e),ee.R.changeUserInput(e),a.identity,a.identity,a.identity)}}e.alignable={isValidToAlign:t(b,b,a.constFalse,b,a.constFalse)},e.alertIterator=y,e.itemReleaser=(e,t,i)=>ie.G.getItemReleaser(e,t,i,de.v.Capabilities.getItemReleaser()),e.hasAlerts=de.v.Capabilities.getHasAlerts,e.getDefaultNextAlertItemFilter=t=>(0,pe.W9)(e.isSelectableWithAlertItem,(i=>!e.disposable.isScheduledToDispose(i)&&(0,r.pipe)(i,e.hasAlertsQueries.hasActiveAlert,h.map((e=>t.isRegistered(e.id))),h.getOrElse(a.constFalse)))),e.hasUserInput=k,e.priorityTest=(0,pe.W9)(i,(e=>J.$.isPriority(e.activeAlert))),e.verifiable=()=>de.v.Capabilities.getVerifiable(e.disposable),e.getCapabilities=function(t,i,s,r,n,o,l,d=(0,a.constant)(h.none),p=te.IG.Default){return{...c(d,l),...e.disposable,...e.hidable,...e.equatable,...k(),...e.cloneable(),...u(t,s),...g(t,s,n),...f(t,s,r,p,n),...w(t,s,p,n),...v(t,s,o,r,p,n),..._(t,i,s,n),...e.hasAlertsQueries,...e.changePositionStrategyQueries,...e.alignable,...e.releaseAlert(t,s,o,r,p,n),...e.unselectable(t,s,r,p,n),...e.selectableByAlert(t,s,r,p,n),...e.selectableById(t,s,r,p,n),...e.updateMeta(t),...e.animatableFeed(t,s,o,r,p,n),...e.hasPriorityToggle(t,s,n),...e.itemReleaser(s,o,r),...e.verifiable(),...e.hasAlerts(y(s,r),e.hasAlertsQueries,(()=>e.getDefaultNextAlertItemFilter(r)))}}}(q||(q={}))},5178:(e,t,i)=>{i.d(t,{Q:()=>a,_:()=>n});var a,s=i(75003),r=i(53844);!function(e){e.readersAttention="readers_attention",e.settings="settings",e.smartPhrases="smart_phrases"}(a||(a={}));class n{constructor(e,t,i){this._assistantLayoutViewModel=e,this._domain=t,this._gnar=i}getDomain(){return this._domain}openFeedback(e){this._entryPoint=e,this._gnar.assistantFeedbackButtonClick(this._entryPoint),this._assistantLayoutViewModel.pushActiveView({type:s.aH.Type.feedback})}submitFeedback(e){this._gnar.assistantFeedbackSubmitButtonClick(this._entryPoint,e.domain,e.text,(0,r.d)(e)?e.score:void 0)}get entryPoint(){return this._entryPoint}}},75003:(e,t,i)=>{i.d(t,{aH:()=>a,D$:()=>c,_z:()=>d});var a,s=i(90361),r=i(14601),n=i(78674),o=i(85985),l=i(38983);!function(e){let t,i,a,s;!function(e){e.default="default",e.emogenie="emogenie",e.readersAttention="readersAttention",e.readersAttentionHelp="readersAttentionHelp",e.feedback="feedback",e.settings="settings",e.proofitRequest="proofitRequest",e.proofitReview="proofitReview",e.popup="popup",e.startupPlaceholder="startupPlaceholder"}(t=e.Type||(e.Type={})),function(e){let t;!function(e){let t;!function(e){e.predictionWidget="predictionWidget",e.navigation="navigation",e.readersAttentionItem="readersAttentionItem"}(t=e.Type||(e.Type={}))}(t=e.Caller||(e.Caller={}))}(i=e.ReadersAttention||(e.ReadersAttention={})),function(e){let t;!function(e){e.headerButton="headerButton",e.descriptionLink="descriptionLink"}(t=e.Caller||(e.Caller={}))}(a=e.ReadersAttentionHelp||(e.ReadersAttentionHelp={})),function(e){let t;!function(e){e.none="none"}(t=e.Type||(e.Type={}))}(s=e.Popup||(e.Popup={})),e.isDefault=function(t){return t.type===e.Type.default},e.isEmogenie=function(t){return t.type===e.Type.emogenie},e.isReadersAttention=function(t){return t.type===e.Type.readersAttention},e.isReadersAttentionHelp=function(t){return t.type===e.Type.readersAttentionHelp},e.isFeedback=function(t){return t.type===e.Type.feedback},e.isSettings=function(t){return t.type===e.Type.settings},e.isProofitRequest=function(t){return t.type===e.Type.proofitRequest},e.isProofitReview=function(t){return t.type===e.Type.proofitReview},e.isPopup=function(t){return t.type===e.Type.popup},e.hasAlerts=function(e){switch(e.type){case t.default:case t.emogenie:case t.readersAttention:return!0;default:return!1}}}(a||(a={}));class c{constructor(e,t,i,c,d){this._defaultView=i,this.browser=d,this._sub=new r.w,this.viewHistory=[],this.isHeaderNavigationEnabled=l.h.create(!0).view(),this._activeView=l.h.create({type:a.Type.startupPlaceholder}),this._sub.add(e.subscribe((e=>{if(e.length>0)for(;!a.hasAlerts(this._activeView.get());)this.popActiveView()}))),c&&this._sub.add(t.pipe(n.b(100),o.h(s.fQ)).subscribe((()=>{if(c.has(this._activeView.get().type))for(;this._activeView.get().type!==this._defaultView.type;)this.popActiveView()})))}get activeView(){return this._activeView.view()}get lastView(){return this.viewHistory[this.viewHistory.length-1]||this._defaultView}pushActiveView(e){const t=this._activeView.get();e.type!==t.type&&(t.type!==a.Type.startupPlaceholder&&this.viewHistory.push(t),this._activeView.set(e))}popActiveView(){const e=this.viewHistory.pop()||this._defaultView;this._activeView.set(e)}replaceActiveView(e){e.type!==this._activeView.get().type&&this._activeView.set(e)}dispose(){this._sub.unsubscribe()}}class d extends c{constructor(e,t,i,s){super(t,i,{type:a.Type.default},new Set([a.Type.readersAttention,a.Type.emogenie]),s),this.isHeaderNavigationEnabled=this._activeView.view((e=>e.type!==a.Type.feedback)),this._sub.add(this._activeView.subscribe((t=>{switch(t.type){case a.Type.settings:return void e.assistantSettingsShow();case a.Type.proofitRequest:return void e.proofitRequestFormShow();default:return}})))}popActiveView(){const e=this.viewHistory.pop()||this._defaultView;e.type===a.Type.readersAttention&&(e.caller={type:a.ReadersAttention.Caller.Type.navigation}),this._activeView.set(e)}}},59456:(e,t,i)=>{i.d(t,{W:()=>s});var a=i(63919);const s=e=>{const t=e.initialPositionOffset.get();return{initialPositionOffset:t,onDrag:i=>{e.updateInitialPositionOffset(a.E9.plus(t,function({x:e,y:t}){return a.E9.create({top:t,left:e})}(i.translate)))}}}},49197:(e,t,i)=>{i.d(t,{a:()=>E,z:()=>x});var a=i(57050),s=i(17889),r=i(80864),n=i(90361),o=i(74850),l=i(40018),c=i(4390),d=i(17594),p=i(34383),m=i(15215),u=i(86718),h=i(35416),g=i(14601),f=i(98403),v=i(77176),w=i(16118),_=i(85985),b=i(41398),y=i(83078),S=i(5114),k=i(71249),A=i(38983);class E{constructor(e,t,i,s,n,l=r.O.getActiveItemWithAlert){this._feature=e,this._alertsCollection=t,this._alertsService=i,this._assistantLensState=s,this._takeawayAlertChanges=n,this._getActiveItemWithAlert=l,this._log=o.Y.create(E.name),this._checklist=A.h.create(p.D.empty()),this._subscription=new g.w,this.checklist=this._checklist.view(),(0,a.pipe)(this._feature,y.tap((e=>this._subscription.add(this._handleChecklistUpdates(e))))),this._subscription.add(this._markTakeawaysAsDoneWhenChecklistItemCollapsed()),this._subscription.add(this._markTakeawayAsDoneWhenMarkedCorrectlyDetectedOutsideOfChecklist()),this._subscription.add(this._markTakeawayNotDoneIfUnreadable()),this._subscription.add(this._checklist.subscribe((e=>this._log.debug("State changed",e))))}_handleChecklistUpdates(e){return this._subscription.add((t=e,i=this._alertsCollection,A.h.combine(t.rawChecklist,i,((e,t)=>{const i=c.p.reduce(new Map,((e,t)=>{return(0,a.pipe)((i=t,(0,a.pipe)(i.alert.extraProperties.takeawayBundleId,S.map(p.T.Id.create))),S.fold((()=>e),(i=>e.set(i,(e.get(i)||[]).concat([t])))));var i}))(t);return new Map(Array.from(e.items.values()).map((t=>[p.T.Id.create(t.id),I(t,e.wordsCount,i)])))}))).subscribe(f.wW(this._checklist)));var t,i}_markTakeawaysAsDoneWhenChecklistItemCollapsed(){return this._assistantLensState.pipe(v.U((e=>h.nL.hasItems(e)?h.In.getActiveItem(e.currentLens):S.none)),w.G(),v.U((([e,t])=>(0,a.pipe)(e,S.filter(m.d.isChecklistItemWithAlerts),S.map((e=>({item:e,alerts:e.alerts.filter(M).map((e=>e.id))}))),S.filter((({item:e})=>(0,a.pipe)(t,S.fold(a.constTrue,(t=>t.id!==e.id))))),S.fold((()=>[]),(e=>e.alerts)))))).subscribe((e=>{e.forEach((e=>{this._alertsService.changeTakeawayFeedback(e,l.TO.correctlyDetectedAndDone)}))}))}_markTakeawayNotDoneIfUnreadable(){return this._takeawayAlertChanges.pipe(v.U((e=>Array.from(e.changed.values()).filter((e=>y.contains(l.TO.correctlyDetectedAndDone)(e.takeawayFeedback)&&!e.takeawayIsLikelyToBeRead)).map((e=>e.id))))).subscribe((e=>{e.forEach((e=>{this._alertsService.changeTakeawayFeedback(e,l.TO.correctlyDetected)}))}))}_markTakeawayAsDoneWhenMarkedCorrectlyDetectedOutsideOfChecklist(){return this._takeawayAlertChanges.pipe(v.U((e=>e.changed)),_.h((e=>e.size>0)),b.M(this._assistantLensState),v.U((([e,t])=>(0,a.pipe)(h.nL.hasItems(t)?this._getActiveItemWithAlert(t.currentLens):S.none,S.filter((0,a.not)(m.d.isChecklistItemWithAlerts)),S.fold((()=>[]),(()=>Array.from(e.values()).filter((0,a.flow)(d.$.fromModel,M)).map((e=>e.id)))))))).subscribe((e=>{e.forEach((e=>{this._alertsService.changeTakeawayFeedback(e,l.TO.correctlyDetectedAndDone)}))}))}dispose(){this._subscription.unsubscribe()}}function C(e){return l.bZ.isTakeaway(e)&&e.takeawayIsLikelyToBeRead&&(y.contains(l.TO.correctlyDetected)(e.takeawayFeedback)||y.contains(l.TO.correctlyDetectedAndDone)(e.takeawayFeedback))}function I(e,t,i){const r=p.T.Id.create(e.id),n=(i.get(r)||[]).map((e=>e.alert)),o=(0,a.pipe)(n.filter(C),s.nI),c=(0,a.pipe)(n,k.filter((e=>!l.bZ.isTakeaway(e)||S.isNone(e.takeawayFeedback)||y.contains(l.TO.correctlyDetected)(e.takeawayFeedback))),(e=>e.every(C)?[]:e),s.nI);return{id:r,rank:e.rank,suggestionsView:(0,a.pipe)(e.suggestionsCard,S.chain((e=>(0,a.pipe)(c,S.map((t=>({title:e.title,miniTitle:e.miniTitle,miniLabel:S.none,alertIds:(0,a.pipe)(t,(0,s.UI)((e=>e.id)))}))))))),successView:(0,a.pipe)(e.successCard,S.chain((e=>(0,a.pipe)(o,S.map((t=>({title:e.title,miniTitle:e.miniTitle,miniLabel:S.none,alertIds:(0,a.pipe)(t,(0,s.UI)((e=>e.id)))}))))))),emptyView:{checked:e.defaultCard.checked,title:e.defaultCard.title,miniTitle:e.defaultCard.miniTitle,miniLabel:"textLength"===e.defaultCard.kind?S.some(`${t} words`):S.none,card:T(e,t)}}}function T(e,t){const i="simple"===e.defaultCard.kind?u.f.Kind.simple:"textLength"===e.defaultCard.kind?u.f.Kind.textLength:(0,n.vE)(e.defaultCard.kind);return i===u.f.Kind.simple?{kind:i,explanation:e.defaultCard.description,details:e.defaultCard.details}:{kind:i,explanation:e.defaultCard.description,details:e.defaultCard.details,wordCount:t}}function M(e){return d.$.isTakeaway(e)&&e.takeawayIsLikelyToBeRead&&y.contains(l.TO.correctlyDetected)(e.takeawayFeedback)}function x(e){return Array.from(e.values()).reduce(((e,t)=>function(e){return S.isNone(e.suggestionsView)&&(S.isSome(e.successView)||e.emptyView.checked)}(t)?e+1:e),0)}},23518:(e,t,i)=>{i.d(t,{d:()=>a,X:()=>F});var a,s=i(17771),r=i(57050),n=i(26328),o=i(40327),l=i(75003),c=i(41034),d=i(90361),p=i(66896),m=i(40018),u=i(4390),h=i(14601),g=i(76974),f=i(28043),v=i(93508),w=i(16118),_=i(77176),b=i(19751),y=i(85985),S=i(34383),k=i(15215),A=i(35416),E=i(5114),C=i(83078),I=i(73975),T=i(71249),M=i(38983);function x(e){return l.aH.isReadersAttention(e)||l.aH.isReadersAttentionHelp(e)}!function(e){e.ok="ok",e.warning="warning",e.feedback="feedback"}(a||(a={}));class F{constructor(e,t,i,s,l,d,p){this._readersAttentionFeature=e,this._checklistItemsCollection=t,this._assistantLayoutVM=i,this._alertsCollection=s,this._alertsReader=l,this._assistantLensState=d,this._takeawayAlertChanges=p,this._subs=new h.w,this.predictionCardState=(0,o.pipe)(this._readersAttentionFeature,E.fold((()=>g.of(E.none)),(e=>function(e,t,i){return M.h.combine(e.messages,e.heatmapReceived,e.hidden,t,((e,t,s,l)=>(0,o.pipe)(e,E.filter((()=>t&&l.size>0&&!s)),E.map((e=>({message:e.predictionMessage,icon:Array.from(l.values()).every(L)?a.ok:Array.from(l.values()).every((e=>(0,o.pipe)(e.suggestionsView,E.map(function(e){return t=>(0,o.pipe)(t.alertIds,(0,n.UI)((0,r.flow)(e.getById,E.filter((e=>m.bZ.isTakeaway(e)&&e.takeawayIsLikelyToBeRead&&E.isNone(e.takeawayFeedback))))),T.every(E.isSome))}(i)),E.getOrElse((()=>E.isSome(e.successView)||e.emptyView.checked)))))?a.feedback:a.warning,alertsCount:E.some(V(l))}))))))}(e,this._checklistItemsCollection,this._alertsReader)))),this._subs.add(this._handleHeatmapVisibilityAndNavigationTracking()),this._subs.add(this._trackChecklistItemExpand()),(0,o.pipe)(this._readersAttentionFeature,C.tap((e=>{this._subs.add((0,c.W)(this._takeawayAlertChanges,e.takeawaysFeedbackStore))})))}open(e){this._assistantLayoutVM.pushActiveView({type:l.aH.Type.readersAttention,caller:e})}showHelp(e){this._assistantLayoutVM.pushActiveView({type:l.aH.Type.readersAttentionHelp,caller:e}),this._trackOnShowHelp(e)}dispose(){x(this._assistantLayoutVM.activeView.get())&&(0,o.pipe)(this._readersAttentionFeature,C.tap((e=>e.heatmapVisible.set(!1)))),x(this._assistantLayoutVM.activeView.get())&&this._trackOnReadersAttentionHide(),this._subs.unsubscribe()}_handleHeatmapVisibilityAndNavigationTracking(){return this._assistantLayoutVM.activeView.pipe(f.x(((e,t)=>e.type===t.type)),v.O(null),w.G()).subscribe((([e,t])=>{(0,o.pipe)(this._readersAttentionFeature,C.tap((i=>{x(t)&&!i.heatmapVisible.get()?i.heatmapVisible.set(!0):e&&x(e)&&!x(t)&&i.heatmapVisible.get()&&i.heatmapVisible.set(!1)}))),!l.aH.isReadersAttention(t)||e&&l.aH.isReadersAttentionHelp(e)?!x(t)&&e&&x(e)&&this._trackOnReadersAttentionHide():this._trackOnReadersAttentionShow(t.caller)}))}_trackChecklistItemExpand(){return this._assistantLensState.pipe(_.U((e=>(0,o.pipe)(E.fromPredicate(A.nL.hasItems)(e),E.map(A.nL.Prism.getLens().get),E.filter((e=>e.id===p.R.SpecialId.PredictionTakeaways)),E.chain(A.In.getActiveItemOfType(k.d.isChecklistItem)),E.map((e=>{return{id:(t=e.id,i=p.R.SpecialId.PredictionTakeaways,S.T.Id.create(t.substr(i.length+1)||t)),title:(0,o.pipe)(e.itemMeta.miniTitle,E.getOrElse((()=>e.itemMeta.title))),checked:R(e),numAlerts:k.d.isChecklistItemWithAlerts(e)?e.alerts.length:0};var t,i}))))),b.$f(E.getEq(I.contramap((e=>e.id))(I.eqString))),_.U(E.getOrElse(r.constNull)),y.h(d.fQ)).subscribe((e=>(0,o.pipe)(this._readersAttentionFeature,C.tap((t=>t.tracking.onChecklistItemExpand(e))))))}_trackOnReadersAttentionShow(e){(0,o.pipe)(this._readersAttentionFeature,E.chain((e=>(0,o.pipe)(s.g(E.option)(e.messages.get(),P(this._checklistItemsCollection.get())),E.map((t=>({feature:e,predictionMessage:t[0].predictionMessage,checklistInfo:t[1]})))))),C.tap((({feature:t,predictionMessage:i,checklistInfo:a})=>{t.tracking.onOpen(a,i,this._getNumAlerts(),e)})))}_trackOnReadersAttentionHide(){(0,o.pipe)(this._readersAttentionFeature,E.chain((e=>(0,o.pipe)(P(this._checklistItemsCollection.get()),E.map((t=>({feature:e,checklistInfo:t})))))),C.tap((({feature:e,checklistInfo:t})=>{e.tracking.onClose(t,this._getNumAlerts())})))}_trackOnShowHelp(e){(0,o.pipe)(this._readersAttentionFeature,C.tap((t=>{t.tracking.onHelpScreenShow(e)})))}_getNumAlerts(){return(0,o.pipe)(this._alertsCollection.get(),u.p.reduce({takeaway:0,nonTakeaway:0},((e,t)=>{const i=m.bZ.isTakeaway(t.alert),a=m.bZ.belongsToPredictionTakeaways(t.alert)&&!i;return{takeaway:e.takeaway+(i?1:0),nonTakeaway:e.nonTakeaway+(a?1:0)}})))}}function R(e){return k.d.isChecklistItemWithAlerts(e)&&"single"===e.viewKind||k.d.isChecklistItemEmpty(e)&&e.itemMeta.checked}function L(e){return E.isNone(e.suggestionsView)&&(E.isSome(e.successView)||e.emptyView.checked)}function P(e){const t=Array.from(e.values()).sort(((e,t)=>e.rank-t.rank));return(0,o.pipe)(t.map((e=>({checked:L(e),message:(0,o.pipe)(e.suggestionsView,C.orElse(e.successView),E.map((e=>(0,o.pipe)(e.miniTitle,E.getOrElse((()=>e.title))))),E.getOrElse((()=>(0,o.pipe)(e.emptyView.miniTitle,E.getOrElse((()=>e.emptyView.title))))))}))),n.nI)}function V(e){return(0,o.pipe)(Array.from(e.values()),T.reduce(0,((e,t)=>e+(0,o.pipe)(t.suggestionsView,E.map((e=>e.alertIds.length)),E.alt((()=>(0,o.pipe)(t.successView,E.map((()=>1))))),E.getOrElse((()=>0))))))}},41034:(e,t,i)=>{i.d(t,{a:()=>f,W:()=>v});var a=i(17771),s=i(57050),r=i(40327),n=i(40018),o=i(4390),l=i(93508),c=i(16118),d=i(77176),p=i(85985),m=i(19751),u=i(92843),h=i(5114),g=i(83078);function f(e){return e.pipe(l.O(o.p.empty),c.G(),d.U((([e,t])=>(0,r.pipe)(o.p.diff(e,t),o.p.Diff.filter((e=>n.bZ.isTakeaway(e.alert)))))),p.h((0,s.not)(u.v.isEmpty)),d.U(u.v.reduce({changed:new Map,removed:new Map},((e,t)=>n.bZ.isTakeaway(t.alert)?(e.removed.set(t.alert.id,t.alert),e):e),((e,t,i)=>n.bZ.isTakeaway(i.alert)?(e.changed.set(i.alert.id,i.alert),e):e),((e,t)=>n.bZ.isTakeaway(t.alert)?(e.changed.set(t.alert.id,t.alert),e):e))),m.d({bufferSize:1,refCount:!0}))}function v(e,t){return e.subscribe((e=>{Array.from(e.changed.values()).forEach((e=>{(0,r.pipe)(a.Y(h.option)({rawId:(0,r.pipe)(e,n.bZ.getRawId),feedback:e.takeawayFeedback}),g.tap((({rawId:e,feedback:i})=>{t.registerFeedback(e,i)})))})),Array.from(e.removed.values()).forEach((e=>{(0,r.pipe)(e,n.bZ.getRawId,g.tap((e=>{t.deleteFeedback(e)})))}))}))}},31536:(e,t,i)=>{i.d(t,{X:()=>s});var a=i(38040);class s{constructor(e,t,i){this._contentScriptState=e,this._contentScriptActions=t,this.domain=i,this.state=this._contentScriptState.view((e=>({user:e.user,commonSettings:e.page,dynamicConfig:e.dynamicConfig}))),this.actions={toggleSite:(e,t)=>this._contentScriptActions.toggleSite({enabled:e,domain:t,isPartOfGdocsSidebarExperiment:(0,a.IJ)(this.state.view("user").get())}),toggleDefs:this._contentScriptActions.toggleDefs,toggleAutocomplete:this._contentScriptActions.toggleAutocomplete,toggleAutocorrect:this._contentScriptActions.toggleAutocorrect,changeStrongDialect:this._contentScriptActions.changeStrongDialect,setDesktopIntegration:this._contentScriptActions.setDesktopIntegration}}}},68654:(e,t,i)=>{i.d(t,{fM:()=>V,_2:()=>O,yS:()=>N,qS:()=>H,XU:()=>B});var a=i(17771),s=i(57050),r=i(40327),n=i(29909),o=i(80864),l=i(16868),c=i(66896),d=i(40018),p=i(15646),m=i(99116),u=i(35416),h=i(74364),g=i(66310),f=i(91402),v=i(40151),w=i(76974),_=i(77176),b=i(85985),y=i(78674),S=i(60797),k=i(28043),A=i(41398),E=i(98403),C=i(2834),I=i(24209),T=i(598),M=i(83401),x=i(16118),F=i(22232),R=i(5114),L=i(83078),P=i(95195);function V(e,t,i,a,s){return{id:"changeAlertEffect",when:c.R.isWithAlertsId,what:u.nL.Effect.SwitchAlert.create(e.actionEvents.pipe(g.w((e=>{const n=t.get();if(!u.nL.hasCards(n))return f._(new F.ej("Cannot update state without cards"));switch(e.type){case p.lY.Type.alertMinicardButtonClick:return(0,r.pipe)(i.getRegistered(e.alertHighlight.alert.id),R.fold((()=>(s.warn("somehow we got click on non registered alert",e.alertHighlight.alert),v.E)),(()=>w.of(e.alertHighlight))));case p.lY.Type.cardMatchesNavigationButtonClick:const t=e.transitionTo;switch(t.kind){case"anotherAlert":return(0,r.pipe)("right"===e.direction?a.nextAlert(t.card):(0,r.pipe)(a.prevAlert(t.card),L.orElse(a.anyRegisteredAlert(t.card))),R.fold((()=>v.E),(e=>w.of({alert:e,highlightIndex:0}))));case"sameAlert":return(0,r.pipe)(i.getRegistered(t.card.activeAlert.id),R.fold((()=>v.E),(()=>w.of({alert:t.card.activeAlert,highlightIndex:t.highlightIndex}))));default:return(0,F.vE)(t)}default:return v.E}})),_.U((e=>({alertHighlight:e,alertSource:d.l$.sidebar,options:{order:"lensOrder"}})))))}}function O(e,t,i){const a=e.pipe(b.h(u.nL.hasCards),y.b(0),_.U((e=>e)),b.h((e=>e.currentLens.items.size>0&&R.isNone(u.In.getActiveItem(e.currentLens))&&i.get())),_.U((e=>(0,r.pipe)(e.currentLens.items.getAt(0),R.chain(o.O.checksFeedItemsMapper((e=>R.some(e.activeAlert)),(e=>R.some(e.activeAlert)),(()=>R.none),(()=>R.none),(()=>R.none))),L.tap((()=>t.set(R.some(l.CV.skip))))))),S.oA,b.h((e=>e.state.type===d.bZ.State.Type.REGISTERED)),k.x());return{id:"focusFirstCardSideEffect",when:e=>e!==c.R.SpecialId.PredictionTakeaways&&e!==c.R.SpecialId.PredictionEmogenie,what:u.nL.Effect.SwitchLens.create(a.pipe(A.M(e),_.U((([e,t])=>({lensId:t.currentLens.id,alertSource:d.l$.text,options:{order:"lensOrder",toFocus:u.nL.Effect.FocusBehavior.focusAlert({alert:e,highlightIndex:0})}})))))}}function N(e,t,i){const a=e.pipe(_.U((e=>a=>e.type===h.ay.Type.AppliedAlertAnimationFinished&&a.currentLens.meta.filter(e.alert)&&u.nL.hasItems(a)?a.patch({currentLens:(0,r.pipe)(P.tryCatch((()=>d.bZ.isApplicableAlert(e.alert)?t.finishApplyAnimation([e.alert])(a.currentLens):a.currentLens),(e=>i.error("could not update lens state on applied animation finish",e))),P.getOrElse((()=>a.currentLens))),alertSource:e.alert.state.source}):a)));return{id:"onAlertApply",when:s.constTrue,what:u.nL.Effect.Applicator.create(a)}}function H(e,t){return{id:"lensChangeEffect",when:s.constTrue,what:u.nL.Effect.SwitchLens.create(e.pipe(A.M(t),b.h((([e,t])=>e.lensId!==t)),_.U((([e])=>({lensId:e.lensId,alertSource:d.l$.sidebar,options:{order:"lensOrder",toFocus:e.focusFirstCard?u.nL.Effect.FocusBehavior.focusFirst:u.nL.Effect.FocusBehavior.noFocus}})))))}}const B=(e,t,i)=>{const a=(0,r.pipe)(e,_.U(u.nL.mapper((({currentLens:e,alertSource:t})=>R.some({currentLens:e,alertSource:t})))),U(i),g.w(E.b2.rafScheduler),C.b((e=>t.moveCardsBy(e,"freezeActiveCardOnCardsListUpdate"))));return{id:"freezeActiveCardOnCardsListUpdate",when:c.R.isWithAlertsId,what:u.nL.Effect.Applicator.create(I.T(I.T(a).pipe(T.c(M.C))))}},U=e=>t=>t.pipe((0,m.Sd)(e),_.U(R.map((e=>e.currentLens))),x.G(),b.h((([e,t])=>(0,r.pipe)((0,s.tuple)(e,t),(0,s.tupled)(L.map2(((e,t)=>e.id===t.id&&(0,r.pipe)((0,s.tuple)(u.In.getActiveItem(e),e.cardIndex,u.In.getActiveItem(t),t.cardIndex),(0,s.tupled)((0,a.g)(R.option)),R.map((([e,t,i,a])=>e.id===i.id&&t!==a)),R.getOrElse((()=>!1)))))),R.getOrElse((()=>!1))))),_.U((0,s.flow)(n.Pd(R.chain(u.In.getActiveItem),R.chain(u.In.getActiveItem)),(0,s.tupled)(L.map2(((e,t)=>t.positionState.absTop-e.positionState.absTop))),R.getOrElse((()=>0)))))},40033:(e,t,i)=>{i.d(t,{fA:()=>p,pL:()=>S});var a=i(40327),s=i(27378),r=i(23518),n=i(79921),o=i(19217);const l=({message:e,emoji:t,emojiId:i,icon:a,iconPartName:r})=>s.createElement("div",{className:o.insight},t&&i&&s.createElement("div",{className:o.insight__inline_icon},s.createElement(n.dy,{unicodeHexArray:[i],unicodeLiteral:t})),a&&s.createElement("div",{className:o.insight__inline_icon,"data-grammarly-part":r},a),s.createElement("div",{className:o.insight__inline_text},e));var c=i(53112);const d=()=>s.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:c.Z.red50}),s.createElement("path",{d:"M8.94827 4H7.05196L7.22242 10.1108H8.78208L8.94827 4ZM8.00225 12.8381C8.5477 12.8381 9.02071 12.3821 9.02498 11.8153C9.02071 11.2571 8.5477 10.8011 8.00225 10.8011C7.43975 10.8011 6.97526 11.2571 6.97952 11.8153C6.97526 12.3821 7.43975 12.8381 8.00225 12.8381Z",fill:c.Z.neutral0}));var p,m=i(46547),u=i(88326),h=i(90361),g=i(21474),f=i(3656),v=i(77176),w=i(18208),_=i(5739),b=i(31881),y=i(98029);!function(e){e.hidden="hidden",e.zero="zero",e.visible="visible"}(p||(p={}));const S=({predictionsVM:e})=>b.UI.mount(T,e.previewFlow),k=b.UI.Grid.make((({slots:e})=>s.createElement("div",{className:y.predictions},s.createElement("div",{className:y.predictions__header},"Predictions"),e.children))),A=({children:e,count:t,dataPartName:i})=>s.createElement(m.Z,{kind:"assistant-priority-lens",dataPartName:i,marginBottom:"12px"},s.createElement("div",{className:y.predictions__card},e,t>0&&s.createElement("div",{className:y.counterContainer},s.createElement(f.CL,null,t)))),E=b.UI.Node.make((({state:e,notify:t})=>s.createElement(u.M,{clickHandler:t("select")},s.createElement(_.F.Fragment,null,e.pipe(v.U((e=>s.createElement(A,{count:e.alertsCount,dataPartName:"emogenie-prediction-card"},s.createElement(l,{key:"tone",message:"off"===e.emotion.brandToneLabel?s.createElement(s.Fragment,null,"May sound ",s.createElement("span",{className:y.predictions__off_brand},"off-brand")):`Sounds ${e.emotion.name}`,emoji:e.emotion.emoji,emojiId:e.emotion.emojiId}))))))))),C=b.UI.Node.make((({state:e,notify:t})=>s.createElement(u.M,{clickHandler:t("select")},s.createElement(_.F.Fragment,null,e.pipe(v.U((e=>s.createElement(A,{count:e.alertsCount,dataPartName:"readers-attention-prediction-card"},s.createElement(l,{key:"readersAttention",message:w.capitalize(e.message),icon:e.icon===r.d.ok?s.createElement(g.JO.ValidationOk,{width:16}):e.icon===r.d.warning?s.createElement(d,null):e.icon===r.d.feedback?s.createElement(g.JO.Megaphone,{width:16}):(0,h.vE)(e.icon),iconPartName:e.icon===r.d.ok?"icon-ok":e.icon===r.d.warning?"icon-warning":e.icon===r.d.feedback?"icon-feedback":(0,h.vE)(e.icon)}))))))))),I=b.UI.Group.make({tone:M(E),readersAttention:M(C)}),T=b.UI.Union.make("kind",{[p.hidden]:b.UI.Node.empty,[p.zero]:b.UI.Node.empty,[p.visible]:b.UI.Composite.make(k,I)});function M(e){return{tag:"_tag",members:{Some:(0,a.pipe)(e,b.UI.contramapState((e=>e.value))),None:b.UI.Node.empty}}}},15090:(e,t,i)=>{i.d(t,{g:()=>a});var a,s=i(40327),r=i(14601),n=i(85985),o=i(15646),l=i(83078);!function(e){e.createSubscription=function(e,t,i,a){const c=new r.w,d=e.pipe(n.h(o.lY.isAlertApplyAction)).subscribe((e=>(0,s.pipe)(i(e.alertId),l.tap((e=>{var i;if("unlocked"===l.orUndefined(e.extraProperties.freePremium)){const{clarityAIFree:e,clarityAIPreviewUX:s}=a.experiments||{};"alert_only"===e?t.freePremiumClarityAISuggestionAcceptButtonClick("assistant"):"alert_email"!==e&&"assistant"!==s&&"inline"!==s||t.freePremiumClarityAISuggestionAcceptForEmailButtonClick("assistant"),(null===(i=a.experiments)||void 0===i?void 0:i.anonymousPremiumPreview)&&t.anonymousPreviewAcceptedAlert()}else"upsell"===l.orUndefined(e.extraProperties.occasionalPromotion)&&t.premiumClarityAISuggestionAcceptButtonClick()}))))),p=e.pipe(n.h(o.lY.isAlertIgnoreAction)).subscribe((e=>(0,s.pipe)(i(e.alertId),l.tap((e=>{var i;"unlocked"===l.orUndefined(e.extraProperties.freePremium)&&(null===(i=a.experiments)||void 0===i?void 0:i.anonymousPremiumPreview)&&t.anonymousPreviewDismissAlert()})))));return c.add(d),c.add(p),c}}(a||(a={}))},45662:(e,t,i)=>{i.d(t,{c:()=>s});var a=i(41186);class s{constructor(e){this._highlights=e}addHighlight(e,t,i){return this._highlights.addHighlight(e,t,i)}updateHighlight(e,t,i){return this._highlights.updateHighlight(e,t,i)}removeHighlights(e){return this._highlights.removeHighlights(e)}recalculateHighlight(e){return this._highlights.recalculateHighlight(e)}recalculateAllHighlights(){return this._highlights.recalculateAllHighlights()}maintainConsistency(e,t=(e=>e),i=!1){return this._highlights.maintainConsistency(e,t,i)}hasHighlight(e){return this._highlights.hasHighlight(e)}getSelectedHighlightsTracker(e){return(0,a.H)({...e,highlights:this._highlights})}getGeometryByHighlightId(e){return this._highlights.geometry.get().get(e)}}},20153:(e,t,i)=>{i.d(t,{n$:()=>c,pR:()=>d,uL:()=>p,Xw:()=>m,Ys:()=>u,hF:()=>h});var a=i(57050),s=i(40327),r=i(84313),n=i(48521),o=i(16892),l=i(5114);const c=e=>t=>({...t,positionState:e}),d=e=>t=>({...t,visualState:e}),p=e=>t=>({...t,visualState:n.o.VisualState.to(t.visualState,e)}),m=e=>t=>({...t,visualState:n.o.VisualState.complete(t.visualState,e)});function u(e,t){return i=>{const p=(0,s.pipe)(e,l.map((e=>t.compare(i,e)>0)),l.getOrElse(a.constTrue)),m=(0,s.pipe)(e,l.exists((e=>e.id===i.id))),u=m&&r.X.isCardOpen(i.visualState)?"expanded":"focused",h=(0,s.pipe)(e,l.fold((()=>n.o.VisualState.initial({type:u,clockwise:p})),(e=>n.o.VisualState.to(i.visualState,{type:u,clockwise:p}))));return(0,s.pipe)(i,m?a.identity:c(o.s.PositionState.invalidateHeight(i.positionState)),d(h))}}function h(e,t){return i=>{const r=(0,s.pipe)(e,l.map((e=>t.compare(i,e)>0)),l.getOrElse(a.constTrue)),p=(0,s.pipe)(e,l.exists((e=>e.id===i.id)));return(0,s.pipe)(i,p?a.identity:c(o.s.PositionState.invalidateHeight(i.positionState)),n.o.isHidden(i)?a.identity:d(n.o.VisualState.to(i.visualState,{type:"rendered",clockwise:r})))}}},65060:(e,t,i)=>{i.d(t,{g:()=>a,m:()=>m});var a,s=i(57050),r=i(2291),n=i(36156),o=i(16892),l=i(48521),c=i(4890),d=i(73975),p=i(5114);function m(e){return e.id===a.id}!function(e){e.id="ReadersAttentionItemId",e.kind="ReadersAttentionItem",e.eq=d.fromEquals(((e,t)=>e.hashCode()===t.hashCode()&&o.s.PositionState.eq.equals(e.positionState,t.positionState)&&l.o.VisualState.eq.equals(e.visualState,t.visualState))),e.hashCodeOwnFields=e=>(0,n.NO)({title:e.title,description:e.description,details:(0,s.pipe)(e.details,p.fold((()=>"none"),(e=>`some(${e})`))),attentionScore:r.T.prism.reverseGet(e.attentionScore)}),e.hashCode=e.hashCodeOwnFields,e.create=function(t,i,a){return{id:e.id,kind:e.kind,renderOptions:{...c.j.defaultOptions,layoutDensity:c.j.Density.minimal},positionState:i,visualState:a,title:t.title,description:t.description,details:t.details,attentionScore:t.attentionScore,equals(t){return e.eq.equals(this,t)},hashCode(){return e.hashCode(this)}}}}(a||(a={}))},16314:(e,t,i)=>{var a;function s(e){return e.type===a.miniCardClick}function r(e){return e.type===a.ignoreButtonClick}function n(e){return e.type===a.viewMoreButtonClick}function o(e){return e.type===a.feedbackButtonClick}i.d(t,{Dy:()=>a,Vl:()=>s,l9:()=>r,Q:()=>n,RJ:()=>o}),function(e){e.miniCardClick="readersAttentionItemMiniCardClick",e.ignoreButtonClick="readersAttentionItemIgnoreButtonClick",e.viewMoreButtonClick="readersAttentionItemViewMoreButtonClick",e.feedbackButtonClick="readersAttentionItemFeedbackButtonClick"}(a||(a={}))},35501:(e,t,i)=>{i.d(t,{h:()=>h,r:()=>g});var a=i(27378),s=i(63847),r=i(3656),n=i(77176),o=i(2291),l=i(8125),c=i(5739),d=i(12187),p=i(32821),m=i(35630);const u=({progress:e})=>a.createElement(c.F.Fragment,null,e.pipe(n.U((e=>a.createElement(s.P,{percentage:o.g.prism.reverseGet(e),colorType:s.P.ColorType.neoBlue,iconSize:s.P.IconSize.extraSmall,theme:{radialProgressBar:m.circleProgress,radialProgressText:m.circleText}}))))),h=e=>p.UI.Node.make((({view:t})=>a.createElement(c.F.div,{...(0,d.Sh)(m.header,t("density").pipe(n.U((e=>"normal"===e)),n.U((0,l.RN)(m.normal,m.compact))))},a.createElement("div",{className:m.progressIcon},a.createElement(u,{progress:t("attentionScore").pipe(n.U(o.g.fromRatio))})),a.createElement(r.XY,{...(0,d.Sh)(m.title,"full"===e?m.full:void 0)},t("title"))))),g=p.UI.Node.make((({view:e})=>a.createElement(a.Fragment,null,a.createElement("div",{className:m.progressContainer,"data-name":"attention-score-progress-bar"},a.createElement(c.F.div,{className:m.progressBar,style:{width:e("attentionScore").pipe(n.U(o.g.fromRatio),n.U(o.g.prism.reverseGet),n.U((e=>`${e}%`)))}},a.createElement(r.XY,{className:m.progressValue,"data-name":"attention-score-progress-value"},e("attentionScore").pipe(n.U(o.g.fromRatio),n.U(o.g.prism.reverseGet),n.U((e=>`${e}%`)))))),a.createElement(r.XY,{className:m.description},e("description")))))},86620:(e,t,i)=>{i.d(t,{U:()=>a,C:()=>c});var a,s=i(27378),r=i(29511),n=i(71284),o=i(88056),l=i(95574);!function(e){let t;!function(e){e.isAppleSystem="isAppleSystem"}(t=e.SidebarFlag||(e.SidebarFlag={})),e.Flag={...t,...n.a.Flag},e.Context=s.createContext(o.Y.invariantContent("Environment"))}(a||(a={}));class c{constructor(){this._flags=new Set,this.actions={openUrl:e=>l.tryCatchError((()=>{document.location.href=e.toString()})),openPopup:e=>l.tryCatchError((()=>{const t=self.open(e.toString(),void 0,"noreferrer");t&&(t.opener=null)}))};(0,r.O)().config.systemInfo.os.isMac&&this._flags.add(a.Flag.isAppleSystem),this._flags.add(a.Flag.supportsSVGDominantBaseline),this._flags.add(a.Flag.onlyTrustedEvents)}has(e){return this._flags.has(e)}}},90989:(e,t,i)=>{i.d(t,{S:()=>a,I:()=>c});var a,s=i(27378),r=i(30763),n=i(88056),o=i(19429),l=i(35407);!function(e){e.Context=s.createContext(n.Y.invariantContent("SidebarTextResources")),e.holder=o.VF((()=>({logoText:"GRAMMARLY",plagiarismTooltip:"Scan for plagiarism",setGoalsTooltip:"Adjust goals",statisticsTooltip:"See performance"})))}(a||(a={}));const c=l.composeS({denali:r.m.holder,sidebar:a.holder})},10720:(e,t,i)=>{i.d(t,{US:()=>W,hz:()=>j,ux:()=>G});var a=i(57050),s=i(27378),r=i(80864),n=i(2027),o=i(66896),l=i(63969),c=i(68579),d=i(36156),p=i(71841),m=i(74238),u=i(99116),h=i(35416),g=i(18955),f=i(77176),v=i(98403),w=i(32952),_=i(93508),b=i(76974),y=i(2844),S=i(60797),k=i(24209),A=i(18625),E=i(66310),C=i(40151),I=i(85089),T=i(2834),M=i(95093),x=i(24713),F=i(85985),R=i(49708),L=i(17343),P=i(19751),V=i(5114),O=i(19962),N=i(5739),H=i(81531),B=i(31881),U=i(47476);const D=B.UI.Grid.make((({slots:e,view:t})=>s.createElement(N.F.div,{style:{marginBottom:t("spacing").pipe(f.U(l.u.rem))}},e.children)));function W(e){switch(e){case o.R.SpecialId.PredictionTakeaways:case o.R.SpecialId.Priority:return.75;default:return 1}}const j=s.forwardRef((({state:e,cardsViewModel:t,cardsListScrollManager:i,connectorElements:o,header:l,footer:m,capabilities:u,comparator:f,readersAttentionItemViewModel:y},S)=>{const k=v.jw((e=>{let t=7;return t=31*t+(0,d.AC)(e.currentLens.id),t=31*t+(h.nL.hasItems(e)?1231:1237),t}),e).view((e=>h.nL.hasItems(e.get())?e.view(h.nL.Prism.getLens()):null)).view((e=>e?{state:e,spacing:W(e.get().id)}:null)),A=s.useContext(n.Dg).state;return s.createElement(g.d,{className:b.of(""),name:"cardlist",stateSyncListener:q(i,o,A),height:G(e,i,u),isMaster:!0},s.createElement(s.Fragment,null,l?s.createElement(N.F.div,{className:U.headerOrFooterWrapper,mount:e=>o.lens("title").set(V.fromNullable(e))},l):null,s.createElement(N.F.div,{mount:S},k.view((e=>{return e?B.UI.mount((s=e.spacing,(0,a.pipe)(c.A.cardList(r.O.item(t.actionEvents)),B.UI.patch("content","cell","item")((e=>(0,a.pipe)(B.UI.Knot.make(D,{children:e.child}),B.UI.squash,B.UI.contramapState((e=>({children:e,root:{spacing:s}}))),B.UI.mapAction((e=>e.action))))))),(e=>(0,a.pipe)(r.O.createCardListFlow(y)(t,e,new w.xQ,p.i$(i).pipe(_.O(!1)),u,f)))(e.state)):null;var s}))),m?s.createElement(N.F.div,{className:U.headerOrFooterWrapper},m):null))})),G=(e,t,i)=>{const a=(0,u.Sd)(i)(e.view(h.nL.mapper((({currentLens:e,alertSource:t})=>V.some({currentLens:e,alertSource:t})))));return y.aj([a.pipe(S.oA,f.U((({currentLens:e})=>e.cardsHeight)),_.O(0)),t.paddingTop]).pipe(f.U((([e,t])=>e+t)))},q=(e,t,i)=>{const a=H.Monitoring.Logging.getLogger("view_models");return k.T(A.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(E.w(V.fold((()=>C.E),(e=>I.YC(e).pipe(T.b((()=>a.debug("update card list viewport due to viewport resize event"))),M.T(i.pipe(x.j("dragging"),F.h((e=>!e)),E.w(v.b2.rafScheduler),T.b((()=>a.debug("update card list viewport due to drag end event"))))),f.U((()=>e.getBoundingClientRect())),f.U((e=>({top:m.r.FromWindowTop.ISO.wrap(e.top),height:e.height}))))))),T.b(v.wW(e.viewport))),t.view("scrollProvider").pipe(E.w(V.fold((()=>C.E),(t=>R.R(t,"scroll").pipe(f.U((()=>t.scrollTop)),_.O(t.scrollTop),T.b(v.wW(e.scrollTop)),L.h(v.PU)))))),t.view("title").pipe(E.w(V.fold((()=>b.of(O.Rect.empty)),(e=>I.YC(e)))),f.U((e=>e.height)),P.d({bufferSize:1,refCount:!0}),T.b(v.wW(e.paddingTop))),t.view("scrollConsumer").pipe(E.w(V.fold((()=>C.E),(t=>e.scrollOffset.pipe(T.b((e=>{t.scrollTop+=e})))))))).pipe(L.h(void 0))}},68340:(e,t,i)=>{i.d(t,{C:()=>V,S:()=>P});var a=i(40327),s=i(18756),r=i(27378),n=i(80864),o=i(10720),l=i(73582),c=i(19106),d=i(41488),p=i(66896),m=i(70023),u=i(61903),h=i(25975),g=i(18955),f=i(98403),v=i(60797),w=i(2834),_=i(77176),b=i(19962),y=i(5114),S=i(5739),k=i(31881),A=i(74880),E=i(57050),C=i(38819),I=i(30509);const T=({upgradeViewModel:e})=>{const t=e.advancedAlerts.pipe(_.U((0,E.flow)(y.map((e=>({count:e.count,alerts:e.alerts()}))))));return r.createElement(S.F.div,{className:I.premiumLens},k.UI.mount(C.r,k.Z.fromSideEffect((t=>{"upgrade"===t.action.action.action.kind&&(c.J.getPremiumButtonClick("gDocsSidebarAssistantSuccessView","GoPremium"),e.openUpgradeUrl(l.L.Place.gdocsSidebarSuccessView))}),t)))};var M=i(30763),x=i(89379),F=i(28378),R=i(879);const L=({successLensViewModel:e})=>{const t=(0,x.hM)((0,x.wK)(e.successState.view("type"),r.useContext(M.m.Context)));return r.createElement(S.F.div,{className:R.successLens},k.UI.mount(F.q,t))},P=r.forwardRef((({state:e,cardsViewModel:t,upgradeViewModel:i,cardsListScrollManager:d,capabilities:g,...v},_)=>{const b=f.jw((e=>{let t=7;return t=31*t+(0,s.AC)(e.currentLens.id),t=31*t+(h.v.WithSuccess.State.isInSuccess(g)(e)?1231:1237),t}),e),A=(0,a.pipe)((0,m.d)(i.advancedAlerts),k.Z.extendActions(w.b((e=>{e.key===u.n.State.expanded&&"upgrade"===e.action.kind&&(c.J.getPremiumButtonClick("gDocsSideBarAssistantList","SeeWhatsInPremium"),i.openUpgradeUrl(l.L.Place.gdocsSidebarCardList))}))));return r.createElement(V,{ref:_},(e=>r.createElement(S.F.Fragment,null,b.view((a=>{const s=a.get();return s.currentLens.id===p.R.SpecialId.Premium?r.createElement(T,{upgradeViewModel:i}):h.v.WithSuccess.State.isInSuccess(g)(s)?r.createElement(L,{successLensViewModel:v.successLensViewModel}):r.createElement("div",null,r.createElement(o.hz,{state:a,cardsViewModel:t,cardsListScrollManager:d,connectorElements:e,header:k.UI.mount(u.n.TogglablePanel,A),comparator:n.O.listItemOrd,capabilities:g,readersAttentionItemViewModel:y.none}))})))))})),V=r.forwardRef((({children:e,onClick:t,className:i=A.cardList,footer:s},n)=>{const o=g.d.Elements.create(),l=(0,a.pipe)(o.view("viewport"),v.oA,_.U(b.Rect.fromEl));return r.createElement("div",{onClick:t,className:i,ref:e=>{"function"==typeof n?n(e):n&&(n.current=e);const t=y.fromNullable(e);o.lens("scrollConsumer").set(t),o.lens("scrollProvider").set(t),o.lens("viewport").set(t)}},r.createElement(d.l.RootVirtualContainer,{name:"cardListConnector",viewport:l},e(o)),s)}))},1309:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(27378);if(3075==i.j)var s=i(87380);if(3075==i.j)var r=i(21474);if(3075==i.j)var n=i(66896);if(3075==i.j)var o=i(5739);var l=i(57731);const c=({lensPreviewViewModel:e})=>{const t=e.getLens(n.R.SpecialId.AllAlerts).view((e=>e.count));return a.createElement(o.F.div,{className:l.footer},a.createElement(d,{activeAlerts:t}))},d=({activeAlerts:e})=>a.createElement(o.F.Fragment,null,e.view((e=>e>0?a.createElement(s.x.OutcomeCounter,{count:e,theme:{counterWrapper:l.counterWrapper,counterContent:l.counter}}):a.createElement(r.JO.CheckmarkOutcomes,{className:l.counterCheckmarkIcon}))))},74928:(e,t,i)=>{i.d(t,{$l:()=>C});var a=i(27378);if(3075==i.j)var s=i(77394);if(3075==i.j)var r=i(90989);if(3075==i.j)var n=i(7046);if(3075==i.j)var o=i(21474);if(3075==i.j)var l=i(81301);if(3075==i.j)var c=i(3656);if(3075==i.j)var d=i(66896);if(3075==i.j)var p=i(40018);if(3075==i.j)var m=i(40743);if(3075==i.j)var u=i(87667);if(3075==i.j)var h=i(92644);if(3075==i.j)var g=i(15774);if(3075==i.j)var f=i(89186);if(3075==i.j)var v=i(84317);if(3075==i.j)var w=i(77176);if(3075==i.j)var _=i(85985);if(3075==i.j)var b=i(22232);if(3075==i.j)var y=i(8125);if(3075==i.j)var S=i(5114);if(3075==i.j)var k=i(12187);var A=i(31881),E=i(21831);const C=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:r,features:n})=>{switch(n.priorityLens.kind){case s.h.Kind.dropdown:return a.createElement(I,{state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:r});case s.h.Kind.priorityToggle:return a.createElement(T,{state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:r,defaultMode:n.priorityLens.defaultMode});case s.h.Kind.none:return a.createElement(M,{navigationViewModel:t,modalManager:i});default:(0,b.vE)(n.priorityLens)}},I=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:s})=>a.createElement("div",{className:E.priorityLensHeader},a.createElement(x,{navigationViewModel:t,modalManager:i}),a.createElement("div",{className:E.prioritySwitchWrapper},A.UI.mount(u.n.Switch,(0,h.i)(s,t,e.pipe(w.U((e=>e.currentLens.id))))))),T=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:s,defaultMode:r})=>a.createElement("div",{className:E.priorityLensHeader},a.createElement(x,{navigationViewModel:t,modalManager:i}),a.createElement("div",{className:E.prioritySwitchFlatWrapper},A.UI.mount(f.B.DefaultHeader,(0,v.HP)(t,e.pipe(w.U((e=>e.currentLens.id)),_.h((0,y.Kg)(d.R.isPriority,d.R.isAllAlerts))),"priority"===r?g.H.LensMode.priority:g.H.LensMode.all,"compact",s,10)))),M=({navigationViewModel:e,modalManager:t})=>a.createElement("div",{className:E.defaultHeader},a.createElement(x,{navigationViewModel:e,modalManager:t}),a.createElement("div",{...(0,k.Sh)(E.lensNavigation,E.disabledLensNavigation)},A.UI.mount(m.C,A.Z.fromSideEffect((t=>{e.events.next({type:"switchToLens",id:t.lens.id,focusFirst:!1,actionSource:p.l$.sidebar})}),{activeLensId:S.none,previews:Object.values(e.lensPreviews.get()).filter((e=>e.id!==d.R.SpecialId.Vox)),disabled:!1})))),x=({navigationViewModel:e,modalManager:t})=>{const i=a.useContext(r.S.Context),s=t.state.view(S.exists((e=>e.instance.type===l.dC.SetGoals)));return a.createElement("div",{className:E.head},a.createElement("div",{className:E.headerGroup},a.createElement(o.JO.Grammarly,{className:E.logoIcon,width:18}),a.createElement(c.H5,{className:E.logoText},i.logoText)),a.createElement(n.zx.Flat,{name:"setGoals",className:E.setGoalsButton,title:i.setGoalsTooltip,titleAlign:"bottomCenter",active:s,disabled:s,onClick:()=>e.events.next({type:"setGoals"})},a.createElement(o.JO.GoalsEmpty,{width:24})),a.createElement("div",{className:E.headerGroup},a.createElement("div",{className:E.divider}),a.createElement(n.zx.Flat,{name:"closeSidebar",onClick:()=>e.events.next({type:"toggleSidebar",actionSource:p.l$.sidebar})},a.createElement(o.JO.Close,{width:16}))))}},80550:(e,t,i)=>{i.d(t,{L:()=>o});var a=i(57050),s=i(27378),r=i(5114),n=i(5739);const o=({modalManager:e})=>s.createElement(n.F.Fragment,null,e.state.view((0,a.flow)(r.map((({component:e})=>e)),r.toNullable)))},11177:(e,t,i)=>{i.d(t,{P:()=>o});var a=i(27378),s=i(50790),r=i(30543),n=i(32380);const o={unauthorizedError:(e,t)=>a.createElement(r.s.UnauthorizedError,{action:t("gotoLogin")}),offline:()=>a.createElement(l,null),alertUndo:(e,t)=>a.createElement(n.A.Standard,{action:t("undo"),params:e.args.params})},l=()=>a.createElement(s.DI.TitledContent,{title:"Lost Connection"},"Your Internet session was interrupted.")},92132:(e,t,i)=>{i.d(t,{Q:()=>l});var a=i(27378),s=i(41046),r=i(60797),n=i(95300),o=i(5114);const l=({children:e,remSize:t,setter:i})=>(c+=1,a.useEffect((()=>{const e=t.subscribe((e=>{d.next(o.some(e)),i(o.some(e))}));return()=>{e.unsubscribe(),c-=1,0===c&&(d.next(o.none),i(o.none))}}),[t]),a.createElement(s.u.Context.Provider,{value:d.pipe(r.oA)},e));let c=0;const d=new n.X(o.none)},9025:(e,t,i)=>{i.d(t,{_:()=>r});var a=i(27378);if(3075==i.j)var s=i(94071);const r=({children:e,className:t})=>a.createElement("div",{className:t,style:{position:"fixed",right:"0px",top:"0px",bottom:"0px",width:s.xK,zIndex:1e3,background:"white",display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100vh"}},e)},94071:(e,t,i)=>{i.d(t,{iB:()=>a,xK:()=>s,H2:()=>r,kl:()=>n});const a=".docs-companion-sidebar",s="300px";var r;!function(e){e.selector=".companion-guest-app-switcher .app-switcher-button",e.selectedClass="app-switcher-button-selected",e.selectedSelector=`.${e.selectedClass}`,e.activeClass="app-switcher-button-active",e.hoverClass="app-switcher-button-hover",e.disabledClass="app-switcher-button-disabled"}(r||(r={}));const n=".companion-about-panel-button"},94663:(e,t,i)=>{i.d(t,{I:()=>n});var a=i(5802),s=i(41966);const r={priority:a.P.Priority.highest,timeout:a.P.TimeoutDisabled,position:a.P.Position.top,viewType:a.P.ViewType.standard};var n;!function(e){e.createFactory=function(){return{alertUndo:s.r.createBuilder().build({priority:a.P.Priority.low,timeout:a.P.DefaultTimeout,position:a.P.Position.bottomRight,viewType:a.P.ViewType.standard}),unauthorizedError:s.r.createBuilder().build(r),offline:s.r.createBuilder().build(r)}}}(n||(n={}))},70091:(e,t,i)=>{i.d(t,{U9:()=>T,jv:()=>x});var a=i(27378);if(3075==i.j)var s=i(86620);if(3075==i.j)var r=i(90989);if(3075==i.j)var n=i(68340);if(3075==i.j)var o=i(1309);if(3075==i.j)var l=i(74928);if(3075==i.j)var c=i(80550);if(3075==i.j)var d=i(11177);if(3075==i.j)var p=i(92132);if(3075==i.j)var m=i(9025);if(3075==i.j)var u=i(50981);var h=i(48189);if(3075==i.j)var g=i(71284);if(3075==i.j)var f=i(41046);if(3075==i.j)var v=i(30763);if(3075==i.j)var w=i(47861);if(3075==i.j)var _=i(97528);if(3075==i.j)var b=i(71860);if(3075==i.j)var y=i(85255);if(3075==i.j)var S=i(76974);if(3075==i.j)var k=i(8313);var A=i(79850),E=i(75259),C=i(67129);const I=({state:e,cardsViewModel:t,navigationViewModel:i,successLensViewModel:s,upgradeViewModel:r,cardsListScrollManager:c,notificationManager:p,lensPreviewViewModel:u,modalManager:h,features:g,capabilities:f})=>a.createElement(m._,{className:C.sidebarContainer},a.createElement(l.$l,{state:e,navigationViewModel:i,modalManager:h,lensPreviewViewModel:u,features:g}),a.createElement(n.S,{cardsViewModel:t,state:e,successLensViewModel:s,upgradeViewModel:r,cardsListScrollManager:c,capabilities:f}),"none"!==g.priorityLens.kind?null:a.createElement(o.Z,{lensPreviewViewModel:u}),a.createElement(w.i,{key:"notificationCenter",manager:p,views:d.P,theme:{grid:{container:E.container,bottomLeft:E.bottomLeft,bottomRight:E.bottomRight,top:E.top},view:{wrapper:E.notificationWrapper}}}));function T(e){return({integration:t,sidebarReady:i,shortenItFeature:r,ethicalAIFeature:n,cardEvents:o})=>()=>{const l=t.engine,d=new s.C,{lensState:p,cardsViewModel:m,navigationViewModel:h,successLensViewModel:g,upgradeViewModel:f,dispose:v,cardsListScrollManager:w,notificationManager:_,lensPreviewViewModel:S,modalManager:k,capabilities:A}=(0,u.G)(l,t.denaliViewAdapter,e,t.connectionState,t.pageState,t.gnar,t.user,t.document.settings.lens("selectedLens"),t.features,i,r,n,o);return y.P.useEffectOnWillUnmount((()=>{l.shutdown(),v()})),a.createElement(M,{environment:d},a.createElement(I,{state:p,cardsViewModel:m,navigationViewModel:h,successLensViewModel:g,upgradeViewModel:f,cardsListScrollManager:w,notificationManager:_,lensPreviewViewModel:S,modalManager:k,features:t.features,capabilities:A}),a.createElement(c.L,{modalManager:k}),a.createElement(b.X,null))}}const M=({environment:e,children:t})=>{const i=a.useRef((0,r.I)(v.m.getConfig(e.has(s.U.Flag.isAppleSystem)?"mac":"windows")));return a.createElement(p.Q,{remSize:S.of(16),setter:e=>f.u.setRootCssVar(document.documentElement,e)},a.createElement(s.U.Context.Provider,{value:e},a.createElement(g.a.Context.Provider,{value:e},a.createElement(r.S.Context.Provider,{value:i.current.sidebar},a.createElement(v.m.Context.Provider,{value:i.current.denali},a.createElement(k.TG.ContextMock,null,a.createElement(_.G.DefaultProvider,null,a.createElement(x,null,t))))))))},x=({children:e})=>a.createElement(a.Fragment,null,a.createElement("div",{"data-grammarly-part":"gdocs-sidebar",className:A.wrapper},e),a.createElement(h.p,{thin:!0,thinItalic:!0,regular:!0,italic:!0,bold:!0,boldItalic:!0,semiBold:!0}))},16868:(e,t,i)=>{i.d(t,{hp:()=>N,CV:()=>H,k9:()=>B});var a=i(57050),s=i(40327),r=i(74850),n=i(59443),o=i(40018),l=i(66896),c=i(18625),d=i(60797),p=i(77176),m=i(66310),u=i(17343),h=i(98403),g=i(91224),f=i(40151),v=i(38194),w=i(76974),_=i(24209),b=i(93508),y=i(16118),S=i(85985),k=i(28043),A=i(41398),E=i(83401),C=i(598),I=i(25980),T=i(58562),M=i(74238),x=i(99116),F=i(4890),R=i(35416),L=i(5114),P=i(83078),V=i(38983);class O{constructor(e,t){this._cardPositions=e,this._markPositions=t,this._log=r.Y.create(O.name)}alignCardToMark({id:e,renderOptions:{features:t},activeAlert:i,activeHighlightIndex:a},r){return c.P((()=>this._markPositions.getMarkAlertPosition({alert:i,highlightIndex:a}))).pipe(d.oA,p.U((i=>(0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(F.j.Features.showLabel),L.some(i),"cardContentTop"),L.fromEither))),d.oA,m.w((i=>this._cardPositions.setCardPosition(e,t.has(F.j.Features.showLabel),!0,i.top))),u.h(h.PU),g.K((e=>(this._log.error("Cannot align card to mark",e),f.E))),v.B())}alignMarkTo(e,t,i,a){return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e.id,e.renderOptions.features.has(F.j.Features.showLabel),L.some(i),"cardContentTop"),L.fromEither)).pipe(d.oA))).pipe(m.w((i=>_.T(this._markPositions.moveAlertHighlightInViewport(t,M.r.FromWindowTop.ISO.modify(M.L.concatC(i.contentOffset))(i.top),n.uq.initial),this._cardPositions.setCardPosition(e.id,e.renderOptions.features.has(F.j.Features.showLabel),!0,i.top)))),u.h(h.PU),g.K((e=>(this._log.error("Cannot align mark to suggested position",e),f.E))),v.B())}alignMarkToCard({id:e,renderOptions:{features:t},activeHighlightIndex:i,activeAlert:a},r,o=L.none){return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(F.j.Features.showLabel),o,"cardContentTop"),L.fromEither)).pipe(d.oA))).pipe(m.w((s=>_.T(this._markPositions.moveAlertHighlightInViewport({alert:a,highlightIndex:i},M.r.FromWindowTop.ISO.modify(M.L.concatC(s.contentOffset))(s.top),n.uq.initial),this._cardPositions.setCardPosition(e,t.has(F.j.Features.showLabel),!0,s.top)))),u.h(h.PU),g.K((e=>(this._log.error("Cannot align mark to card",e),f.E))),v.B())}alignCardTo(e,t,i){const a=i!==I.v.Animation.NO_ANIMATION;return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPosition(e.id,e.renderOptions.features.has(F.j.Features.showLabel),L.some(t),"cardTop"),L.fromEither)).pipe(d.oA))).pipe(m.w((t=>this._cardPositions.setCardPosition(e.id,e.renderOptions.features.has(F.j.Features.showLabel),a,t.top))),u.h(h.PU),g.K((e=>(this._log.error("Cannot align card to required top",e),f.E))),v.B())}}const N=(e,t,i,a,s,r)=>new O(T.eZ.getSuperScrollMapper(e,a,V.h.create(16)),T.UC.getMapper(t,s,r));var H;!function(e){e.skip="skip"}(H||(H={}));const B=(e,t,i,r,n,c=h.b2.rafScheduler)=>{const d=(e,i,a,s)=>{if(a===o.l$.text)return t.alignCardToMark(e,i?I.v.Animation.ANIMATE_ALL:I.v.Animation.NO_ANIMATION,!0);if(a===R.h8.forceText)return t.alignCardToMark(e,I.v.Animation.NO_ANIMATION,!1);{const r=a===o.l$.sidebar;return t.alignMarkToCard(e,r?i?I.v.Animation.ANIMATE_ALL:I.v.Animation.ANIMATE_MARK:I.v.Animation.NO_ANIMATION,s)}},g=_.T(e.view(R.nL.mapper((({currentLens:e,alertSource:t})=>L.some({currentLens:e,alertSource:t})))).pipe(b.O(L.none),p.U(L.map((e=>e.currentLens.id))),y.G(),S.h((([e,t])=>(0,s.pipe)(P.map2(((e,t)=>e!==t))(e,t),L.exists(a.identity)))),u.h(L.none)),e.view(R.nL.mapper((({currentLens:e,alertSource:t})=>L.some({currentLens:e,alertSource:t})))).pipe(S.h(L.exists((({currentLens:e})=>(0,x.Bk)(n)(e)))),p.U(L.chain((({currentLens:e,alertSource:t})=>(0,s.pipe)(r(e),L.filter(n.isValidToAlign),L.map((i=>({item:i,source:t,lensId:e.id}))))))))).pipe(k.x((0,a.flow)(P.map2(((e,t)=>e.lensId===t.lensId&&e.item.activeAlert.id===t.item.activeAlert.id&&e.item.visualState.transition.type===t.item.visualState.transition.type&&e.item.activeHighlightIndex===t.item.activeHighlightIndex)),L.exists(a.identity))),b.O(L.none),y.G(),p.U((([e,t])=>(0,s.pipe)(t,L.map((i=>({item:i.item,source:i.source,animate:(0,s.pipe)(e,P.forAll((({lensId:e})=>e===i.lensId))),suggestedPosition:(0,s.pipe)(e,L.filter((e=>!n.isScheduledToDispose(e.item))),L.chain((e=>(0,s.pipe)(t,L.map((t=>[e.item,t.item]))))),L.filter((([e,t])=>t.lensId===e.lensId&&t.positionState.absTop>e.positionState.absTop)),L.map((([e,t])=>M.r.FromWindowTop.ISO.wrap(t.positionState.absTop))))})))))),m.w(L.fold((()=>f.E),c)),A.M(i),m.w((([{item:e,source:t,animate:a,suggestedPosition:r},n])=>(0,s.pipe)(n,L.fold((()=>d(e,a,t,r)),(t=>(i.set(L.none),t===H.skip?E.C:d(e,a,t,r))))))));return{id:"alignmentSideEffect",when:l.R.isWithAlertsId,what:R.nL.Effect.Applicator.create(g.pipe(C.c(E.C)))}}},93829:(e,t,i)=>{if(i.d(t,{C:()=>o}),3075==i.j)var a=i(9671);if(3075==i.j)var s=i(15090);if(3075==i.j)var r=i(38143);if(3075==i.j)var n=i(45586);class o{constructor(e,t,i,a){this._cardsViewModel=e,this._gnar=t,this._getAlertById=i,this._user=a,this._subs=new n.w.Keeper,this.subscribeToSidebarCardActions()}subscribeToSidebarCardActions(){this._subs.push(this.subscribeToPremiumTrialFooterCtaClick(),s.g.createSubscription(this._cardsViewModel.actionEvents,this._gnar,this._getAlertById,this._user),(0,a.t)(this._cardsViewModel.actionEvents,this._gnar,"gdocs"))}subscribeToPremiumTrialFooterCtaClick(){return r.Nm(this._cardsViewModel.actionEvents,this._gnar)}dispose(){this._subs.dispose()}}},51540:(e,t,i)=>{i.d(t,{A7:()=>A,uo:()=>E,Ng:()=>C,CH:()=>I});var a=i(57050),s=i(40018);if(3075==i.j)var r=i(66896);var n=i(55935),o=i(66310),l=i(40151),c=i(76974),d=i(41398),p=i(85985),m=i(77176);if(3075==i.j)var u=i(28043);if(3075==i.j)var h=i(598);if(3075==i.j)var g=i(83401);if(3075==i.j)var f=i(13444);if(3075==i.j)var v=i(57091);if(3075==i.j)var w=i(16118);var _=i(35416);if(3075==i.j)var b=i(25975);var y=i(5114);if(3075==i.j)var S=i(83078);if(3075==i.j)var k=i(38983);function A(e,t){return{id:"alertSwitchingByClickSideEffect",when:a.constTrue,what:_.nL.Effect.SwitchAlert.create(e.alertClicked.pipe(n.T(1),o.w(y.fold((()=>l.E),c.of)),d.M(t.pipe(p.h(_.nL.hasCards),m.U((e=>e.currentLens.id))),((e,t)=>({...e,lensId:t}))),m.U((({alert:e,highlightIndex:t,lensId:i})=>({alertHighlight:{alert:e,highlightIndex:t},alertSource:s.l$.text,options:{lensId:i,order:"textOrder"}})))))}}function E(e,t){return{id:"connectionManager",when:()=>!0,what:_.nL.Effect.SwitchAlert.create(e.pipe(m.U((e=>e.online)),u.x(),o.w((e=>e?l.E:t.enqueue("offline",{reconnectTime:k.h.create(10)}))),h.c(g.C)))}}function C(e,t,i){const a=e.getLens(r.R.SpecialId.Premium).pipe(m.U((e=>e.count>0)),u.x());return{id:"autoSwitchToPremiumLensSideEffect",when:e=>e===r.R.SpecialId.AllAlerts||e===r.R.SpecialId.Priority,what:_.nL.Effect.SwitchLens.create(t.pipe(m.U(b.v.WithSuccess.State.isInSuccess(i)),u.x(),f.g(1),v.a(a),p.h((([e,t])=>e&&t)),m.U((()=>({lensId:r.R.SpecialId.Premium,alertSource:s.l$.sidebar,options:{toFocus:_.nL.Effect.FocusBehavior.noFocus}})))))}}function I(e,t){const i=e.getLens(r.R.SpecialId.AllAlerts).pipe(m.U((e=>e.count>0)),u.x()),n=e.getLens(r.R.SpecialId.Priority).pipe(m.U((e=>e.count>0)),u.x());return{id:"autoSwitchFromPremiumLensSideEffect",when:a.constTrue,what:_.nL.Effect.SwitchLens.create(t.pipe(m.U((e=>e.currentLens.id)),u.x(),w.G(),p.h((([e,t])=>t===r.R.SpecialId.Premium)),m.U((([e,t])=>e)),v.a(i,n),m.U((([e,t,i])=>e===r.R.SpecialId.Priority&&i?y.some(r.R.SpecialId.Priority):e===r.R.SpecialId.AllAlerts&&t?y.some(r.R.SpecialId.AllAlerts):y.none)),p.h(y.isSome),m.U(S.unsafeGet),m.U((e=>({lensId:e,alertSource:s.l$.sidebar,options:{toFocus:_.nL.Effect.FocusBehavior.noFocus}})))))}}},50981:(e,t,i)=>{if(i.d(t,{G:()=>oe}),3075==i.j)var a=i(57050);if(3075==i.j)var s=i(40327);if(3075==i.j)var r=i(50622);if(3075==i.j)var n=i(58809);if(3075==i.j)var o=i(8043);if(3075==i.j)var l=i(80864);if(3075==i.j)var c=i(38143);if(3075==i.j)var d=i(77394);if(3075==i.j)var p=i(86620);if(3075==i.j)var m=i(94663);if(3075==i.j)var u=i(93829);if(3075==i.j)var h=i(62346);if(3075==i.j)var g=i(37290);if(3075==i.j)var f=i(73582);if(3075==i.j)var v=i(92783);if(3075==i.j)var w=i(44618);if(3075==i.j)var _=i(90361);if(3075==i.j)var b=i(81301);if(3075==i.j)var y=i(61813);if(3075==i.j)var S=i(66896);if(3075==i.j)var k=i(13313);if(3075==i.j)var A=i(98403);if(3075==i.j)var E=i(76974);if(3075==i.j)var C=i(77176);if(3075==i.j)var I=i(85985);if(3075==i.j)var T=i(40151);if(3075==i.j)var M=i(66310);if(3075==i.j)var x=i(21619);if(3075==i.j)var F=i(54216);if(3075==i.j)var R=i(83436);if(3075==i.j)var L=i(48052);if(3075==i.j)var P=i(91549);if(3075==i.j)var V=i(83167);if(3075==i.j)var O=i(20594);if(3075==i.j)var N=i(35607);if(3075==i.j)var H=i(20291);if(3075==i.j)var B=i(34383);if(3075==i.j)var U=i(11245);if(3075==i.j)var D=i(4890);if(3075==i.j)var W=i(35416);if(3075==i.j)var j=i(25975);if(3075==i.j)var G=i(73841);if(3075==i.j)var q=i(89770);if(3075==i.j)var z=i(39920);if(3075==i.j)var Z=i(17372);if(3075==i.j)var Y=i(74364);if(3075==i.j)var K=i(27125);if(3075==i.j)var Q=i(5114);if(3075==i.j)var X=i(95195);if(3075==i.j)var $=i(8125);if(3075==i.j)var J=i(95574);if(3075==i.j)var ee=i(83078);if(3075==i.j)var te=i(38983);if(3075==i.j)var ie=i(81531);if(3075==i.j)var ae=i(16868);if(3075==i.j)var se=i(51540);if(3075==i.j)var re=i(40081);if(3075==i.j)var ne=i(71962);const oe=(e,t,i,oe,le,ce,de,pe,me,ue,he,ge,fe)=>{var ve;const we=ie.Monitoring.Logging.getLogger("view_models"),_e=te.h.create(k.A.defaultState),be=F.t.create(F.t.defaultLensFilters,F.t.defaultTextFilters),ye=e.alertsList.state.pipe((t=>k.A.get(t,e.alertsList.lensesScores,be))).subscribe(A.wW(_e)),Se=new re.t(_e.view("lenses"),be,e.sessionModel.scoreStatus),ke=(0,L.$y)((0,w.a)(t).getContents),Ae={features:(()=>{const e=new Set;return e.add(O.IG.Features.showCardLabelInOutcomes),c.t0(de,le.get())&&e.add(O.IG.Features.showPremiumTrialFooters),e})(),cardLayoutDensityMode:D.j.Density.compact,shouldAnimateAlertApply:a.constFalse},Ee=(0,O.Ls)(ke,e.alertsReader,Ae,(()=>E.of(Q.none)),e.mutingAlertsReader),Ce=P.R.ItemFactory.create(ke,e.mutingAlertsReader,Ae,(()=>E.of(Q.none))),Ie=(0,U.U)(ke,e.alertsReader,Ae,B.T.ordAlert),Te=l.O.getCapabilities(Ee,Ce,Ie,e.alertsReader,ke,te.h.create(B.D.empty()),(()=>Fe.get().currentLens.id)),Me=new q.oq(e.alertsList.state,e.alertsReader,_e.view("lenses"),e.positionManager,Se,new z.gi(l.O.equatable.structEq,l.O.defaultOrd),(0,z.is)(Ee,Te),Te,be),xe=(null===(ve=de.experiments)||void 0===ve?void 0:ve.disablePriorityLens)?S.R.SpecialId.AllAlerts:((e,t)=>{switch(e.kind){case d.h.Kind.dropdown:return t.get();case d.h.Kind.priorityToggle:return"priority"===e.defaultMode?S.R.SpecialId.Priority:S.R.SpecialId.AllAlerts;case d.h.Kind.none:return S.R.SpecialId.AllAlerts;default:(0,_.vE)(e)}})(me.priorityLens,pe);i.next({kind:d.R.ChangeLens,selectedLens:xe===S.R.SpecialId.Priority?"priority":"all"});const Fe=te.h.create(Me.emptyState(xe)),Re=Fe.pipe(C.U((e=>e.currentLens.id)),I.h(n.U.SelectedLens.filter)).subscribe((e=>pe.set(e))),Le=(0,V.u0)((()=>t.getCursor().index),Me),Pe=new f.x(e.alertsList,Fe,5),Ve=new b.EQ(new ne.o(e.sessionModel,Pe,de.isPremium,ce)),Oe=new g.$(Fe,Se,i,Ve,t,me,ce,Z.z.all),Ne=new R.Xx({flush:()=>t.flushChanges()},Oe.events,Ee,e.alertsService,Q.none,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,s.pipe)(e.mutedAlertsCategoriesModel,Q.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,v.Um)().suggestionsSettings)})))),Q.none,(()=>!1),l.O.getActiveItemWithAlert,Te,Fe,new p.C),He=new u.C(Ne,ce,e.alertsReader.getById,de),Be=new h.o(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,Fe,be,T.E,l.O.getActiveItemWithAlert,te.h.create(de.experiments).view(),ue),Ue=new N.o((()=>X.right(void 0))),De=(0,ae.hp)(Fe,Be,te.h.create(16),Ue,t,we),We=new x.mN(t,Fe,Be,e.alertsReader,l.O.getActiveItemWithAlert),je=new y.y(te.h.create([]),m.I.createFactory(),3,5e3),Ge=[R.dv.changeAlertEffect(Fe,Ne,Ee,l.O.getActiveItemWithAlert,e.alertsReader,Q.some(De),Le,we.getLogger("CardsViewModelEffects.changeAlertEffect")),...Ne.getApplicatorEffects(),H.R7(Fe,Ue,Te,(0,a.unsafeCoerce)(Ne.actionEvents),{cardsAroundActive:25,cardsBeyondViewport:25}),se.A7(We,Fe),(0,ae.k9)(Fe,De,te.h.create(Q.none),l.O.getActiveAlignableItem,Te),H.XU(Fe,Ue,Te),Y.EQ.focusMarkByActiveAlert(Fe,Be,e.alertsReader,l.O.getActiveFocusableItem,we.getLogger("MarksEffects.focusMarkByActiveAlert")),se.uo(oe,je),R.dv.createSendActiveAlertFeedbacksEffect(Fe,l.O.getActiveItemWithAlert,e.alertsService,e.alertsReader,we.getLogger("CardsViewModelEffects.createSendActiveAlertFeedbacksEffect")),se.Ng(Se,Fe,Te),se.CH(Se,Fe),Oe.lensChangeEffect],qe="none"!==me.priorityLens.kind?Oe.lensMode.view(Z.K.isPriorityMode).view((0,$.RN)(S.R.SpecialId.Priority,S.R.SpecialId.AllAlerts)):te.h.create(S.R.SpecialId.AllAlerts),ze=(0,V.VC)(Me,Le,qe,l.O.getActiveItemWithAlert,Te),Ze=te.h.create(!0),Ye=V.Py.getStateTransformer(V.Py.getDefaultBehavior(l.O.getActiveItemWithAlert,Te),ze,e.alertsReader,Te,(e=>Ze.get()&&"text"!==e.alertSource),a.constVoid,qe),Ke=j.v.Items.getItemsPositionsUpdateTransformer(Te),Qe=(0,a.flow)(Ye,J.chainLeft(Ke)),Xe=new G.l(Fe,Me,e.alertsReader,e.alertsService,Ge,l.O.getActiveItemWithAlert,Qe),$e=new K.L(Fe,e.sessionModel,a.constVoid,Te,Q.none,Q.none,(e=>W.nL.isWithPriorityList(e)&&j.v.WithPriority.onlyNonPriorityAlertsLeft(e.currentLens,l.O.priorityTest,Te)),j.v.WithPriority.isInSuccess(l.O.priorityTest,Te),te.h.create(!1)),Je=he.pipe(M.w(Q.fold((()=>T.E),(t=>t.initAssistantSession(Ne.actionEvents,e.alertsReader,Fe,e.alertsService,e.alertsList.state))))).subscribe(),et=ge.pipe(M.w(Q.fold((()=>T.E),(t=>t.initCardActionsProcessing(Ne.actionEvents,e.alertsReader,(0,o.aU)(Fe),(0,o.X5)(We,Fe),Fe))))).subscribe(),tt=Ne.actionEvents.subscribe((0,a.flow)((0,r.JH)(e.alertsReader,r.SV.Source.sidebar),ee.tap((e=>fe.next(e)))));return{lensState:Fe,lensStateManager:Xe,cardsViewModel:Ne,marksViewModel:Be,navigationViewModel:Oe,successLensViewModel:$e,alignmentViewModel:De,lensPreviewViewModel:Se,cardsListScrollManager:Ue,notificationManager:je,upgradeViewModel:Pe,modalManager:Ve,capabilities:Te,dispose:()=>{tt.unsubscribe(),Be.dispose(),Re.unsubscribe(),ye.unsubscribe(),He.dispose(),Je.unsubscribe(),et.unsubscribe()}}}},40081:(e,t,i)=>{i.d(t,{t:()=>v});var a=i(71249),s=i(57050),r=i(40327),n=i(45614),o=i(32426),l=i(80800),c=i(66896),d=i(2291),p=i(64992),m=i(8125),u=i(22232),h=i(5114),g=i(90329),f=i(38983);class v{constructor(e,t,i){this._lensesList=e,this._alertsFilterService=t,this._scoreStatus=i,this.getLens=(0,m.HP)((function(e){switch(e){case c.R.SpecialId.AllAlerts:return this._lensesList.view(w(c.R.Info.allAlerts,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.AllAlerts)));case c.R.SpecialId.Priority:return this._lensesList.view(w(c.R.Info.priority,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.Priority)));case c.R.SpecialId.PredictionTakeaways:return this._lensesList.view(w(c.R.Info.predictionTakeaways,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.PredictionTakeaways)));case c.R.SpecialId.PredictionEmogenie:return this._lensesList.view(w(c.R.Info.predictionEmogenie,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.PredictionEmogenie)));case c.R.SpecialId.RealTimeProofit:return this._lensesList.view(w(c.R.Info.realTimeProofit,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.RealTimeProofit)));case c.R.SpecialId.Plagiarism:return this._lensesList.view(this._getPlagiarismLens);case c.R.SpecialId.Premium:return this._lensesList.view(w(c.R.Info.premium,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.Premium)));case c.R.SpecialId.Correctness:case c.R.SpecialId.Clarity:case c.R.SpecialId.Engagement:case c.R.SpecialId.Delivery:case c.R.SpecialId.Vox:case c.R.SpecialId.CorrectnessPriority:case c.R.SpecialId.ClarityPriority:case c.R.SpecialId.EngagementPriority:case c.R.SpecialId.DeliveryPriority:case c.R.SpecialId.VoxPriority:return this._lensesList.view(w(c.R.Info.createOutcome(e),c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));case c.R.SpecialId.RealTimeProofit:return this._lensesList.view(w(c.R.Info.realTimeProofit,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));default:return(0,u.vE)(e)}})),this._outcomes=[c.R.SpecialId.Correctness,c.R.SpecialId.Clarity,c.R.SpecialId.Engagement,c.R.SpecialId.Delivery],this._previews=(0,m.HP)((()=>n.fromFoldableMap((0,o.getFirstSemigroup)(),a.array)(this._outcomes,(e=>[e,this._getPreview(e)])))),this._isDocumentEmpty=f.h.create(!1),this._isFree=f.h.create(!1),this._outcomeStatusMask=f.h.combine(this._isDocumentEmpty,this._isFree,((e,t)=>{let i=0;return e&&(i|=p.x.IsDocumentEmpty),t&&(i|=p.x.IsFreeUser),i})),this._getPlagiarismLens=(0,s.flow)(w(c.R.Info.plagiarism,{...c.R.Meta.group.empty,percentile:d.T.MAX},this._alertsFilterService.getLensesFilter(c.R.SpecialId.Plagiarism)),c.R.WithAlerts.modifyMeta((e=>({...e,percentile:d.T.groupSum.concat(d.T.MAX,d.T.groupSum.inverse(e.percentile))}))))}findLens(e){return(0,r.pipe)(h.fromNullable([this.getLens(c.R.SpecialId.AllAlerts),this.getLens(c.R.SpecialId.Premium)].find((t=>e(t.get())))),h.map((e=>e.get().id)))}_getPreview(e){return{...c.R.Info.base,logo:h.none,...this._getOutcomeButtonData(e)}}get lensPreviews(){return this._previews()}_getOutcomeButtonData(e){const t=this.getLens(e),i=t.get().title,a=this._isFree.view((t=>t&&(e===c.R.SpecialId.Engagement||e===c.R.SpecialId.Delivery))),n=f.h.combine(t.view("count").view((e=>0===e)),a,((e,t)=>e&&!t)),{description:o,stateMessage:m}=(0,p.O)(e),u=f.h.combine(this._isDocumentEmpty,n,t.view("percentile"),((e,t,i)=>e?d.T.MIN:t?d.T.MAX:i)).view(d.g.fromRatio),g=f.h.create(!1),v=f.h.combine(this._scoreStatus.view((e=>(0,r.pipe)(e,h.map((e=>e===l.v0.ScoresStatus.SENSITIVE)),h.getOrElse(s.constFalse)))),t,u,this._outcomeStatusMask,g,m);return{id:e,title:i,description:o,status:v,progress:u,isUnavailable:a}}get nonEmptyLensId(){return(0,r.pipe)(h.fromNullable([this.getLens(c.R.SpecialId.AllAlerts),this.getLens(c.R.SpecialId.Premium)].find((e=>e.get().count>0))),h.map((e=>e.get().id)))}}function w(e,t,i){return a=>{return new c.R.LensImpl(e,(s=e.id,n=t,e=>(0,r.pipe)(g.P5(c.R.Id.ord)(s,e),h.getOrElse((()=>n))))(a),i);var s,n}}},62346:(e,t,i)=>{i.d(t,{o:()=>z});var a,s,r=i(57050),n=i(40327),o=i(33381),l=i(80864),c=i(95572),d=i(56983),p=i(95384),m=i(5817),u=i(51374),h=i(40018),g=i(66896),f=i(4390),v=i(45586),w=i(98403),_=i(59368),b=i(16746),y=i(17594),S=i(35416),k=i(25975),A=i(74364),E=i(76974),C=i(32952),I=i(16118),T=i(77176),M=i(85985),x=i(40151),F=i(24209),R=i(60797),L=i(41398),P=i(24713),V=i(28043),O=i(5114),N=i(8125),H=i(92843),B=i(95195),U=i(83078),D=i(71249),W=i(55415),j=i(22232),G=i(38983),q=i(81531);!function(e){e.create=(e,t,i,a,s,r)=>(n,o)=>{const l=o.to.visualState===_.Bd.highlighted;return p.sO.Change.getCreateAction({range:n,capiAlertId:e,visualState:l?{type:p.sO.Change.VisualState.Type.highlighted,source:t()}:{type:p.sO.Change.VisualState.Type.visible},highlightColor:i,highlightDisplayFormat:a(n(),l),highlightDisappearOnHoverDelay:s,order:r})},e.update=(e,t,i,a,s,r)=>(n,o)=>{const l=o.to.visualState===_.Bd.highlighted;return p.sO.Change.getUpdateAction({range:n,capiAlertId:e,visualState:l?{type:p.sO.Change.VisualState.Type.highlighted,source:t()}:{type:p.sO.Change.VisualState.Type.visible},highlightColor:i,highlightDisplayFormat:a(n(),l),highlightDisappearOnHoverDelay:s,order:r})},e.remove=e=>t=>p.sO.Change.getRemoveAction({range:t,capiAlertId:e})}(a||(a={}));class z{constructor(e,t,i,m,w,k,F,R,L,P,V=E.of(void 0),W=!1){this._alertList=e,this._alertsReader=t,this._positionManager=i,this._alertsService=m,this._ded=w,this._lensState=k,this._alertsFilterService=F,this._alertsFiltersChanged=R,this._getActiveItemWithAlert=L,this._experiments=P,this._readyObs=V,this._emulateAppliedAlertAnimation=W,this._highlightedAlert=O.none,this._focusedAlert=O.none,this._marksMap=new Map,this._subs=new v.w.Keeper,this.events=new C.xQ,this._alertStateDiff=this._alertList.state.pipe(I.G(),T.U((([e,t])=>f.p.diff(e,t))),M.h((0,N.ff)(H.v.isEmpty))),this._alertsFilter=G.h.create(r.constFalse),this._filteredAlerts=G.h.create(O.none),this._ready=!1,this._log=q.Monitoring.Logging.getLogger("marks_view_model"),this.getMarkByAlert=e=>(0,n.pipe)(this._marksMap.get(e.alert.id),O.fromNullable,O.chain((t=>t.markByIndex(e.highlightIndex)))),this.getAlertByMark=e=>(0,n.pipe)(this._alertsReader.getRegistered(u.P.fromRangeIdToAlertId(e.id)),O.chain((t=>(0,n.pipe)(A.$A.getHighlightIndex(t,e.range()),B.map((e=>({alert:y.$.fromModel(t),highlightIndex:e}))),O.fromEither)))),this.ensureAlertHighlightInViewport=(e,t,i)=>(0,n.pipe)(this.getMarkByAlert(e),O.fold((()=>x.E),(e=>this._ded.scrollToMark(e.id,{animate:i,paddingTop:t})))),this._createMA=e=>{const t=U.unsafeGet(e.rawId),{impact:i,cardLayout:{outcome:m},extra_properties:{smart_phrases_intent:f}}=e.toRawAlert(),v=o.M.getHighlightColor(c.DD.createOutcomeType(m),"critical"===i?c.Hg.critical:c.Hg.advanced,Boolean(f),this._experiments.get()),w=o.M.getHighlightDisplayFormat(Boolean(f),this._experiments.get()),k=this._lensState.view(S.nL.getActiveItem(l.O.getActiveItemWithAlert)).view((0,r.flow)(O.filter((t=>t.activeAlert.id===e.id)),O.map((e=>e.activeHighlightIndex)),O.getOrElse((()=>0)))),E=e=>(t,i)=>{const a=e.getHighlightRanges().some(u.x.isEnclosingView),s=u.x.isEnclosingView(t),r=h.bZ.isSuperAlert(e),o=e.getHighlightRanges(),l=(0,n.pipe)(o,D.findIndex((e=>e.start===t.start&&e.end===t.end)),O.getOrElse((()=>0)))===k.get(),c=r&&i&&l,p=r&&i&&!l;return s?d.jk.enclosing:a&&w===d.jk.underlineAndBackground?d.jk.underline:c?d.jk.underlineAndBackground:p?d.jk.background:w},C=o.M.getHighlightDisappearOnHoverDelay(Boolean(f),this._experiments.get()),I=g.R.getSortOrder(e.lensType),T=new b.v((t=>(0,n.pipe)(this._alertsReader.getById(e.id),O.alt((()=>(t&&this._log.warn("Could not find alert for provided MarkAlert",{alert:e,source:t}),O.some(e)))),O.map(y.$.fromModel),U.unsafeGet)),this._alertsService,this._alertsService,(e=>this._ded.changeMarks(e)),a.create(t,(()=>p.sO.Change.VisualState.Source.api),v,E(e),C,I),a.update(t,(()=>s.getAlertSource(e,this._lensState.get(),this._getActiveItemWithAlert)),v,E(e),C,I),a.remove(t),(t=>{t.to.visualState===_.Bd.applied&&(this.events.next({type:A.ay.Type.AppliedAlertAnimationFinished,alert:e}),this._handleRemovedAlerts([e]).forEach((e=>e.apply())))}));return this._marksMap.set(e.id,T),T},this._handleRemovedAlerts=e=>e.map((({id:e})=>{const t=this._marksMap.get(e);return this._marksMap.delete(e),t.scheduleApply(_.Bd.disposed),t})),this._handleAlertUpdate=e=>e.map((e=>h.bZ.isRegistered(e)&&!h.bZ.isMuted(e)?(0,n.pipe)(O.fromNullable(this._marksMap.get(e.id)),O.fold((()=>this._alertsFilter.get()(e)?this._createMA(e):null),(e=>(e.scheduleUpdate(),_.Oe.isOrWillBe(_.Bd.success)(e)&&e.scheduleApply(_.Bd.highlighted),e)))):(0,n.pipe)(O.fromNullable(this._marksMap.get(e.id)),O.fold((()=>{}),(t=>(e.allowUpdate&&h.bZ.isCapiDone(e)&&h.bZ.isRated(e)&&_.Oe.isOrWillBe(_.Bd.highlighted)(t)?(t.scheduleUpdate(),t.scheduleApply(_.Bd.success)):(t.scheduleApply(_.Bd.disposed),this._marksMap.delete(t.alert.id)),t)))))).filter((e=>Boolean(e))),this._subs.push(this._readyObs.subscribe((()=>{this._subs.push(this._listenAlertsUpdates(),this._listenRangesUpdates(),this._listenFilterChange(),this._listenFilteredAlerts()),this._ready=!0})))}focusAlertHighlight(e){return this._ready?(0,n.pipe)(this._marksMap.get(e.alert.id),O.fromNullable,O.map((t=>{this._focusedAlert=O.some(e.alert.id),t.scheduleApply(_.Bd.highlighted),t.scheduleForceUpdate(),t.apply()})),B.fromOption((()=>new Error("Unknown alert"))),B.map((()=>({dispose:()=>{O.exists((t=>t===e.alert.id))(this._focusedAlert)&&(this._highlightedAlert=O.none),(0,n.pipe)(this._marksMap.get(e.alert.id),O.fromNullable,O.filter((()=>!(0,n.pipe)(this._highlightedAlert,O.exists((t=>t===e.alert.id))))),O.map((e=>{e.scheduleApply(_.Bd.visible),e.apply()})))}})))):B.left(new Error("marks view model is not ready yet"))}highlightAlertHighlight(e){return this._ready?(0,n.pipe)(this._marksMap.get(e.id),O.fromNullable,O.map((t=>{this._highlightedAlert=O.some(e.id),t.scheduleApply(_.Bd.highlighted),t.apply()})),B.fromOption((()=>new Error("Unknown alert"))),B.map((()=>({dispose:()=>{O.exists((t=>t===e.id))(this._highlightedAlert)&&(this._highlightedAlert=O.none),(0,n.pipe)(this._marksMap.get(e.id),O.fromNullable,O.filter((()=>!(0,n.pipe)(this._focusedAlert,O.exists((t=>t===e.id))))),O.map((e=>{e.scheduleApply(_.Bd.visible),e.apply()})))}})))):B.left(new Error("marks view model is not ready yet"))}moveCursorToHighlight(e,t){return this._ready?(0,n.pipe)(this._marksMap.get(e.alert.id),O.fromNullable,O.chain((t=>t.markByIndex(e.highlightIndex))),O.chain((e=>O.fromEither(e.range()))),O.fold((()=>B.left(new Error("Cannot find mark for given range"))),(e=>{const{index:i,length:a}=this._ded.getCursor();if(0===a&&(i<e.start||i>e.end)){const i=Math.min(e[t],this._ded.getLastPossibleCursorPosition());return(0,n.pipe)(this._ded.setCursor(i,0),B.orElse(B.left))}return B.right(void 0)}))):B.left(new Error("marks view model is not ready yet"))}dispose(){this._subs.dispose()}_listenAlertsUpdates(){const e=e=>({activeAlerts:[],updatedAlerts:[],removedAlerts:[],acceptedAlerts:[],hiddenMarkAlerts:[],...e});return F.T(this._filteredAlerts.pipe(R.cp((({visible:t,hidden:i})=>E.of(e({activeAlerts:W.toArray(t),removedAlerts:W.toArray(i)}))))),this._alertStateDiff.pipe(L.M(this._alertsFilter),T.U((([t,i])=>(0,n.pipe)(t,H.v.reduce(e({}),((e,t)=>(this._marksMap.has(t.alert.id)&&e.removedAlerts.push(t.alert),e)),((e,t,i)=>(h.bZ.isAccepted(i.alert)?e.acceptedAlerts.push(i.alert):e.updatedAlerts.push(i.alert),e)),((e,t)=>(i(t.alert)&&e.activeAlerts.push(t.alert),e)))))))).pipe(T.U((({activeAlerts:e,removedAlerts:t,updatedAlerts:i,acceptedAlerts:a})=>{let s=[];return s=s.concat(e.filter((0,N.W9)((0,N.ff)(h.bZ.isPremium),(e=>O.isSome(e.rawId)))).map((e=>{const t=this._marksMap.get(e.id);return void 0!==t?(t.scheduleForceUpdate(),t):this._createMA(e)}))),this._emulateAppliedAlertAnimation&&setTimeout((()=>{a.forEach((e=>{this.events.next({type:A.ay.Type.AppliedAlertAnimationFinished,alert:e})}))}),3*(0,m.Xd)(20)),s=s.concat(this._handleRemovedAlerts(t.concat(a).filter((e=>this._marksMap.has(e.id))))),s=s.concat(this._handleAlertUpdate(i)),s}))).subscribe((e=>{if(e.length>0){const[t,...i]=e;t.applyWith(i)}}))}_listenRangesUpdates(){return this._positionManager.rangeChanged.pipe(P.j("changed"),T.U((e=>e.filter((e=>u.P.is(e)&&u.x.isVisible(e)&&this._marksMap.has(e.meta.alertId))))),M.h((e=>e.length>0))).subscribe((e=>{const t=Array.from(e.values()).reduce(((e,t)=>(0,n.pipe)(this._alertsReader.getById(t.meta.alertId),O.chain((e=>this._alertsReader.getRegistered(e.id))),O.chain((e=>O.fromNullable(this._marksMap.get(e.id)))),U.tap((t=>e.set(t.alert.id,t))),(0,r.constant)(e))),new Map),i=Array.from(t.values());if(i.forEach((e=>{e.scheduleForceUpdate()})),i.length>0){const[e,...t]=i;e.applyWith(t)}}))}_listenFilterChange(){return F.T(this._lensState.pipe(M.h((e=>e.currentLens.id!==g.R.SpecialId.Premium)),V.x(((e,t)=>!(e.currentLens.id!==t.currentLens.id||S.nL.isWithPriorityList(e)&&S.nL.isWithPriorityList(t)&&k.v.WithPriority.isNonPriorityListOpened(e.currentLens)!==k.v.WithPriority.isNonPriorityListOpened(t.currentLens)))),V.x()),this._alertsFiltersChanged.pipe(L.M(this._lensState),T.U((([e,t])=>t)))).pipe(T.U((e=>this._alertsFilterService.alertVisibleInText(e.currentLens.id,k.v.WithPriority.nonPriorityAlertsVisible(e))))).subscribe(w.wW(this._alertsFilter))}_listenFilteredAlerts(){return this._alertsFilter.pipe(L.M(this._alertList.state),T.U((([e,t])=>(0,n.pipe)(t,f.p.reduce({visible:{},hidden:{}},((t,i)=>(e(i.alert)&&h.bZ.isRegistered(i.alert)?t.visible[i.alert.id]=i.alert:t.hidden[i.alert.id]=i.alert,t))),(e=>O.some(e)))))).subscribe(w.wW(this._filteredAlerts))}}!function(e){e.toSidebarFluidMarkSource=e=>{switch(e){case h.l$.text:case S.h8.forceText:return p.sO.Change.VisualState.Source.text;case h.l$.sidebar:case S.h8.forceSidebar:return p.sO.Change.VisualState.Source.sidebar;case h.l$.api:return p.sO.Change.VisualState.Source.api;default:return(0,j.vE)(e)}},e.getAlertSource=(t,i,a)=>S.nL.hasCards(i)?(0,n.pipe)(a(i.currentLens),O.fold((()=>p.sO.Change.VisualState.Source.api),(a=>a.activeAlert.id===t.id?e.toSidebarFluidMarkSource(i.alertSource):p.sO.Change.VisualState.Source.api))):p.sO.Change.VisualState.Source.api}(s||(s={}))},71962:(e,t,i)=>{i.d(t,{o:()=>M});var a=i(57050),s=i(40327),r=i(98403),n=i(18625),o=i(57091),l=i(66310),c=i(76974),d=i(13444),p=i(93508),m=i(48403),u=i(95343),h=i(25970),g=i(5114),f=i(95195),v=i(38983),w=i(81531);class _{constructor(e,t){this._documentModel=e,this._modalOperations=t,this.reportViewModel=g.none,this.state=n.P((()=>r.GQ((()=>this._documentModel.calculateStats())))).pipe(o.a(this._documentModel.checkingState,((e,t)=>(0,s.pipe)(e,g.filter((()=>"idle"===t))))),l.w(g.fold((()=>c.of({type:h.g.State.Type.LOADING}).pipe(d.g(150))),f.fold((e=>(w.Monitoring.Logging.getLogger("editor.toolbar").error("Error on requesting document stats",e),this.onModalClose(),c.of({type:h.g.State.Type.ERROR}))),(e=>v.h.combine(this._documentModel.score,this._documentModel.counters,this._documentModel.documentLength.view("trimmed"),((t,i,a)=>(0,s.pipe)(t,g.fold((()=>({type:h.g.State.Type.SHORT_CONTENT})),(t=>({type:h.g.State.Type.READY,documentIsEmpty:0===a,score:t,counters:i,stats:e})))))))))),p.O({type:h.g.State.Type.EMPTY}),m._(1),u.x()),this.onModalClose=()=>{this._modalOperations.onClose()}}}var b=i(73582),y=i(73353),S=i(81301),k=i(54286),A=i(22621),E=i(39321),C=i(77176),I=i(22232),T=i(31881);class M{constructor(e,t,i,a){this._documentModel=e,this._upgradeViewModel=t,this._isPremiumUser=i,this._gnar=a}load(e){switch(e.type){case S.dC.SetGoals:return this._loadSetGoals(e.source);case S.dC.Performance:return this._loadPerformance();default:return(0,I.vE)(e)}}_loadSetGoals(e){return Promise.resolve((t=>{const i={demoMode:!1,isRedesign:!1,isFree:!this._isPremiumUser,defaultAudience:"knowledgeable"},r=k._.create(this._documentModel.context.get(),(0,s.pipe)(this._documentModel.defaultContext.get(),g.fold((()=>y.R$.defaultContextFallback),a.identity)),i,!1),n=v.h.combine(r.showSetGoalsLoader,r.localContext,((t,a)=>({blocks:r.blocks,context:a,showOnLoad:t,features:i,source:e}))),o=T.Z.fromSideEffect((e=>{switch(e.kind){case A.R.ActionsKind.open:break;case A.R.ActionsKind.upgrade:this._upgradeViewModel.openUpgradeUrl(b.L.Place.gdocsGoals),this._gnar.getPremiumButtonClick("assistantGoals","GoPremium");break;case A.R.ActionsKind.close:t.onClose(),this._documentModel.updateContext(e.context);break;case A.R.ActionsKind.reset:r.localContext.set(y.R$.unset);break;case A.R.ActionsKind.showOnLoadChanged:r.showSetGoalsLoader.set(e.value);break;default:(0,I.vE)(e)}}),n);return{instance:{type:S.dC.SetGoals,source:e},component:T.UI.mount(A.R.Modal,o)}}))}_loadPerformance(){return Promise.resolve((e=>{const t=new _(this._documentModel,e),i=T.UI.Knot.make(E.q.ModalView,{downloadButton:T.UI.Node.empty}),a=T.Z.fromSideEffect((t=>{switch(t.action.kind){case E.q.ActionsKind.close:e.onClose();break;default:(0,I.vE)(t.action.kind)}}),t.state.pipe(C.U((e=>({root:e})))));return{instance:{type:S.dC.Performance},component:T.UI.mount(i,a)}}))}}},37290:(e,t,i)=>{if(i.d(t,{$:()=>b}),3075==i.j)var a=i(57050);if(3075==i.j)var s=i(77394);if(3075==i.j)var r=i(81301);if(3075==i.j)var n=i(40018);if(3075==i.j)var o=i(66896);if(3075==i.j)var l=i(32952);if(3075==i.j)var c=i(45586);if(3075==i.j)var d=i(41398);if(3075==i.j)var p=i(77176);if(3075==i.j)var m=i(85985);if(3075==i.j)var u=i(66310);if(3075==i.j)var h=i(40151);if(3075==i.j)var g=i(35416);if(3075==i.j)var f=i(43637);if(3075==i.j)var v=i(5114);if(3075==i.j)var w=i(22232);if(3075==i.j)var _=i(38983);class b{constructor(e,t,i,s,r,u,h,w){this._state=e,this._lensPreviewVM=t,this._sidebarEvents=i,this._modalManager=s,this._ded=r,this._features=u,this._gnar=h,this._defaultLensMode=w,this.isUphooksRedesign=!1,this.popover=_.h.create(v.none),this.events=new l.xQ,this.activeLensId=this._state.view("currentLens","id"),this.documentActions=_.h.create({proofit:f.Bo.proofitDisabled(f.TV.NotAvailable),plagiarism:f.Bo.plagiarismDisabled(f.eh.NotAvailable)}),this.showMuteControl=_.h.create(!1),this._subs=new c.w.Keeper,this._lensSwitch=new l.xQ,this.lensMode=_.h.create(this._defaultLensMode),this.lensTitleType="none"!==this._features.priorityLens.kind?f.Bo.LensTitleType.priority:f.Bo.LensTitleType.default,this.lensChangeEffect={id:"lensChangeEffect",when:a.constTrue,what:g.nL.Effect.SwitchLens.create(this._lensSwitch.pipe(d.M(this._state.pipe(p.U((e=>e.currentLens.id)))),m.h((([{lensId:e},t])=>e!==t)),p.U((([{lensId:e,focusFirst:t}])=>({lensId:e,alertSource:n.l$.sidebar,options:{order:"lensOrder",toFocus:t?g.nL.Effect.FocusBehavior.focusFirst:g.nL.Effect.FocusBehavior.noFocus}})))))},this._listenNavigationEvent();const b=[o.R.SpecialId.Correctness,o.R.SpecialId.Clarity,o.R.SpecialId.Engagement,o.R.SpecialId.Delivery].reduce(((e,t)=>(e[t]=this._lensPreviewVM.lensPreviews[t],e)),{});this.lensPreviews=_.h.create(b)}dispose(){this._subs.dispose()}_listenNavigationEvent(){this._subs.push(this.events.pipe(u.w((e=>{switch(e.type){case"toggleSidebar":return this._sidebarEvents.next({kind:s.R.Close}),h.E;case"switchToLens":if("none"!==this._features.priorityLens.kind){const t=e.id===o.R.SpecialId.Priority?"priority":"all";this._sidebarEvents.next({kind:s.R.ChangeLens,selectedLens:t}),this._lensSwitch.next({lensId:e.id,focusFirst:e.focusFirst}),this._gnar.gdocsSidebarChangeLensButtonClick(t,this._lensPreviewVM.getLens(o.R.SpecialId.AllAlerts).get().count,this._ded.getTextLength(),this._lensPreviewVM.getLens(o.R.SpecialId.Priority).get().count,"dropdown"===this._features.priorityLens.kind?"dropdown":"priorityToggle")}else this._gnar.gdocsSidebarOpenLensButtonClick(e.id);return h.E;case"setGoals":return this._modalManager.show(r.Iy.setGoals("user"));case"performance":return this._modalManager.show(r.Iy.performance);case"switchToCritical":case"switchToAdvanced":case"preferences":case"switchToAll":return h.E;default:return(0,w.vE)(e)}}))).subscribe())}}},73582:(e,t,i)=>{i.d(t,{L:()=>a,x:()=>y});var a,s=i(40327),r=i(65421),n=i(39354),o=i(66896),l=i(40018),c=i(6782),d=i(4390),p=i(2844),m=i(77176),u=i(98403),h=i(5114),g=i(71249),f=i(8125),v=i(95574),w=i(95195),_=i(38983),b=i(81531);!function(e){let t;!function(e){e.gdocsSidebarCardList="gdocsSidebarCardList",e.gdocsSidebarSuccessView="gdocsSidebarSuccessView",e.gdocsGoals="gdocsGoals",e.assistantCardList="assistantCardList",e.extensionSettingsAssistant="extensionSettingsAssistant"}(t=e.Place||(e.Place={}))}(a||(a={}));class y{constructor(e,t,i){this._alertsList=e,this._lensState=t,this._maxAlertCategories=i,this._log=b.Monitoring.Logging.getLogger("UpgradeViewModel"),this._advancedAlerts=_.h.create([]),this.advancedAlerts=this._advancedAlerts.view((e=>e.length>0?h.some({count:e.length,alerts:()=>this._formatLiteAlerts(y._getGroupedLiteAlerts(e))}):h.none)),this.smartPhrasesPremiumAlert=this._advancedAlerts.view(g.findFirst((e=>h.isSome(e.extraProperties.smartPhrasesPremium)))),this._formatLiteAlerts=e=>{const t=e.slice(0,this._maxAlertCategories),i=e.slice(this._maxAlertCategories).map((e=>e.count)).reduce(f.Sm,0);return i>0?[...t,{group:"",category:"",categoryHuman:"more...",count:i}]:t},p.aj([this._lensState.view("currentLens").view("id").view(o.R.isPriority).view((e=>e?e=>l.bZ.isRegistered(e)&&l.bZ.isPremium(e)&&l.bZ.isPriority(e):e=>l.bZ.isRegistered(e)&&l.bZ.isPremium(e))),this._alertsList.state]).pipe(m.U((([e,t])=>d.p.reduce([],((t,{alert:i})=>(e(i)&&t.push(i),t)))(t)))).subscribe(u.wW(this._advancedAlerts))}openUpgradeUrl(e){(0,s.pipe)(v.tryCatchError((()=>{(0,n.P4)().openSubscriptionDialog({currentAlerts:this._getCapiAlerts(),isAnonymousUser:!1,showPlanComparison:!0,isFromEmail:!1,forceUtmCampaign:e})})),w.getOrElse((e=>this._log.fatal("unexpected error on open upgrade page",e))))}_getCapiAlerts(){return this._advancedAlerts.get().map((e=>(0,r.fe)(y._toRawAlertWithPossibleWrongId(e),"sidebar")))}static _getGroupedLiteAlerts(e){return c.Q.group(e.map((e=>e.toLiteAlert())))}static _toRawAlertWithPossibleWrongId(e){return{...e.toRawAlert(),id:(0,s.pipe)(e.rawId,h.getOrElse((()=>e.id)))}}}},95888:(e,t,i)=>{i.d(t,{J:()=>l});var a=i(27378),s=i(53112);const r=({color:e=s.Z.neutral0})=>a.createElement("svg",{width:"16",height:"13",viewBox:"0 0 16 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{filter:"url(#filter0_d)"},a.createElement("path",{d:"M3 5L6.5 8.5L13 2",stroke:e,strokeWidth:"2"})),a.createElement("defs",null,a.createElement("filter",{id:"filter0_d",x:"0.292892",y:"0.292847",width:"15.4142",height:"12.6213",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.createElement("feOffset",{dy:"1"}),a.createElement("feGaussianBlur",{stdDeviation:"1"}),a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.211765 0 0 0 0 0.34902 0 0 0 0 0.709804 0 0 0 0.5 0"}),a.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"}))));var n=i(12187),o=i(53358);const l=({onChange:e,labelId:t,className:i,checked:s,children:l,dataGrammarlyPart:c="ui-kit-checkbox"})=>{const[d,p]=a.useState(null!=s&&s);a.useEffect((()=>{null==e||e(d)}),[d]),a.useEffect((()=>{p(Boolean(s))}),[s]);const m=e=>{e.preventDefault(),e.stopPropagation(),p(!d)};return a.createElement("div",{"data-grammarly-part":c,...(0,n.Sh)(o.checkboxContainer,i)},a.createElement("div",{...(0,n.Sh)(o.checkbox,d?o.checkboxChecked:null),role:"checkbox","aria-checked":d,tabIndex:0,"aria-labelledby":t,onKeyDown:e=>{" "===e.key&&m(e)},onClick:m},d?a.createElement(r,null):null),a.createElement("label",{id:t,onClick:m},l))}},84488:(e,t,i)=>{i.d(t,{G:()=>r});var a=i(27378),s=i(31542);const r=({children:e,style:t,dataGrammarlyPart:i="ui-kit-iframe",...r})=>{const[n,o]=a.useState(null),l=a.useCallback((e=>{var t,i;let a=null;"contentDocument"in e.target&&(a=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),o(a),a&&(a.style.margin="0",a.style.height="100vh")}),[]);return a.createElement("iframe",{...r,style:{border:"none",...t},onLoad:l,srcDoc:"<html><body></body></html>","data-grammarly-part":i},n&&(0,s.createPortal)(e,n))}},47422:(e,t,i)=>{i.d(t,{z:()=>l});var a=i(27378),s=i(84488),r=i(68370),n=i(51897),o=i.n(n);const l=({placeholder:e,onChange:t,ariaLabel:i,className:n})=>{const[l,c]=a.useState("");return a.useEffect((()=>{t(l)}),[l]),a.createElement(s.G,{dataGrammarlyPart:"ui-kit-textbox",className:n,style:{width:"100%",height:"100%"}},a.createElement(r.b,null,o().__css),a.createElement("div",{role:"textbox",className:o().textBox,contentEditable:!0,onInput:e=>c(e.target.innerText),"data-placeholder":e,"aria-placeholder":e,"aria-label":i}))}},81108:(e,t,i)=>{i.d(t,{Q:()=>o});var a=i(27378),s=i(90361),r=i(10247);const n=e=>{if(e.reason===r.rS.NO_FREE_TRIALS_LEFT){const t="No email reviews left this month";let i;if(e.meta.quotaResetDate){const t=Intl.DateTimeFormat([],{month:"short",day:"numeric"}).format(new Date(Date.parse(e.meta.quotaResetDate)));i=`You will get ${r.SR} free reviews again next month (${t}). You can also use paid expert writing help in Grammarly's web editor anytime.`}else i=`You will get ${r.SR} free reviews again next month. You can also use paid expert writing help in Grammarly's web editor anytime.`;return{title:t,message:i}}return e.reason===r.rS.NOT_ENOUGH_WORDS?{message:`Your email must be at least ${r.fy} words (currently ${e.meta.wordsCount}).`}:e.reason===r.rS.TOO_MANY_WORDS?{message:`Your email must be under ${r.Vw} words (currently ${e.meta.wordsCount}).`}:(e=>{switch(e){case r.rS.NOT_AVAILABLE:return{message:"Our experts are currently working on other text. Please try again later."};case r.rS.NOT_AVAILABLE_QUOTA_ERROR:return{title:"Something went wrong",message:"We couldn't determine how many requests you have left. Please try again later."};case r.rS.CONFLICTING_REQUEST:return{title:"Separate request in progress",message:"You can submit this request once the experts are finished with the one you already submitted."};case r.rS.CHECKING_INITIAL_AVAILABILITY:return{message:"Checking for available experts..."};case r.rS.UNSUPPORTED_LANGUAGE:return{message:"Our writing experts can only help with emails written in English."};default:(0,s.vE)(e)}})(e.reason)},o=({info:e,includeTitle:t})=>{const i=n(e);return a.createElement(a.Fragment,null,t?a.createElement(a.Fragment,null,i.title?a.createElement("b",null,i.title):a.createElement("b",null,"Get expert writing help"),a.createElement("br",null)):null,i.message)};o.defaultProps={includeTitle:!1}},53844:(e,t,i)=>{i.d(t,{q:()=>h,d:()=>u});var a=i(27378),s=i(12187),r=i(21420);const n=({options:e,onChange:t=(()=>null),ariaLabel:i,className:n})=>{const o=[],[l,c]=a.useState(null);a.useEffect((()=>{var i;null!==l&&(null===(i=o[l])||void 0===i||i.focus()),t(null!==l?e[l].value:null)}),[l]);const d=null!==l?e[l]:null;return a.createElement("div",{"data-grammarly-part":"ui-kit-radio-group",className:n},a.createElement("div",{className:r.radioGroup,role:"radiogroup","aria-label":i,onKeyDown:t=>{if(" "!==t.key||d){if("ArrowRight"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();c(((l||0)+1)%e.length)}else if("ArrowLeft"===t.key||"ArrowUp"===t.key){t.preventDefault(),t.stopPropagation();const i=(l||0)-1;c(i<0?e.length-1:i)}}else t.preventDefault(),t.stopPropagation(),c(0)}},e.map(((e,t)=>{const i=(null==d?void 0:d.value)===e.value,n=0===t;return a.createElement("div",{key:e.value,...(0,s.Sh)(r.radioGroupOption,i?r.radioGroupOptionSelected:null),role:"radio",tabIndex:i||n&&!d?0:-1,"aria-checked":i,onClick:e=>{e.preventDefault(),e.stopPropagation(),c(t)},ref:e=>o.push(e)},e.render())}))))};var o,l=i(24606),c=i(47422),d=i(95888),p=i(51217),m=i(44544);function u(e){return"score"in e}!function(e){e.bad="bad",e.ok="ok",e.good="good"}(o||(o={}));const h=e=>{var t;const i=[o.bad,o.ok,o.good],[r,u]=a.useState(null),[h,g]=a.useState(""),[f,v]=a.useState(!1),[w,_]=a.useState(!1);let b;return b=w&&!1!==e.showPostSubmitScreen?a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-thank-you",...(0,s.Sh)(p.feedbackFormContainer,p.feedbackFormContainerAlignCenter)},a.createElement("div",{className:p.feedbackFormSuccessMessageTextContainer},a.createElement("div",{className:p.feedbackFormSuccessMessageIcon}),a.createElement("div",{className:p.feedbackFormSuccessMessageTitle},"Thank you!"),a.createElement("div",{className:p.feedbackFormSuccessMessageSubtitle},"Your feedback helps us improve.")),a.createElement(l.z,{className:p.feedbackFormSubmitButton,kind:"success",type:"submit",onClick:e.onClose},"Done"),e.fixSubmitButtonOverflowBottomPadding?a.createElement("div",{className:p.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:p.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null):a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-fields",...(0,s.Sh)(p.feedbackFormContainer,"center"===e.align?p.feedbackFormContainerAlignCenter:null)},a.createElement("div",{className:p.feedbackFormFields},e.hideLogo?null:a.createElement("div",{className:p.feedbackFormLogo}),e.hideTitle?null:a.createElement("div",{...(0,s.Sh)(p.feedbackFormTitle,e.compactDisplay?p.compact:null)},e.title||a.createElement("span",null,"How do you like ",a.createElement("br",null)," Grammarly?")),e.withScore?a.createElement(a.Fragment,null,a.createElement(n,{ariaLabel:"Feedback Score",options:i.map((e=>({value:e,render(){let t,i;return e===o.bad?(t=m.feedbackFormOptionIconDisheartening,i="Dissatisfied"):e===o.ok?(t=m.feedbackFormOptionIconNeutral,i="It's OK"):(t=t=m.feedbackFormOptionIconSmiling,i="Satisfied"),a.createElement("div",{className:m.feedbackFormOption},a.createElement("div",{...(0,s.Sh)(m.feedbackFormOptionIcon,t)}),a.createElement("div",null,i))}}))),onChange:u,...(0,s.Sh)(p.feedbackFormScore,e.compactDisplay?p.compact:null)}),e.hideTextBoxTitle?null:a.createElement("div",{className:p.feedbackFormTextBoxTitle},"How can we improve?")):null,a.createElement(c.z,{onChange:g,placeholder:e.placeholderText||"Tell us what you think",ariaLabel:"Feedback Text",...(0,s.Sh)(p.feedbackFormTextBox,e.compactDisplay?p.compact:null)}),e.domain?a.createElement(a.Fragment,null,e.hideDomainHelpText?null:a.createElement("div",{className:p.feedbackFormShareDomainTitle},"Help improve Grammarly by sharing the domain you’re on:"),a.createElement(d.J,{labelId:"feedback-form-share-domain-checkbox",onChange:v,className:p.feedbackFormShareDomainCheckbox},"Include the domain ",a.createElement("b",null,e.domain)," with my feedback")):null),a.createElement(l.z,{className:p.feedbackFormSubmitButton,kind:null!==(t=e.submitButtonKind)&&void 0!==t?t:"success",type:"submit",disabled:e.withScore?!r:!h,onClick:()=>{var t,i;e.withScore&&r?(null===(t=e.onSubmit)||void 0===t||t.call(e,{score:r,text:h,domain:f?e.domain:void 0}),_(!0)):!e.withScore&&h&&(null===(i=e.onSubmit)||void 0===i||i.call(e,{text:h,domain:f?e.domain:void 0}),_(!0))}},"Submit"),e.fixSubmitButtonOverflowBottomPadding?a.createElement("div",{className:p.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:p.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null),a.createElement("div",{style:{height:"100%",...e.style},"data-grammarly-part":"surveys-feedback-form"},b)};h.defaultProps={hideLogo:!1,align:"center",fixSubmitButtonOverflowBottomPadding:!1}},24372:(e,t,i)=>{i.d(t,{J:()=>s});var a=i(64408);const s=new Proxy({},{get:(e,t)=>(...e)=>a.emitBackground("gnar-track",{method:t,props:e})})},25682:(e,t,i)=>{var a=i(93476)((function(e){return e[1]}));a.push([e.id,"._380Y1-textBox{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;background:#f9faff;border:1px solid #e7e9f5;box-sizing:border-box;border-radius:4px;padding:10px 8px;overflow-y:auto;cursor:text;width:100%;height:100%;}._380Y1-textBox:empty:before{font-feature-settings:'ss03' on;font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:14px;line-height:21px;content:attr(data-placeholder)}",""]),a.locals={textBox:"_380Y1-textBox"},e.exports=a},33751:e=>{e.exports={cardList:"_1Eape",cardListFooterDynamic:"Inkbe",cardListFooterStatic:"_7OpWh",cardListFooterAnimate:"_29PbU",upgradeHookWrapper:"_9GpAY",assistant:"AnaVG",dragging:"_1XWvb",mainView:"_38aRY"}},90282:e=>{e.exports={footerButton:"_2rtYm",feedbackButton:"ywPnS",singleCardAssistantFeedbackButton:"_2KYb_"}},78846:e=>{e.exports={actions_hovered:"Xf2Pk",header:"_3p6xo",draggableWrapper:"_2_Oau",draggable:"_1m9e2",headerActions:"_2asjJ",headerActionBtnProofitIcon:"_1GEsJ",headerActionBtnGoalsIcon:"_1ZjAn",logoscore_fadein:"xzxut",fadein:"_30rWn",logoscore_fadeout:"_1DBSi",fadeout:"_24pVK",logo_score:"_6nCpo",spin:"_2gcAi"}},19217:e=>{e.exports={insight:"_3o8h_",insight__inline_icon:"svSbC",insight__inline_text:"_3Uft0"}},75039:e=>{e.exports={panel:"_1_EJL",score_container:"_2K_dc",info_icon:"wbvN6",lens_switch:"_3zrPc"}},98029:e=>{e.exports={predictions:"_3feHG",predictions__header:"_35Gcg",predictions__card:"_2xc9F",counterContainer:"_2co0s",predictions__zero_text:"_25oPK",predictions__off_brand:"_1sCHK"}},40145:e=>{e.exports={relatedSuggestionsTitle:"_3lmjh"}},55364:e=>{e.exports={viewOverlay:"_3iGYO",content:"_2sw8A",footer:"_3kpn-",viewOverlayGoBack:"_2Z1Xu",defaultViewOverlayPanel:"jqEio",gradientViewOverlayPanel:"_3Qgxa",proofitViewOverlayPanel:"_9lDqb",defaultViewOverlayHeader:"_1GTGF",defaultViewOverlayContent:"nXzeg",gradientViewOverlayContent:"_2hao0",proofitViewOverlayContent:"_2XeMU",logo:"xQSpk",proofitViewOverlayHeader:"_3dGrl",proofitViewOverlayHeaderBetaBadge:"_2wTGA"}},44715:e=>{e.exports={viewOverlay:"_2Unkh",content:"_2jpRZ",footer:"_24flt",viewOverlayGoBack:"a19pK",defaultViewOverlayPanel:"KLJW2",gradientViewOverlayPanel:"_2_U8f",helpPanel:"_1PEah",defaultViewOverlayHeader:"_2_b0R",defaultViewOverlayContent:"_1PG6A",gradientViewOverlayContent:"_21gzK",logo:"_3JvmB",helpPanelContent:"_7zg7r",helpBanner:"_3zyoV",helpBannerImage:"_3bc5C",helpHeader:"_1vP1w",helpBannerMessage:"uCPe4",helpContent:"FQviE",heatmap:"BPLCG"}},82318:e=>{e.exports={viewOverlay:"_24v8y",content:"_1GUCQ",footer:"_VXnz",viewOverlayGoBack:"_2vYal",defaultViewOverlayPanel:"_181-n",gradientViewOverlayPanel:"_30LCU",defaultViewOverlayHeader:"_2YCIK",defaultViewOverlayContent:"_1T1GW",gradientViewOverlayContent:"_2hMw0",logo:"_1wpBP",cardList:"_2M4t-",headerGroup:"Qwt6V",questionMarkButton:"_2U3v1",questionMarkIcon:"_3hiB8",summaryWrapper:"_3f-rw",message:"_2UO09",inlineButton:"_1-m6b",relatedSuggestionsTitle:"_3oKNQ"}},91574:e=>{e.exports={settingsDoneButton:"_3hYyu"}},40656:e=>{e.exports={singleCardAssistant:"_12876",singleCardAssistantEmogenieReportHeaderBrandTones:"ktqOZ",singleCardAssistantEmogenieReportHeaderBrandTonesLogo:"_3WgYO"}},35327:e=>{e.exports={summary_heading:"_28Zxw",summary_wrapper:"_3qF24",summary_fadein:"_1OTrB",fadein:"_1ETLE",summary_fadeout:"GJSzn",fadeout:"YHKQy"}},73008:e=>{e.exports={viewOverlay:"_8FYR8",content:"D8x8A",footer:"_1oEdF",viewOverlayGoBack:"_2IRn0",defaultViewOverlayPanel:"_3wpsL",gradientViewOverlayPanel:"_2zadI",defaultViewOverlayHeader:"_3Y5Ie",defaultViewOverlayContent:"_1FPwk",gradientViewOverlayContent:"_2WqSK",logo:"oiRsy"}},62513:e=>{e.exports={compactSuccessLens:"_1G56p",compactSuccessLensContainer:"_1cOu3"}},35630:e=>{e.exports={circleProgress:"_1npo5",circleText:"_3muDd",card:"AAT_T",header:"_3k6P5",compact:"_1Efs0",normal:"_2_T8O",progressIcon:"_3lupT",title:"_1U6tn",full:"_24i7N",progressContainer:"TH-Um",progressBar:"_1Tzvc",progressValue:"_1Ck8G",description:"_4m_YN"}},32585:e=>{e.exports={cardBody:"_1qMrW",description:"_3g_X-",actions:"G0xen",lessIcon:"_3HhMd",minimalDescription:"srN6O",actionsFooter:"_11uNl",feedbackFooter:"_2PAOt",viewMoreButton:"_1CGEL"}},11510:e=>{e.exports={miniCard:"_2FMyP"}},47476:e=>{e.exports={headerOrFooterWrapper:"_1snlI"}},74880:e=>{e.exports={cardList:"_2bCPN"}},30509:e=>{e.exports={premiumLens:"_2XK23"}},879:e=>{e.exports={successLens:"_1mbLA"}},57731:e=>{e.exports={footer:"_3W9PJ",plagiarismButton:"_1nouH",counterWrapper:"GHbf1",counter:"_2h93m",counterCheckmarkIcon:"_2-1xd"}},21831:e=>{e.exports={defaultHeader:"ghh6_",priorityLensHeader:"_2xf6x",head:"_1uTIv",headerGroup:"_1oce-",logoIcon:"_3Ey-O",logoText:"_1hTkC",headerButton:"_2HD8-",setGoalsButton:"_1EomQ",divider:"_2ku5Y",lensNavigation:"_1d7rU",disabledLensNavigation:"NFW3f",prioritySwitchWrapper:"EIY83",prioritySwitchFlatWrapper:"_3ujn6"}},79850:e=>{e.exports={wrapper:"_2PLre"}},75259:e=>{e.exports={container:"_2D4XC",baseGrid:"_2pCwn",bottomLeft:"_3_LGs",bottomRight:"_2tHhO",top:"_2Qg0A",notificationWrapper:"_3waR1"}},67129:e=>{e.exports={sidebarContainer:"_1_f6i"}},12267:e=>{e.exports={singleCardAssistant:"_29x5a",singleCardAssistantHeader:"eFwvd",singleCardAssistantHeaderWithOverlappingContent:"EKs5v",singleCardAssistantHeaderDraggable:"_3wYqZ",singleCardAssistantHeaderWithoutOverlappingContent:"c2-ry",singleCardAssistantHeaderWithButtonHovered:"GL12R",singleCardAssistantHeaderContent:"_17X-B",singleCardAssistantHeaderDraggableIcon:"_1bSo7",singleCardAssistantHeaderBackButton:"_3anZx",singleCardAssistantHeaderBackButtonIcon:"_3Zzy6",singleCardAssistantHeaderContentInner:"_1KwfK",singleCardAssistantHeaderButtons:"jHXUY",singleCardAssistantHeaderDraggableHoveredBackground:"_85ToU",singleCardAssistantContent:"_1r3xI",singleCardAssistantContentWithPadding:"Jgq6x",singleCardAssistantContentWithOverlappingHeader:"_3qJuR",spin:"_2z-hC"}},17208:e=>{e.exports={successReport:"_2zWCa",successReportIcon:"_3aU35",successReportTitle:"_2C75-",successReportSubtitle:"_6-_6x",spin:"_3dWuJ"}},49468:e=>{e.exports={smartPhrasesPremiumCard:"_1Y_nm",smartPhrasesPremiumCardEmoji:"_2iNih",smartPhrasesPremiumCardHeader:"WRN2l",smartPhrasesPremiumCardButtons:"_1jzc9",smartPhrasesPremiumCardUpgradeButton:"_2ABK9"}},12266:e=>{e.exports={emogenieReport:"SoJtK",emogenieReportHeader:"wVkE-",emogenieReportHeaderTitle:"_1ARH3",emogenieReportHeaderSubTitle:"_3Jo1r",emogenieReportHeaderBrandOffSubTitle:"_1FbkK",emogenieReportItems:"_18u69",emogenieReportBetaDisclaimer:"_3lBw6",emogenieReportBetaDisclaimerText:"g-mh1",emogenieReportCheckbox:"_1mxcw"}},8471:e=>{e.exports={emogenieReportItem:"_2VgP1",emogenieReportItemBrandTone:"os2BZ",emogenieReportItemFeedback:"_3Po2q",emogenieReportItemFeedbackIcon:"_3jxVn",emogenieReportItemFeedbackText:"_3sBTt",emogenieReportItemEmotion:"_2pWWy",emogenieReportItemEmotionEmojiAndName:"_3Z3wv",emogenieReportItemEmotionEmoji:"_2cinA",emogenieReportItemEmotionName:"GSyum",emogenieReportItemEmotionIntensity:"_3oWFN",emogenieReportItemEmotionIntensityDot:"_2wQcZ",emogenieReportItemEmotionIntensityDotActive:"_9zOn8",emogenieReportItemEmotionBrandToneBadge:"_2iuvQ",emogenieReportItemDescription:"_1A3aU",spin:"_1g4LL"}},75100:e=>{e.exports={settingsButton:"RuCYy",spin:"_2dlxE"}},53358:e=>{e.exports={checkboxContainer:"_30OQ2",checkbox:"_1eqmB",checkboxChecked:"_105R3"}},21420:e=>{e.exports={radioGroup:"_3jZFB",radioGroupOption:"_1Boe7",radioGroupOptionSelected:"_37tnK"}},59e3:e=>{e.exports={proofitRequestFormBtnLoadingSpinner:"_1dhPr",spin:"_34iE-"}},41063:e=>{e.exports={proofitHowItWorksSteps:"_29Vif",proofitHowItWorksStep:"M3Zas",proofitHowItWorksStepNumberContainer:"oAgaO",proofitHowItWorksStepNumber:"_1ZCJT",proofitHowItWorksStepOne:"_1jzAP",proofitHowItWorksStepOneNumberContainer:"_3zIlJ",proofitHowItWorksStepTwo:"TNSEJ",proofitHowItWorksStepTwoNumberContainer:"_2B7-Z",proofitHowItWorksStepThree:"_3G_IW",proofitHowItWorksStepThreeNumberContainer:"_1xWbH"}},17487:e=>{e.exports={proofitRequestForm:"_16jRB",proofitRequestFormImg:"L3ge0",proofitRequestFormTitle:"_2AohE",proofitRequestFormDescription:"_1-l2N",proofitRequestFormCostAndTime:"_1fthW",proofitRequestFormTime:"XwGo8",proofitRequestFormCostAndTimeTitle:"kTnKg",proofitRequestFormCostAndTimeSubtitle:"_12FlO",proofitRequestFormRequestBtn:"_3Iaok",proofitRequestFormUnavailableMsg:"_1hKiE",proofitRequestFormFootnote:"_3_jiZ",proofitRequestFormFootnoteFreeTrial:"IrTLS",proofitRequestFormFootnoteHowItWorksDontShowAgainCheckbox:"canRi",proofitRequestFormPrivacyInfoTitle:"_2YkLm",proofitRequestFormPrivacyInfoDescription:"_23aSV",proofitRequestFormPrivacyInfoDescriptionItem:"_31giz",proofitRequestFormPrivacyInfoDescriptionItemBulletPoint:"_3vURB"}},8400:e=>{e.exports={proofitReviewForm:"_1_T1p",proofitReviewFormTitle:"_1VtIM",proofitReviewFormDescription:"gQQZe",proofitFeedbackForm:"_tV9e",proofitDoneButton:"W2xwF"}},57398:e=>{e.exports={scoreRing:"_1V95O",loading:"_3_fuY",rotation:"_3cevg",scoreText:"_3MN4B"}},51217:e=>{e.exports={feedbackFormContainer:"_1M-GI",feedbackFormContainerAlignCenter:"_3QNrK",feedbackFormFields:"Jg_OY",feedbackFormTitle:"nPjzw",feedbackFormTextBoxTitle:"_2yUbL",feedbackFormLogo:"_2C-d7",compact:"_1wDKK",feedbackFormScore:"_3AmBq",feedbackFormTextBox:"FO2oU",feedbackFormShareDomainTitle:"_2UXTO",feedbackFormShareDomainCheckbox:"_3mSXM",feedbackFormSubmitButton:"_32xYR",feedbackFormSubmitButtonFixOverflowBottomPadding:"IJDSA",feedbackFormSubmitButtonFixOverflowBottomPaddingChild:"_3d5Tf",feedbackFormSuccessMessageTextContainer:"_2JO6Z",feedbackFormSuccessMessageIcon:"oVxds",feedbackFormSuccessMessageTitle:"_1MdvM",feedbackFormSuccessMessageSubtitle:"_1EKkw",spin:"_2ycFE"}},44544:e=>{e.exports={feedbackFormOption:"_9K_Q8",feedbackFormOptionIcon:"_259oL",feedbackFormOptionIconDisheartening:"_3NJTM",feedbackFormOptionIconNeutral:"i-5N8",feedbackFormOptionIconSmiling:"_1Dxi9",spin:"_2elyX"}},71527:e=>{e.exports={selected:"_3Ibej",label:"EKNV1",option:"ygVjN"}},66402:e=>{e.exports={american:"pyFmV",australian:"_2WGo3",british:"_1nkJZ",canadian:"_35Lt7"}},68089:e=>{e.exports={hover_blocker:"_1b9OS"}},56542:e=>{e.exports={settingsContent:"_2LPPC",singleCardAssistant:"_1eJQR",fullWidth:"_1c69A",heading:"uyO-m",allSettings:"_3yj-F",separator:"_2LaDH",settingsLink:"_1DiWR"}},1005:e=>{e.exports={heading:"LLSOT"}},26485:e=>{e.exports={select_checkbox:"_3jXk9",centered:"_2GfZn",select_children:"nYWGL",beta:"_2D7H7",new:"_3Lqg-",checkbox:"_2nj-e",checkbox_check:"_28S0f",on:"UigB5",off:"_30ryz",checkbox_check_round:"_1PwEM",checkbox_control_wrapper:"_1KIp6",grayOut:"ZleQc",on_off:"_3mcZ6",disabled:"_1Sp_7",setting_item:"_3JLH2"}},6304:e=>{e.exports={line:"_2vgUt",withMaxWidth:"_27l5X",disabled:"_3kA-F",dialectPicker:"_2v6OJ"}},47740:e=>{e.exports={container:"_1eoMt",contant:"_255K3",title:"_3hI6a",spacer:"_2uzpC"}},17324:e=>{e.exports={windows:"_2wKpF",setting_item:"_6eFop",fixing:"_3sQF9",thin_text:"_2m369",footer:"AIrzw",gr_popup_settings:"_18flg",iOS:"_2Y-35",footer_btn:"_16bxQ",short_border:"FqAkb",top:"_2N9kH",upgraded:"_1D3x1",content:"_36NTm",since:"dfV8r",business:"Nb2Rp",edu:"_3Q9EY",my_grammarly:"_1NXBN",new_document:"bpEGW",unsupported_site:"iBAYN",unsupported_item:"_13zLn",unsupported_title:"_3rfYX",domain:"_1tlAE",domain_in_details:"_2z4_y",unsupported_temporary:"Xw4Jp",unsupported_permanently:"_27hK2",unsupported_grammarly:"_2xTYa",diamond:"p3X6p",userPanel:"_3cZ8t",email:"bBX3_",link:"_3ko8g",blue:"b4yKe",edc_stripe:"_1wkrp",line:"_2_8JS",not_supported:"kU9B_",site_switcher:"_2KZQq",upgrade:"_1zI1G",def_switcher:"_29_cp",on:"_2JO5i",off:"_3f4Zs",favicon:"sjSDn",centered:"taU_8",summary:"_1cNov",upgrade_title:"_3aOe6",settingsContent:"_2BkNA",withBackground:"pNvqp",llamaTitle:"h5j0H",llamaDescription:"mHaqr"}},23345:e=>{e.exports={line:"NMkwQ",content:"lWYTI",upgrade:"_2GRJe"}}}]);