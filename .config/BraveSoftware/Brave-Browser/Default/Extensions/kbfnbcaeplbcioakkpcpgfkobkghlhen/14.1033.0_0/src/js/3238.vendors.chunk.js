/*! For license information please see 3238.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[3238],{11066:(e,t)=>{function n(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=i(e)+"="+i(t);null==t&&(n.maxage=-1),n.maxage&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; path="+n.path),n.domain&&(r+="; domain="+n.domain),n.expires&&(r+="; expires="+n.expires.toUTCString()),n.secure&&(r+="; secure"),document.cookie=r}function r(e){var t=function(e){var t={},n=e.split(/ *; */);if(!n[0])return t;var r=n,i=Array.isArray(r),s=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(s>=r.length)break;a=r[s++]}else{if((s=r.next()).done)break;a=s.value}var c=a;t[o((c=c.split("="))[0])]=o(c[1])}return t}(document.cookie);return e?t[e]:t}function i(e){try{return encodeURIComponent(e)}catch(e){return null}}function o(e){try{return decodeURIComponent(e)}catch(e){return null}}t.Z=function(e,t,i){if(arguments.length<2)return r(e);n(e,t,i)}},18410:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestBuilder=t.Request=t.HTTPError=t.RequestError=t.Ajax=void 0;var r,i=n(59312),o=n(99950),s=n(32687),a=n(99129),c=n(16595);!function(e){e.extend=function(e){return c.R.local((function(t){return i.__assign(i.__assign({},t),{requestExtender:t.requestExtender?p.Extender.compose(e,t.requestExtender):e})}))};var t=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=t,r.details=n,r.name="ParseError",r}return i.__extends(t,e),t.prototype.toString=function(){return"Ajax response parsing error\n        Message "+this.message+"\n        Details "+s.failure(this.details)},t}(c.CustomError);e.ParseError=t,function(e){e.json="application/json",e.form="application/x-www-form-urlencoded",e.multipart="multipart/form-data",e.pdf="application/pdf",e.txt="text/plain",e.stream="application/octet-stream",e.vnd="application/vnd",e.zip="application/zip",e.any="*/*"}(e.MimeType||(e.MimeType={})),e.mapToHTTPErrorWithoutBody=function(t,n,r){return r.removeBody(),e.mapToHTTPError(t,n,r)},e.mapToHTTPError=function(e,t,n){return new u({request:n,code:t.status,status:t.statusText,url:t.url,body:e})}}(r=t.Ajax||(t.Ajax={}));var l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=t,r.details=n,r.name="RequestError",r}return i.__extends(t,e),t.prototype.toString=function(){return"Request error\n      Message: "+this.message+"\n      details: "+this.details},t.fromError=function(e,n){var r=new t(e,n.message);return r.stack=n.stack,r},t}(c.CustomError);t.RequestError=l;var u=function(e){function t(t){var n=t.code,r=t.status,i=t.url,o=t.message,s=t.body,a=t.request,c=e.call(this,Boolean(o)?o:Boolean(r||s)?r||s:"HTTPError")||this;return c.name="HTTPError",c.url=i,c.code=n,c.body=s,c.status=r,c.request=a,c}return i.__extends(t,e),t.prototype.toString=function(){return"Response\n      Message: "+this.message+"\n      Status: "+this.status+"\n      Code: "+this.code+"\n      Body: "+this.body+"\n      "+(void 0!==this.request?"\n"+this.request.toString():"Url: "+this.url)},t}(c.CustomError);t.HTTPError=u;var d=function(){function e(e,t,n,r,i){this._url=e,this._method=t,this._headers=n,this._mime=r,this._body=i}return e.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p.get.apply(p,e).build()},e.post=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p.post.apply(p,e).build()},e.put=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p.put.apply(p,e).build()},e.del=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p.del.apply(p,e).build()},e.head=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p.head.apply(p,e).build()},Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this._method},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mime",{get:function(){return this._mime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return c.O.fromNullable(this._body)},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"Request\n    Method: "+this.method.toUpperCase()+"\n    Url: "+this.url+"\n    Mime: "+this.mime+"\n    Headers: "+JSON.stringify(this.headers,void 0,2)+"\n    Body:"+c.O.mapOrDefault((function(e){return t=JSON.stringify(e instanceof URLSearchParams?(r={},e.forEach((function(e,t){return r[t]=e})),r):e,void 0,2),n=200,t.length<=n?t:t.slice(0,n)+"....";var t,n,r}),"empty")(this.body)+"\n    "},e.prototype.removeBody=function(){this._body=void 0},e}();t.Request=d,function(e){!function(e){e.GET="get",e.POST="post",e.PUT="put",e.OPTIONS="options",e.HEAD="head",e.TRACE="trace",e.DELETE="delete",e.CONNECT="connect"}(e.Method||(e.Method={}))}(d=t.Request||(t.Request={})),t.Request=d;var p=function(){function e(e,t,n,r,i,o,s,a){void 0===e&&(e=""),void 0===t&&(t=new URLSearchParams),void 0===n&&(n=[]),void 0===r&&(r={}),void 0===a&&(a=!1),this._url=e,this._queryParams=t,this._cookies=n,this._headers=r,this._method=i,this._mime=o,this._body=s,this._preserveUrl=a}return e.join=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=[].slice.call(t.filter((function(e){return e.length>0})),0).join("/");return e._normalize(r)},e._normalize=function(e){return e=(e=(e=e.replace(/:\//g,"://")).replace(/([^:\s])\/+/g,"$1/")).replace(/\/(\?|#)/g,"$1")},e.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method(d.Method.GET)},e.post=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method(d.Method.POST)},e.put=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method(d.Method.PUT)},e.del=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method(d.Method.DELETE)},e.head=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method(d.Method.HEAD)},e.url=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new e(e.join.apply(e,t))},e.prototype.url=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(""!==this._url)throw new Error("URL already set to "+this._url+", use join(string) to add additional parts to it");return this.join(e.join.apply(e,t))},e.create=function(){return new e},e.prototype.method=function(e){if(Boolean(this._method)&&this._method!==e)throw new Error("Method already set to "+this._method+", but was overwritten by "+e);return this._method=e,this},e.prototype.join=function(t){return this._url=e.join(this._url,t),this},e.prototype.pathParam=function(t){return this._url=e.join(this._url,encodeURIComponent(t)),this},e.prototype.body=function(e){if(Boolean(this._body))throw new Error("Body already set to "+this._body+", but was overwritten by "+e);return this._body=e,this},e.prototype.formParam=function(e,t){return(this._body=this._body instanceof URLSearchParams?this._body:new URLSearchParams).append(e,t),this},e.prototype.multipartFormData=function(e,t,n){var r=this._body instanceof a?this._body:new a;return r.append(e,t,n),this._body=r,this},e.prototype.header=function(e,t){return this._headers[e]=t,this},e.prototype.queryParam=function(e,t){return this._queryParams.append(e,t),this},e.prototype.cookie=function(e,t){return this._cookies.push(e+"="+t),this},e.prototype.mime=function(e){if(Boolean(this._mime)&&this._mime!==e)throw new Error("MIME already set to "+this._mime+", but was overwritten by "+e);return this._mime=e,this},e.prototype.json=function(e){return Boolean(e)?this.body(e).mime(r.MimeType.json):this.mime(r.MimeType.json)},e.prototype.preserveUrl=function(){return this._preserveUrl=!0,this},e.prototype.build=function(){if(!this._url||0===this._url.length)throw new Error("URL cannot be empty");if(this._preserveUrl||(this._url=this._url.replace(/\/$/,"")),(""+this._queryParams).length>0&&(this._url+="?"+this._queryParams),this._body instanceof URLSearchParams){if(Boolean(this._mime)&&this._mime!==r.MimeType.form)throw new Error("Only application/x-www-form-urlencoded can be used for form requests, don't specify it mandatory in mime() method");this._mime=r.MimeType.form}else if(this._body instanceof a&&Boolean(this._mime)&&this._mime!==r.MimeType.multipart)throw new Error("Only multipart/form-data can be used for multipart form data requests, don't specify it mandatory in mime() method");if(this._mime===r.MimeType.json&&Boolean(this._body)&&(this._body=JSON.stringify(this._body)),!Boolean(this._method))throw new Error("HTTP method was not set");if(this._method=this._method.toLocaleLowerCase(),"get"===this._method&&Boolean(this._body))throw new Error("Body is not supported for GET");if(Boolean(this._mime)&&(this._headers["Content-Type"]=this._mime),this._cookies.length>0){this._headers.Cookie=this._cookies.join("; ")}return new d(this._url,this._method,this._headers,Boolean(this._mime)?this._mime:null,this._body)},e}();t.RequestBuilder=p,function(e){!function(e){e.identity=function(e){return o.task.of(e)},e.compose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n){return t.reduce(o.task.chain,e.identity(n))}}}(e.Extender||(e.Extender={}))}(p=t.RequestBuilder||(t.RequestBuilder={})),t.RequestBuilder=p},81777:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Alternative=t.AlternativeReversed=t.AlternativeOperation=void 0;var r,i,o=n(59312),s=n(71249),a=n(45614),c=n(57050),l=n(40327),u=n(64450),d=n(16595),p=n(81531),h=n(64613),m=n(27966);!function(e){var t,n;!function(e){e.Important="important",e.Main="main",e.Optional="optional"}(t=e.Type||(e.Type={})),function(e){e.OptionalContext="optional_context"}(n=e.TypeExt||(e.TypeExt={}));var r=function(e){return"object"==typeof e&&null!==e};e.eqAttributes=a.getEq(d.Eq.fromEquals((function(t,n){return r(t)&&r(n)?e.eqAttributes.equals(t,n):d.Eq.eqStrict.equals(t,n)}))),e.eq=d.Eq.getStructEq({type:d.Eq.eqStrict,group:d.O.getEq(d.Eq.eqString),insert:d.Eq.eqString,delete:d.Eq.eqNumber,retain:d.Eq.eqNumber,attributes:e.eqAttributes}),e.isInsert=function(e){return"insert"in e},e.isInsertString=function(t){return e.isInsert(t)&&i(t.insert)},e.isInsertGap=function(t){return e.isInsert(t)&&s(t.insert)},e.isDelete=function(e){return"delete"in e},e.isRetain=function(e){return"retain"in e},e.isOptionalContextRetain=function(t){return"retain"in t&&e.isOptionalContextType(t.type)};var i=function(e){return"string"==typeof e},s=function(e){return"object"==typeof e&&null!==e&&"gap"in e};e.isMain=function(t){return t.type===e.Type.Main},e.isOptionalType=function(t){return t===e.Type.Optional},e.isOptionalContextType=function(t){return t===e.TypeExt.OptionalContext},e.isSignificant=function(e){switch(e.type){case t.Main:case t.Important:return!0;case t.Optional:return!1;default:return d.assertNever(e.type)}},e.fromRawAbsAlternative=function(e){if(a=e.ops,c=a[0],Boolean(c)&&"retain"in c&&Boolean(c.attributes)&&"optional_context"===c.attributes.type){var t=e.ops,r=t[0],i=t.slice(1),s={retain:r.retain,type:n.OptionalContext,group:d.O.none};return o.__spreadArrays([s],i.map(m))}return e.ops.map(m);var a,c},e.length=u.Delta.Op.length,e.anonymize=function(t){return e.isInsert(t)?o.__assign(o.__assign({},t),{insert:"string"==typeof t.insert?"<"+e.length(t)+">":"<embed>"}):t};var p=function(){function n(e){this.ops=e,this.index=0,this.offset=0}return n.prototype.hasNext=function(){return this.peekLength()<1/0},n.prototype.next=function(n){Boolean(n)||(n=1/0);var r=this.ops[this.index];if(Boolean(r)){var i=r.type,o=this.offset,s=e.length(r);return n>=s-o?(n=s-o,this.index+=1,this.offset=0):this.offset+=n,e.isDelete(r)?{delete:n,type:i,group:r.group}:e.isRetain(r)?{retain:n,type:i,group:r.group,attributes:!e.isOptionalContextType(i)&&r.attributes}:e.isInsertString(r)?{insert:r.insert.substr(o,n),type:i,group:r.group,attributes:r.attributes}:r}return{retain:1/0,type:t.Optional,group:d.O.none,attributes:{}}},n.prototype.peekLength=function(){return Boolean(this.ops[this.index])?e.length(this.ops[this.index])-this.offset:1/0},n.prototype.peekType=function(){return Boolean(this.ops[this.index])?e.isDelete(this.ops[this.index])?"delete":e.isRetain(this.ops[this.index])?"retain":"insert":"retain"},n}();e.Iterator=p;var h=c.flow(d.O.fromNullable,d.O.map(a.deleteAt("type")),d.O.map(a.deleteAt("group")),d.O.getOrElse((function(){return{}}))),m=function(e){var n,r=function(e){if(null!=(null==e?void 0:e.type))switch(e.type){case"main":return t.Main;case"important":return t.Important;default:return d.assertNever(e.type)}return t.Optional}(e.attributes),i=(n=e.attributes,l.pipe(d.O.fromNullable(n),d.O.chain((function(e){return d.O.fromNullable(e.group)}))));return"insert"in e?{insert:e.insert,type:r,group:i,attributes:h(e.attributes)}:"delete"in e?{delete:e.delete,type:r,group:i}:{retain:e.retain,type:r,group:i,attributes:h(e.attributes)}}}(r=t.AlternativeOperation||(t.AlternativeOperation={})),function(e){e.fromAlternative=function(e){var t=e.alternative,n=e.fullText;return l.pipe(t.delta.invert(n),i.fromRawDelta)},e.fromAlternativeBoldified=function(t){var n=t.alternative,r=t.fullText,i=l.pipe(n.delta.map(h.DeltaUtils.match((function(e){return l.pipe(e,d.O.fromPredicate(h.DeltaUtils.isInsertString),d.O.chain((function(e){return l.pipe(d.O.fromNullable(e.attributes),d.O.map((function(t){return{attributes:t,retain:e.insert.length}})))})),d.O.filter((function(e){var t=e.attributes;return Boolean(t.bold)})),d.O.map((function(e){return{retain:e.retain,attributes:{bold:!1}}})))}),(function(e){return d.O.none}),(function(e){return d.O.some({retain:e.retain})}))),d.A.compact,(function(e){return new u.Delta(e)}),(function(e){return r.compose(e)}));return e.fromAlternative({alternative:n,fullText:i})},e.fromAlternativeListified=function(t){var n=t.alternative,r=t.fullText;return l.pipe(e.fromAlternative({alternative:n,fullText:r}),(function(e){return l.pipe(e.delta.ops,d.A.findLastIndex((function(e){return h.DeltaUtils.isInsertString(e)&&"\n"===e.insert&&Boolean(!e.attributes||!Boolean(e.attributes.list))})),d.O.map((function(t){var n=e.delta.ops,r=n[t];return new u.Delta(o.__spreadArrays(n.slice(0,t),[o.__assign(o.__assign({},r),{attributes:o.__assign(o.__assign({},r.attributes),{list:!1})})],n.slice(t+1)))})),d.O.getOrElse((function(){return e.delta})))}),i.fromRawDelta)}}(t.AlternativeReversed||(t.AlternativeReversed={})),function(e){var t;function n(e){return function(t){return r.isInsertGap(t)?o.__assign(o.__assign({},t),{insert:e}):t}}function i(e){return new a(e)}e.hasOptionalContext=function(e){return Boolean(e[0])&&r.isOptionalContextRetain(e[0])},function(e){e.Insert="insert",e.Remove="remove",e.Substitution="substitution"}(t=e.Type||(e.Type={})),function(e){function t(t){return t.type===r.Type.Main?d.O.some(r.isInsert(t)?e.Insert:e.Remove):d.O.none}e.eq=d.Eq.eqString,e.fromOperation=t,e.semigroup={concat:function(t,n){switch(t){case e.Insert:return n===e.Remove?e.Substitution:n;case e.Remove:return n===e.Insert?e.Substitution:n;case e.Substitution:return e.Substitution;default:return d.assertNever(t)}}},e.monoid=d.O.getMonoid(e.semigroup),e.parse=s.foldMap(e.monoid)(t)}(t=e.Type||(e.Type={})),e.eq=d.Eq.getStructEq({lengthAffected:d.Eq.eqNumber,type:d.O.getEq(t.eq),ops:s.getEq(r.eq)}),e.fromRawDelta=c.flow(m.RawTransform.AbsAlternative.unsafeFromDelta,r.fromRawAbsAlternative,i),e.fillGaps=function(t,r){return e.hasOptionalContext(t.ops)?i(o.__spreadArrays([t.ops[0]],t.ops.slice(1).map(n(r)))):i(t.ops.map(n(r)))},e.dismissTransformGroups=function(t,n){var s=d.A.filterMap((function(e){return l.pipe(e.group,d.O.filter((function(e){return n.has(e)})),d.O.fold((function(){return d.O.some(e)}),(function(){return function(e){return r.isDelete(e)?d.O.some({type:e.type,group:e.group,retain:e.delete,attributes:{}}):r.isInsert(e)?d.O.none:d.O.some(e)}(e)})))}));if(e.hasOptionalContext(t.ops)){var a=t.ops,c=a[0],u=a.slice(1);return i(o.__spreadArrays([c],l.pipe(u,s)))}return i(l.pipe(t.ops,s))},e.getTransformGroups=function(e){var t=new Set;return e.ops.forEach((function(e){return l.pipe(e.group,d.O.tap((function(e){return t.add(e)})))})),t},e.getDeleteOpsGroupsList=function(e){return l.pipe(e.ops.filter(r.isDelete),d.A.map((function(e){return e.group})),d.A.compact)},e.create=i,e.validate=c.flow((function(e){return e.ops}),d.E.fromPredicate(d.ArrayUtils.existsOnEdgesOnly(r.isOptionalContextRetain),(function(e){return"Optional_context operations exist not only at the beginning or at the end of Delta"}))),function(t){t.fromSerialized=function(t){return{context:t.context,alternatives:l.pipe(t.alternatives,d.NEA.map((function(e){return e.ops})),d.NEA.map(e.create))}},t.fromSubalerts=function(e,t){return{context:e,alternatives:d.NEA.map(c.flow(r.fromRawAbsAlternative,i))(t)}},t.fromRawTransform=function(e){return{context:d.NEA.of(e.context),alternatives:d.NEA.map(c.flow(r.fromRawAbsAlternative,i))(e.alternatives)}},t.rebase=function(e){return function(t){return{context:l.pipe(t.context,d.NEA.map((function(t){return{s:e.transformPosition(t.s,!0),e:e.transformPosition(t.e,!0)}}))),alternatives:l.pipe(t.alternatives,d.NEA.map((function(t){return l.pipe(t.rebase(e),d.O.fold((function(){return t}),c.identity))})))}}},t.copy=function(e){return{context:d.NEA.copy(e.context),alternatives:d.NEA.copy(e.alternatives)}}}(e.Group||(e.Group={}));var a=function(){function n(e){this.ops=e,this.type=t.parse(this.ops),this.lengthAffected=h.DeltaUtils.calcAffectedLength(this)}return n.prototype.rebase=function(e){var t=e.ops[0];if(!Boolean(t)||h.DeltaUtils.isRetain(t)&&(void 0===t.attributes||0===Object.keys(t.attributes).length)&&u.Delta.Op.length(t)>this.lengthAffected)return d.O.some(this);var n=this.ops.length>=2&&h.DeltaUtils.isDelete(this.ops[this.ops.length-2])&&h.DeltaUtils.isInsert(this.ops[this.ops.length-1]);return!Boolean(t)||n&&h.DeltaUtils.isRetain(t)&&(void 0===t.attributes||0===Object.keys(t.attributes).length)&&u.Delta.Op.length(t)===this.lengthAffected?d.O.some(this):this._internalRebase(e)},n.prototype._internalRebase=function(t){for(var i=this,o=u.Delta.Op.iterator(t.ops),s=new r.Iterator(this.ops),a=d.O.some(new n([])),c=!1;s.hasNext();)if("insert"===o.peekType()){if(c&&l.pipe(a,d.O.forAll((function(e){return e.ops[e.ops.length-1].type===r.Type.Main}))))return d.O.none;var p=u.Delta.Op.length(o.next()),m=l.pipe(a,d.O.map((function(e){return e.ops[e.ops.length-1]})),d.O.unsafeGet);if(c&&d.O.forAll((function(e){return e.lengthAffected>0}))(a)){var f={retain:p,type:m.type,group:m.group,attributes:"attributes"in m&&!r.isOptionalContextType(m.type)&&m.attributes};a=n._pushOp(a,f)}else a=n._pushOp(a,{retain:p,type:r.Type.Optional,group:d.O.none,attributes:{}})}else if("insert"===s.peekType()){var g=s.next();if(g.type===r.Type.Main&&"delete"===o.peekType()&&o.offset>0)return d.O.none;a=n._pushOp(a,g)}else{var y=Math.min(o.peekLength(),s.peekLength()),_=o.next(y),v=s.next(y);h.DeltaUtils.isDelete(_)||(c=s.offset>0,a=n._pushOp(a,r.isDelete(v)?v:r.isOptionalContextType(v.type)?{retain:y,type:r.TypeExt.OptionalContext,group:d.O.none}:{retain:y,type:v.type,group:v.group,attributes:v.attributes}))}return l.pipe(a,d.O.map((function(t){return t.type=e.Type.parse(i.ops),t})))},n._pushOp=function(e,t){return l.pipe(e,d.O.chain((function(e){return l.pipe(d.E.tryCatchError((function(){return e._push(t)})),d.E.mapLeft((function(e){return p.Monitoring.Logging.getLogger("Alternative").error("Alternative push error",e),e})),d.O.fromEither)})))},n.prototype._push=function(e){var t=this.ops.length,n=this.ops[t-1];if(Boolean(n)){if(r.isOptionalContextRetain(e))return r.isOptionalContextRetain(n)?n.retain+=e.retain:r.isRetain(n)&&t<=2?2===t?(d.invariant(r.isOptionalContextRetain(this.ops[0]),"OptionalContext is expected in the beginning of alternative but not found",JSON.stringify({ops:this.ops,newOp:e,index:t})),this.ops[0].retain+=e.retain):(this.ops[t]=n,this.ops[t-1]=e):d.invariant(r.isOptionalContextRetain(n)||r.isRetain(n)&&1===t,"Attempted to push optional_context in the middle of alternative ops",JSON.stringify({ops:this.ops,newOp:e,index:t})),this.lengthAffected+=e.retain,this;if(r.isDelete(e)&&r.isDelete(n))return e.type===n.type?n.delete+=e.delete:this.ops.push(e),this.lengthAffected+=e.delete,this;if(r.isInsert(e)&&r.isInsert(n))return e.type===n.type&&"string"==typeof e.insert&&"string"==typeof n.insert&&r.eqAttributes.equals(e.attributes,n.attributes)?n.insert+=e.insert:this.ops.push(e),this;if(r.isRetain(e)&&r.isRetain(n))return e.type===n.type?n.retain+=e.retain:this.ops.push(e),this.lengthAffected+=e.retain,this;this.ops.push(e)}else this.ops=[e];return r.isInsert(e)||(this.lengthAffected+=r.length(e)),this},Object.defineProperty(n.prototype,"delta",{get:function(){return h.DeltaUtils.normalizeDelta(new u.Delta(this))},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{ops:this.ops}},n}();e.compose=function(e,t){var n={composedDelta:new u.Delta,currentFullText:t,reversedAlternatives:[]},r=e.reduce((function(e,t,n){var r=t[0],i=t[1];return l.pipe(r.rebase(e.composedDelta),d.O.fold((function(){e.reversedAlternatives.push(d.E.left({error:new Error("Could not rebase alternative to composed delta"),delta:r.delta,alternativeIndex:n}))}),(function(t){var r=i({alternative:t,fullText:e.currentFullText});e.composedDelta=e.composedDelta.compose(t.delta),e.currentFullText=e.currentFullText.compose(t.delta),function(e,t){e.forEach((function(n,r){return l.pipe(n,d.E.fold(c.constVoid,(function(n){e[r]=l.pipe(n.reversedAlternative.rebase(t.delta),d.E.fromOption((function(){return{error:new Error("Could not rebase reversed alternative to some alternative"),delta:n.reversedAlternative.delta,alternativeIndex:n.alternativeIndex}})),d.E.map((function(e){return o.__assign(o.__assign({},n),{reversedAlternative:e})})))})))}))}(e.reversedAlternatives,t),e.reversedAlternatives.push(d.E.right({reversedAlternative:r,alternativeIndex:n}))}))),e}),n),i=l.pipe(r.reversedAlternatives,d.A.separate,d.RecoverableOperation.fromSeparatedArray);return o.__assign(o.__assign({},r),{reversedAlternatives:i})},e.withoutOptionalOps=function(t){return e.create(t.filter((function(e){return!r.isOptionalType(e.type)})))}}(i=t.Alternative||(t.Alternative={}))},86664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCAPIEventHandler=void 0;var n=function(){},r=function(){this.onSessionStarted=n,this.onWaitForOT=n,this.onReady=n,this.onSessionInbound=n,this.beforeAlert=n,this.onAlert=n,this.onRemove=n,this.onChange=n,this.onSynonyms=n,this.onPlagiarism=n,this.onBeforeAsyncCheckFinish=n,this.onAsyncCheckFinish=n,this.onError=n,this.onBeforeFinish=n,this.onFinish=n,this.onStats=n,this.onTextMaps=n,this.onTextInfo=n,this.onEmotions=n,this.onPong=n,this.onDebugInfo=n,this.onConnect=n,this.onDisconnect=n,this.onClose=n,this.onQueueMsgAccepted=n,this.onQueueMsgDropped=n,this.onAck=n,this.onMessageReceived=n,this.onMessageSent=n,this.onAutoComplete=n,this.onAttentionHeatmap=n,this.onAttentionInfo=n,this.onProofitAvailability=n,this.onProofitCancelled=n,this.onProofitCompleted=n,this.onProofitProgress=n,this.onProofitProgressProblem=n,this.onProofitSubmit=n,this.onShortenItFinished=n};t.DefaultCAPIEventHandler=r},13669:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CAPIConnection=void 0;var r=n(59312),i=n(57050),o=n(40327),s=n(16595),a=n(81531),c=n(26696),l=n(86664),u=n(59954),d=function(){function e(e,t,n){var d=this,p=e.handler,h=e.reconnectHandler,m=void 0===h?c.Reconnect.getDefaultReconnect(c.Reconnect.ClientType.capi):h,f=e.maxReconnectDelay,g=e.baseReconnectDelay,y=r.__rest(e,["handler","reconnectHandler","maxReconnectDelay","baseReconnectDelay"]);this._connect=t,this._ws=n,this._log=a.Monitoring.Logging.getLogger("coreclients.capi.connection"),this._isIdle=!1,this._isStarted=!1,this._currentSessionId=s.O.empty(),this._getSessionId=function(){return d._currentSessionId};var _=r.__assign(r.__assign({},p||{}),{onWaitForOT:function(e){var t;s.invariant(void 0!==d._onInitResetSent&&void 0!==d._onInitResetFailed,"expected initial connect promise to be initialized at this stage"),d._log.trace("sending initial reset Delta to CAPI"),d._capi.pushChanges(d._contentSource())().then(s.E.fold((function(e){d._onInitResetFailed(e),d._onInitResetFailed=void 0}),s.O.fold(i.constVoid,(function(e){d._onInitResetSent(e),d._onInitResetSent=void 0})))),null===(t=null==p?void 0:p.onWaitForOT)||void 0===t||t.call(p,e)},onSessionStarted:function(e){var t;d._currentSessionId=s.O.some(e.sessionUuid),null===(t=null==p?void 0:p.onSessionStarted)||void 0===t||t.call(p,e)}});this._handler=Object.assign(new l.DefaultCAPIEventHandler,_),this._ws.onMessage((function(e,t){d._capi.isStable(t)&&v.reset()})).onConnecting((function(){d._isIdle=!1})).onConnect((function(){return d._handler.onConnect({kind:"connect"})})).onDisconnect((function(e){if(d._currentSessionId=s.O.none,!d._capi.isClosed()){var t={canGoIdle:d._capi.canGoIdle(),isStable:d._capi.isStable()};d._log.debug("calling reconnect handler:",t),o.pipe(m(e,v,t),(function(t){return d._handler.onDisconnect({kind:"disconnect",reason:e,reconnectCounter:v.retryStatus.iterNumber,reconnectResult:t}),t}),s.E.fold((function(e){d._log.warn("error reconnecting, closing CAPI:",e.message),d._capi.close("error reconnecting:"+e.message)}),(function(e){"idle"===e.kind&&(d._isIdle=!0)})))}}));var v=new c.Reconnect.ReconnectSchedulerImpl((function(){return d.connect(d._contentSource).then((function(e){var t=e[0];e[1];return t}))}),[c.Reconnect.defaultRetryPolicy(g,f)]);this._capi=new u.CAPIClientImpl(y,this._handler,this._ws,{getSessionId:this._getSessionId})}return e.prototype.connect=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return s.invariant(!this._capi.isClosed(),"cannot connect when CAPI is closed"),this._isIdle=!1,this._isStarted=!0,this._contentSource=e,this._log.trace("connect: initializing new ws connection"),[4,this._connect(this._ws)];case 1:return t=r.sent(),this._conn=t,[2,new Promise((function(e,r){n._onInitResetFailed=r,n._onInitResetSent=function(n){return e([t,n])},setTimeout((function(){return r('failed to initialize CAPI: timeout waiting for "wait_for_ot event" to send an initial reset Delta')}),5e3)}))]}}))}))},e.prototype.close=function(e,t){return void 0===e&&(e=c.Reconnect.WsCodes.NORMAL_CLOSURE),r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return n=Boolean(t)?t:"CAPI WS Close called",this._log.trace("close: closing CAPI because: "+n),[4,this._capi.close(n)];case 1:return r.sent(),this._conn?(this._log.debug("close: closing connection because: "+n),[4,this._conn.close({code:e,reason:n})]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},Object.defineProperty(e.prototype,"isIdle",{get:function(){return this._isIdle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisconnected",{get:function(){return this._ws.isDisconnected()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wasStarted",{get:function(){return this._isStarted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"client",{get:function(){return this._capi},enumerable:!1,configurable:!0}),e}();t.CAPIConnection=d},60169:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CAPIHttpClient=void 0;var r=n(18410),i=n(52868),o=function(){function e(e,t,n){this._url=e,this._ajaxFactory=t,this._fingerprints=n,this._ajax=this._ajaxFactory({requestExtender:i.Fingerprints.toHeaderAppender(this._fingerprints)})}return e.prototype.checkText=function(e){var t=r.RequestBuilder.post(this._url,"/check").mime(r.Ajax.MimeType.txt).body(e);return this._ajax.json(t)},e.prototype.getWeeklyStatistics=function(){var e=r.RequestBuilder.get(this._url,"/statistics/product/weekly");return this._ajax.json(e)},e.prototype.getMonthlyStatistics=function(){var e=r.RequestBuilder.get(this._url,"/statistics/product/monthly");return this._ajax.json(e)},e.targetTag="capi",e}();t.CAPIHttpClient=o},59954:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RawAlertValidation=t.AsyncChecksStateManager=t.CAPIClientImpl=t.optimizedOTSerializer=void 0;var r,i,o=n(59312),s=n(57050),a=n(40327),c=n(16595),l=n(81531),u=n(93153),d=n(6760),p=n(70861),h=n(49150),m=n(95302),f=n(67529),g=n(44562),y=n(96804),_=n(76971),v=n(67697),b=n(99727);!function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.WAITING_FOR_OT=3]="WAITING_FOR_OT",e[e.WAITING_FOR_ACK=4]="WAITING_FOR_ACK",e[e.SESSION_INBOUND=5]="SESSION_INBOUND",e[e.ANY=6]="ANY",e[e.CLOSED=7]="CLOSED"}(r||(r={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECT=2]="DISCONNECT",e[e.WAIT=3]="WAIT",e[e.READY=4]="READY",e[e.SEND=5]="SEND",e[e.ACK=6]="ACK",e[e.CLOSE=7]="CLOSE"}(i||(i={}));t.optimizedOTSerializer=function(e){if("string"==typeof e)return e;switch(e.action){case"submit_ot":if(e.chunked)return JSON.stringify(e);var t=o.__assign(o.__assign({},e),{deltasString:void 0,deltas:void 0}),n=JSON.stringify(t);return n.substring(0,n.length-1)+',"deltas": '+e.deltasString+"}";default:return JSON.stringify(e)}};var E=function(){function e(e,t,n,s){var g=this,v=e.context,b=void 0===v?void 0:v,E=e.dialect,w=void 0===E?"undefined":E,A=e.client,C=e.clientVersion,T=void 0===C?"":C,k=e.extDomain,O=void 0===k?void 0:k,N=e.sendDelay,M=void 0===N?50:N,x=e.docid,R=void 0===x?"":x,L=e.clientSupports,D=void 0===L?[]:L,P=e.sduiConfig,U=e.isDemoDoc,F=void 0!==U&&U,j=e.maxMessageSizeKb,B=e.messagePaddingKb,W=e.startSessionOptions,G=void 0===W?{}:W,z=e.idGenerator,H=void 0===z?new p.CappedIdGenerator(y.MAX_SAFE_ID,0,!1):z;this._connectionOptions=s,this._log=l.Monitoring.Logging.getLogger("coreclients.capi",l.Logging.LogLevel.DEBUG),this._queueIdGenerator=new p.CappedIdGenerator(y.MAX_SAFE_ID,0,!1),this._textSize=0,this._asyncChecksManager=new I,this._pingsMap=new Map,this._validateAlert=S.validate,this._statsRequester=new m.ValueRequester(15e3,"CAPI.DocStats"),this._synonymsRequester=new m.ValueRequester(15e3,"CAPI.Synonyms"),this._getTextRequester=new m.ValueRequester(15e3,"CAPI.Text"),this._commandsRequester=new m.ValueRequester(15e3,"CAPI.Commands"),this._otChunksNotifier=new m.ValueNotifier(15e3,"CAPI.OT.Chunks"),this.reportLensFeedback=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:t,lens:e},g._commandsRequester)},this.reportSystemFeedback=function(e){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:e},g._commandsRequester)},this.reportEmotionFeedback=function(e,t,n){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:t,emotion:e,subtype:n},g._commandsRequester)},this.reportEmotionSentenceFeedback=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:t,alertId:e},g._commandsRequester)},this.reportMuteFeedback=function(e,t,n){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:n,userMuteScope:t,userMuteCategories:e},g._commandsRequester)},this.reportAutocorrectFeedback=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:e,before:t.before,after:t.after,context:t.context,expected:t.expected},g._commandsRequester)},this.reportAutocompleteFeedback=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:e,alertId:t.alertId,begin:t.begin,end:t.end,context:t.context,before:t.before,after:t.after,text:t.text,pname:t.pname},g._commandsRequester)},this.reportAutocompleteRejectedFeedback=function(e){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:f.AutocompleteFeedbackType.COMPLETION_REJECTED,alertId:e.alertId,begin:e.begin,end:e.end,context:e.context,before:e.before,after:e.after,text:e.text,pname:e.pname,subtype:e.subtype},g._commandsRequester)},this.reportSnippetFeedback=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"feedback",type:e,snippetUuid:t},g._commandsRequester)},this.requestSynonyms=function(e,t){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"synonyms",begin:e,token:t},g._synonymsRequester)},this.shortenItSubmit=function(e){return a.pipe(c.TE.rightIO((function(){g._log.trace("shorten-it submit")})),c.TE.chain((function(){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"shorten_it_submit",alertId:e},g._commandsRequester)})))},this.requestDocStats=this._sendLazyInbandCommand((function(){return{id:g._idGenerator.newId(),action:"get_text_stats"}}),this._statsRequester),this.enablePlagiarismSearch=a.pipe(c.TE.rightIO((function(){g._log.trace("Enable plagiarism search"),g._asyncChecksManager.resetCheck("plagiarism")})),c.TE.chain((function(){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"toggle_checks",checks:{plagiarism:!0}},g._commandsRequester)}))),this.disablePlagiarismSearch=this._sendLazyInbandCommand((function(){return{id:g._idGenerator.newId(),action:"toggle_checks",checks:{plagiarism:!1}}}),this._commandsRequester),this.realtimeProofitSubmit=function(e){return g._log.trace("Submit real-time Proofit job"),g._sendInbandCommand({id:g._idGenerator.newId(),action:"realtime_proofit_submit",reconnect:e},g._commandsRequester)},this.realtimeProofitCancel=a.pipe(c.TE.rightIO((function(){g._log.trace("Cancel real-time Proofit job")})),c.TE.chain((function(){return g._sendInbandCommand({id:g._idGenerator.newId(),action:"realtime_proofit_cancel"},g._commandsRequester)}))),this.submitRecipients=function(e){return g._log.trace("Submit recipients for better suggestions!"),g._sendInbandCommand({id:g._idGenerator.newId(),action:"submit_recipients",recipients:e},g._commandsRequester)},this.ping=this._sendLazyInbandCommand((function(){return{id:g._idGenerator.newId(),action:"ping"}}),this._commandsRequester),this.canGoIdle=function(){return g._changesQueue.isEmpty&&!g._changesQueue.isStaging},this.isStable=function(e){var t=void 0===e?g._idGenerator.id:g._idGenerator.id+1;return(void 0===e||"error"!==e.action)&&t>5},this._startSession=function(){return o.__awaiter(g,void 0,void 0,(function(){var e,t,n,r;return o.__generator(this,(function(s){switch(s.label){case 0:return this._log.trace("_startSession"),this._idGenerator.reset(),this._queueIdGenerator.reset(),e="session start",this._clear(e),this._commandsRequester.clear(e),this._statsRequester.clear(e),this._synonymsRequester.clear(e),this._getTextRequester.clear(e),"function"!=typeof this._startSessionOptions?[3,2]:[4,this._startSessionOptions()];case 1:return n=s.sent(),[3,3];case 2:n=this._startSessionOptions,s.label=3;case 3:return t=n,r=o.__assign(o.__assign({id:this._idGenerator.newId(),action:"start",client:this._client.type,clientSubtype:this._client.sub,clientVersion:this._clientVersion,dialect:this._dialect,docid:this._docid,extDomain:this._extDomain,documentContext:this._context&&u.DocumentContext.serialize(this._context),clientSupports:this._clientSupports,isDemoDoc:this._isDemoDoc},void 0!==this._sduiConfig?{sdui:this._sduiConfig}:{}),t),this._queueIdGenerator.newId(),[4,this._fsm.event(i.SEND)];case 4:return s.sent(),this._sendMessage(r),[2]}}))}))},this._handleStart=function(e){g._log.trace("_handleStart"),g._fsm.event(i.ACK);var t=e.userMutedCategories,n=e.domainCategory,o=e.domainName,s=e.isEnterprise,a=e.defaultDocumentContext,c=e.sessionUuid;g._handler.onSessionStarted({kind:"session_started",userMutedCategories:t,domainCategory:n,domainName:o,isEnterprise:s,defaultDocumentContext:u.DocumentContext.parseDefault(a),sessionUuid:c}),g._fsm.is(r.CONNECTED)&&g._fsm.event(i.WAIT)},this._waitForSubmitOt=function(){g._handler.onWaitForOT({kind:"wait_for_ot"})},this._sessionInbound=function(e){g._handler.onSessionInbound({kind:"session_inbound"}),g._trySend(e)},this._canSend=function(){return!g._fsm.is(r.DISCONNECTED,r.CONNECTING,r.CLOSED)},this._send=function(){return o.__awaiter(g,void 0,void 0,(function(){var e,t,n=this;return o.__generator(this,(function(s){switch(s.label){case 0:return this._resetTimer(),!this._fsm.is(r.SESSION_INBOUND)||this._changesQueue.isEmpty?[3,6]:[4,this._fsm.event(i.SEND)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,4,,5]),e=this._changesQueue.poll(),[4,a.pipe(e,c.O.map((function(e){return o.__awaiter(n,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return t=_.ChangesQueue.isChange(e),[4,this._sendMessage(this._processQueueMessage(e))];case 1:return n.sent(),t?[3,3]:[4,this._fsm.event(i.ACK)];case 2:n.sent()?this._changesQueue.ackOperation(e.id):this._log.debug("can not do ack for non change msg because we are in unexpected state",{state:r[this._fsm.current]}),n.label=3;case 3:return[2]}}))}))})))];case 3:return s.sent(),[3,5];case 4:return t=s.sent(),this._log.error("unexpected error on sending",t),[3,5];case 5:return[3,7];case 6:this._trySend(this._fsm.current),s.label=7;case 7:return[2]}}))}))},this._processQueueMessage=function(e){return _.ChangesQueue.isChange(e)?g._processSubmitOTMessage(e):g._shouldHaveSeparateRevision(e.cmd)?o.__assign(o.__assign({},e.cmd),{rev:e.rev,id:e.id}):o.__assign(o.__assign({},e.cmd),{id:e.id})},this._resetTimer=function(){void 0!==g._timeout&&(clearTimeout(g._timeout),g._timeout=void 0)},this._onQueueMsgAccepted=function(e){g._handler.onQueueMsgAccepted({kind:"queue_msg_accepted",message:e})},this._onQueueMsgDropped=function(e,t){e.filter(_.ChangesQueue.isCmd).forEach((function(e){var n=new m.DroppedError("message dropped from queue:"+t);switch(e.cmd.action){case"ping":case"option":case"toggle_checks":case"set_context":case"feedback":g._commandsRequester.onError(e.id,n);break;case"get_text_stats":g._statsRequester.onError(e.id,n);break;case"synonyms":g._synonymsRequester.onError(e.id,n);break;case"get_debug_info":g._getTextRequester.onError(e.id,n)}})),g._handler.onQueueMsgDropped({kind:"queue_msgs_dropped",messages:e,reason:t})},this._handler=t,this._context=b,this._dialect=w,this._client=A,this._clientVersion=T,this._extDomain=O,this._sendDelay=M,this._docid=R,this._clientSupports=D,this._sduiConfig=P,this._isDemoDoc=F,this._startSessionOptions=G,this._idGenerator=H,this._changesQueue=new _.CapiQueue(this._shouldHaveSeparateRevision,this._onQueueMsgAccepted,this._onQueueMsgDropped,(function(){return g._queueIdGenerator.newId()}),j,B),this._fsm=new d.StateMachine("capi",r.DISCONNECTED,r.CLOSED).with(r.ANY).parentOf(r.CONNECTED,r.CONNECTING,r.DISCONNECTED,r.WAITING_FOR_OT,r.WAITING_FOR_ACK,r.SESSION_INBOUND).from(r.ANY).to(r.CLOSED).on(i.CLOSE).from(r.DISCONNECTED).to(r.CONNECTING).on(i.CONNECT).from(r.CONNECTING).to(r.CONNECTING).on(i.CONNECT).from(r.CONNECTING).to(r.CONNECTED).on(i.CONNECTED).from(r.CONNECTED,r.WAITING_FOR_OT,r.WAITING_FOR_ACK,r.SESSION_INBOUND,r.CONNECTING).to(r.DISCONNECTED).on(i.DISCONNECT).from(r.CONNECTED).to(r.WAITING_FOR_OT).on(i.WAIT).from(r.CONNECTED,r.WAITING_FOR_OT).to(r.SESSION_INBOUND).on(i.READY).from(r.SESSION_INBOUND).to(r.WAITING_FOR_ACK).on(i.SEND).from(r.WAITING_FOR_ACK).to(r.SESSION_INBOUND).on(i.ACK).on(r.CONNECTED,this._startSession).on(r.WAITING_FOR_OT,this._waitForSubmitOt).on(r.SESSION_INBOUND,(function(e){return g._sessionInbound(e.to)})).on(r.DISCONNECTED,(function(e){return g._clear(e.args)})),this._log.isEnabled(l.Logging.LogLevel.TRACE)&&this._fsm.verbose(r,i),n.onConnecting((function(){return g._handleConnecting()})).onConnect((function(e){return g._handleConnect(e)})).onDisconnect((function(e){return g._handleDisconnect(e)})).onMessage((function(e,t){return g._handleMessage(t)})),c.registerDebugHelper("closeCapiSocket",(function(e,t){void 0===e&&(e=1e3),null!==g._conn&&g._conn._ws.close(e,t)})),c.registerDebugHelper("capiState",this),c.registerDebugHelper("capiReadyToReceive",(function(){return g._fsm.is(r.SESSION_INBOUND)&&g._changesQueue.isEmpty})),c.registerDebugHelper("capiRuntimeError",(function(){var e=h.Change.ins(0,"test",100500);g.pushChanges(e)}))}return e.prototype.pushChanges=function(e){return this._pushChangesTask(e)},Object.defineProperty(e.prototype,"checkingState",{get:function(){return 0===this._checkedTextSize||1===this._textSize?"idle":this._checkedTextSize>f.BIG_TEXT_SIZE&&this._textSize>f.BIG_TEXT_SIZE/3?"full":"checking"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asyncChecksState",{get:function(){return this._asyncChecksManager.getState()},enumerable:!1,configurable:!0}),e.prototype.setSessionOption=function(e){switch(e.kind){case f.CAPISessionOptionType.Context:return this.setContext(e.context);case f.CAPISessionOptionType.GnarContainerId:return this.setOption(e.kind,e.id);default:return c.assertNever(e)}},e.prototype.setContext=function(e){return this._log.debug("setContext(...)"),this._context=e,this._sendInbandCommand({action:"set_context",id:this._idGenerator.newId(),rev:-1,documentContext:u.DocumentContext.serialize(e)},this._commandsRequester)},e.prototype.setOption=function(e,t){return this._log.trace("Set option "+t),this._sendInbandCommand({id:this._idGenerator.newId(),action:"option",name:e,value:t},this._commandsRequester)},e.prototype.sendUserAction=function(e,t){var n=this;return this._log.debug("sendUserAction",{componentId:e,userAction:t}),a.pipe(this._connectionOptions.getSessionId(),c.E.fromOption((function(){return new Error("Can not sendUserAction because sessionId is empty")})),c.TE.fromEither,c.TE.chain((function(r){return n._sendInbandCommand({id:n._idGenerator.newId(),action:"user_action",sessionId:r,componentId:e,userAction:t},n._commandsRequester)})))},e.prototype.sendDebugReport=function(e,t){return this._log.debug("sendDebugReport",{alertId:e,errorMessage:t}),this._sendInbandCommand({id:this._idGenerator.newId(),action:"debug_report",type:"sdui_decode_error",alertId:e,errorMessage:t},this._commandsRequester)},e.prototype.sendFeedback=function(e){switch(this._log.debug("sendFeedback",e.kind),e.kind){case f.AlertFeedbackType.ACCEPTED:return this._sendAlertAcceptedFeedback(e);case f.AlertFeedbackType.IGNORE:return this.reportIgnoreFeedback(e.id,e.reason,e.subtype,e.pnameQualifier,e.drilldownSuggestionIds);case f.AlertFeedbackType.ACKNOWLEDGED:return this.reportAcknowledgeFeedback(e.id,e.subtype,e.pnameQualifier);case f.AlertFeedbackType.ADD_TO_DICTIONARY:case f.AlertFeedbackType.LOOKED:case f.AlertFeedbackType.CLOSED:case f.AlertFeedbackType.LIKE:case f.AlertFeedbackType.DISLIKE:case f.AlertFeedbackType.WRONG_SUGGESTION:case f.AlertFeedbackType.OFFENSIVE_CONTENT:case f.AlertFeedbackType.EXPANDED:case f.AlertFeedbackType.IGNORE_BULK_ACCEPTED:case f.AlertFeedbackType.HIDE:return this.reportAlertFeedback(e.id,e.kind,e.subtype);case f.DrilldownFeedbackType.DRILLDOWN:return this._reportDrilldownFeedback(e.id,e.alternativeIndex,e.drilldownSuggestionIds,e.subtype);case f.SynonymFeedbackType.SYNONYM_ACCEPTED:return this.reportSynonymFeedback(e.id,e.kind,e.replacementText,e.subtype);case f.SynonymFeedbackType.SYNONYM_DISMISSED:return this.reportSynonymFeedback(e.id,e.kind,e.subtype);case f.EmotionFeedbackType.EMOTION_LIKE:case f.EmotionFeedbackType.EMOTION_DISLIKE:case f.EmotionFeedbackType.EMOTION_OFFENSIVE:return this.reportEmotionFeedback(e.emotionName,e.kind,e.subtype);case f.EmotionSentenceFeedbackType.EMOTION_SENTENCE_LIKE:case f.EmotionSentenceFeedbackType.EMOTION_SENTENCE_DISLIKE:return this.reportEmotionSentenceFeedback(e.id,e.kind);case f.MutedFeedbackType.MUTE:case f.MutedFeedbackType.UNMUTE:return this.reportMuteFeedback(e.userMuteCategories,e.userMuteScope,e.kind);case f.SystemFeedbackType.RECHECK_SHOWN:return this.reportSystemFeedback(e.kind);case f.LensFeedbackType.LENS_CLOSE:case f.LensFeedbackType.LENS_OPEN:case f.LensFeedbackType.DISMISS_BY_LENS:return this.reportLensFeedback(e.lensName,e.kind);case f.AutocorrectFeedbackType.AUTOCORRECT_ACCEPT:case f.AutocorrectFeedbackType.AUTOCORRECT_DISMISS:case f.AutocorrectFeedbackType.AUTOCORRECT_REPLACE:return this.reportAutocorrectFeedback(e.kind,e);case f.AutocompleteFeedbackType.COMPLETION_REJECTED:return this.reportAutocompleteRejectedFeedback(e);case f.AutocompleteFeedbackType.COMPLETION_ACCEPTED:case f.AutocompleteFeedbackType.COMPLETION_IGNORED:case f.AutocompleteFeedbackType.COMPLETION_SHOWN:return this.reportAutocompleteFeedback(e.kind,e);case f.AlertsBatchFeedbackType.BULK_ACCEPTED:return this.reportAlertsBatchFeedback(e.alertIds,e.kind,e.subtype);case f.SnippetsFeedbackType.SNIPPET_ACCEPTED:return this.reportSnippetFeedback(e.kind,e.snippetUuid);default:return c.assertNever(e)}},e.prototype._reportDrilldownFeedback=function(e,t,n,r){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.DrilldownFeedbackType.DRILLDOWN,alertId:e,alternativeIndex:t,drilldownSuggestionIds:n,subtype:r},this._commandsRequester)},e.prototype._sendAlertAcceptedFeedback=function(e){return"replacementText"in e?this._reportTextAlertAcceptedFeedback(e.id,e.replacementText,e.subtype,e.reason):"alternativeIndex"in e?this._reportTransformJsonAlertAcceptedFeedback(e.id,e.alternativeIndex,e.gapValue,e.subtype,e.drilldownSuggestionIds,e.dismissedTransformGroups,e.reason):c.assertNever(e)},e.prototype.reportIgnoreFeedback=function(e,t,n,r,i){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.AlertFeedbackType.IGNORE,alertId:e,userReason:t,subtype:n,pnameQualifier:r,drilldownSuggestionIds:i},this._commandsRequester)},e.prototype.reportAcknowledgeFeedback=function(e,t,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.AlertFeedbackType.ACKNOWLEDGED,alertId:e,subtype:t,pnameQualifier:n},this._commandsRequester)},e.prototype.reportAlertFeedback=function(e,t,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertId:e,subtype:n},this._commandsRequester)},e.prototype.reportAlertsBatchFeedback=function(e,t,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertIds:e,subtype:n},this._commandsRequester)},e.prototype._reportTextAlertAcceptedFeedback=function(e,t,n,r){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.AlertFeedbackType.ACCEPTED,alertId:e,text:t,subtype:n,userReason:r},this._commandsRequester)},e.prototype._reportTransformJsonAlertAcceptedFeedback=function(e,t,n,r,i,o,s){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.AlertFeedbackType.ACCEPTED,alertId:e,alternativeIndex:t,gapValue:n,subtype:r,drilldownSuggestionIds:i,dismissedTransformGroups:o,userReason:s},this._commandsRequester)},e.prototype.reportSynonymFeedback=function(e,t,n,r){switch(t){case f.SynonymFeedbackType.SYNONYM_ACCEPTED:var i={id:this._idGenerator.newId(),action:"feedback",type:f.SynonymFeedbackType.SYNONYM_ACCEPTED,text:n,alertId:e,subtype:r};return this._sendInbandCommand(i,this._commandsRequester);case f.SynonymFeedbackType.SYNONYM_DISMISSED:return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:f.SynonymFeedbackType.SYNONYM_DISMISSED,alertId:e,subtype:r},this._commandsRequester);default:return c.assertNever(t)}},e.prototype.isClosed=function(){return this._fsm.is(r.CLOSED)},e.prototype.close=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return this.isClosed()?(this._log.trace("close: CAPI already closed, skipping"),[2]):(this._log.trace("close: closing CAPI"),[4,this._fsm.event(i.CLOSE,e)]);case 1:return t.sent()?this._clear(e):this._log.error("Cannot go to CLOSED state"),[2]}}))}))},e.prototype.getText=function(){return c.TE.toPromise(this._sendInbandCommand({id:this._idGenerator.newId(),action:"get_debug_info"},this._getTextRequester))},e.prototype._handleConnecting=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this._fsm.event(i.CONNECT)];case 1:return e.sent()||this._log.error("Can not enter CONNECTING state",{fsmState:r[this._fsm.current]}),[2]}}))}))},e.prototype._handleConnect=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(o){switch(o.label){case 0:this._log.trace("_handleConnect("+r[this._fsm.current]+"): received new ws connection"),this._conn=e,t=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._fsm.event(i.CONNECTED)];case 2:return o.sent()||(t="failed to switch to CONNECTED state"),[3,4];case 3:return n=o.sent(),t=n,[3,4];case 4:if(Boolean(t))throw this._log.warn("Connection cannot be finalized.",t),t;return[2]}}))}))},e.prototype._handleDisconnect=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(o){switch(o.label){case 0:return this._log.trace("_handleDisconnect("+r[this._fsm.current]+")",e),[4,this._fsm.event(i.DISCONNECT,e.reason)];case 1:return t=o.sent(),n=this._fsm.is(r.CLOSED)?l.Logging.LogLevel.WARN:l.Logging.LogLevel.ERROR,t||this._log.log(n,"Can not enter DISCONNECTED state",{reason:e,fsmState:r[this._fsm.current]}),[2]}}))}))},e.prototype._handleMessage=function(e){switch(this._handler.onMessageReceived({kind:"message_received",message:e}),this._log.isEnabled(l.Logging.LogLevel.TRACE)&&this._log.trace("Message <<< "+JSON.stringify(e).replace("\n"," ").substring(0,300)),e.action){case"start":this._handleStart(e);break;case"alert":this._handleAlert(e);break;case"remove":this._handler.onRemove({kind:"alert_removed",alertId:f.RawAlert.Id.create(e.id),hint:a.pipe(c.O.fromNullable(e.hint),c.O.filter((function(e){return e===g.AlertRemoveHint.NotFixed}))),mergedIn:a.pipe(c.O.fromNullable(e.mergedIn),c.O.map((function(e){return f.RawAlert.Id.create(e)})))});break;case"alert_changes":this._handleAlertChange(e);break;case"finished":this._handleFinish(e);break;case"async_check_finished":this._handleAsyncCheckFinished(e);break;case"complete":this._handleComplete(e);break;case"heatmap":this._handleAttentionHeatmap(e);break;case"attention_widget":this._handleAttentionInfo(e);break;case"submit_ot":this._handleSubmitOtAck(e);break;case"submit_ot_chunk":this._handleSubmitOtChunkAck(e);break;case"feedback":case"option":case"toggle_checks":case"set_context":case"submit_recipients":case"user_action":case"debug_report":this._handleCommandAck(e);break;case"perfstats":this._handleAck(e);break;case"error":this._handleError(e);break;case"pong":this._handlePong(e);break;case"synonyms":this._handleSynonyms(e);break;case"text_stats":this._handleTextStats(e);break;case"text_maps":this._handleTextMaps(e);break;case"text_info":this._handleTextInfo(e);break;case"emotions":this._handleEmotions(e);break;case"debug_info":this._handler.onDebugInfo({kind:"debug_info",info:e}),this._getTextRequester.onValue(e.id,e.text);break;case"realtime_proofit_availability":this._handleProofitAvailability(e);break;case"realtime_proofit_submit_resp":this._handleProofitSubmit(e);break;case"realtime_proofit_progress":this._handleProofitProgress(e);break;case"realtime_proofit_cancel_resp":this._handleProofitCancelled(e);break;case"shorten_it_submit":this._handleCommandAck(e);break;case"shorten_it_finished":this._handleShortenItFinished(e);break;default:this._log.error("Unknown message",{message:e}),c.assertNever(e)}},e.prototype._handleAlert=function(e){var t=this;this._handler.beforeAlert({kind:"before_alert"});var n=f.RawAlert.fromAlertMessage(e);this._log.trace("_handleAlert");var r=this._changesQueue.transformAlertAgainstQueue(n);a.pipe(r,c.E.fromOption((function(){return new Error("position overlap: "+JSON.stringify(n).substring(0,200))})),c.E.chain(this._validateAlert),c.E.fold((function(e){t._log.isEnabled(l.Logging.LogLevel.TRACE)&&t._log.trace("OT ALERT: discarding alert due to error",e)}),(function(e){return t._handler.onAlert({kind:"alert_received",alert:e})})))},e.prototype._handleAlertChange=function(e){return a.pipe({kind:"alert_changed",alertId:f.RawAlert.Id.create(e.id),rev:e.rev,extraProperties:e.extra_properties&&f.RawAlert.parseExtraProperties(e.extra_properties),transformJson:e.transformJson&&f.RelRawTransform.toAbs(e.transformJson),muted:e.muted,sdui:e.sdui},this._changesQueue.transformChangeAgainstQueue,c.O.fold(s.constVoid,this._handler.onChange))},e.prototype._handleComplete=function(e){this._handler.onAutoComplete({kind:"autocomplete_received",complete:e})},e.prototype._handleAttentionHeatmap=function(e){var t=f.RawAttentionHeatmap.fromAttentionHeatmapMessage(e);this._handler.onAttentionHeatmap({kind:"attention_heatmap_received",heatmap:this._changesQueue.transformAttentionHeatmapAgainstQueue(t)})},e.prototype._handleAttentionInfo=function(e){var t;2===e.version?this._handler.onAttentionInfo({kind:"attention_info_received",rev:e.rev,wordsCount:e.wordsCount,checklist:e.checklist.map(v.AttentionChecklistItem.fromRaw),headerMessage:e.headerMessage,predictionMessage:e.predictionMessage,hidden:null!==(t=e.hidden)&&void 0!==t&&t}):this._log.error("Got an unsupported attention_widget message version",e)},e.prototype._handleTextMaps=function(e){var t={score:e.score,generalScore:e.generalScore,textMaps:e.textMaps};this._handler.onTextMaps({kind:"text_maps",data:t})},e.prototype._handleTextInfo=function(e){var t={wordsCount:e.wordsCount,charsCount:e.charsCount-1,readingTime:b.DocumentStatistics.calculateReadingTime(e.wordsCount),speakingTime:b.DocumentStatistics.calculateSpeakingTime(e.wordsCount),readabilityScore:e.readabilityScore,messages:c.O.fromNullable(e.messages),sessionStats:e.sessionStats};this._handler.onTextInfo({kind:"text_info",data:t})},e.prototype._handleEmotions=function(e){this._handler.onEmotions({kind:"emotions",emotions:e.emotions,institutionLogo:e.institutionLogo,brandTonesEnabled:e.brandTonesEnabled,hidden:e.hidden})},e.prototype._handleProofitAvailability=function(e){this._handler.onProofitAvailability({id:e.id,kind:"realtime_proofit_availability",available:e.available,quota:e.quota})},e.prototype._handleProofitSubmit=function(e){this._handler.onProofitSubmit({id:e.id,kind:"realtime_proofit_submit_resp",status:e.status})},e.prototype._handleProofitProgress=function(e){"in_progress"===e.status?this._handler.onProofitProgress(o.__assign({kind:"realtime_proofit_in_progress"},e)):"completed"===e.status?this._handler.onProofitCompleted(o.__assign({kind:"realtime_proofit_completed"},e)):"error"===e.status?this._handler.onProofitProgressProblem(o.__assign({kind:"realtime_proofit_progress_error"},e)):"rejected"===e.status&&this._handler.onProofitProgressProblem(o.__assign({kind:"realtime_proofit_progress_rejected"},e))},e.prototype._handleProofitCancelled=function(e){this._handler.onProofitCancelled({id:e.id,kind:"realtime_proofit_cancel_resp",refunded:e.refunded,quota:e.quota})},e.prototype._handleShortenItFinished=function(e){this._handler.onShortenItFinished({kind:"shorten_it_finished",alertId:f.RawAlert.Id.create(e.alertId)})},e.prototype._handleFinish=function(e){this._log.trace("_handleFinish"),this._handler.onBeforeFinish({kind:"before_finish"}),this._changesQueue.ackRevision(e.rev);var t=this._createFinishEvent(e);this._handler.onFinish(t)},e.prototype._handleAsyncCheckFinished=function(e){this._handler.onBeforeAsyncCheckFinish({kind:"before_async_check_finish"}),this._asyncChecksManager.finish(e),this._handler.onAsyncCheckFinish({kind:"async_check_finished",check:e.check,revision:e.rev,outcomeScores:e.outcomeScores})},e.prototype._handleSubmitOtAck=function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._fsm.is(r.WAITING_FOR_ACK)?(this._handleAck(e),this._changesQueue.ackOperation(e.id),this._fsm.event(i.ACK)):this._log.error("Got an unexpected submit_ot ack",{curentState:r[this._fsm.current]})},e.prototype._sendNextOtChunk=function(e){var t=this;return 0===e.chunks.length?(this._log.trace("no more chunks, sending final submit_ot message"),c.TE.tryCatch((function(){return o.__awaiter(t,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this._sendMessage(e.submitOt)];case 1:return[2,t.sent()]}}))}))}),(function(e){return new Error("failed to send final submit_ot message: "+e)}))):(this._log.trace("sending next submit_ot chunk"),a.pipe(c.TE.tryCatch((function(){return o.__awaiter(t,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return t=e.chunks.splice(0,1)[0],[4,this._sendMessage(t)];case 1:return n.sent(),[2,t]}}))}))}),(function(e){return new Error("failed to send next chunk message: "+e)})),c.TE.chain((function(n){return t._waitForOtChunkAck(n,e)}))))},e.prototype._waitForOtChunkAck=function(e,t){var n=this;return a.pipe(this._otChunksNotifier.waitFor(e.id,t),c.TE.chain(this._sendNextOtChunk.bind(this)),c.TE.mapLeft((function(e){return n._log.error("failed sending OT chunks",e),e})))},e.prototype._handleSubmitOtChunkAck=function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._otChunksNotifier.notify(e.id)},e.prototype._handleCommandAck=function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._commandsRequester.onValue(e.id),this._handleAck(e)},e.prototype._handleAck=function(e){a.pipe(w(e),c.O.fold(s.constNull,this._handler.onAck))},e.prototype._handlePong=function(e){var t=self.performance.now();this._handler.onPong({kind:"pong",latency:a.pipe(c.O.fromNullable(this._pingsMap.get(e.id)),c.O.map((function(e){return t-e})))})},e.prototype._handleSynonyms=function(e){var t=this._parseSynonymsResult(e);this._handler.onSynonyms({kind:"synonyms",synonyms:t,word:e.token,position:e.synonyms.pos}),this._synonymsRequester.onValue(e.id,t)},e.prototype._handleTextStats=function(e){e.readingTime=b.DocumentStatistics.calculateReadingTime(e.words),e.speakingTime=b.DocumentStatistics.calculateSpeakingTime(e.words),this._handler.onStats({kind:"stats",stats:e}),this._statsRequester.onValue(e.id,e)},e.prototype._createFinishEvent=function(e){return{kind:"finish",revision:e.rev,score:a.pipe(c.O.fromNullable(e.generalScore),c.O.filter((function(e){return e>=0})),c.O.map((function(t){return{errorRateScore:e.score,rank:t}}))),scoreStatus:c.O.fromNullable(e.scoresStatus),removed:new Set(e.removed),dialect:e.dialect,outcomeScores:y.Message.OutcomeScores.normalize(e.outcomeScores),foreign:e.foreign}},e.prototype._parseSynonymsResult=function(e){var t=this,n=function(e){return e.derived};return{id:e.id.toString(),originalWord:e.token,synonymsOrGroups:function(e){return 0===e.synonyms.meanings.length?c.O.none:1===e.synonyms.meanings.length?c.O.some(c.E.left(e.synonyms.meanings[0].synonyms.map(n))):c.O.some(c.E.right(e.synonyms.meanings.map((function(r){return void 0===r.meaning&&t._log.warn("Absent meaning in synonyms group.",{token:e.token}),{meaning:Boolean(r.meaning)?r.meaning:"",words:r.synonyms.map(n)}}))))}(e),pname:e.synonyms.pname}},e.prototype._trySend=function(e){void 0===this._timeout&&e===r.SESSION_INBOUND?this._timeout=self.setTimeout(this._send,this._sendDelay):e!==r.WAITING_FOR_OT||this._changesQueue.isEmpty?this._log.trace("_trySend("+r[e]+") send timeout already set or not waiting for ot, ignoring"):(this._log.trace("_trySend("+r[e]+") moving to READY"),this._fsm.event(i.READY),this._handler.onReady({kind:"ready"}))},e.prototype._shouldHaveSeparateRevision=function(e){return"set_context"===e.action},e.prototype._pushChangesTask=function(e){var t=this;this._log.debug("pushChanges("+r[this._fsm.current]+"):",e.kind);return h.Change.isReset(e)&&this._fsm.is(r.SESSION_INBOUND,r.WAITING_FOR_ACK)?(this._log.debug("pushChanges("+r[this._fsm.current]+"): got reset while active session, starting new session"),function(){return o.__awaiter(t,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:this._log.debug("pushChanges("+r[this._fsm.current]+"): starting new session"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._startSession()];case 2:return n.sent(),[2,this._pushChanges(e)];case 3:return t=n.sent(),this._log.warn("pushChanges("+r[this._fsm.current]+"): failed sending start message: ",t),[2,c.E.left(t)];case 4:return[2]}}))}))}):c.TE.fromIOEither((function(){return t._pushChanges(e)}))},e.prototype._pushChanges=function(e){var t=this;if(!this._canSend())return this._log.debug("pushChanges: cannot send, rejecting changes",e.kind),c.E.left(new m.NotConnectedError("Cannot accepts changes as WS connection is down"));var n=function(e){t._asyncChecksManager.stage(t._changesQueue.localRevision);var n=t._changesQueue.pushChanges(e);return t._textSize=e.prevLen+e.length,t._trySend(t._fsm.current),c.E.right(c.O.some(n))};return h.Change.isDelta(e)?this._fsm.is(r.WAITING_FOR_OT)?c.E.left(new m.NotReadyError("Capi is waiting for reset change but got a delta, dropping change")):n(e):h.Change.isReset(e)?n(h.Change.delta(e.delta)):(this._changesQueue.isEmpty||this.ping(),c.E.right(c.O.none))},e.prototype._sendInbandCommand=function(e,t){return this._sendLazyInbandCommand((function(){return e}),t)},e.prototype._sendLazyInbandCommand=function(e,t){var n=this;return function(){var i=e();if(n._log.trace("_sendInbandCommand("+r[n._fsm.current]+"): ",i.action),n._canSend()){var o=n._changesQueue.isEmpty,s=n._changesQueue.pushCommand(i),a=t.watchRequest(s);return o?(n._log.trace("_sendInbandCommand: Q.isEmpty, sending command immediately"),n._send()):(n._log.trace("_sendInbandCommand: Q.notEmpty, delaying sending command"),n._trySend(n._fsm.current)),a}return n._log.debug("_sendInbandCommand: cannot send, rejecting command",i.action),Promise.resolve(c.E.left(new m.NotConnectedError("Cannot send commands as WS connection is down")))}},e.prototype._processSubmitOTMessage=function(e){if(_.ChangesQueue.isChunkedChange(e)){var t=e.chunks.map((function(e){return{id:e.id,action:"submit_ot_chunk",chunk:e.chunk}})),n=t.splice(0,1)[0],r={chunks:t,submitOt:{id:e.id,action:"submit_ot",rev:e.rev,doc_len:e.change.prevLen,chunked:!0}};return this._waitForOtChunkAck(n,r)(),n}return{id:e.id,action:"submit_ot",rev:e.rev,doc_len:e.change.prevLen,deltas:[e.change.delta],deltasString:e.deltasString,chunked:!1}},e.prototype._sendMessage=function(e){var t=this;return this._log.isEnabled(l.Logging.LogLevel.TRACE)&&this._log.trace("Sending >>>> "+JSON.stringify(e).replace("\n"," ").substring(0,300)),this._handler.onMessageSent({kind:"message_sent",message:e}),"ping"===e.action&&this._pingsMap.set(e.id,self.performance.now()),c.expectNonNull(this._conn,"_sendMessage should never be called without a connection").send(e).catch((function(e){return t._log.debug("fail on send",e)}))},Object.defineProperty(e.prototype,"_checkedTextSize",{get:function(){return this._changesQueue.stagedAmount},enumerable:!1,configurable:!0}),e.prototype._clear=function(e){this._log.debug("clearing message queue, reason: "+e),this._pingsMap.clear(),this._changesQueue.isEmpty||this._log.warn("clean queue with messages",{reason:e,queue:this._changesQueue.toJSON()}),this._changesQueue.clear(e),this._asyncChecksManager.reset(),this._resetTimer()},e.prototype._handleError=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(e.error){case f.ErrorCode.CANNOT_GET_TEXT_STATS:this._statsRequester.onError(e.id,new Error("Server Error"));break;case f.ErrorCode.CANNOT_FIND_SYNONYM:this._synonymsRequester.onError(e.id,new Error("can not find synonym"));break;case f.ErrorCode.RUNTIME_ERROR:this._fsm.is(r.WAITING_FOR_ACK)?(this._log.error("Got runtime_error for submit_ot",{message:e}),this._clear("runtime_error on submit_ot")):this._clear("runtime_error");break;default:this._handler.onError(o.__assign({kind:"error"},e)),this._log.error("Error",{message:e})}return[2]}))}))},e}();t.CAPIClientImpl=E;var I=function(){function e(){this._wasChecked={plagiarism:!1},this.reset()}return e.prototype.getState=function(){return{plagiarism:this._pendingRevision>this._finishedRevisions.plagiarism?this._wasChecked.plagiarism?"checking":"full":"idle"}},e.prototype.stage=function(e){this._pendingRevision=Math.max(this._pendingRevision,e)},e.prototype.finish=function(e){this._finishedRevisions[e.check]=Math.max(this._finishedRevisions[e.check],e.rev),this._wasChecked[e.check]=!0},e.prototype.reset=function(){this._pendingRevision=0,this._finishedRevisions={plagiarism:-1}},e.prototype.resetCheck=function(e){this._finishedRevisions[e]=-1},e}();t.AsyncChecksStateManager=I;var S,w=function(e){switch(e.action){case"option":return c.O.some({kind:"option_ack"});case"set_context":return c.O.some({kind:"set_context_ack",revision:e.rev});case"submit_recipients":return c.O.some({kind:"submit_recipients_ack"});case"toggle_checks":return c.O.some({kind:"toggle_checks_ack"});case"submit_ot":return c.O.some({kind:"set_context_ack",revision:e.rev});case"feedback":return c.O.some({kind:"feedback_ack",outcomeScores:e.scores?y.Message.OutcomeScores.normalize(e.scores):void 0,scoreStatus:e.scoresStatus});case"submit_ot_chunk":case"shorten_it_submit":case"perfstats":case"user_action":case"debug_report":return c.O.none;default:return c.assertNever(e)}};!function(e){e.validate=function(e){var t=e.extra_properties.drilldownTree;return void 0===t?c.E.right(e):a.pipe(e,c.E.fromPredicate(f.RawAlert.withTransformJson,(function(){return n("no transformJSON")})),c.E.chain((function(e){var t=e.transformJson.alternatives;return a.pipe(t,c.E.fromOption((function(){return n("no alternatives")})))})),c.E.chain((function(i){var o=i.alternatives;return t.length>0&&r(o)(t)?c.E.right(e):c.E.left(n("incomplete tree"))})));function n(t){return new Error("Incorrect drilldownTree: "+JSON.stringify(e.extra_properties.drilldownTree)+" - "+t)}function r(e){return function(t){return t.every((function(t){var n=t[0],i=t[1];return void 0!==e[n]&&(!!f.Drilldown.isLeaf(i)||r(e)(i))}))}}}}(S=t.RawAlertValidation||(t.RawAlertValidation={}))},67529:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextMaps=t.BIG_TEXT_SIZE=t.PNameQualifier=t.CAPISessionOptionType=t.FeedbackSubtype=t.FeedbackType=t.SnippetsFeedbackType=t.AutocompleteFeedbackType=t.AutocorrectFeedbackType=t.MutedFeedbackType=t.SynonymFeedbackType=t.SystemFeedbackType=t.EmotionSentenceFeedbackType=t.EmotionFeedbackType=t.LensFeedbackType=t.AlertsBatchFeedbackType=t.DrilldownFeedbackType=t.AlertFeedbackType=t.ErrorSeverity=t.ErrorCode=t.RawAlert=t.AbsRawTransform=t.RawAttentionHeatmap=t.RelRawTransform=t.CardLayout=t.Autocomplete=t.MutedAlerts=t.DomainInfo=t.Drilldown=t.nominal=void 0;var r,i,o,s,a,c=n(59312),l=n(71249),u=n(57050),d=n(40327),p=n(69243),h=n(16595),m=n(81531),f=n(64613),g=n(49150),y=n(81777),_=n(96804),v=n(27966);t.nominal||(t.nominal={}),function(e){e.empty=[],e.isLeaf=function(e){return 0===e.length},e.Tree=p.recursion("Tree",(function(){return p.array(p.tuple([p.number,e.Tree]))}))}(r=t.Drilldown||(t.Drilldown={})),function(e){!function(e){e.sales_crm="sales_crm",e.sales_engagement="sales_engagement",e.sales_enablement="sales_enablement",e.marketing_email_automation="marketing_email_automation",e.marketing_content="marketing_content",e.customer_service="customer_service",e.customer_surveys_surveys="customer_surveys_surveys",e.recruiting="recruiting",e.training_learning="training_learning",e.project_management="project_management",e.legal="legal",e.contractors="contractors",e.human_resources="human_resources",e.email="email",e.business_chat="business_chat"}(e.DomainCategory||(e.DomainCategory={}))}(t.DomainInfo||(t.DomainInfo={})),function(e){!function(e){e.InQuotes="InQuotes"}(e.SpecialCategory||(e.SpecialCategory={})),function(e){e.GLOBAL="GLOBAL",e.SESSION="SESSION",e.DOCUMENT="DOCUMENT"}(e.ScopeType||(e.ScopeType={})),function(e){e.MUTED_BY_USER="MUTED_BY_USER",e.NOT_ELIGIBLE_FOR_INLINE="NOT_ELIGIBLE_FOR_INLINE",e.NOT_MUTED="NOT_MUTED"}(e.MutedByType||(e.MutedByType={}))}(i=t.MutedAlerts||(t.MutedAlerts={})),function(e){!function(e){e.NOT_RELEVANT="NOT_RELEVANT",e.WRONG_TONE="WRONG_TONE",e.INCORRECT="INCORRECT",e.WRONG_GRAMMAR="WRONG_GRAMMAR",e.OFFENSIVE="OFFENSIVE",e.OTHER="OTHER"}(e.SuggestionRejectionReason||(e.SuggestionRejectionReason={}))}(t.Autocomplete||(t.Autocomplete={})),function(e){e.mock={bundle:"Test bundle",bundleRank:10,group:"Test Group",rank:1,outcome:"Correctness"}}(t.CardLayout||(t.CardLayout={})),function(e){function t(e){return function(t){return{s:e.s+t.s,e:e.s+t.e,type:t.type}}}function n(e,t){return void 0===t&&(t=!1),0===e.s?u.unsafeCoerce:function(n){return u.unsafeCoerce({ops:c.__spreadArrays([{retain:e.s,attributes:t?void 0:{type:v.RawTransform.Edit.TypeExt.OPTIONAL_CONTEXT}}],n.ops)})}}e.prependContextToHighlight=t,e.prependContext=n,e.toAbs=function(e){return s.create({highlights:e.highlights.map(t(e.context)),alternatives:d.pipe(e,h.O.fromPredicate((function(e){return!!e.alternatives&&e.alternatives.length>0})),h.O.map((function(e){return c.__assign(c.__assign({},e),{alternatives:h.NEA.map(n(e.context))(e.alternatives)})})),h.O.map(y.Alternative.Group.fromRawTransform))})}}(o=t.RelRawTransform||(t.RelRawTransform={})),function(e){var t,n;!function(e){e.create=function(e){return e.toString()}}(t=e.Id||(e.Id={})),function(e){e.rebase=function(e,t){var n=t.transformPosition(e.begin,!0),r=t.transformPosition(e.end,!0),i=(new g.Delta).insert(e.text).compose(t.slice(e.begin)).reduce((function(e,t){return f.DeltaUtils.isInsert(t)?""+e+t.insert:e}),"").slice(0,r-n);return c.__assign(c.__assign({},e),{begin:n,end:r,text:i})},e.isSquashed=function(e){return e.begin>=e.end},e.fromAttentionHeatmapMessage=function(e){return c.__assign(c.__assign({},e),{id:t.create(e.id)})}}(n=e.Range||(e.Range={})),e.fromAttentionHeatmapMessage=function(e){return c.__assign(c.__assign({},e),{add:e.add.map(n.fromAttentionHeatmapMessage),update:e.update.map(n.fromAttentionHeatmapMessage),remove:e.remove.map(t.create),attentionScore:d.pipe(e,h.O.fromPredicate(_.Message.AttentionHeatmap.hasAttentionInfo),h.O.map(h.ObjectUtils.pick("attentionScore"))),showAttentionCard:d.pipe(e,h.O.fromPredicate(_.Message.AttentionHeatmap.hasAttentionInfo),h.O.map(h.ObjectUtils.pick("showAttentionCard")))})}}(t.RawAttentionHeatmap||(t.RawAttentionHeatmap={})),function(e){e.create=function(e){return e},e.isSquashed=function(e){return e.highlights.some(v.RawTransform.Range.isEmpty)},e.isValidAfterTransform=function(e,n){var r=t(e),i=t(n);return h.ArrayUtils.compareInPairs(r.highlights,i.highlights,(function(e,t){return e.e-e.s==t.e-t.s}))&&h.ArrayUtils.compareInPairs(r.alternatives,i.alternatives,(function(e,t){return h.ArrayUtils.compareInPairs(e.ops.filter(h.not(f.DeltaUtils.isRetain)),t.ops.filter(h.not(f.DeltaUtils.isRetain)),f.DeltaUtils.isEqual((function(){return!0})))}))},e.rebase=function(t,n){return e.create({highlights:t.highlights.map((function(e){return{s:n.transformPosition(e.s,!0),e:n.transformPosition(e.e,!0),type:e.type}})),alternatives:d.pipe(t.alternatives,h.O.map(y.Alternative.Group.rebase(n)))})};var t=function(e){return{highlights:e.highlights,alternatives:d.pipe(e.alternatives,h.O.fold((function(){return[]}),(function(e){return e.alternatives.map((function(e){return e.delta}))})))}}}(s=t.AbsRawTransform||(t.AbsRawTransform={})),function(e){var t,n,a;function u(e){return void 0!==e.drilldownTree?c.__assign(c.__assign({},e),{drilldownTree:d.pipe(e.drilldownTree,(function(e){return"object"==typeof e?e:JSON.parse(e)}),r.Tree.decode,h.E.unsafeGet)}):e}function p(e,t){d.pipe(e.ops,l.findFirst((function(e){return f.DeltaUtils.isInsert(e)&&d.pipe(f.DeltaUtils.getAttr(e,"type"),h.O.exists((function(e){return e===v.RawTransform.Edit.Type.MAIN})))&&"string"==typeof e.insert})),h.O.map((function(e){var n=e.insert;return t(n)})))}function _(e){return function(t){switch(t){case i.SpecialCategory.InQuotes:return"true"===e.extra_properties.in_quotes;default:return!1}}}function b(e){return!I(e)&&!S(e)}function E(e){return void 0!==e.begin&&void 0!==e.end&&void 0!==e.highlightBegin&&void 0!==e.highlightEnd}function I(e){return void 0!==e.cardLayout&&void 0!==e.transformJson}function S(e){return"labels"in e&&"subalerts"in e}function w(e,t,n,r){return b(e)?t(e):I(e)?n(e):r(e)}!function(e){e.create=function(e){return e.toString()}}(e.Id||(e.Id={})),function(e){e.Critical="critical",e.Advanced="advanced"}(t=e.Impact||(e.Impact={})),function(e){e.all="all",e.priority="priority"}(n=e.View||(e.View={})),function(e){e.inline="inline",e.not_inline="not_inline"}(a=e.Inline||(e.Inline={})),e.parseExtraProperties=u,e.fromAlertMessage=function(t){return Object.assign({},t,c.__assign({id:e.Id.create(t.id),cost:Boolean(t.cost)?t.cost:1,extra_properties:u(t.extra_properties)},t.transformJson?{transformJson:o.toAbs(t.transformJson),highlightText:[t.highlightText]}:d.pipe(h.NEA.fromNullableArray(t.subalerts),h.O.fold((function(){return{highlightText:[t.highlightText]}}),(function(e){return d.pipe(function(e,t){return d.pipe(t,h.O.fold((function(){return h.E.left(new Error("Got corrupted superalert — the labels are missing"))}),(function(t){return function(e,t){if(e.length<2)return h.E.left(new Error("There should be more than one subalert, got "+e.length));var n=t.map((function(e){return{matches:0,replacements:new Set,label:e}})),r=n.reduce((function(e,t){return e[t.label]=t,e}),{}),i=h.NEA.fromNullableArray(e[0].transformJson.alternatives);if(n.length>0&&h.O.isNone(i)||!d.pipe(i,h.O.forAll((function(e){return n.length===e.length}))))return h.E.left(new Error("Alternatives array length must match labels array length"));for(var a=d.pipe(i,h.O.map(h.NEA.mapWithIndex((function(t,r){return p(r,(function(e){return n[t].replacements.add(e)})),o.prependContext(e[0].transformJson.context)(r)}))),h.O.map((function(t){return r[e[0].label].matches+=1,[h.NEA.of(e[0].transformJson.context),t]}))),l=e[0].transformJson.highlights.map(o.prependContextToHighlight(e[0].transformJson.context)),u=[e[0].highlightText],m=function(t){var i=e[t];if(n.length>0){if(!i.transformJson.alternatives)return{value:h.E.left(new Error("The alternatives are missing from subalert, expected length: "+n.length))};if(i.transformJson.alternatives.length!==n.length)return{value:h.E.left(new Error("Subalert has incorrect alternatives length: expected "+n.length+", got "+i.transformJson.alternatives.length))}}a=d.pipe(a,h.O.map((function(e){var t=e[0],s=e[1];r[i.label].matches+=1,t.push(i.transformJson.context);for(var a=function(e){var t=i.transformJson.alternatives[e];p(t,(function(t){return n[e].replacements.add(t)})),s[e]=d.pipe(new g.Delta(s[e]),(function(e){return e.compose(e.transform(new g.Delta(o.prependContext(i.transformJson.context,!0)(t)),!0))}),v.RawTransform.AbsAlternative.unsafeFromDelta)},c=0;c<s.length;c++)a(c);return[t,s]}))),l.push.apply(l,i.transformJson.highlights.map(o.prependContextToHighlight(i.transformJson.context))),u.push(i.highlightText)},f=1;f<e.length;f++){var _=m(f);if("object"==typeof _)return _.value}return h.E.right({subalerts:s.create({alternatives:d.pipe(a,h.O.map((function(e){var t=e[0],n=e[1];return y.Alternative.Group.fromSubalerts(t,n)}))),highlights:l}),labels:n.map((function(e){var t=e.replacements,n=c.__rest(e,["replacements"]);return c.__assign(c.__assign({},n),{replacementTexts:Array.from(t)})})),highlightText:u})}(e,t)})))}(e,h.O.fromNullable(t.labels)),h.E.getOrElse((function(e){return m.Monitoring.Logging.getLogger("coreclients.capi.data").error("Error repacking superalert",e),{highlightText:[]}})))})))))},e.isFullSentence=function(e){return"true"===e.full_sentence_rewrite||"true"===e.full_sentence_fluency_rewrite},e.belongsToAnySpecialCategory=function(e){var t=_(e);return-1!==Object.values(i.SpecialCategory).findIndex(t)},e.belongsToSpecialCategory=_,e.withPosition=b,e.hasPosition=E,e.withTransformJson=I,e.withAlternatives=function(e){return I(e)&&h.O.isSome(e.transformJson.alternatives)},e.withSubalerts=S,e.match=w,e.matchBy=function(e,t,n){return function(r){return w(r,e,t,n)}},function(e){function t(e){return e.end-e.begin}function n(e){return e.highlightEnd-e.highlightBegin}e.shift=function(e,t){return{begin:e.begin+t,end:e.end+t,highlightBegin:e.highlightBegin+t,highlightEnd:e.highlightEnd+t}},e.rebase=function(e,t){return{begin:t.transformPosition(e.begin,!0),end:t.transformPosition(e.end,!0),highlightBegin:t.transformPosition(e.highlightBegin,!0),highlightEnd:t.transformPosition(e.highlightEnd,!0)}},e.getReplacementLength=t,e.getHighlightLength=n,e.isSquashed=function(e){return 0===t(e)||0===n(e)},e.hasEqualLength=function(e,r){return t(e)===t(r)&&n(e)===n(r)}}(e.Position||(e.Position={})),e.isPlagiarism=function(e){return void 0!==e.cardLayout&&"Originality"===e.cardLayout.outcome},e.isOneGap=function(e){return void 0!==e.extra_properties&&"gap_transform"in e.extra_properties},e.isSmartPhrases=function(e){return void 0!==e.extra_properties&&"smart_phrases_intent"in e.extra_properties},e.isSentenceLevelBrandTones=function(e){return void 0!==e.extra_properties&&"brandToneDescription"in e.extra_properties},e.isTakeaway=function(e){return void 0!==e.extra_properties&&"takeawayScore"in e.extra_properties},e.hasDrilldownTree=function(e){return void 0!==e.extra_properties&&"drilldownTree"in e.extra_properties},e.isShortenIt=function(e){return void 0!==e.extra_properties&&"shorten_it"in e.extra_properties},e.isToneAI=function(e){return void 0!==e.extra_properties&&"tone_slider"in e.extra_properties},e.isEthicalAI=function(e){return void 0!==e.extra_properties&&"ethical_ai_external_link"in e.extra_properties},e.isSuggestedSnippet=function(e){return void 0!==e.extra_properties&&"suggested_snippet_text"in e.extra_properties&&"suggested_snippet_lib_link"in e.extra_properties},e.isHidden=function(e){return!0===e.hidden},e.isRawAlert=function(e){if(!Boolean(e))return!1;var t=e;return Number.isInteger(t.rev)&&w(t,(function(e){return Number.isInteger(e.begin)&&Number.isInteger(e.end)&&Number.isInteger(e.highlightBegin)&&Number.isInteger(e.highlightEnd)}),(function(e){return e.transformJson.highlights.length>0}),(function(e){return e.labels.length>0}))},e.mock={id:e.Id.create(""),rev:0,pname:"Spelling/BritishVsAmerican/BrInstOfAm/BrInstOfAm",group:"ContextualSpelling",point:"BrInstOfAm",category:"BritishVsAmerican",categoryHuman:"British vs American",hidden:!1,text:"centralise",todo:"correct",minicardTitle:"correct",title:"Inconsistent spelling",cost:1,transforms:["<span class='gr_grammar_del'>centralise</span>→<span class='gr_grammar_ins'>centralize</span>"],details:"<p>One of&nbsp;the most obvious differences between American and British English is&nbsp;the spelling of&nbsp;certain words such as&nbsp;<b>color/colour, learned/learnt,</b> and <b>toward/towards</b>. Typically, the spelling of&nbsp;words like these only varies by&nbsp;one or&nbsp;two letters. In&nbsp;the interest of&nbsp;consistency and clarity, you should use the spelling that will be&nbsp;more familiar to&nbsp;your intended audience.\n",explanation:"<p>The word <b>centralise</b> is&nbsp;a&nbsp;British English spelling. In&nbsp;the interest of&nbsp;consistency, consider replacing it&nbsp;with the American English spelling.\n",examples:'<p><span class="grey">British: I&nbsp;wish you success in&nbsp;all your endeavours.</span><br/><span class="grey">American: I&nbsp;wish you success in&nbsp;all your endeavors.</span><br/><p><span class="grey">British: Sweet yoghurts contain a&nbsp;lot of&nbsp;sugar.</span><br/><span class="grey">American: Sweet yogurts contain a&nbsp;lot of&nbsp;sugar.</span><br/><p><span class="grey">British: Serena moved towards the blinking light.</span><br/><span class="grey">American: Serena moved toward the blinking light.</span><br/>',free:!0,impact:e.Impact.Critical,highlightBegin:5092,highlightEnd:5102,highlightText:[""],begin:5092,end:5102,replacements:["centralize"],extra_properties:{priority:"2"},cardLayout:{bundle:"Fix spelling and grammar",bundleRank:10,group:"Spelling",rank:10,outcome:"Correctness"},transformJson:s.create({highlights:[{s:5092,e:5102}],alternatives:h.O.none}),view:n.all,inline:a.inline},e.mockPlagiarism={id:e.Id.create(""),rev:0,transforms:[],title:"Citation audit",cost:1,details:"",explanation:"",examples:"",free:!1,impact:e.Impact.Advanced,hidden:!1,todo:"",minicardTitle:"",cardLayout:{bundle:"Plagiarism",bundleRank:10,group:"Unoriginal content",rank:0,outcome:"Originality"},category:"Plagiarism",categoryHuman:"Unoriginal content",begin:156,end:697,text:"",group:"Plagiarism",pname:"Plagiarism/Plagiarism/UnoriginalContent",point:"UnoriginalContent",highlightBegin:156,highlightEnd:697,highlightText:[""],replacements:[],extra_properties:{},transformJson:s.create({highlights:[{s:1,e:40}],alternatives:h.O.none}),view:n.all,inline:a.not_inline},e.mockWithSubalerts={id:e.Id.create(""),point:"Capitalization",title:"Inconsistent capitalization",details:"<p>For certain words, capitalization preferences can vary between style guides. <i>Internet</i> was once routinely capitalized, for example. However, in recent years many style guides have begun advising writers to lowercase the word: <i>internet</i>. Whether you choose to capitalize a particular term or not, it’s best to choose one style and use it consistently throughout the same document.\n",explanation:"<p>You wrote <b>Country</b> once and <b>country</b> twice. Both spellings are acceptable, but it’s best not to switch back and forth. Choose whether or not to capitalize this word throughout your text.\n",examples:'<p><span class="grey">Inconsistent: Office life was different before the <b>Internet</b>. Education has changed because of the <b>internet</b>, too.</span><br/><span class="grey">Consistent: Office life was different before the <b>internet</b>. Education has changed because of the <b>internet</b>, too.</span><br/><span class="grey">Consistent: Office life was different before the <b>Internet</b>. Education has changed because of the <b>Internet</b>, too.</span><br/>',todo:"capitalize consistently",minicardTitle:"capitalize consistently",free:!1,hidden:!1,labels:[{label:"Country",matches:1,replacementTexts:["Country"]},{label:"country",matches:2,replacementTexts:["country"]}],highlightText:["Country","country"],cost:1,subalerts:s.create({highlights:[{s:144,e:162},{s:755,e:778},{s:1458,e:1481}],alternatives:h.O.some(y.Alternative.Group.fromSubalerts([{s:144,e:162},{s:755,e:778},{s:1458,e:1481}],[v.RawTransform.AbsAlternative.unsafeFromDelta({ops:[{retain:144,attributes:{type:v.RawTransform.Edit.TypeExt.OPTIONAL_CONTEXT}},{delete:7,attributes:{type:v.RawTransform.Edit.Type.MAIN}},{insert:"Country",attributes:{type:v.RawTransform.Edit.Type.MAIN}}]}),v.RawTransform.AbsAlternative.unsafeFromDelta({ops:[{retain:144,attributes:{type:v.RawTransform.Edit.TypeExt.OPTIONAL_CONTEXT}},{delete:7,attributes:{type:v.RawTransform.Edit.Type.MAIN}},{insert:"country",attributes:{type:v.RawTransform.Edit.Type.MAIN}}]})]))}),category:"Inconsistency",text:"",group:"Style",pname:"Style/Inconsistency/Capitalization/Capitalization",rev:0,replacements:[],impact:t.Advanced,extra_properties:{priority:"4"},cardLayout:{bundle:"Keep your style consistent",bundleRank:10,group:"Consistency",rank:160,outcome:"Correctness"},categoryHuman:"Text Inconsistencies",updatable:!0,view:n.all,inline:a.not_inline},e.clearUserTextFields=function(e){var t=e;return t.text,t.replacements,t.highlightText,t.transformJson,t.transforms,t.details,t.explanation,t.examples,c.__rest(t,["text","replacements","highlightText","transformJson","transforms","details","explanation","examples"])},e.unsafeGetPosition=function(e){return h.invariant(E(e),"raw alert should have a position"),e},e.unsafeGetTransformJson=function(e){return h.invariant(I(e),"raw alert should have transformJson"),e}}(t.RawAlert||(t.RawAlert={})),function(e){e.NOT_AUTHORIZED="not_authorized",e.SESSION_NOT_INITIALIZED="session_not_initialized",e.BAD_REQUEST="bad_request",e.BACKEND_ERROR="backend_error",e.AUTH_ERROR="auth_error",e.RUNTIME_ERROR="runtime_error",e.ILLEGAL_DICT_WORD="illegal_dict_word",e.TIMEOUT="timeout",e.CANNOT_FIND_SYNONYM="cannot_find_synonym",e.CANNOT_GET_TEXT_STATS="cannot_get_text_stats"}(t.ErrorCode||(t.ErrorCode={})),function(e){e[e.INFO=0]="INFO",e[e.WARN=1]="WARN",e[e.ERROR=2]="ERROR"}(t.ErrorSeverity||(t.ErrorSeverity={})),function(e){e.IGNORE="IGNORE",e.ADD_TO_DICTIONARY="ADD_TO_DICTIONARY",e.LOOKED="LOOKED",e.ACCEPTED="ACCEPTED",e.CLOSED="CLOSED",e.ACKNOWLEDGED="ACKNOWLEDGED",e.HIDE="HIDE",e.LIKE="LIKE",e.DISLIKE="DISLIKE",e.WRONG_SUGGESTION="WRONG_SUGGESTION",e.OFFENSIVE_CONTENT="OFFENSIVE_CONTENT",e.EXPANDED="EXPANDED",e.IGNORE_BULK_ACCEPTED="IGNORE_BULK_ACCEPTED"}(a=t.AlertFeedbackType||(t.AlertFeedbackType={})),function(e){e.DRILLDOWN="DRILLDOWN"}(t.DrilldownFeedbackType||(t.DrilldownFeedbackType={})),function(e){e.BULK_ACCEPTED="BULK_ACCEPTED"}(t.AlertsBatchFeedbackType||(t.AlertsBatchFeedbackType={})),function(e){e.LENS_CLOSE="LENS_CLOSE",e.LENS_OPEN="LENS_OPEN",e.DISMISS_BY_LENS="DISMISS_BY_LENS"}(t.LensFeedbackType||(t.LensFeedbackType={})),function(e){e.EMOTION_LIKE="EMOTION_LIKE",e.EMOTION_DISLIKE="EMOTION_DISLIKE",e.EMOTION_OFFENSIVE="EMOTION_OFFENSIVE"}(t.EmotionFeedbackType||(t.EmotionFeedbackType={})),function(e){e.EMOTION_SENTENCE_LIKE="EMOTION_SENTENCE_LIKE",e.EMOTION_SENTENCE_DISLIKE="EMOTION_SENTENCE_DISLIKE"}(t.EmotionSentenceFeedbackType||(t.EmotionSentenceFeedbackType={})),function(e){e.RECHECK_SHOWN="RECHECK_SHOWN"}(t.SystemFeedbackType||(t.SystemFeedbackType={})),function(e){e.SYNONYM_ACCEPTED="SYNONYM_ACCEPTED",e.SYNONYM_DISMISSED="SYNONYM_DISMISSED"}(t.SynonymFeedbackType||(t.SynonymFeedbackType={})),function(e){e.MUTE="MUTE",e.UNMUTE="UNMUTE"}(t.MutedFeedbackType||(t.MutedFeedbackType={})),function(e){e.AUTOCORRECT_ACCEPT="AUTOCORRECT_ACCEPT",e.AUTOCORRECT_DISMISS="AUTOCORRECT_DISMISS",e.AUTOCORRECT_REPLACE="AUTOCORRECT_REPLACE"}(t.AutocorrectFeedbackType||(t.AutocorrectFeedbackType={})),function(e){e.COMPLETION_SHOWN="COMPLETION_SHOWN",e.COMPLETION_IGNORED="COMPLETION_IGNORED",e.COMPLETION_ACCEPTED="COMPLETION_ACCEPTED",e.COMPLETION_REJECTED="COMPLETION_REJECTED"}(t.AutocompleteFeedbackType||(t.AutocompleteFeedbackType={})),function(e){e.SNIPPET_ACCEPTED="SNIPPET_ACCEPTED"}(t.SnippetsFeedbackType||(t.SnippetsFeedbackType={})),function(e){e.willRemoveAlert=function(e){return e===a.IGNORE||e===a.OFFENSIVE_CONTENT||e===a.WRONG_SUGGESTION||e===a.ADD_TO_DICTIONARY||e===a.LIKE||e===a.DISLIKE||e===a.ACKNOWLEDGED||e===a.HIDE}}(t.FeedbackType||(t.FeedbackType={})),function(e){e.Inline="inline",e.Hover="hover",e.Click="click",e.SidebarPriority="sidebar-priority",e.Sidebar="sidebar"}(t.FeedbackSubtype||(t.FeedbackSubtype={})),function(e){e.Context="context",e.GnarContainerId="gnar_containerId"}(t.CAPISessionOptionType||(t.CAPISessionOptionType={})),function(e){e.likelyToBeReadTakeaway="LikelyToRead",e.unlikelyToBeReadTakeaway="NotLikelyToRead"}(t.PNameQualifier||(t.PNameQualifier={})),t.BIG_TEXT_SIZE=300,function(e){e.generatePoints=function(e,t,n){var r=function(e,t){return Math.max(Math.trunc(e/t),h.rand(e))};return h.ArrayUtils.mapNTimes(r(e,2),(function(e){return h.ArrayUtils.mapNTimes(r(t,3),(function(t){return{value:Math.random()*n,alertIds:[],footprint:""+(100*e+t)}}))}))}}(t.TextMaps||(t.TextMaps={}))},44562:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CAPIEvent=t.AlertRemoveHint=void 0,function(e){e.NotFixed="NOT_FIXED"}(t.AlertRemoveHint||(t.AlertRemoveHint={})),function(e){e.is=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.some((function(e){return e===t.kind}))}},e.isUserFeedbackWithGeneralScore=function(e){var t;return Boolean(null===(t=e.outcomeScores)||void 0===t?void 0:t.GeneralScore)},e.isUserFeedbackWithScoreStatus=function(e){return Boolean(e.scoreStatus)}}(t.CAPIEvent||(t.CAPIEvent={}))},61601:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentStatistics=t.MAX_SAFE_ID=t.Message=t.CAPIFeature=t.CAPIHttpClient=t.optimizedOTSerializer=t.CAPIClientImpl=t.CAPIConnection=void 0;var r=n(59312),i=n(13669);Object.defineProperty(t,"CAPIConnection",{enumerable:!0,get:function(){return i.CAPIConnection}});var o=n(59954);Object.defineProperty(t,"CAPIClientImpl",{enumerable:!0,get:function(){return o.CAPIClientImpl}}),Object.defineProperty(t,"optimizedOTSerializer",{enumerable:!0,get:function(){return o.optimizedOTSerializer}});var s=n(60169);Object.defineProperty(t,"CAPIHttpClient",{enumerable:!0,get:function(){return s.CAPIHttpClient}});var a=n(96804);Object.defineProperty(t,"CAPIFeature",{enumerable:!0,get:function(){return a.CAPIFeature}}),Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return a.Message}}),Object.defineProperty(t,"MAX_SAFE_ID",{enumerable:!0,get:function(){return a.MAX_SAFE_ID}}),r.__exportStar(n(27966),t),r.__exportStar(n(67529),t),r.__exportStar(n(44562),t);var c=n(99727);Object.defineProperty(t,"DocumentStatistics",{enumerable:!0,get:function(){return c.DocumentStatistics}}),r.__exportStar(n(81777),t),r.__exportStar(n(80270),t)},80270:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LatencyMeasuringWSHandler=t.defaultConnectionFactory=t.windowPerformanceClientClock=void 0;var r=n(59312),i=n(76210),o=n(81531),s=n(9518),a=function(){function e(e,t){this._innerCon=e,this._addTimer=t}return e.prototype.send=function(e){return this._innerCon.send(this._addTimer(e))},e.prototype.close=function(e){return this._innerCon.close(e)},Object.defineProperty(e.prototype,"_ws",{get:function(){return this._innerCon._ws},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._innerCon.state},enumerable:!1,configurable:!0}),e}();function c(e,t){return new s.SerializingWSConnection(e,t)}t.windowPerformanceClientClock=function(){return Math.trunc(self.performance.now())},t.defaultConnectionFactory=c;var l=function(){function e(e,n,r,s,l,u){var d=this;void 0===r&&(r=10),void 0===s&&(s=t.windowPerformanceClientClock),void 0===l&&(l=i.v4),void 0===u&&(u=c),this._innerWs=e,this._idGenerator=n,this._bufferSize=r,this._clientClock=s,this._timerIdGenerator=l,this._defaultConnection=u,this._log=o.Monitoring.Logging.getLogger("coreclients.capi.latencyMeasuringWSHandler"),this._timers=[],this._connection=null,this._innerWs=e.onDisconnect((function(){d._timers=[]})).onMessage((function(e,t){d._processTimerResponse(t)})).withConnection((function(e,t){return new a(d._defaultConnection(e,t),(function(e){return d._addTimerToRequest(e)}))})).onConnect((function(e){d._connection=e}))}return e.prototype.onConnecting=function(e){return this._innerWs.onConnecting(e),this},e.prototype.onConnect=function(e){return this._innerWs.onConnect(e),this},e.prototype.onDisconnect=function(e){return this._innerWs.onDisconnect(e),this},e.prototype.onMessage=function(e){return this._innerWs.onMessage(e),this},e.prototype.connect=function(e){return this._innerWs.connect(e)},e.prototype.isDisconnected=function(){return this._innerWs.isDisconnected()},e.prototype._addTimerToRequest=function(e){if("string"==typeof e)return e;switch(e.action){case"ping":case"submit_ot":return r.__assign(r.__assign({},e),{timer:{client_clock:this._clientClock(),id:this._timerIdGenerator()}});default:return e}},e.prototype._processTimerResponse=function(e){var t=this;switch(e.action){case"pong":case"finished":return void(e.timer&&(this._timers.push({id:e.timer.id,name:e.timer.name,client_clock:this._clientClock()}),this._timers.length>=this._bufferSize&&setTimeout((function(){return t._flush()}),0)));default:return}},e.prototype._flush=function(){this._timers.length>0&&(null===this._connection?this._log.warn("tried flushing when not connected"):(this._connection.send({id:this._idGenerator.newId(),action:"perfstats",timers:this._timers}),this._timers=[]))},e}();t.LatencyMeasuringWSHandler=l},96804:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.CAPIFeature=t.MAX_SAFE_ID=void 0;var r=n(59312);t.MAX_SAFE_ID=Math.pow(2,32)/2,function(e){e.alertsUpdate="alerts_update",e.textInfo="text_info",e.freeAdvancedChecks="free_inline_advanced_alerts",e.readability="readability_check",e.sentenceVariety="sentence_variety_check",e.fillerWords="filler_words_check",e.alertsChanges="alerts_changes",e.freeClarityChecks="free_clarity_alerts",e.superAlerts="super_alerts",e.consistency="consistency_check",e.setGoalsLink="set_goals_link",e.emogenieCheck="emogenie_check",e.toneCards="tone_cards",e.alternativeDeletesCard="alternative_deletes_card",e.voxCheck="vox_check",e.plagiarismAlertsUpdate="plagiarism_alerts_update",e.fullSentenceRewrite="full_sentence_rewrite_card",e.listCard="turn_to_list_card",e.userMutes="user_mutes",e.completions="completions",e.muteQuotedAlerts="mute_quoted_alerts",e.keyTakeaways="key_takeaways_v4",e.supportsFormatting="formatting",e.supportsButtonTransformCards="transform_with_button_card",e.priorityAlertsView="priority_alerts_view",e.proofit="realtime_proofit",e.freeOccasionalPremiumAlerts="free_occasional_premium_alerts",e.gapTransformCard="gap_transform_card",e.smartPhrases="smart_phrases",e.toneAI="tone_slider_card",e.ethicalAI="ethical_ai_card",e.sentenceLevelBrandTones="sentence_level_brand_tones",e.enclosingHighlight="enclosing_highlight",e.drilldownCard="drilldown_card",e.shortenIt="shorten_it",e.ideasGalleryLink="ideas_gallery_link",e.suggestedSnippets="suggested_snippets"}(t.CAPIFeature||(t.CAPIFeature={})),function(e){!function(e){e.OK="OK",e.TOO_SMALL="TOO_SMALL",e.SENSITIVE="SENSITIVE",e.ERROR="ERROR"}(e.ScoresStatus||(e.ScoresStatus={})),function(e){var t={Clarity:0,Correctness:0,Engagement:0,Tone:0,"Style guide":0,GeneralScore:0};e.normalize=function(e){return r.__assign(r.__assign({},t),e)}}(e.OutcomeScores||(e.OutcomeScores={})),function(e){e.hasAttentionInfo=function(e){return"attentionScore"in e&&"showAttentionCard"in e}}(e.AttentionHeatmap||(e.AttentionHeatmap={})),function(e){!function(e){e.click="click"}(e.Type||(e.Type={}))}(e.UserAction||(e.UserAction={}))}(t.Message||(t.Message={}))},76971:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CapiQueue=t.ChangesQueue=void 0;var r,i=n(59312),o=n(57050),s=n(40327),a=n(16595),c=n(81531),l=n(64613),u=n(67529),d=n(7858);!function(e){function t(e){return"change"===e.kind}function n(e){return"change_chunked"===e.kind}e.isChange=a.orP(t,n),e.isFullChange=t,e.isChunkedChange=n,e.isCmd=function(e){return"cmd"===e.kind},e.isCmdIncRevision=function(e){return"cmdIncRevision"===e.kind}}(r=t.ChangesQueue||(t.ChangesQueue={}));var p=function(){function e(e,t,n,i,o,s){var l=this;void 0===o&&(o=100),void 0===s&&(s=.1),this._shouldIncreaseRevision=e,this._acceptHandler=t,this._dropHandler=n,this._idGenerator=i,this._maxMessageSizeKb=o,this._messagePaddingKb=s,this._log=c.Monitoring.Logging.getLogger("coreclients.capi.queue",c.Logging.LogLevel.DEBUG),this._changes=[],this._staged=[],this._stagedOperationId=null,this._stagedAmount=0,this.transformChangeAgainstQueue=function(e){if(e.transformJson){var t=l._getQueuedDeltaAndLatestRevision(e.rev),n=u.AbsRawTransform.rebase(e.transformJson,t.delta);return u.AbsRawTransform.isSquashed(n)?a.O.none:a.O.some(a.ObjectUtils.update(e,{transformJson:n,rev:t.latestRev}))}return a.O.some(e)},this._split=function(e){var t=JSON.stringify([e.delta]);return l._log.trace("change delta string",{deltasStr:t,size:d.utf8Kbytes(t)}),d.split(t,l._maxMessageSizeKb,l._messagePaddingKb)},this._acceptMessage=function(e){l._updateCheckedTextSize(e),l._acceptHandler(e)},this._dropMessages=function(e,t){e.forEach(l._updateCheckedTextSize),l._dropHandler(e,t)},this._updateCheckedTextSize=function(e){r.isChange(e)?l._changeStagedAmount(-e.change.amount):l._shouldIncreaseRevision(e.cmd)&&l._changeStagedAmount(-u.BIG_TEXT_SIZE)},this._log.debug("capi queue created",{maxMessageSizeKb:this._maxMessageSizeKb,messagePaddingKb:this._messagePaddingKb}),this.clear("init")}return e.prototype.pushChanges=function(e){var t=this,n=s.pipe(this._tail(),a.O.filter(r.isChange));return s.pipe(n,a.O.fold((function(){return t._log.trace("pushChanges() adding new change to queue"),t._enqueueChange(e,t._split(e))}),(function(n){t._log.trace("pushChanges() composing with latest change");var r=n.change.compose(e),i=t._split(r);if(t._replaceChange(t._changes.length-1,r,i),r.isEmpty){var o=t._changes.pop();setTimeout((function(){return t._acceptMessage(o)}),0)}return n.id})))},e.prototype.pushCommand=function(e){var t=this._idGenerator();return this._shouldIncreaseRevision(e)?(this._changeStagedAmount(u.BIG_TEXT_SIZE),this._changes.push({kind:"cmdIncRevision",cmd:e,id:t,rev:this._revision++})):this._changes.push({kind:"cmd",cmd:e,id:t,rev:this._revision}),t},Object.defineProperty(e.prototype,"isStaging",{get:function(){return this._staged.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._changes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localRevision",{get:function(){return this._revision},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stagedAmount",{get:function(){return this._stagedAmount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasChanges",{get:function(){return this._changes.some(r.isChange)},enumerable:!1,configurable:!0}),e.prototype.poll=function(){var e=this;return a.invariant(null===this._stagedOperationId,"Should not be in staging mode"),s.pipe(a.O.fromNullable(this._changes.shift()),a.O.map((function(t){return r.isCmd(t)||e._staged.push(t),e._stagedOperationId=t.id,t})))},e.prototype.ackOperation=function(e){a.invariant(!!this._stagedOperationId&&e===this._stagedOperationId,"Cannot ack operation by wrong id. Expected: '"+this._stagedOperationId+", got: '"+e+"'"),this._stagedOperationId=null},e.prototype.ackRevision=function(e){this._ackedRevisions.add(e),this._cleanStaged()},e.prototype.transformAlertAgainstQueue=function(t){var n=this._getQueuedDeltaAndLatestRevision(t.rev),r=s.pipe(u.RawAlert.hasPosition(t)?e._transformPosition(t,n.delta):a.O.some(t),a.O.map((function(e){return a.ObjectUtils.update(e,{rev:n.latestRev})})));return s.pipe(r,a.O.chain(u.RawAlert.matchBy(a.O.some,(function(e){var t=u.AbsRawTransform.rebase(e.transformJson,n.delta);return(!0===e.updatable?u.AbsRawTransform.isSquashed(t):!u.AbsRawTransform.isValidAfterTransform(e.transformJson,t))?a.O.none:a.O.some(a.ObjectUtils.update(e,{transformJson:t}))}),(function(e){var t=u.AbsRawTransform.rebase(e.subalerts,n.delta);return u.AbsRawTransform.isSquashed(t)?a.O.none:a.O.some(a.ObjectUtils.update(e,{subalerts:t}))}))))},e.prototype.transformAttentionHeatmapAgainstQueue=function(e){var t=this._getQueuedDeltaAndLatestRevision(e.rev),n=function(e){return e.map((function(e){return u.RawAttentionHeatmap.Range.rebase(e,t.delta)}))},r=n(e.update),s=r.filter(u.RawAttentionHeatmap.Range.isSquashed).map((function(e){return e.id}));return a.ObjectUtils.update(e,{rev:t.latestRev,add:n(e.add).filter(o.not(u.RawAttentionHeatmap.Range.isSquashed)),update:r.filter(o.not(u.RawAttentionHeatmap.Range.isSquashed)),remove:i.__spreadArrays(e.remove,s)})},e.prototype.clear=function(e){var t=i.__spreadArrays(this._changes,this._staged);this._changes=[],this._staged=[],this._stagedOperationId=null,this._ackedRevisions=new Set,this._revision=0,t.length>0&&this._dropMessages(t,e)},e.prototype._tail=function(){return this.isEmpty?a.O.none:a.O.fromNullable(this._changes[this._changes.length-1])},e.prototype._enqueueChange=function(e,t){var n,r=this,i=this._revision++;if(this._changeStagedAmount(e.amount),1===t.length)n=this._idGenerator(),this._changes.push({kind:"change",change:e,id:n,rev:i,deltasString:t[0]});else{this._log.trace("change is larger than maximum allowed size, splitting to chunks",t.length);var o=t.map((function(e){return{id:r._idGenerator(),chunk:e}}));n=this._idGenerator(),this._changes.push({kind:"change_chunked",change:e,id:n,rev:i,chunks:o})}return n},e.prototype._replaceChange=function(e,t,n){var o=this,s=this._changes[e];a.invariant(r.isChange(s),"queued change should exist");var c=s;this._changeStagedAmount(-c.change.amount+t.amount),n.length>1?this._changes[e]=i.__assign(i.__assign({},c),{kind:"change_chunked",chunks:n.map((function(e){return{id:o._idGenerator(),chunk:e}}))}):this._changes[e]=i.__assign(i.__assign({},c),{kind:"change",change:t,deltasString:n[0]})},e.prototype._cleanStaged=function(){for(;void 0!==this._staged[0]&&this._ackedRevisions.has(this._staged[0].rev);){var e=this._staged.shift();this._ackedRevisions.delete(e.rev),this._acceptMessage(e)}},e.prototype._changeStagedAmount=function(e){this._stagedAmount+=e},e.prototype._getQueuedDeltaAndLatestRevision=function(e){var t=this._staged.filter((function(t){return t.rev>e})).concat(this._changes).filter(r.isChange);return{delta:l.DeltaUtils.squash(t.map((function(e){return e.change.delta}))),latestRev:s.pipe(a.A.last(t),a.O.map((function(e){return e.rev})),a.O.getOrElse((function(){return e})))}},e.prototype.toJSON=function(){return{isEmpty:this.isEmpty,isStaging:this.isStaging,changes:this._changes.map((function(e){return r.isChange(e)?{kind:"change",prevLen:e.change.prevLen,changeDiff:e.change.length,changeAmount:e.change.amount}:e}))}},e._transformPosition=function(e,t){var n=u.RawAlert.Position.rebase(e,t);return(!0===e.updatable?u.RawAlert.Position.isSquashed(n):!u.RawAlert.Position.hasEqualLength(e,n))?a.O.none:a.O.some(a.ObjectUtils.update(e,n))},e}();t.CapiQueue=p},27966:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RawTransform=void 0;var r=n(59312),i=n(57050),o=n(16595),s=n(64613);!function(e){var t;!function(e){e.isEmpty=function(e){return e.e-e.s==0}}(e.Range||(e.Range={})),function(e){!function(e){e.MAIN="main",e.IMPORTANT="important"}(e.Type||(e.Type={})),function(e){e.OPTIONAL_CONTEXT="optional_context"}(e.TypeExt||(e.TypeExt={}))}(t=e.Edit||(e.Edit={})),function(e){function n(e){return i.pipe(e.ops,o.O.fromPredicate((function(e){return-1===e.findIndex(n)})),o.O.fold((function(){return o.E.left({ops:(t=e.ops,t.reduce((function(e,t,i){if(n(t,i)){var o=t.attributes,s=(o.type,r.__rest(o,["type"]));e.push(r.__assign(r.__assign({},t),{attributes:s}))}else e.push(t);return e}),[]))});var t}),(function(e){return o.E.right({ops:e})})));function n(e,n){return n>0&&s.DeltaUtils.isRetain(e)&&void 0!==e.attributes&&e.attributes.type===t.TypeExt.OPTIONAL_CONTEXT}}e.unsafeFromDelta=function(e){return i.pipe(e,n,o.E.fold(i.identity,i.identity))},e.fromDelta=n}(e.AbsAlternative||(e.AbsAlternative={}))}(t.RawTransform||(t.RawTransform={}))},67697:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AttentionChecklistItem=void 0;var r=n(59312),i=n(40327),o=n(16595);!function(e){e.fromRaw=function(e){return r.__assign(r.__assign({},e),{suggestionsCard:i.pipe(o.O.fromNullable(e.suggestionsCard),o.O.map((function(e){return{title:e.title,miniTitle:o.O.fromNullable(e.miniTitle)}}))),successCard:i.pipe(o.O.fromNullable(e.successCard),o.O.map((function(e){return{title:e.title,miniTitle:o.O.fromNullable(e.miniTitle)}}))),defaultCard:r.__assign(r.__assign({},e.defaultCard),{miniTitle:o.O.fromNullable(e.defaultCard.miniTitle),details:o.O.fromNullable(e.defaultCard.details)})})}}(t.AttentionChecklistItem||(t.AttentionChecklistItem={}))},7858:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.split=t.utf8Kbytes=t.utf8Bytes=void 0;var r=n(16595);function i(e){for(var t,n,r=0,i=e.length,o=0;o<i;o++)(t=e.charCodeAt(o))>=55296&&t<57344&&t<56320&&o+1<i&&(n=e.charCodeAt(o+1))>=56320&&n<57344?(r+=4,o++):r+=t<128?1:t<2048?2:3;return r}function o(e,t){var n=e.charCodeAt(t),r=e.charCodeAt(t+1);return n>=55296&&n<57344&&r>=56320&&r<57344}function s(e){return i(e)/1e3}t.utf8Bytes=i,t.utf8Kbytes=s,t.split=function(e,t,n){if(void 0===n&&(n=0),r.invariant(n<t,"padding must be less than the max message size"),c(3*e.length)+n<t)return[e];if(s(e)<t-n)return[e];for(var i=Math.max(2,Math.floor(a(t-n)/3)),l=Math.ceil(e.length/i),u=new Array(l),d=0,p=0;d<e.length;){var h=o(e,d+i-1)?i-1:i;u[p++]=e.substr(d,h),d+=h}return u};var a=function(e){return 1e3*e},c=function(e){return e/1e3}},99727:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentStatistics=void 0;var r=n(16595);!function(e){function t(e,t){var n=t/60,i=r.DateUtils.secondsToTime(e/n);return i.s=i.h>0&&i.m>10?0:Math.floor(i.s),i}e.calculateReadingTime=function(e){return t(e,250)},e.calculateSpeakingTime=function(e){return t(e,130)},e.generateStats=function(t,n){var r={words:t,chars:n,sentences:Math.floor(t/5),readingTime:{},speakingTime:{},uniqueWords:40*Math.random(),uniqueWordsIndex:100*Math.random(),rareWords:20*Math.random(),rareWordsIndex:100*Math.random(),wordLength:5.4,wordLengthIndex:100*Math.random(),sentenceLength:16.7,sentenceLengthIndex:100*Math.random(),readabilityScore:73,readabilityDescription:"Your text is likely to be understood by a reader who has at least 7th grade education (age 12)"};return r.readingTime=e.calculateReadingTime(r.words),r.speakingTime=e.calculateSpeakingTime(r.words),r}}(t.DocumentStatistics||(t.DocumentStatistics={}))},32769:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Dapi=t.DapiPropertiesSerializationError=t.Properties=t.PropertyImpl=t.emptyValue=void 0;var r=n(59312),i=n(95195),o=n(45614),s=n(40327),a=n(69243),c=n(32687),l=n(16595),u=n(18410),d=n(52868);function p(e){return"null"===e||"undefined"===e||null==e}function h(e){if(null===e||"null"===e||"boolean"==typeof e)return null;var t=Number(e);return Number.isNaN(t)?null:t}function m(e){return p(e)?null:"true"===e||"false"!==e&&"0"!==e&&Boolean(e)}function f(e){try{return JSON.parse(decodeURI(e))}catch(e){return null}}t.emptyValue=p;var g,y=function(){function e(e){this._value=e}return e.prototype.getStr=function(){return p(this._value)?null:String(this._value)},e.prototype.getNum=function(){return h(this._value)},e.prototype.getBool=function(){return m(this._value)},e.prototype.getBoolOrDefault=function(e){return function(e,t){return p(e)?t:"true"===e||"false"!==e&&"0"!==e&&Boolean(e)}(this._value,e)},e.prototype.getObject=function(){return f(this._value)},e.prototype.getArray=function(){return f(this._value)},e.prototype.getObjProp=function(e){return Boolean(this._value.hasOwnProperty(e))?this._value[e]:null},e}();t.PropertyImpl=y,function(e){e.find=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.find((function(t){return t.has(e)}));return new y(r&&r[e])},e.of=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=new v,r=0,i=e;r<i.length;r++){var o=i[r];for(var s in o){var a=o[s];n[s]="object"==typeof a?encodeURI(JSON.stringify(a)):a}}return n},e.is=function(e){return e instanceof v}}(g=t.Properties||(t.Properties={}));var _,v=function(){function e(){}return e.prototype.getStr=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.getNum=function(e){return this.hasOwnProperty(e)?h(this[e]):null},e.prototype.getBool=function(e){return this.hasOwnProperty(e)?m(this[e]):null},e.prototype.getObject=function(e){return this.hasOwnProperty(e)?f(this[e]):null},e.prototype.has=function(e){return this.hasOwnProperty(e)},e.prototype.ifPresent=function(e,t){Boolean(this[e])&&t(this[e])},e.prototype.entries=function(){var e=this;return Object.keys(this).map((function(t){return[t,new y(e[t])]}))},e.find=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.find((function(t){return t.has(e)}));return new y(r&&r[e])},e}(),b=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=t,r.details=n,r.name="DapiPropertiesSerializationError",r}return r.__extends(t,e),t.prototype.toString=function(){return"DAPI properties serialization error\n      Message "+this.message+"\n      Details "+c.failure(this.details)},t}(l.CustomError);function E(e){return _.fromProperties(e).decode(e)}function I(e){return new b("Serialization failed",e)}t.DapiPropertiesSerializationError=b,function(e){var t=["{","}",";","="];e.property=new a.Type("property",(function(e){return!0}),(function(e,n){var r=n[1].key,i=String(e);return i.length>1024?a.failure(e,n,"Property "+r+" is too long (max length is 1024)"):t.some((function(e){return i.indexOf(e)>=0}))?a.failure(e,n,"Property "+r+" has forbidden characters ("+t.join(", ")+")"):a.success(e)}),a.identity),e.fromProperties=function(t){return a.type(s.pipe(t,o.filter((function(e){return"function"!=typeof e})),o.map((function(t){return e.property}))))}}(_||(_={}));var S=function(){function e(e,t,n){this._fingerprints=n,this._endpoints={props:"props/v2",mimic:"mimic"},this._url=u.RequestBuilder.join(e,"api"),this._ajax=t({requestExtender:d.Fingerprints.toHeaderAppender(this._fingerprints)})}return e.prototype.load=function(){return s.pipe(this._ajax.json(u.RequestBuilder.get(this._url,this._endpoints.props)),this._ajax.map(g.of))},e.prototype.get=function(e){return s.pipe(this._ajax.text(u.RequestBuilder.get(this._url,this._endpoints.props,e)),this._ajax.map((function(t){var n;return g.of(((n={})[e]=t||null,n))})))},e.prototype.save=function(e){var t=this;return s.pipe(e,E,i.mapLeft(I),i.fold(this._ajax.throwError,this._ajax.of),this._ajax.map((function(e){return u.RequestBuilder.post(t._url,t._endpoints.props).json(e)})),this._ajax.chain(this._ajax.empty))},e.prototype.getMimic=function(e){return this._ajax.json(u.RequestBuilder.get(this._url,this._endpoints.mimic).cookie("gnar_containerId",e))},e.prototype.getMimicWithProps=function(e){return s.pipe(this._ajax.json(u.RequestBuilder.get(this._url,this._endpoints.mimic,"withProps").cookie("gnar_containerId",e)),this._ajax.map((function(e){var t=e.groups,n=e.properties;return{experiments:new Set(t),properties:g.of(n)}})))},e.targetTag="dapi",e}();t.Dapi=S},64613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaUtils=void 0;var r=n(57050),i=n(40327),o=n(64450),s=n(16595);!function(e){e.isInsert=function(e){return"insert"in e},e.isInsertString=function(t){return e.isInsert(t)&&"string"==typeof t.insert},e.isInsertEmbed=function(t){return e.isInsert(t)&&!e.isInsertString(t)},e.isDelete=function(e){return"delete"in e},e.isRetain=function(e){return"retain"in e},e.containsInsertsOnly=function(t){return t.ops.every(e.isInsert)},e.getInsertLength=o.Delta.Op.length,e.getTrimmedInsertLength=function(t){return e.isInsertString(t)?t.insert.trim().length:1},e.match=function(t,n,r){return function(i){return e.isInsert(i)?t(i):e.isDelete(i)?n(i):r(i)}},e.getAttr=function(t,n){return e.isDelete(t)||!t.attributes?s.O.none:"function"==typeof n?i.pipe(s.O.fromNullable(Object.keys(t.attributes).find(n)),s.O.map((function(e){return t.attributes[e]}))):s.O.fromNullable(t.attributes[n])},e.operationLength=o.Delta.Op.length;var t=function(e){return-e.delete};e.getOperationOffset=e.match(o.Delta.Op.length,t,o.Delta.Op.length);var n=function(e){return function(t){return t.ops.map(e).reduce(s.sum,0)}},a=function(){return 0};e.calcDiffLength=n(e.match(o.Delta.Op.length,t,a)),e.calcAmountLength=n(e.match(o.Delta.Op.length,o.Delta.Op.length,a)),e.calcAffectedLength=n(e.match(a,o.Delta.Op.length,o.Delta.Op.length)),e.rangeOfTheChange=function(t){var n=e.match(r.constTrue,r.constTrue,(function(e){return Boolean(e.attributes)}));return t.ops.reduce((function(t,r){var o=t[0],a=t[1],c=e.operationLength(r),l=a+c;return[i.pipe(o,s.O.fold((function(){return n(r)?s.O.some([a,l]):s.O.none}),(function(e){return n(r)?s.O.some([e[0],l]):s.O.some(e)}))),l]}),[s.O.none,0])[0]},e.isEqual=function(t){return function(n,r){return e.match((function(n){return e.isInsert(r)&&n.insert===r.insert&&t(n.attributes,r.attributes)}),(function(t){return e.isDelete(r)&&t.delete===r.delete}),(function(n){return e.isRetain(r)&&n.retain===r.retain&&t(n.attributes,r.attributes)}))(n)}},e.deltaEq=s.Eq.fromEquals((function(t,n){return t.ops.length===n.ops.length&&s.ArrayUtils.compareInPairs(t.ops,n.ops,e.isEqual(s.ObjectUtils.deepEqual))})),e.normalizeDelta=function(e){return(new o.Delta).compose(e)};var c=function(e){return e&&Object.keys(e).reduce((function(t,n){return t[n]="string"==typeof e[n]?"<"+e[n].length+">":e[n],t}),{})};e.anonymizeTextAndStringAttrs=function(t){return t.ops.reduce((function(t,n){return e.match((function(n){return t.insert("string"==typeof n.insert?"<"+e.getInsertLength(n)+">":"<embed>",c(n.attributes))}),(function(e){return t.delete(e.delete)}),(function(e){return t.retain(e.retain,c(e.attributes))}))(n)}),new o.Delta)},e.squash=function(e){return e.reduce((function(e,t){return e.compose(new o.Delta(t))}),new o.Delta)},e.cleanAllAttrs=function(t){return t.reduce((function(t,n){return e.match((function(e){return t.insert(e.insert)}),(function(e){return t.delete(e.delete)}),(function(e){return t.retain(e.retain)}))(n)}),new o.Delta)};var l=function(e){return s.O.fromNullable(e.attributes)};e.getAttrs=e.match(l,(function(){return s.O.none}),l),e.skipAny=r.constFalse;e.cleanDelta=function(t,n){return function(r){var i=function(e){return e&&Object.keys(e).filter((function(e,t,r){return n(e,r.slice(0))})).reduce((function(t,n){return t[n]=e[n],t}),{})};return r.reduce((function(n,r){return e.match((function(e){return n.insert("string"==typeof e.insert||t(e.insert)?e.insert:" ",i(e.attributes))}),(function(e){return n.delete(e.delete)}),(function(e){return n.retain(e.retain,i(e.attributes))}))(r)}),new o.Delta)}},e.splitToDeleteThenInsert=function(t){return t.reduce((function(t,n){var r=t[0],i=t[1];return e.match((function(e){return[r,i.push(e)]}),(function(e){return[r.push(e),i]}),(function(e){return[r.push({retain:e.retain}),i.push(e)]}))(n)}),[new o.Delta,new o.Delta]).map((function(e){return e.chop()}))},e.nonEmpty=function(e){return e.ops.length>0},e.findInDelta=function(e,t){return void 0===t&&(t=a),function(n){for(var r=0,i=0;r<n.ops.length;){var a=n.ops[r];if(e(a))return i+=t(a),s.O.some(i);i+=o.Delta.Op.length(a),r+=1}return s.O.none}}}(t.DeltaUtils||(t.DeltaUtils={}))},93153:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.genreToDocumentContext=t.domainToGenre=t.genreToDomain=t.DocumentContext=void 0;var r,i=n(59312),o=n(73975),s=n(57050),a=n(40327),c=n(69243),l=n(32687),u=n(16595),d=n(81531),p=n(34930),h=u.O.getEq({equals:function(e,t){return e===t}});function m(e){if(!Boolean(e))return"general";switch(e.split("_")[0]){case"academic":return"academic";case"business":return"business";case"technical":case"medical":return"mail";case"creative":return"creative";case"casual":return"casual";default:return"general"}}!function(e){e.equals=function(e,t){return u.O.getEq(o.eqStrict).equals(e.domain,t.domain)&&u.O.getEq({equals:u.isSetsEq}).equals(e.goals,t.goals)&&h.equals(e.audience,t.audience)&&h.equals(e.style,t.style)&&u.O.getEq({equals:u.isSetsEq}).equals(e.emotions,t.emotions)},e.goals=p.literalArray(["inform","describe","convince","tellStory","sell"]),e.goalsLabels=["Inform","Describe","Convince","Tell A Story"],e.audiences=p.literalArray(["general","knowledgeable","expert"]),e.formalityLevels=p.literalArray(["informal","neutral","formal"]),e.tone=p.literalArray(["neutral","confident","joyful","optimistic","friendly","urgent","analytical","respectful"]),e.domains=p.literalArray(["academic","business","general","mail","casual","creative"]),e.dialects=p.literalArray(["american","british","canadian","australian"]),e.fromDomain=function(t){return i.__assign(i.__assign({},e.unset),{domain:u.O.some(t)})},e.fromGoals=function(t){return i.__assign(i.__assign({},e.unset),{goals:u.O.some(new Set(t))})},e.unset={goals:u.O.none,domain:u.O.none,emotions:u.O.none,audience:u.O.none,style:u.O.none,dialect:u.O.none},e.defaultContextFallback={goals:new Set,domain:"general",emotions:new Set,audience:"knowledgeable",style:"neutral",dialect:u.O.none},e.isStyleValidWithDomain=function(e,t){return"neutral"===t||("formal"===t?"creative"!==e&&"casual"!==e:"academic"!==e)};var t=p.Type.literalUnion("goal",e.goals),n=p.Type.set(t),r=p.Type.literalUnion("audience",e.audiences),m=p.Type.literalUnion("formality",e.formalityLevels),f=p.Type.literalUnion("tone",e.tone),g=p.Type.set(f),y=p.Type.literalUnion("domain",e.domains),_=p.Type.literalUnion("dialect",e.dialects);e.IOType=c.interface({goals:p.Type.option(n),domain:p.Type.option(y),audience:p.Type.option(r),style:p.Type.option(m),emotions:p.Type.option(g),dialect:p.Type.option(_)}),e.IOTypeDefault=c.interface({goals:n,domain:y,audience:r,style:m,emotions:g,dialect:p.Type.option(_)}),e.tryParse=function(e){return function(t){return a.pipe(e(t),u.E.mapLeft(l.failure),u.E.mapLeft((function(e){return d.Monitoring.Logging.getLogger("coreclients.dox.context").warn("failed to parse document context",e),e})))}},e.parse=s.flow(u.O.fromNullable,u.O.chain((function(t){return a.pipe(t,e.tryParse(e.IOType.decode),u.O.fromEither)}))),e.parseDefault=s.flow(u.O.fromNullable,u.O.chain(s.flow(e.tryParse((function(t){return e.IOTypeDefault.decode(t)})),u.O.fromEither))),e.serialize=function(t){return e.IOType.encode(t)},e.serializeDefault=function(t){return e.IOTypeDefault.encode(t)}}(r=t.DocumentContext||(t.DocumentContext={})),t.genreToDomain=m,t.domainToGenre=function(e){switch(e){case"general":return"general";case"academic":return"academic_general";case"business":return"business_other";case"mail":return"technical_other";case"creative":return"creative_other";case"casual":return"casual_other";default:return e}},t.genreToDocumentContext=function(e){return r.fromDomain(m(e))}},6760:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBuilder=t.TransitionBuilder=t.WithBuilder=t.StateMachine=t.EventInfo=void 0;var r=n(59312),i=n(81531),o=function(){function e(e,t,n,r){this.from=e,this.to=t,this.event=n,this.args=r}return e.prototype.toString=function(){return"Transition: From: "+this.from+" to: "+this.to+" (Args: "+this.args+")"},e}();t.EventInfo=o;var s=function(){function e(t,n,r){this._name=t,this._log=i.Monitoring.Logging.getLogger("coreclients.fsm"),this._parents={},this._transitions={},this._scheduled=[],this._listeners={},this._inTransition=!1,this._verbose=!1,this._id=++e._ids,this._current=n,this._final=null!=r?r:null}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFinal",{get:function(){return this._final===this._current},enumerable:!1,configurable:!0}),e.prototype.transition=function(e,t,n){this._transitions[e<<11|n]=t},e.prototype.parent=function(e,t){this._parents[e]=t},e.prototype.is=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.findIndex((function(t){return t===e._current}))>=0},e.prototype.from=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(c.bind.apply(c,r.__spreadArrays([void 0,this],e)))},e.prototype.with=function(e){return new a(this,e)},e.prototype.verbose=function(e,t){return this._verbose=!0,this._states=e,this._events=t,this},e.prototype.on=function(e,t){return this._addCallback(this._listeners,e,t),this},e.prototype.event=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(i){return[2,new Promise((function(i,s){return r.__awaiter(n,void 0,void 0,(function(){var n,a,c,l;return r.__generator(this,(function(d){switch(d.label){case 0:if(this._verbose&&this._trace("Handling event "+this._eventName(e)+", currently in "+this._stateName(this._current)),this._current===this._final)return this._trace("Cannot handle event "+e+": FSM is in it's final state "+this._current),[2,i(!1)];if(this._inTransition)return this._scheduled.push(new u(e,t,i,s)),[2];n=this._current,a=null,c=function(){var s,c,u,d,p,h,m;return r.__generator(this,(function(f){switch(f.label){case 0:if(void 0===(s=l._transitions[n<<11|e]))return[3,10];l._inTransition=!0,c=Boolean(l._listeners[s])?l._listeners[s]:[],u=new o(l._current,s,e,t),f.label=1;case 1:f.trys.push([1,7,8,9]),l._verbose&&l._trace("Transition from "+l._stateName(u.from)+" to "+l._stateName(u.to)+" on "+l._eventName(e)+" Arguments: "+t),l._current=s,d=c.map((function(e){return Promise.resolve(e(u))})),l._inTransition=!1,p=function(e){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,l.event(e.event,e.args).then((function(t){return e.done(t)})).catch((function(t){return e.fail(t)}))];case 1:return t.sent(),[2]}}))},h=l._scheduled.shift(),f.label=2;case 2:return void 0===h?[3,5]:[5,p(h)];case 3:f.sent(),f.label=4;case 4:return h=l._scheduled.shift(),[3,2];case 5:return[4,Promise.all(d).then((function(e){return i(!0)}))];case 6:return f.sent(),[3,9];case 7:return m=f.sent(),a=m,[3,9];case 8:return l._inTransition=!1,[7];case 9:return[2,"break"];case 10:return n=l._parents[n],[2]}}))},l=this,d.label=1;case 1:return void 0===n?[3,3]:[5,c()];case 2:return"break"===d.sent()?[3,3]:[3,1];case 3:return Boolean(a)?s(a):i(!1),[2]}}))}))}))]}))}))},e.prototype._addCallback=function(e,t,n){var r=e[t];return Boolean(r)||(r=[],e[t]=r),r.push(n),this},e.prototype._eventName=function(e){return void 0===this._events?e:this._events[e]},e.prototype._stateName=function(e){return void 0===this._states?e:this._states[e]},e.prototype._trace=function(e){this._log.trace("FSM#"+this._id+(this._name&&"_"+this._name)+" [VERBOSE]: "+e)},e._ids=0,e}();t.StateMachine=s;var a=function(){function e(e,t){this.hsm=e,this.state=t}return e.prototype.childrenOf=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach((function(t){return e.hsm.parent(e.state,t)})),this.hsm},e.prototype.parentOf=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach((function(t){return e.hsm.parent(t,e.state)})),this.hsm},e}();t.WithBuilder=a;var c=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.hsm=e,this._states=t}return e.prototype.to=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new l(this.hsm,this._states,e)},e}();t.TransitionBuilder=c;var l=function(){function e(e,t,n){this.hsm=e,this.from=t,this.to=n}return e.prototype.on=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach((function(t){return e.from.forEach((function(n){return e.to.forEach((function(r){return e.hsm.transition(n,r,t)}))}))})),this.hsm},e}();t.EventBuilder=l;var u=function(e,t,n,r){this.event=e,this.args=t,this.done=n,this.fail=r}},52868:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCookiesAppender=t.createHeadersAppender=t.Fingerprints=void 0;var r=n(59312);function i(e){var t=this;return function(n){return function(){return r.__awaiter(t,void 0,void 0,(function(){var t,i,o,s,a,c,l,u;return r.__generator(this,(function(r){switch(r.label){case 0:for(i in t=[],e)t.push(i);o=0,r.label=1;case 1:return o<t.length?(s=t[o],a=e[s],l=(c=n).header,u=[s],[4,"function"==typeof a?a():a]):[3,4];case 2:l.apply(c,u.concat([r.sent()])),r.label=3;case 3:return o++,[3,1];case 4:return[2,n]}}))}))}}}!function(e){e.toHeaderAppender=function(e){return i({"X-Client-Version":e.clientVersion.toString(),"X-Client-Type":function(){return e.clientName},"X-Container-Id":e.containerId,"X-CSRF-Token":e.csrfToken})}}(t.Fingerprints||(t.Fingerprints={})),t.createHeadersAppender=i,t.createCookiesAppender=function(e){var t=this;return function(n){return function(){return r.__awaiter(t,void 0,void 0,(function(){var t,i,o,s,a,c,l,u;return r.__generator(this,(function(r){switch(r.label){case 0:for(i in t=[],e)t.push(i);o=0,r.label=1;case 1:return o<t.length?(s=t[o],a=e[s],l=(c=n).cookie,u=[s],[4,"function"==typeof a?a():a]):[3,4];case 2:l.apply(c,u.concat([r.sent()])),r.label=3;case 3:return o++,[3,1];case 4:return[2,n]}}))}))}}}},70861:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CappedIdGenerator=void 0;var r=n(16595),i=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!0),this._capacity=e,this._start=t,this._allowOverflow=n,this._nextId=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._nextId},enumerable:!1,configurable:!0}),e.prototype.newId=function(){var e=this._nextId;if(e>this._capacity){if(!this._allowOverflow)throw new r.InvariantError("ids limit reached: "+this._capacity);this._nextId=e=0}return this._nextId++,e},e.prototype.reset=function(){this._nextId=this._start},e}();t.CappedIdGenerator=i},34930:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Type=t.literalArray=void 0;var r=n(59312),i=n(40327),o=n(69243),s=n(16595),a=n(32769);function c(e){return e}t.literalArray=c,function(e){function t(e){return function(t){return s.O.is(t)&&i.pipe(t,s.O.fold((function(){return!0}),e.is))}}function n(e){return function(t){return Array.isArray(t)&&t.length>0&&t.every(e.is)}}e.set=function(e){return new o.Type("Set<"+e.name+">",(function(e){return e instanceof Set}),(function(t,n){return s.E.either.map(o.array(e).validate(t,n),(function(e){return new Set(e)}))}),(function(e){return Array.from(e)}))},e.getIsOption=t,e.option=function(e){return new o.Type("option:"+e.name,t(e),(function(t,n){return null==t?s.E.right(s.O.none):s.E.either.map(e.validate(t,n),s.O.some)}),s.O.fold((function(){}),e.encode))},e.opaque=function(e){return new o.Type("Opaque",(function(e){return"string"==typeof e}),(function(t,n){return s.E.either.chain(e.validate(t,n),(function(e){return o.success(e)}))}),(function(e){return e}))},e.getIsNEA=n,e.nonEmptyArray=function(e){return new o.Type("NEA",n(e),(function(t,n){return s.E.either.chain(o.array(e).validate(t,n),(function(e){return e.length>0?o.success(e):o.failure(e,n,"Array is empty")}))}),(function(e){return s.O.unsafeGet(s.NEA.fromArray(e))}))},e.literalUnion=function(e,t){return o.union(t.map((function(e){return o.literal(e)})),e+":string")},e.date=function(){return new o.Type("Date",(function(e){return e instanceof Date}),(function(e,t){var n=Date.parse(e.toString()),r=isNaN(n)?e:n;return s.E.either.map(o.number.validate(r,t),(function(e){return new Date(e)}))}),(function(e){return e.getTime()}))};var c=function(e){return o.string.is(e)&&!Number.isNaN(Number(e))};e.stringFromNumber=new o.Type("stringFromNumber",c,(function(e,t){return c(e)?o.success(e):"number"!=typeof e||Number.isNaN(e)?o.failure(e,t):o.success(e.toString())}),(function(e){return Number(e)})),e.withDefault=function(e,t){return new o.Type("withDefault("+JSON.stringify(t)+"):"+e.name,e.is,(function(n,r){return e.validate(a.emptyValue(n)?t:n,r)}),e.encode)},e.fallback=function(e,t){return new o.Type("fallback("+JSON.stringify(t)+"):"+e.name,e.is,(function(n,r){var i=e.validate(n,r);return s.E.isLeft(i)?s.E.right(t):i}),e.encode)};var l=function(e,t){Array.prototype.push.apply(e,t)},u=["boolean","string","Date","number","Array","Set","object","Dictionary","StringEnum","Partial"];function d(e,t){var n=function(e){var t=e.replace(/\w+\(.*?\):/,"");if("{"===t[0]&&"}"===t[t.length-1])return"object";var n=t.split(":").pop();return 0===n.indexOf("Date")?"Date":0===n.indexOf("Array<")?"Array":0===n.indexOf("Set<")?"Set":0===n.indexOf("StringEnum<")?"StringEnum":0===t.indexOf("Partial<")?"Partial":(s.invariant(u.indexOf(n)>-1,"unsupported prop type "+e),n)}(e);switch(n){case"boolean":return t.getBool();case"string":case"StringEnum":return t.getStr();case"Date":return null===t.getNum()?t.getStr():t.getNum();case"number":return t.getNum();case"Array":case"Set":return t.getArray();case"object":case"Partial":case"Dictionary":return t.getObject();default:return s.assertNever(n)}}e.properties=function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=function(e){return"{ "+Object.keys(e).map((function(t){return t+": "+e[t].name})).join(", ")+" }"}(e)),new o.InterfaceType(n,(function(t){if(!a.Properties.is(t))return!1;for(var n in e)if(!e[n].is(t[n]))return!1;return!0}),(function(n,c){if(!Array.isArray(n)||n.some((function(e){return!a.Properties.is(e)})))return o.failure(n,c);var u={},p=[],h=function(h){var m=""!==t?t+":"+h:h,f=a.Properties.find.apply(a.Properties,r.__spreadArrays([m],n)),g=e[h],y=d(g.name,f),_=g.validate(y,o.appendContext(c,h,g));i.pipe(_,s.E.fold((function(e){return l(p,e)}),(function(e){u[h]=e})))};for(var m in e)h(m);return p.length?o.failures(p):o.success(u)}),(function(n){var r={};for(var i in e){var o=""!==t?t+":"+i:i,s=e[i],c=n[i];s.is(c)&&(r[o]=e[i].encode(c))}return a.Properties.of(r)}),e)},e.combineProperties=function(e,t){void 0===t&&(t="("+e.map((function(e){return e.name})).join(" & ")+")");var n=e.length;return new o.IntersectionType(t,(function(t){return e.every((function(e){return e.is(t)}))}),(function(t,r){for(var a={},c=[],u=0;u<n;u++){var d=e[u].validate(t,r);i.pipe(d,s.E.fold((function(e){return l(c,e)}),(function(e){return Object.assign(a,e)})))}return c.length?o.failures(c):o.success(a)}),(function(t){return a.Properties.of.apply(a.Properties,e.map((function(e){return e.encode(t)})))}),e)},e.createStringEnum=function(e,t){return o.keyof(Object.values(e).reduce((function(e,t){return e[t]=null,e}),{}),"StringEnum<"+t+">")}}(t.Type||(t.Type={}))},62097:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserWebSocket=void 0;try{n=null!==WebSocket&&void 0!==WebSocket?WebSocket:self.MozWebSocket}catch(e){}function r(e,t){return Boolean(t)?new n(e,t):new n(e)}Boolean(n)&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(r,e,{get:function(){return n[e]}})})),t.BrowserWebSocket=Boolean(n)?r:null},49150:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Diff=t.Change=t.DeltaChange=t.Delta=void 0;var r,i=n(57050),o=n(64450),s=n(16595),a=n(64613),c=n(64450);Object.defineProperty(t,"Delta",{enumerable:!0,get:function(){return c.Delta}}),function(e){e.split=function(e,t){return[e]}}(t.DeltaChange||(t.DeltaChange={})),function(e){e.fromArrayOfDeltas=function(t,n){var r=n;return t.map((function(t){var n=e.delta(t,r);return r+=a.DeltaUtils.calcDiffLength(t),n}))};var t=function(){function e(e,t){this.delta=e,this.prevLen=t,this.kind="delta",this._length=void 0,this._amount=void 0,this._text=void 0}return Object.defineProperty(e.prototype,"length",{get:function(){return Boolean(this._length)?this._length:this._length=a.DeltaUtils.calcDiffLength(this.delta)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"amount",{get:function(){return Boolean(this._amount)?this._amount:this._amount=a.DeltaUtils.calcAmountLength(this.delta)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var e=this;return this._text||(this._text=s.E.tryCatchError((function(){return e.delta.ops.reduce((function(e,t){return a.DeltaUtils.match((function(t){return""+e+t.insert}),(function(){throw new Error("can not get text on delta with deletes")}),(function(){throw new Error("can not get text on delta with retains")}))(t)}),"")})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.delta.ops.length},enumerable:!1,configurable:!0}),e.prototype.compose=function(t){return new e(this.delta.compose(t.delta),this.prevLen)},e.prototype.transform=function(t,n){return void 0===n&&(n=!0),new e(t.delta.transform(this.delta,n),this.prevLen+t.length)},e.prototype.toJSON=function(){return{kind:this.kind,delta:a.DeltaUtils.anonymizeTextAndStringAttrs(this.delta),prevLen:this.prevLen,length:this.length,amount:this.amount}},e.prototype.toString=function(){return"Delta("+this.delta+", pl: "+this.prevLen+")"},e}(),n=function(){function e(){this.kind="flush"}return e.prototype.toString=function(){return"Flush()"},e}(),r=function(){function e(e){this.delta=e,this.kind="reset"}return Object.defineProperty(e.prototype,"text",{get:function(){var e=this;return this._text||(this._text=s.E.tryCatchError((function(){return e.delta.ops.reduce((function(e,t){if(a.DeltaUtils.isInsert(t))return""+e+t.insert;throw a.DeltaUtils.isDelete(t)?new Error("can not get text on delta with deletes"):new Error("can not get text on delta with retains")}),"")})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return Boolean(this._length)?this._length:this._length=a.DeltaUtils.calcDiffLength(this.delta)},enumerable:!1,configurable:!0}),e.prototype.compose=function(e){return l(this.delta.compose(e.delta))},e.prototype.toJSON=function(){return{kind:this.kind,delta:a.DeltaUtils.anonymizeTextAndStringAttrs(this.delta),length:this.length}},e.prototype.toString=function(){return"Reset("+this.delta+")"},e}();function c(e,n){return void 0===n&&(n=0),new t(e,n)}function l(e){return a.DeltaUtils.containsInsertsOnly(e)?s.E.right(new r(e)):s.E.left(new Error("Delta should contains only inserts to be Reset"))}e.delta=c,e.ins=function(e,t,n){return void 0===n&&(n=0),c((new o.Delta).retain(e).insert(t),n)},e.del=function(e,t,n){return void 0===n&&(n=0),c((new o.Delta).retain(e).delete(t),n)},e.ret=function(e,t,n){return void 0===t&&(t=0),c((new o.Delta).retain(e,n),t)},e.res=l,e.unsafeRes=i.flow(l,s.E.unsafeGet),e.resFromText=function(e){return s.E.unsafeGet(l((new o.Delta).insert(e)))},e.flush=function(){return new n},e.isDelta=function(e){return"delta"===e.kind},e.isReset=function(e){return"reset"===e.kind},e.isFlush=function(e){return"flush"===e.kind}}(r=t.Change||(t.Change={})),function(e){e.diffAsChanges=function(e,t){var n=(new o.Delta).insert(e),i=(new o.Delta).insert(t);return r.delta(n.diff(i),e.length)}}(t.Diff||(t.Diff={}))},26696:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Reconnect=void 0;var r=n(59312),i=n(35214),o=n(40327),s=n(5986),a=n(16595),c=n(81531),l=function(){function e(e){void 0===e&&(e=5*a.DateUtils.MS_IN_MIN),this._windowTime=e,this._count=0}return e.prototype.inc=function(){this._count++,this._startCounter()},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),e.prototype._startCounter=function(){var e=this;this._timer=this._timer||setTimeout((function(){e._timer=void 0,e._count-- >0&&e._startCounter()}),this._windowTime)},e}();!function(e){var t,n;!function(e){e[e.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",e[e.GOING_AWAY=1001]="GOING_AWAY",e[e.CLOSED_ABNORMALLY=1006]="CLOSED_ABNORMALLY",e[e.NOT_CONSISTENT=1007]="NOT_CONSISTENT",e[e.VIOLATED_POLICY=1008]="VIOLATED_POLICY",e[e.TOO_BIG=1009]="TOO_BIG",e[e.UNEXPECTED_CONDITION=1011]="UNEXPECTED_CONDITION",e[e.SERVICE_RESTART=1012]="SERVICE_RESTART",e[e.CLIENT_MALFUNCTION=3e3]="CLIENT_MALFUNCTION",e[e.BLOCKED_BY_CLIENT=4e3]="BLOCKED_BY_CLIENT",e[e.UNAUTHORIZED=4001]="UNAUTHORIZED",e[e.SERVER_SHUTDOWN=4002]="SERVER_SHUTDOWN",e[e.NOT_FOUND=4004]="NOT_FOUND",e[e.PRECONDITION_FAILED=4012]="PRECONDITION_FAILED",e[e.TOO_MANY_REQUESTS=4029]="TOO_MANY_REQUESTS",e[e.UNKNOWN_WS_ERROR=-1]="UNKNOWN_WS_ERROR"}(t=e.WsCodes||(e.WsCodes={})),function(e){e.capi="capi",e.dox="dox"}(n=e.ClientType||(e.ClientType={}));e.getIdleReconnect=function(e){var t=c.Monitoring.Logging.getLogger("coreclients."+n[e]+".reconnect",c.Logging.LogLevel.TRACE);return function(n,r){var i={client:e,code:n.code,reason:n.reason,reconnectCounter:r.retryStatus.iterNumber};return t.info("skipping reconnect ",i),a.E.right({kind:"idle"})}},e.getDefaultReconnect=function(e,i){var s=this;void 0===i&&(i=5);var u=c.Monitoring.Logging.getLogger("coreclients."+n[e]+".reconnect",c.Logging.LogLevel.TRACE),d=new l;return function(n,c,l){return function(e){return"RUNTIME_ERROR"===e.error.status}(n)&&(u.debug("disconnected because of runtime error"),d.inc()),o.pipe(function(e,n,r,i,s,c){if(void 0===c&&(c="backOffReconnect"),n.iterNumber>10)return a.E.left(new Error("Maximum number (10) of reconnect attempts reached"));switch(e.code){case t.NORMAL_CLOSURE:case t.GOING_AWAY:return o.pipe(s.canGoIdle?"idle":"backOffReconnect",a.E.right);case t.TOO_BIG:return a.E.left(new Error("WS closed because message was too big"));case t.UNEXPECTED_CONDITION:return o.pipe(r>i?"idle":"backOffReconnect",a.E.right);case t.CLOSED_ABNORMALLY:case t.VIOLATED_POLICY:case t.SERVICE_RESTART:case t.SERVER_SHUTDOWN:case t.TOO_MANY_REQUESTS:return a.E.right("backOffReconnect");case t.NOT_FOUND:return a.E.left(new Error("WS closed due to not found error"));case t.UNAUTHORIZED:return a.E.left(new Error("WS closed due to unauthorized error"));case t.CLIENT_MALFUNCTION:case t.BLOCKED_BY_CLIENT:return!s.isStable&&n.iterNumber>1?a.E.left(new Error("Failed to init connection for the second time")):a.E.right("backOffReconnect");case t.NOT_CONSISTENT:return n.iterNumber>1?a.E.left(new Error("Tried to send invalid message for the second time in a row")):a.E.right("backOffReconnect");case t.PRECONDITION_FAILED:return a.E.left(new Error("Precondition failed"));default:return a.E.right(c)}}(n,c.retryStatus,d.count,i,l),a.E.chain((function(t){var i,o={client:e,code:n.code,reason:n.reason,reconnectDecision:t,reconnectStatus:c.retryStatus};switch(t){case"idle":return u.debug("Skip reconnect, going idle",o),a.E.right({kind:"idle"});case"backOffReconnect":return u.debug("Trying to reconnect",o),a.E.right({kind:"scheduledReconnect",reconnect:(i=c.retryStatus,r.__awaiter(s,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c.scheduleReconnect(i)];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),u.warn("Reconnect failed due to error ",e),[3,3];case 3:return[2]}}))})))});default:return a.E.left(new Error("unsupported reconnect decision: "+t))}})))}},e.defaultRetryPolicy=function(e,t){return void 0===e&&(e=a.DateUtils.MS_IN_SEC),void 0===t&&(t=a.DateUtils.MS_IN_MIN),s.capDelay(t,s.exponentialBackoff(e))};var u=function(){function t(t,n){void 0===n&&(n=[e.defaultRetryPolicy()]),this._reconnect=t,this.retryPolicies=n,this._log=c.Monitoring.Logging.getLogger("coreclients.reconnect.scheduler"),this._policy=i.fold(s.monoidRetryPolicy)(n),this.retryStatus=s.defaultRetryStatus}return t.prototype.reset=function(){this.retryStatus=s.defaultRetryStatus},t.prototype.scheduleReconnect=function(e){var t=this;return void 0===e&&(e=this.retryStatus),this.retryStatus=s.applyPolicy(this._policy,e),o.pipe(this.retryStatus.previousDelay,a.O.tap((function(e){return t._log.debug("Reconnecting after timeout "+e)})),a.O.fold(this._reconnect,(function(e){return a.delay(e).then(t._reconnect)})))},t}();e.ReconnectSchedulerImpl=u}(t.Reconnect||(t.Reconnect={}))},95302:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCookie=t.ValueRequester=t.ValueNotifier=t.retryWithDelay=t.retry=t.NotReadyError=t.NotConnectedError=t.DroppedError=t.TimeoutError=t.delay=t.assert=t.AssertionError=void 0;var r=n(59312),i=n(35214),o=n(40327),s=n(5986),a=n(43388),c=n(16595),l=n(81531),u=function(e){function t(t,n,r){var i=e.call(this,"AssertionError: "+r)||this;return i.expected=t,i.actual=n,i.name="AssertionError",i}return r.__extends(t,e),t.prototype.toString=function(){return this.message+"\nExpected: "+this.expected+"\nActual: "+this.actual},t}(c.CustomError);t.AssertionError=u,t.assert=function(e,t,n){if(e!==t)throw new u(e,t,n)},t.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))};var d=function(e){function t(t){var n=e.call(this,Boolean(t)?t:"Timeout")||this;return n.name="TimeoutError",n}return r.__extends(t,e),t.isTimeoutError=function(e){return e instanceof t},t}(c.CustomError);t.TimeoutError=d;var p=function(e){function t(t){var n=e.call(this,Boolean(t)?t:"Dropped")||this;return n.name="DroppedError",n}return r.__extends(t,e),t.isDroppedError=function(e){return e instanceof t},t}(c.CustomError);t.DroppedError=p;var h=function(e){function t(t){var n=e.call(this,Boolean(t)?t:"Not Connected to WS")||this;return n.name="NotConnectedError",n}return r.__extends(t,e),t.isNotConnectedError=function(e){return e instanceof t},t}(c.CustomError);t.NotConnectedError=h;var m=function(e){function t(t){var n=e.call(this,Boolean(t)?t:"Not ready")||this;return n.name="NotReady",n}return r.__extends(t,e),t.isNotReadyError=function(e){return e instanceof t},t}(c.CustomError);function f(e,t){void 0===t&&(t=function(){return!0});var n=i.fold(s.monoidRetryPolicy)(e);return function(e){return a.retrying(n,(function(t){return o.pipe(t.previousDelay,c.O.fold((function(){return e}),(function(n){return o.pipe(g(t.iterNumber,n),c.TE.apSecond(e))})))}),(function(e){return c.E.isLeft(e)&&t(e.left)}))}}t.NotReadyError=m,t.retry=f,t.retryWithDelay=function(e,t,n,r){return void 0===t&&(t=3),void 0===n&&(n=1e3),void 0===r&&(r=function(){return!0}),f([s.constantDelay(n),s.limitRetries(t)],r)(e)};var g=function(e,t){return c.TE.rightIO((function(){return l.Monitoring.Logging.root.getLogger("coreclients.utils").trace("retryWithDelay: count "+e+", timeout: "+t)}))},y=function(){function e(e,t,n){void 0===e&&(e=5e3),void 0===t&&(t=""),void 0===n&&(n=new d),this._timeout=e,this._timeoutError=n,this._notifications=new Map,this._log=l.Monitoring.Logging.getLogger("coreclients.valueNotifier"+(t.length>0?"."+t:""))}return e.prototype.waitFor=function(e,t){var n=this;return function(){return n._startNotificationWatch(e,t)}},e.prototype.notify=function(e){this._stopNotification(e,c.E.right(void 0))},e.prototype.error=function(e,t){this._log.trace("onError:("+e+")"),this._stopNotification(e,c.E.left(t))},e.prototype.clear=function(e){var t=this;this._log.trace("clearing notification watches: "+e),this._notifications.forEach((function(n,r){t.error(r,new p("clearing value notifier and dropping all pending notification watches:"+e))}))},e.prototype._startNotificationWatch=function(e,t){var n=this;this._log.debug("Starting notification watch: "+e),c.invariant(!this._notifications.has(e),"must not start watch for same notification twice, notification already watched: "+e);var r={};return r.promise=new Promise((function(e){r.notifyValue=function(){return e(c.E.right(t))},r.notifyError=function(t){return e(c.E.left(t))}})),r.timer=self.setTimeout((function(){return n._stopNotification(e,c.E.left(n._timeoutError))}),this._timeout),this._notifications.set(e,r),r.promise},e.prototype._stopNotification=function(e,t){this._log.trace("_stopNotification: stopping notification watch: "+e,t);var n=this._notifications.get(e);void 0===n?this._log.error("Got result for unknown notification or notification has already expired.",{id:e,result:t}):(clearTimeout(n.timer),o.pipe(t,c.E.fold((function(e){return n.notifyError(e)}),(function(){return n.notifyValue()}))),this._notifications.delete(e))},e}();t.ValueNotifier=y;var _=function(){function e(e,t,n){void 0===e&&(e=5e3),void 0===t&&(t=""),void 0===n&&(n=new d),this._timeout=e,this._timeoutError=n,this._requests=new Map,this._log=l.Monitoring.Logging.getLogger("coreclients.valueRequester"+(t.length>0?"."+t:""))}return e.prototype.watchRequest=function(e){return this._startRequestWatch(e)},e.prototype.onValue=function(e,t){this._stopRequest(e,c.E.right(t))},e.prototype.onError=function(e,t){this._log.trace("onError:("+e+")"),this._stopRequest(e,c.E.left(t))},e.prototype.clear=function(e){var t=this;this._log.trace("clearing request watches: "+e),this._requests.forEach((function(n,r){t.onError(r,new p("clearing value requester and dropping all pending request watches:"+e))}))},e.prototype._startRequestWatch=function(e){var t=this;this._log.debug("Starting request watch: "+e),c.invariant(!this._requests.has(e),"must not start watch for same request twice, request already watched: "+e);var n={};return n.promise=new Promise((function(e){n.resolve=e})),n.timer=self.setTimeout((function(){return t._stopRequest(e,c.E.left(t._timeoutError))}),this._timeout),this._requests.set(e,n),n.promise},e.prototype._stopRequest=function(e,t){this._log.trace("_stopRequest: stopping request watch: "+e,t);var n=this._requests.get(e);void 0===n?this._log.warn("Got result for unknown request or request has already expired.",{id:e,result:t}):(clearTimeout(n.timer),n.resolve(t),this._requests.delete(e))},e}();t.ValueRequester=_,t.parseCookie=function(e,t){if(!Boolean(e)||!Boolean(e.get))return c.E.left(new Error("received invalid headers object"));var n=new RegExp("("+t+"=.*?)(?=;)"),r=e.get("set-cookie");if(Boolean(r)){var i=r.match(n),o=i?i[0].split("=")[1].replace('"',""):void 0;return Boolean(o)?c.E.right(o):c.E.left(new Error("cookie "+t+" has empty value"))}return c.E.left(new Error("Got empty set-cookie header"))}},9518:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WSError=t.CloseEventInfo=t.WSCloseReasonImpl=t.WSConnection=t.STMWSConnection=t.SerializingWSConnection=t.WS=t.logPrintln=t.errPrintln=t.Events=t.States=void 0;var r,i,o=n(59312),s=n(40327),a=n(16595),c=n(81531),l=n(6760),u=n(62097),d=n(26696);!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.CLOSED=3]="CLOSED",e[e.ANY=4]="ANY"}(r=t.States||(t.States={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECT=2]="DISCONNECT",e[e.SEND=3]="SEND",e[e.CLOSE=4]="CLOSE"}(i=t.Events||(t.Events={}));t.errPrintln=function(e){c.Monitoring.Logging.getLogger("coreclients.errPrintln").error("WebSocket Error",e)};t.logPrintln=function(e){c.Monitoring.Logging.root.isEnabled(c.Logging.LogLevel.TRACE)&&c.Monitoring.Logging.getLogger("coreclients.errPrintln").trace("WebSocket:",{message:e})};var p=function(){function e(e){var n=this;this._createWSInstance=e,this._log=c.Monitoring.Logging.getLogger("coreclients.ws"),this._ondisconnect=[],this._onconnecting=[],this._onconnect=[],this._onerror=[t.errPrintln],this._onmessage=[],this._read=function(e){try{var t=JSON.parse(e);if(Boolean(t)&&"object"==typeof t&&null!==t)return t}catch(e){}return e},this._write=function(e){return"string"==typeof e?e:JSON.stringify(e)},this._createConnection=function(e){return new h(e,n._write)},this._fsm=new l.StateMachine("ws",r.DISCONNECTED,r.CLOSED).with(r.ANY).parentOf(r.CLOSED,r.CONNECTED,r.CONNECTING,r.DISCONNECTED).from(r.CONNECTING).to(r.CONNECTED).on(i.CONNECTED).from(r.CONNECTED,r.CONNECTING).to(r.DISCONNECTED).on(i.DISCONNECT).from(r.DISCONNECTED).to(r.CONNECTING).on(i.CONNECT).from(r.ANY).to(r.CLOSED).on(i.CLOSE).from(r.CONNECTED).to(r.CONNECTED).on(i.SEND).on(r.CONNECTED,(function(e){return o.__awaiter(n,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return e.from===r.CONNECTED?[3,2]:[4,Promise.all(this._onconnect.map((function(t){return Promise.resolve(t(e.args))})))];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})).on(r.DISCONNECTED,(function(e){return n._ondisconnect.forEach((function(t){return t(e.args)}))})),this._log.isEnabled(c.Logging.LogLevel.TRACE)&&this._fsm.verbose(r,i)}return e.create=function(t){return void 0===t&&(t=function(e){return new u.BrowserWebSocket(e)}),new e(t)},e.prototype.reader=function(e){return this._read=e,this},e.prototype.writer=function(e){return this._write=e,this},e.prototype.withConnection=function(e){return this._createConnection=e,this},e.prototype.onConnecting=function(e){return this._onconnecting.push(e),this},e.prototype.onConnect=function(e){return this._onconnect.push(e),this},e.prototype.onDisconnect=function(e){return this._ondisconnect.push(e),this},e.prototype.onMessage=function(e){return this._onmessage.push(e),this},e.prototype.onError=function(e){return this._onerror.push(e),this},e.prototype.connect=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return a.invariant(this.isDisconnected(),"can only connect WS that is currently disconnected, was "+r[this._fsm.current]),[2,this._createWebSocket(e,this._fsm)]}))}))},e.prototype.isDisconnected=function(){return this._fsm.is(r.DISCONNECTED)},e.prototype.isConnecting=function(){return this._fsm.is(r.CONNECTING)},e.prototype.isConnected=function(){return this._fsm.is(r.CONNECTED)},e.prototype._createWebSocket=function(e,t){var n=this;return this._log.trace("_createWebSocket("+r[t.current]+")"),t.event(i.CONNECT).then((function(c){return new Promise((function(l,u){if(!c){var p=new y({status:"Unknown",message:"Cannot connect",code:d.Reconnect.WsCodes.UNKNOWN_WS_ERROR,url:e});return t.event(i.DISCONNECT,new g(p)),void u(new Error("\n            WebSocket [ERROR] FSM cannot be switched to CONNECTING state from "+r[t.current]+"\n          "))}n._log.debug("Connecting to "+e),n._onconnecting.forEach((function(e){return e()}));var h,m,_=n._createWSInstance(e),v=(h=1e3,m=a.O.empty(),{scheduleIO:function(e){s.pipe(m,a.O.map(self.clearTimeout)),m=s.pipe(e,a.O.map((function(e){return self.setTimeout(e,h)})))}});function b(e){var n=t.is(r.CONNECTING);t.event(i.DISCONNECT,e),n&&u(e.error)}_.onopen=function(s){return o.__awaiter(n,void 0,void 0,(function(){var n,s,a,p=this;return o.__generator(this,(function(o){switch(o.label){case 0:this._log.debug("Connection to "+e+" opened"),n=new f(t,this._createConnection(_,this._write)),s=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.event(i.CONNECTED,n)];case 2:return(c=o.sent())||(s=new Error("WebSocket [ERROR] FSM cannot be switched to CONNECTED state from "+r[t.current])),[3,4];case 3:return a=o.sent(),this._log.warn("WebSocket [ERROR] FSM cannot be switched to CONNECTED state due to error in event handler",a),s=a,[3,4];case 4:return Boolean(s)?(u(s),_.close(d.Reconnect.WsCodes.BLOCKED_BY_CLIENT,"WebSocket lib initialized"),[2]):(_.onmessage=function(e){var t=p._read(e.data);p._onmessage.forEach((function(e){return e(n,t)}))},l(n),[2])}}))}))},_.onclose=function(i){n._log.debug("Connection to "+e+" closed",{code:i.code,reason:i.reason,fsmState:r[t.current]}),v.scheduleIO(a.O.none);var o=new y({status:i.reason,message:"Connection closed: "+i.reason,code:i.code,url:e});b(new g(o))},_.onerror=function(){n._log.debug("Connection to "+e+" errored");var t=new y({status:"ws_error",message:"WebSocket error",url:e}),r=new g(t);v.scheduleIO(a.O.some((function(){try{n._onerror.forEach((function(e){return e(t)}))}catch(e){n._log.error("OnError handler thrown an error",e)}b(r)})))}}))}))},e}();t.WS=p;var h=function(){function e(e,t){this._ws=e,this._serializer=t}return e.prototype.send=function(e){var t=this;return new Promise((function(n){t._ws.send(t._serializer(e)),n()}))},e.prototype.close=function(e){var t=this,n=void 0===e?{}:e,r=n.code,i=void 0===r?d.Reconnect.WsCodes.NORMAL_CLOSURE:r,o=n.reason;return new Promise((function(e){t._ws.close(i,o),e()}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._ws.readyState},enumerable:!1,configurable:!0}),e}();t.SerializingWSConnection=h;var m,f=function(){function e(e,t){this._fsm=e,this._inner=t,this._log=c.Monitoring.Logging.getLogger("coreclients.ws.connection")}return Object.defineProperty(e.prototype,"_ws",{get:function(){return this._inner._ws},enumerable:!1,configurable:!0}),e.prototype.send=function(e){var t=this;return this._fsm.event(i.SEND).then((function(n){if(!n)throw new Error("WebSocket [ERROR]: Trying to send on invalid connection state: "+r[t._fsm.current]);if(t.state!==m.State.OPEN)throw new Error("WebSocket [ERROR]: Trying to send on invalid websocket state: "+m.State[t.state]);return t._inner.send(e)}))},e.prototype.close=function(e){var t=this,n=void 0===e?{}:e,o=n.code,s=void 0===o?d.Reconnect.WsCodes.NORMAL_CLOSURE:o,a=n.reason;return this._fsm.event(i.CLOSE).then((function(e){return e?(t._log.debug("Closing connection",{code:s,reason:a,fsmState:r[t._fsm.current]}),t._inner.close({code:s,reason:a})):(t._log.warn("Tried to close connection which is already closed or closing",{fsmState:r[t._fsm.current]}),Promise.resolve())}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._inner.state},enumerable:!1,configurable:!0}),e}();t.STMWSConnection=f,function(e){!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(e.State||(e.State={}))}(m=t.WSConnection||(t.WSConnection={}));var g=function(){function e(e){this._error=e}return e.prototype.toString=function(){return this._error.message},Object.defineProperty(e.prototype,"code",{get:function(){return this._error.code},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return"WebSocket [CLOSE]: statusCode="+this._error.code+" reason: "+this._error.status},enumerable:!1,configurable:!0}),e}();t.WSCloseReasonImpl=g,function(e){e.is=function(e){return null!=e&&(void 0!==e.code||void 0!==e.reason)}}(t.CloseEventInfo||(t.CloseEventInfo={}));var y=function(e){function t(t){var n=t.code,r=void 0===n?-1:n,i=t.status,o=t.url,s=t.message,a=t.body,c=e.call(this,s)||this;return c.name="WSError",c.url=o,c.code=function(e,t){if(1005===e&&Boolean(t)){var n=t.toLowerCase();return n.indexOf("user not found")>=0?d.Reconnect.WsCodes.UNAUTHORIZED:n.indexOf("cannot find document")>=0?d.Reconnect.WsCodes.NOT_FOUND:n.indexOf("SERVER_SHUTDOWN")>=0?d.Reconnect.WsCodes.SERVER_SHUTDOWN:e}return e}(r,s),c.body=a,c.status=i,c}return o.__extends(t,e),t.prototype.toString=function(){return"Websocket Error\n      Message: "+this.message+"\n      Status: "+this.status+"\n      Code: "+this.code+"\n      Url: "+this.url},t}(a.CustomError);t.WSError=y},76210:(e,t,n)=>{n.r(t),n.d(t,{NIL:()=>N,parse:()=>g,stringify:()=>u,v1:()=>f,v3:()=>A,v4:()=>C,v5:()=>O,validate:()=>a,version:()=>M});var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function o(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"==typeof e&&s.test(e)};for(var c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};var d,p,h=0,m=0;const f=function(e,t,n){var r=t&&n||0,i=t||new Array(16),s=(e=e||{}).node||d,a=void 0!==e.clockseq?e.clockseq:p;if(null==s||null==a){var c=e.random||(e.rng||o)();null==s&&(s=d=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=p=16383&(c[6]<<8|c[7]))}var l=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:m+1,g=l-h+(f-m)/1e4;if(g<0&&void 0===e.clockseq&&(a=a+1&16383),(g<0||l>h)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=l,m=f,p=a;var y=(1e4*(268435455&(l+=122192928e5))+f)%4294967296;i[r++]=y>>>24&255,i[r++]=y>>>16&255,i[r++]=y>>>8&255,i[r++]=255&y;var _=l/4294967296*1e4&268435455;i[r++]=_>>>8&255,i[r++]=255&_,i[r++]=_>>>24&15|16,i[r++]=_>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var v=0;v<6;++v)i[r+v]=s[v];return t||u(i)};const g=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function y(e,t,n){function r(e,r,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=g(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(r),s.set(e,r.length),(s=n(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return u(s)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function _(e){return 14+(e+64>>>9<<4)+1}function v(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function b(e,t,n,r,i,o){return v((s=v(v(t,e),v(r,o)))<<(a=i)|s>>>32-a,n);var s,a}function E(e,t,n,r,i,o,s){return b(t&n|~t&r,e,t,i,o,s)}function I(e,t,n,r,i,o,s){return b(t&r|n&~r,e,t,i,o,s)}function S(e,t,n,r,i,o,s){return b(t^n^r,e,t,i,o,s)}function w(e,t,n,r,i,o,s){return b(n^(t|~r),e,t,i,o,s)}const A=y("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=e[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[_(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,c=r,l=i,u=o;n=E(n,r,i,o,e[s],7,-680876936),o=E(o,n,r,i,e[s+1],12,-389564586),i=E(i,o,n,r,e[s+2],17,606105819),r=E(r,i,o,n,e[s+3],22,-1044525330),n=E(n,r,i,o,e[s+4],7,-176418897),o=E(o,n,r,i,e[s+5],12,1200080426),i=E(i,o,n,r,e[s+6],17,-1473231341),r=E(r,i,o,n,e[s+7],22,-45705983),n=E(n,r,i,o,e[s+8],7,1770035416),o=E(o,n,r,i,e[s+9],12,-1958414417),i=E(i,o,n,r,e[s+10],17,-42063),r=E(r,i,o,n,e[s+11],22,-1990404162),n=E(n,r,i,o,e[s+12],7,1804603682),o=E(o,n,r,i,e[s+13],12,-40341101),i=E(i,o,n,r,e[s+14],17,-1502002290),n=I(n,r=E(r,i,o,n,e[s+15],22,1236535329),i,o,e[s+1],5,-165796510),o=I(o,n,r,i,e[s+6],9,-1069501632),i=I(i,o,n,r,e[s+11],14,643717713),r=I(r,i,o,n,e[s],20,-373897302),n=I(n,r,i,o,e[s+5],5,-701558691),o=I(o,n,r,i,e[s+10],9,38016083),i=I(i,o,n,r,e[s+15],14,-660478335),r=I(r,i,o,n,e[s+4],20,-405537848),n=I(n,r,i,o,e[s+9],5,568446438),o=I(o,n,r,i,e[s+14],9,-1019803690),i=I(i,o,n,r,e[s+3],14,-187363961),r=I(r,i,o,n,e[s+8],20,1163531501),n=I(n,r,i,o,e[s+13],5,-1444681467),o=I(o,n,r,i,e[s+2],9,-51403784),i=I(i,o,n,r,e[s+7],14,1735328473),n=S(n,r=I(r,i,o,n,e[s+12],20,-1926607734),i,o,e[s+5],4,-378558),o=S(o,n,r,i,e[s+8],11,-2022574463),i=S(i,o,n,r,e[s+11],16,1839030562),r=S(r,i,o,n,e[s+14],23,-35309556),n=S(n,r,i,o,e[s+1],4,-1530992060),o=S(o,n,r,i,e[s+4],11,1272893353),i=S(i,o,n,r,e[s+7],16,-155497632),r=S(r,i,o,n,e[s+10],23,-1094730640),n=S(n,r,i,o,e[s+13],4,681279174),o=S(o,n,r,i,e[s],11,-358537222),i=S(i,o,n,r,e[s+3],16,-722521979),r=S(r,i,o,n,e[s+6],23,76029189),n=S(n,r,i,o,e[s+9],4,-640364487),o=S(o,n,r,i,e[s+12],11,-421815835),i=S(i,o,n,r,e[s+15],16,530742520),n=w(n,r=S(r,i,o,n,e[s+2],23,-995338651),i,o,e[s],6,-198630844),o=w(o,n,r,i,e[s+7],10,1126891415),i=w(i,o,n,r,e[s+14],15,-1416354905),r=w(r,i,o,n,e[s+5],21,-57434055),n=w(n,r,i,o,e[s+12],6,1700485571),o=w(o,n,r,i,e[s+3],10,-1894986606),i=w(i,o,n,r,e[s+10],15,-1051523),r=w(r,i,o,n,e[s+1],21,-2054922799),n=w(n,r,i,o,e[s+8],6,1873313359),o=w(o,n,r,i,e[s+15],10,-30611744),i=w(i,o,n,r,e[s+6],15,-1560198380),r=w(r,i,o,n,e[s+13],21,1309151649),n=w(n,r,i,o,e[s+4],6,-145523070),o=w(o,n,r,i,e[s+11],10,-1120210379),i=w(i,o,n,r,e[s+2],15,718787259),r=w(r,i,o,n,e[s+9],21,-343485551),n=v(n,a),r=v(r,c),i=v(i,l),o=v(o,u)}return[n,r,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(_(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))}));const C=function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return u(r)};function T(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function k(e,t){return e<<t|e>>>32-t}const O=y("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var l=new Uint32Array(16),u=0;u<16;++u)l[u]=e[64*c+4*u]<<24|e[64*c+4*u+1]<<16|e[64*c+4*u+2]<<8|e[64*c+4*u+3];a[c]=l}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<s;++d){for(var p=new Uint32Array(80),h=0;h<16;++h)p[h]=a[d][h];for(var m=16;m<80;++m)p[m]=k(p[m-3]^p[m-8]^p[m-14]^p[m-16],1);for(var f=n[0],g=n[1],y=n[2],_=n[3],v=n[4],b=0;b<80;++b){var E=Math.floor(b/20),I=k(f,5)+T(E,g,y,_)+v+t[E]+p[b]>>>0;v=_,_=y,y=k(g,30)>>>0,g=f,f=I}n[0]=n[0]+f>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+_>>>0,n[4]=n[4]+v>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),N="00000000-0000-0000-0000-000000000000";const M=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},59443:(e,t,n)=>{n.d(t,{Y1:()=>r,uq:()=>c});var r,i,o,s,a,c,l,u,d=n(73975),p=n(55415),h=n(22232),m=n(8125),f=n(51996);!function(e){var t;!function(t){var n;!function(e){e.user="user",e.api="api",e.doubleClick="doubleClick"}(n=t.Source||(t.Source={})),t.eq=(0,d.fromEquals)((function(t,r){return t.source===r.source&&(t.source===n.doubleClick&&r.source===n.doubleClick?t.selectedWord===r.selectedWord:e.eqFormatting.equals(t.formatting,r.formatting))}))}(t=e.Meta||(e.Meta={})),e.nonEmpty=function(e){return e.length>0},e.isEmpty=function(e){return 0===e.length},e.toTextRange=function(e){return f.SV.create(e.index,e.index+e.length)},e.isUserSelection=function(e){return e.meta.source===t.Source.user},e.isApiSelection=function(e){return e.meta.source===t.Source.api},e.isDoubleClickSelection=function(e){return e.meta.source===t.Source.doubleClick},e.eqRange=(0,d.fromEquals)((function(e,t){return e.index===t.index&&e.length===t.length})),e.eqFormatting=(0,d.fromEquals)(p.deepEqual),e.eq=(0,d.fromEquals)((function(t,n){return e.eqRange.equals(t,n)&&e.Meta.eq.equals(t.meta,n.meta)})),e.empty={index:0,length:0,meta:{source:e.Meta.Source.user,formatting:{}}}}(r||(r={})),function(e){e.DenaliOtherDocSession="denaliOtherDocSession",e.DenaliSameDocSession="denaliSameDocSession",e.MSOutlook="outlook",e.MSWord="word",e.MSWordOnline="wordOnline",e.MSExcel="excel",e.MSOffice="msoffice",e.ProbablyMSOutlookOnline="probablyMSOutlookOnline",e.GDocs="gdocs",e.GSheets="gsheets",e.ProbablyGMail="probablyGmail",e.CocoaHTMLWriter="cocoaHTMLWriter",e.DropboxPaper="dropbox_paper",e.PlainText="plainText",e.Unknown="unknown",e.Synthetic="synthetic"}(i||(i={})),function(e){e.empty={top:0,bottom:0}}(o||(o={})),function(e){!function(e){e.top="top",e.middle="middle",e.bottom="bottom"}(e.Y||(e.Y={})),function(e){e.left="left",e.middle="middle",e.right="right"}(e.X||(e.X={})),function(t){t.toViewport=function(t){return function(n){switch(n){case e.X.left:return t.left;case e.X.middle:return t.left+t.width/2;case e.X.right:return t.right;default:return(0,h.vE)(n)}}}}(e.X||(e.X={})),function(t){t.toViewport=function(t){return function(n){switch(n){case e.Y.top:return t.top;case e.Y.middle:return t.top+t.height/2;case e.Y.bottom:return t.bottom;default:return(0,h.vE)(n)}}}}(e.Y||(e.Y={}))}(s||(s={})),function(e){var t;!function(e){e.textMaybeWithFormatting="text",e.onlyFormatting="formatting"}(t=e.Type||(e.Type={})),e.isTextMaybeWithFormatting=function(e){return e.type===t.textMaybeWithFormatting},e.isOnlyFormatting=function(e){return e.type===t.onlyFormatting}}(a||(a={})),function(e){e.none="none",e.fast="fast",e.initial="initial",e.fake="fake"}(c||(c={})),function(e){var t;!function(e){e.bold="bold",e.italic="italic",e.underline="underline",e.strike="strike",e.header1="header1",e.header2="header2",e.bulletList="bulletList",e.dashedList="dashedList",e.orderedList="orderedList",e.link="link"}(t=e.Type||(e.Type={})),e.is=function(e){return(0,m.CI)(t,e)},e.asList=Object.values(e.Type),function(e){e.is=function(e){return void 0!==e[t.link]}}(e.LinkPayload||(e.LinkPayload={}))}(l||(l={})),function(e){e.undo="undo",e.redo="redo",e.cut="cut",e.copy="copy",e.paste="paste",e.selectAll="selectAll"}(u||(u={}))},87380:(e,t,n)=>{n.d(t,{x:()=>r});var r,i=n(27378),o=n(5739),s=n(12187),a=n(19962),c=n(44060),l=n(63969),u=n(24588),d=n(71284),p=n(21474),h=n(42329),m=n(43743),f=n(77176),g=n(98403),y=n(57091),_=n(93508),v=n(2291);!function(e){function t(e){return 0===e?"":e>=1e3?`${Math.min(Math.trunc(e/1e3),9)}k+`:String(e)}const n=({className:e,isChecking:t,type:n,animateFade:r=!0})=>{const{state:a,complete:c}=m.f.fadeOutState(t),l="checking-complete";return i.createElement(o.F.div,Object.assign({},(0,s.Sh)(q.loader,e),{role:"loader"}),r?a.pipe(f.U((e=>"end"===e?i.createElement("div",{key:"checking-complete",className:l}):i.createElement(h.$,{key:"spinner",variation:n,size:"100%",className:"fadeOut"===e?q.fadeOut:void 0,onTransitionEnd:c})))):t.pipe(f.U((e=>e?i.createElement(h.$,{variation:n,size:"100%"}):i.createElement("div",{className:l})))))},r=({name:e,theme:n={},count:r,type:c="white",suffix:l=""})=>{const u=i.useContext(d.a.Context);return i.createElement(o.F.div,Object.assign({},(0,s.Sh)(q.roundCounter,g.ab(c,h.$.getClassName(q)),n.counterWrapper),{role:"counter"}),i.createElement("svg",{viewBox:"0 0 32 32",className:q.circular},i.createElement("g",null,i.createElement("circle",{r:"15.75",cx:"16",cy:"16"}),i.createElement("text",Object.assign({x:"16",y:"17"},a.svgVerticalAlignment(u.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:r>=100?14:18,"data-name":e},(0,s.Sh)(k,n.counterContent)),t(r),l))))},c=({name:e,theme:n={},count:r,type:c="white",suffix:l=""})=>{const u=i.useContext(d.a.Context);return i.createElement(o.F.div,Object.assign({},(0,s.Sh)(q.ovalCounter,g.ab(c,h.$.getClassName(q)),n.counterWrapper),{role:"counter"}),i.createElement("svg",{viewBox:"0 0 32 20",className:q.circular},i.createElement("rect",{width:"32",height:"20",rx:"10"}),i.createElement("text",Object.assign({x:"16",y:"10.5"},a.svgVerticalAlignment(u.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:11,"data-name":e},(0,s.Sh)(k,n.counterContent)),t(r),l)))};e.Counter=({theme:e={},count:t,type:n="white"})=>{const o=t>=100?c:r;return i.createElement(o,{theme:Object.assign(Object.assign({},e),{counterWrapper:(0,s.Sh)(e.counterWrapper,q.flexCounter).className}),count:t,type:n})},e.OutcomeCounter=({name:e,theme:n={},count:r,type:c="white",suffix:l,fontSize:u=12})=>{const p=i.useContext(d.a.Context);return i.createElement(o.F.div,Object.assign({},(0,s.Sh)(q.outcomeCounter,g.ab(c,h.$.getClassName(q)),n.counterWrapper),{role:"counter"}),i.createElement("svg",{viewBox:"0 0 32 18",className:q.circular},i.createElement("rect",Object.assign({},function(e,t){return t||e>=100?{width:32}:e>=10?{x:4,width:24}:{x:7,width:18}}(r,!!l),{height:18,rx:9})),i.createElement("text",Object.assign({x:"50%",y:"10px"},a.svgVerticalAlignment(p.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:u,"data-name":e},(0,s.Sh)(k,n.counterContent)),t(r),l)))},e.MainMeter=({count:e,isChecking:t,className:o})=>{const a=0===e;return i.createElement("div",Object.assign({},(0,s.Sh)(q.meter,o)),i.createElement(n,{isChecking:t,type:a?"green":"red"}),0===e?i.createElement(p.JO.Grammarly,null):i.createElement(r,{count:e,type:"red",name:"toolbar-mistakes"}))},e.LensNavMeter=({count:e,isChecking:t})=>i.createElement("div",{className:q.lensNavMeter},i.createElement(n,{isChecking:t,type:"red"}),i.createElement(r,{count:e,type:"white",name:"toolbar-mistakes"})),e.PlagiarismMeter=({count:e,isChecking:t,className:r})=>i.createElement("div",Object.assign({},(0,s.Sh)(q.plagiarismMeter,r)),i.createElement(n,{isChecking:t,type:"violet",animateFade:!1}),i.createElement(o.F.div,{className:q.wrapper},e.pipe(y.a(t),f.U((([e,t])=>0===e?i.createElement(p.JO.NotificationInfo,{className:q.plagiarismIcon,key:"icon",width:20}):!t&&i.createElement(c,{count:e,type:"violet",key:"value",suffix:i.createElement("tspan",{fontSize:8,dominantBaseline:"center"},"%")}))),_.O(null)))),e.PlagiarismOutcomesMeter=({count:t,isChecking:r,className:a})=>i.createElement("div",Object.assign({},(0,s.Sh)(q.plagiarismMeter,a)),i.createElement(n,{isChecking:r,type:"cyan",animateFade:!1}),i.createElement(o.F.div,{className:q.wrapper},t.pipe(y.a(r),f.U((([t,n])=>v.g.isMin(t)?i.createElement(p.JO.CheckmarkOutcomes,{className:q.plagiarismOutcomeIcon,key:"icon",width:20}):!n&&i.createElement(e.OutcomeCounter,{count:v.g.prism.reverseGet(t),type:"cyan",key:"value",suffix:i.createElement("tspan",{fontSize:11},"%")}))),_.O(null))))}(r||(r={}));const b=1.25,E={position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"visible",margin:"auto",width:l.u.percent(100),height:l.u.percent(100)},I={position:"absolute",width:l.u.percent(150),height:l.u.percent(150),transform:"translate(-17%, -17%)"},S={position:"relative",display:"inline-flex"},w={width:l.u.percent(100),height:l.u.percent(100)},A={minWidth:l.u.rem(2),width:l.u.percent(100),height:l.u.rem(b)},C={maxWidth:l.u.rem(2),height:l.u.rem(b)},T="counterText",k=l.u.joinClasses([T,l.u.style({fontWeight:"bold",textAnchor:"middle",fill:c.Il.CoreNeutral0})]),O={fill:u.zh,$nest:{"& .counterText":{fill:u.FW}}},N={fill:c.Il.CoreRed50,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},M={fill:c.Il.CoreGreen50,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},x={fill:c.Il.CoreBlue50,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},R={fill:"transparent",$nest:{"& .counterText":{fill:u.FW}}},L={fill:u.lh,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},D={fill:u.AX,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},P={fill:c.Il.CoreYellow20,$nest:{"& .counterText":{fill:c.Il.CoreYellow80}}},U={fill:c.Il.CoreYellow60,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},F={fill:c.Il.CoreCyan50,$nest:{"& .counterText":{fill:c.Il.CoreNeutral0}}},j={width:l.u.rem(1.5),height:l.u.rem(1.5)},B={margin:`0 ${l.u.rem(.25)}`},W={width:l.u.rem(2),height:l.u.rem(b)},G={margin:`${l.u.rem(-1)} 0`},z={$nest:{"&:not([data-disabled='true'])[data-active='true'], &:not([data-disabled='true'])[data-hovered='true']":{fill:c.Il.CoreCyan50}}},H={width:l.u.rem(2),height:l.u.rem(1.125),position:"relative"},q=l.u.stylesheet({fadeOut:[{opacity:0,transition:"opacity .5s linear"}],circular:[E],loader:[I],wrapper:[S],roundCounter:[S,w],ovalCounter:[S,A],flexCounter:[S,C],gray:[O],red:[N],green:[M],blue:[x],white:[R],violet:[L],yellow:[D],yellowPremium:[P],orange:[U],cyan:[F],meter:[S,j],lensNavMeter:[S,j,B],plagiarismMeter:[S,W],plagiarismIcon:[G],plagiarismOutcomeIcon:[G,z],outcomeCounter:[S,{position:"absolute",left:0},H]})},63899:(e,t,n)=>{n.d(t,{u_:()=>Ie,aV:()=>be,ay:()=>Ee});var r=n(27378),i=n(57050),o=n(38983),s=n(5739),a=n(12187),c=n(25781),l=n(22232),u=n(44060),d=n(63969),p=n(24588),h=n(40219),m=n(7046),f=n(21474),g=n(29909),y=n(40327);function _(e){return getComputedStyle(e)}function v(e,t){for(var n in t){var r=t[n];"number"==typeof r&&(r+="px"),e.style[n]=r}return e}function b(e){var t=document.createElement("div");return t.className=e,t}var E="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function I(e,t){if(!E)throw new Error("No element matching method supported");return E.call(e,t)}function S(e){e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function w(e,t){return Array.prototype.filter.call(e.children,(function(e){return I(e,t)}))}var A="ps",C="ps__rtl",T={thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},k={focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}},O={x:null,y:null};function N(e,t){var n=e.element.classList,r=k.scrolling(t);n.contains(r)?clearTimeout(O[t]):n.add(r)}function M(e,t){O[t]=setTimeout((function(){return e.isAlive&&e.element.classList.remove(k.scrolling(t))}),e.settings.scrollingThreshold)}var x=function(e){this.element=e,this.handlers={}},R={isEmpty:{configurable:!0}};x.prototype.bind=function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)},x.prototype.unbind=function(e,t){var n=this;this.handlers[e]=this.handlers[e].filter((function(r){return!(!t||r===t)||(n.element.removeEventListener(e,r,!1),!1)}))},x.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)},R.isEmpty.get=function(){var e=this;return Object.keys(this.handlers).every((function(t){return 0===e.handlers[t].length}))},Object.defineProperties(x.prototype,R);var L=function(){this.eventElements=[]};function D(e){if("function"==typeof self.CustomEvent)return new CustomEvent(e);var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,void 0),t}function P(e,t,n,r,i){var o;if(void 0===r&&(r=!0),void 0===i&&(i=!1),"top"===t)o=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==t)throw new Error("A proper axis should be provided");o=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function(e,t,n,r,i){var o=n[0],s=n[1],a=n[2],c=n[3],l=n[4],u=n[5];void 0===r&&(r=!0);void 0===i&&(i=!1);var d=e.element;e.reach[c]=null,d[a]<1&&(e.reach[c]="start");d[a]>e[o]-e[s]-1&&(e.reach[c]="end");t&&(d.dispatchEvent(D("ps-scroll-"+c)),t<0?d.dispatchEvent(D("ps-scroll-"+l)):t>0&&d.dispatchEvent(D("ps-scroll-"+u)),r&&function(e,t){N(e,t),M(e,t)}(e,c));e.reach[c]&&(t||i)&&d.dispatchEvent(D("ps-"+c+"-reach-"+e.reach[c]))}(e,n,o,r,i)}function U(e){return parseInt(e,10)||0}L.prototype.eventElement=function(e){var t=this.eventElements.filter((function(t){return t.element===e}))[0];return t||(t=new x(e),this.eventElements.push(t)),t},L.prototype.bind=function(e,t,n){this.eventElement(e).bind(t,n)},L.prototype.unbind=function(e,t,n){var r=this.eventElement(e);r.unbind(t,n),r.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(r),1)},L.prototype.unbindAll=function(){this.eventElements.forEach((function(e){return e.unbindAll()})),this.eventElements=[]},L.prototype.once=function(e,t,n){var r=this.eventElement(e),i=function(e){r.unbind(t,i),n(e)};r.bind(t,i)};var F={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof self&&("ontouchstart"in self||"maxTouchPoints"in self.navigator&&self.navigator.maxTouchPoints>0||self.DocumentTouch&&document instanceof self.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)};function j(e){var t=e.element,n=Math.floor(t.scrollTop),r=t.getBoundingClientRect();e.containerWidth=Math.round(r.width),e.containerHeight=Math.round(r.height),e.contentWidth=t.scrollWidth,e.contentHeight=t.scrollHeight,t.contains(e.scrollbarXRail)||(w(t,T.rail("x")).forEach((function(e){return S(e)})),t.appendChild(e.scrollbarXRail)),t.contains(e.scrollbarYRail)||(w(t,T.rail("y")).forEach((function(e){return S(e)})),t.appendChild(e.scrollbarYRail)),!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth?(e.scrollbarXActive=!0,e.railXWidth=e.containerWidth-e.railXMarginWidth-1,e.railXRatio=e.containerWidth/e.railXWidth,e.scrollbarXWidth=B(e,U(e.railXWidth*e.containerWidth/e.contentWidth)),e.scrollbarXLeft=U((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))):e.scrollbarXActive=!1,!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight?(e.scrollbarYActive=!0,e.railYHeight=e.containerHeight-e.railYMarginHeight-1,e.railYRatio=e.containerHeight/e.railYHeight,e.scrollbarYHeight=B(e,U(e.railYHeight*e.containerHeight/e.contentHeight)),e.scrollbarYTop=U(n*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))):e.scrollbarYActive=!1,e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth&&(e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth),e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight&&(e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight),function(e,t){var n={width:t.railXWidth},r=Math.floor(e.scrollTop);t.isRtl?n.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:n.left=e.scrollLeft;t.isScrollbarXUsingBottom?n.bottom=t.scrollbarXBottom-r:n.top=t.scrollbarXTop+r;v(t.scrollbarXRail,n);var i={top:r,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?i.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9:i.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?i.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:i.left=t.scrollbarYLeft+e.scrollLeft;v(t.scrollbarYRail,i),v(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),v(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(t,e),e.scrollbarXActive?t.classList.add(k.active("x")):(t.classList.remove(k.active("x")),e.scrollbarXWidth=0,e.scrollbarXLeft=0,t.scrollLeft=!0===e.isRtl?e.contentWidth:0),e.scrollbarYActive?t.classList.add(k.active("y")):(t.classList.remove(k.active("y")),e.scrollbarYHeight=0,e.scrollbarYTop=0,t.scrollTop=0)}function B(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function W(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],l=t[7],u=t[8],d=e.element,p=null,h=null,m=null;function f(t){t.touches&&t.touches[0]&&(t[i]=t.touches[0].pageY),d[c]=p+m*(t[i]-h),N(e,l),j(e),t.stopPropagation(),t.preventDefault()}function g(){M(e,l),e[u].classList.remove(k.clicking),e.event.unbind(e.ownerDocument,"mousemove",f)}function y(t,s){p=d[c],s&&t.touches&&(t[i]=t.touches[0].pageY),h=t[i],m=(e[r]-e[n])/(e[o]-e[a]),s?e.event.bind(e.ownerDocument,"touchmove",f):(e.event.bind(e.ownerDocument,"mousemove",f),e.event.once(e.ownerDocument,"mouseup",g),t.preventDefault()),e[u].classList.add(k.clicking),t.stopPropagation()}e.event.bind(e[s],"mousedown",(function(e){y(e)})),e.event.bind(e[s],"touchstart",(function(e){y(e,!0)}))}var G={"click-rail":function(e){e.element,e.event.bind(e.scrollbarY,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarYRail,"mousedown",(function(t){var n=t.pageY-self.pageYOffset-e.scrollbarYRail.getBoundingClientRect().top>e.scrollbarYTop?1:-1;e.element.scrollTop+=n*e.containerHeight,j(e),t.stopPropagation()})),e.event.bind(e.scrollbarX,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarXRail,"mousedown",(function(t){var n=t.pageX-self.pageXOffset-e.scrollbarXRail.getBoundingClientRect().left>e.scrollbarXLeft?1:-1;e.element.scrollLeft+=n*e.containerWidth,j(e),t.stopPropagation()}))},"drag-thumb":function(e){W(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),W(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])},keyboard:function(e){var t=e.element;e.event.bind(e.ownerDocument,"keydown",(function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&(I(t,":hover")||I(e.scrollbarX,":focus")||I(e.scrollbarY,":focus"))){var r,i=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(i){if("IFRAME"===i.tagName)i=i.contentDocument.activeElement;else for(;i.shadowRoot;)i=i.shadowRoot.activeElement;if(I(r=i,"input,[contenteditable]")||I(r,"select,[contenteditable]")||I(r,"textarea,[contenteditable]")||I(r,"button,[contenteditable]"))return}var o=0,s=0;switch(n.which){case 37:o=n.metaKey?-e.contentWidth:n.altKey?-e.containerWidth:-30;break;case 38:s=n.metaKey?e.contentHeight:n.altKey?e.containerHeight:30;break;case 39:o=n.metaKey?e.contentWidth:n.altKey?e.containerWidth:30;break;case 40:s=n.metaKey?-e.contentHeight:n.altKey?-e.containerHeight:-30;break;case 32:s=n.shiftKey?e.containerHeight:-e.containerHeight;break;case 33:s=e.containerHeight;break;case 34:s=-e.containerHeight;break;case 36:s=e.contentHeight;break;case 35:s=-e.contentHeight;break;default:return}e.settings.suppressScrollX&&0!==o||e.settings.suppressScrollY&&0!==s||(t.scrollTop-=s,t.scrollLeft+=o,j(e),function(n,r){var i=Math.floor(t.scrollTop);if(0===n){if(!e.scrollbarYActive)return!1;if(0===i&&r>0||i>=e.contentHeight-e.containerHeight&&r<0)return!e.settings.wheelPropagation}var o=t.scrollLeft;if(0===r){if(!e.scrollbarXActive)return!1;if(0===o&&n<0||o>=e.contentWidth-e.containerWidth&&n>0)return!e.settings.wheelPropagation}return!0}(o,s)&&n.preventDefault())}}))},wheel:function(e){var t=e.element;function n(n){var r=function(e){var t=e.deltaX,n=-1*e.deltaY;return void 0!==t&&void 0!==n||(t=-1*e.wheelDeltaX/6,n=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,n*=10),t!=t&&n!=n&&(t=0,n=e.wheelDelta),e.shiftKey?[-n,-t]:[t,n]}(n),i=r[0],o=r[1];if(!function(e,n,r){if(!F.isWebKit&&t.querySelector("select:focus"))return!0;if(!t.contains(e))return!1;for(var i=e;i&&i!==t;){if(i.classList.contains(T.consuming))return!0;var o=_(i);if(r&&o.overflowY.match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHeight;if(s>0&&(i.scrollTop>0&&r<0||i.scrollTop<s&&r>0))return!0}if(n&&o.overflowX.match(/(scroll|auto)/)){var a=i.scrollWidth-i.clientWidth;if(a>0&&(i.scrollLeft>0&&n<0||i.scrollLeft<a&&n>0))return!0}i=i.parentNode}return!1}(n.target,i,o)){var s=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(o?t.scrollTop-=o*e.settings.wheelSpeed:t.scrollTop+=i*e.settings.wheelSpeed,s=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(i?t.scrollLeft+=i*e.settings.wheelSpeed:t.scrollLeft-=o*e.settings.wheelSpeed,s=!0):(t.scrollTop-=o*e.settings.wheelSpeed,t.scrollLeft+=i*e.settings.wheelSpeed),j(e),(s=s||function(n,r){var i=Math.floor(t.scrollTop),o=0===t.scrollTop,s=i+t.offsetHeight===t.scrollHeight,a=0===t.scrollLeft,c=t.scrollLeft+t.offsetWidth===t.scrollWidth;return!(Math.abs(r)>Math.abs(n)?o||s:a||c)||!e.settings.wheelPropagation}(i,o))&&!n.ctrlKey&&(n.stopPropagation(),n.preventDefault())}}void 0!==self.onwheel?e.event.bind(t,"wheel",n):void 0!==self.onmousewheel&&e.event.bind(t,"mousewheel",n)},touch:function(e){if(F.supportsTouch||F.supportsIePointer){var t=e.element,n={},r=0,i={},o=null;F.supportsTouch?(e.event.bind(t,"touchstart",l),e.event.bind(t,"touchmove",u),e.event.bind(t,"touchend",d)):F.supportsIePointer&&(self.PointerEvent?(e.event.bind(t,"pointerdown",l),e.event.bind(t,"pointermove",u),e.event.bind(t,"pointerup",d)):self.MSPointerEvent&&(e.event.bind(t,"MSPointerDown",l),e.event.bind(t,"MSPointerMove",u),e.event.bind(t,"MSPointerUp",d)))}function s(n,r){t.scrollTop-=r,t.scrollLeft-=n,j(e)}function a(e){return e.targetTouches?e.targetTouches[0]:e}function c(e){return(!e.pointerType||"pen"!==e.pointerType||0!==e.buttons)&&(!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE))}function l(e){if(c(e)){var t=a(e);n.pageX=t.pageX,n.pageY=t.pageY,r=(new Date).getTime(),null!==o&&clearInterval(o)}}function u(o){if(c(o)){var l=a(o),u={pageX:l.pageX,pageY:l.pageY},d=u.pageX-n.pageX,p=u.pageY-n.pageY;if(function(e,n,r){if(!t.contains(e))return!1;for(var i=e;i&&i!==t;){if(i.classList.contains(T.consuming))return!0;var o=_(i);if(r&&o.overflowY.match(/(scroll|auto)/)){var s=i.scrollHeight-i.clientHeight;if(s>0&&(i.scrollTop>0&&r<0||i.scrollTop<s&&r>0))return!0}if(n&&o.overflowX.match(/(scroll|auto)/)){var a=i.scrollWidth-i.clientWidth;if(a>0&&(i.scrollLeft>0&&n<0||i.scrollLeft<a&&n>0))return!0}i=i.parentNode}return!1}(o.target,d,p))return;s(d,p),n=u;var h=(new Date).getTime(),m=h-r;m>0&&(i.x=d/m,i.y=p/m,r=h),function(n,r){var i=Math.floor(t.scrollTop),o=t.scrollLeft,s=Math.abs(n),a=Math.abs(r);if(a>s){if(r<0&&i===e.contentHeight-e.containerHeight||r>0&&0===i)return 0===self.scrollY&&r>0&&F.isChrome}else if(s>a&&(n<0&&o===e.contentWidth-e.containerWidth||n>0&&0===o))return!0;return!0}(d,p)&&o.preventDefault()}}function d(){e.settings.swipeEasing&&(clearInterval(o),o=setInterval((function(){e.isInitialized?clearInterval(o):i.x||i.y?Math.abs(i.x)<.01&&Math.abs(i.y)<.01?clearInterval(o):(s(30*i.x,30*i.y),i.x*=.8,i.y*=.8):clearInterval(o)}),10))}}},z=function(e,t){var n=this;if(void 0===t&&(t={}),"string"==typeof e&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var r in this.element=e,e.classList.add(A),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},t)this.settings[r]=t[r];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var i,o,s=function(){return e.classList.add(k.focus)},a=function(){return e.classList.remove(k.focus)};this.isRtl="rtl"===_(e).direction,!0===this.isRtl&&e.classList.add(C),this.isNegativeScroll=(o=e.scrollLeft,e.scrollLeft=-1,i=e.scrollLeft<0,e.scrollLeft=o,i),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new L,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=b(T.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=b(T.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",s),this.event.bind(this.scrollbarX,"blur",a),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var c=_(this.scrollbarXRail);this.scrollbarXBottom=parseInt(c.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=U(c.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=U(c.borderLeftWidth)+U(c.borderRightWidth),v(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=U(c.marginLeft)+U(c.marginRight),v(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=b(T.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=b(T.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",s),this.event.bind(this.scrollbarY,"blur",a),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var l=_(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=U(l.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function(e){var t=_(e);return U(t.width)+U(t.paddingLeft)+U(t.paddingRight)+U(t.borderLeftWidth)+U(t.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=U(l.borderTopWidth)+U(l.borderBottomWidth),v(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=U(l.marginTop)+U(l.marginBottom),v(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach((function(e){return G[e](n)})),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",(function(e){return n.onScroll(e)})),j(this)};z.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,v(this.scrollbarXRail,{display:"block"}),v(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=U(_(this.scrollbarXRail).marginLeft)+U(_(this.scrollbarXRail).marginRight),this.railYMarginHeight=U(_(this.scrollbarYRail).marginTop)+U(_(this.scrollbarYRail).marginBottom),v(this.scrollbarXRail,{display:"none"}),v(this.scrollbarYRail,{display:"none"}),j(this),P(this,"top",0,!1,!0),P(this,"left",0,!1,!0),v(this.scrollbarXRail,{display:""}),v(this.scrollbarYRail,{display:""}))},z.prototype.onScroll=function(e){this.isAlive&&(j(this),P(this,"top",this.element.scrollTop-this.lastScrollTop),P(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},z.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),S(this.scrollbarX),S(this.scrollbarY),S(this.scrollbarXRail),S(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},z.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter((function(e){return!e.match(/^ps([-_].+|)$/)})).join(" ")};const H=z;var q=n(83078),Y=n(5114),V=n(85255),$=n(60797),Q=n(85089),Z=n(98403),X=n(66310),J=n(78674),K=n(50628),ee=n(2834),te=n(24209),ne=n(66081),re=n(40151),ie=n(77176),oe=n(67434),se=n(49708);const ae="#7d7c7c",ce="#3a3a3a",le="ps--force",ue=d.u.style({position:"relative",overflow:"hidden !important"});d.u.cssRule(".ps",{overflow:d.u.important("hidden"),"overflow-anchor":"none","-ms-touch-action":"auto",touchAction:"auto","-ms-overflow-style":"none",position:"relative",border:"none !important",$nest:Object.assign(Object.assign(Object.assign({},{"& .ps__rail-x, & .ps__rail-y":{zIndex:h.$n,pointerEvents:"all"},".ps__rail-x":{display:"none",opacity:0,transition:"background-color .2s linear, opacity .2s linear","-webkit-transition":"background-color .2s linear, opacity .2s linear",height:15,bottom:0,position:"absolute"},".ps__rail-y":{display:"none",opacity:"0",transition:"background-color .2s linear, opacity .2s linear","-webkit-transition":"background-color .2s linear, opacity .2s linear",width:15,right:0,position:"absolute"},".ps--active-x > .ps__rail-x, .ps--active-y > .ps__rail-y":{display:"block","background-color":"transparent"},"&.ps--hidden > .ps__rail-x, &.ps--hidden > .ps__rail-y":{opacity:0},"&.ps--force > .ps__rail-x, &.ps--force > .ps__rail-y":{opacity:.6},"&:hover > .ps__rail-x, &:hover > .ps__rail-y, &.ps--focus > .ps__rail-x, &.ps--focus > .ps__rail-y, &.ps--scrolling-x > .ps__rail-x, &.ps--scrolling-y > .ps__rail-y":{opacity:.6},".ps__rail-x:hover, .ps__rail-y:hover, .ps__rail-x:focus, .ps__rail-y:focus, .ps__rail-x.ps--clicking, .ps__rail-y.ps--clicking":{"background-color":"#eee",opacity:.9}}),{".ps__thumb-x":{backgroundColor:ae,borderRadius:6,transition:"background-color .2s linear, height .2s ease-in-out","-webkit-transition":"background-color .2s linear, height .2s ease-in-out",height:6,bottom:2,position:"absolute"},".ps__thumb-y":{backgroundColor:ae,borderRadius:6,transition:"background-color .2s linear, width .2s ease-in-out","-webkit-transition":"background-color .2s linear, width .2s ease-in-out",width:6,right:2,position:"absolute"},".ps__rail-x:hover > .ps__thumb-x, .ps__rail-x:focus > .ps__thumb-x, .ps__rail-x.ps--clicking .ps__thumb-x":{backgroundColor:ce,height:11},".ps__rail-y:hover > .ps__thumb-y, .ps__rail-y:focus > .ps__thumb-y, .ps__rail-y.ps--clicking .ps__thumb-y":{backgroundColor:ce,width:11}}),{"@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)":{overflow:d.u.important("auto")},"@supports (-ms-overflow-style: none)":{overflow:d.u.important("auto")}})});const de=({update:e,children:t,onScroll:n,scrollTo:i,name:c,className:l,showWhenScrollable:u})=>{const d=o.h.create(Y.none),p=o.h.create(Y.none);return V.P.useSubscriptionTo(d.pipe($.oA).pipe(X.w((e=>Q.YC(e).pipe(J.b(250),K.P(),ee.b((()=>p.set(Y.some((e=>new H(e,{suppressScrollX:!0,minScrollbarLength:40}))(e)))))))))),V.P.useSubscriptionTo(p.pipe($.oA).pipe(X.w((t=>te.T(Q.YC(t.element).pipe(ne.e(200),ee.b((()=>{t.update()}))),(i||re.E).pipe(ee.b((e=>{t.element.scrollTop=e,t.update()}))),(e||re.E).pipe(ee.b((()=>{t.update()})))))))),V.P.useSubscriptionTo(d.pipe($.oA).pipe(X.w((e=>Z.Dx(l).pipe(ie.U((e=>e?e.split(" "):[])),oe.R(((t,n)=>(t&&e.classList.remove(...t),n&&e.classList.add(...n),n)),[])))))),V.P.useEffectOnWillUnmount((()=>{(0,y.pipe)(p.get(),q.tap((e=>{e.destroy(),p.set(Y.none)})))})),r.createElement("div",Object.assign({},(0,a.Sh)(u&&le,ue),{onScroll:n?()=>n.next():void 0,ref:e=>d.set(Y.fromNullable(e)),role:`scrollbar-${c}`}),r.createElement(s.F.Fragment,null,t))};var pe;!function(e){function t(e){let t=e.deltaX,n=-1*e.deltaY;return void 0!==t&&void 0!==n||(t=-1*e.deltaX/6,n=e.deltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,n*=10),t!=t&&n!=n&&(t=0,n=e.deltaY),[t,n]}e.verticalScrollByWhellEvent=e=>se.R(e,"wheel",{passive:!0}).pipe(ie.U(t),ie.U(g.Yg),ee.b((t=>e.scrollTop-=t)))}(pe||(pe={}));var he=n(43743),me=n(28706),fe=n(28043),ge=n(55935),ye=n(85985),_e=n(76974),ve=n(17343);class be extends r.Component{constructor(){super(...arguments),this._overlayIndex=be._index++,this._subs=[],this._visibilityState=o.h.create("hidden")}componentDidMount(){this._visibilityState.set(this.props.visible.get()?"visible":"hidden"),this._subs.push(this._visibilityState.pipe(ie.U((e=>"visible"===e)),fe.x()).subscribe((e=>be._activeOverlays.modify((t=>{const n=new Set(t);return e?n.add(this._overlayIndex):n.delete(this._overlayIndex),n})))),this.props.visible.pipe(ge.T(1)).subscribe((e=>{const t=this.props.animate?"fadeOut":"hidden";this._visibilityState.set(e?"visible":t)}))),this._subs.push(this._visibilityState.pipe(X.w((e=>"visible"===e?se.R(document,"keydown"):re.E)),ye.h((e=>e.keyCode===c.R.ESC_CODE))).subscribe((()=>{this.props.preventClose||this.props.visible.set(!1),this.props.onClose&&this.props.onClose()})))}componentWillUnmount(){be._activeOverlays.modify((e=>{const t=new Set(e);return t.delete(this._overlayIndex),t})),this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}render(){return r.createElement(s.F.Fragment,null,this._visibilityState.view((e=>{switch(e){case"visible":case"fadeOut":return r.createElement(s.F.div,Object.assign({role:"overlay-wrapper"},(0,a.Sh)(this.props.animate?this._getAnimatedTypeClass(e):this._getTypeClass(e),this._getPositionType(this.props.positionType)),{onClick:()=>{this.props.preventClose||this.props.visible.set(!1),this.props.onClose&&this.props.onClose()},onTransitionEnd:()=>{"fadeOut"===e&&this._visibilityState.set("hidden")}}),r.createElement(s.F.div,Object.assign({},(0,a.Sh)(this.props.animate&&this._getContentClass(e))),r.createElement("div",{className:Fe.scroll,role:"scrollbar-modal"},r.createElement(s.F.div,Object.assign({},(0,a.Sh)(this._getAlignmentClass(),this._getSmallResolutionClass())),this.props.children))));case"hidden":return null;default:return(0,l.vE)(e)}})))}_getSmallResolutionClass(){switch(this.props.smallResolution){case"resize":return Fe.wrapperResize;case"cut":default:return""}}_getAlignmentClass(){switch(this.props.alignment){case"top-center":return Fe.wrapperTopCenter;case"bottom-right":return Fe.wrapperBottomRight;case"none":return"";case"center":default:return Fe.wrapperCenter}}_getTypeClass(e){if("visible"!==e)return Fe.wrapperTransparent;switch(this.props.overlayType){case"light":return Fe.wrapperLight;case"transparent":return Fe.wrapperTransparent;case"dark":default:return Fe.wrapperDark}}_getPositionType(e){switch(e){case"absolute":return Fe.wrapperAbsolute;case"fixed":return Fe.wrapperFixed;default:return(0,l.vE)(e)}}_getAnimatedTypeClass(e){const t="visible"===e;switch(this.props.overlayType){case"light":return he.f.rafSequence(t?[Fe.wrapperTransparent,Fe.wrapperLight]:[Fe.wrapperLight,Fe.wrapperTransparent],!0);case"transparent":return _e.of(Fe.wrapperTransparent);case"dark":default:return he.f.rafSequence(t?[Fe.wrapperTransparent,Fe.wrapperDark]:[Fe.wrapperDark,Fe.wrapperTransparent],!0)}}_getContentClass(e){const{contentFaded:t,content:n}=this.props.theme||Fe,r="visible"===e?[t,n]:[n,t];return he.f.rafSequence(r,!0)}}be.defaultProps={visible:o.h.create(!0)},be._activeOverlays=o.h.create(new Set),be.activeCount=be._activeOverlays.view((e=>e.size)),be._index=0;const Ee=e=>r.createElement(be,Object.assign({},e,{visible:o.h.create(!0),preventClose:!1}),e.children);function Ie({children:e,className:t,close:n}){return r.createElement(s.F.div,Object.assign({},(0,a.Sh)(Fe.modal,t),{onClick:me.UW(i.constVoid)}),e,n?r.createElement("div",{className:Fe.closeIconButtonContainer},r.createElement(m.zx,{name:"modal-close",onClick:n},r.createElement(f.JO.Close,{className:Fe.closeIcon,width:13}))):null)}!function(e){e.Header=({children:e,className:t})=>r.createElement(s.F.header,Object.assign({},(0,a.Sh)(Fe.header,t)),e),e.Body=({children:e,className:t,wrapperClassName:n,name:i})=>{const{ref:o,onMount:c}=V.P.useElWatcher();return r.createElement(de,Object.assign({name:i},(0,a.Sh)(Fe.scrollBody,n),{showWhenScrollable:!0,update:o.pipe($.oA,X.w(Q.YC),ve.h(Z.PU))}),r.createElement(s.F.div,Object.assign({},(0,a.Sh)(Fe.body,t),{mount:c}),e))},e.Footer=({children:e,className:t})=>r.createElement(s.F.div,Object.assign({},(0,a.Sh)(Fe.footer,t))," ",e," ")}(Ie||(Ie={}));const Se={top:0,left:0,display:"flex",flexDirection:"column",overflow:"hidden",width:d.u.percent(100),height:d.u.percent(100),transition:`background ${d.u.seconds(.2)}`,pointerEvents:"auto"},we={position:"fixed",zIndex:h.DY},Ae={margin:`${d.u.rem(-.5)} auto auto`},Ce={background:"rgba(255, 255, 255, .7)"},Te={background:"rgba(100, 107, 131, .4)"},ke={position:"absolute",top:d.u.rem(.5),right:d.u.rem(.5)},Oe={stroke:p.FW},Ne={position:"relative",display:"flex",flexDirection:"column",overflow:"hidden",maxHeight:"90vh",borderRadius:d.u.rem(h.Jr),boxShadow:p.Re},Me={position:"relative",overflow:"hidden",padding:`${d.u.rem(2.5)} ${d.u.rem(2)} ${d.u.rem(1)}`,borderTopLeftRadius:d.u.rem(h.Jr),borderTopRightRadius:d.u.rem(h.Jr),backgroundColor:u.Il.CoreNeutral1},xe={position:"absolute",top:d.u.px(10),right:"@top"},Re={padding:d.u.rem(2),backgroundColor:u.Il.CoreNeutral0},Le={display:"flex",padding:`0 ${d.u.rem(2)}`,height:d.u.rem(4),border:"0 solid transparent",borderWidth:"0 1px",borderBottomRightRadius:d.u.rem(h.Jr),borderBottomLeftRadius:d.u.rem(h.Jr),backgroundColor:u.Il.CoreNeutral1,alignItems:"center",justifyContent:"flex-end",$nest:{"& > *:not(:last-child)":{marginRight:d.u.rem(.5)}}},De={transitionDuration:d.u.seconds(.2),transitionProperty:"opacity, transform",transformOrigin:"center"},Pe={position:"relative",display:"flex",padding:`${d.u.rem(.5)} 0`,width:"100vw",height:"100vh"},Ue={$nest:{[`@media (${h.pZ})`]:{margin:`${d.u.rem(2)} auto auto`}}},Fe=d.u.prefixedStylesheet("modal",{wrapper:[Se],wrapperFixed:[we],wrapperAbsolute:[{position:"absolute"}],wrapperTopCenter:[Ae],wrapperBottomRight:[{margin:"auto 0 0 auto"}],wrapperCenter:[{margin:"auto"}],wrapperLight:[Se,Ce],wrapperDark:[Se,Te],wrapperTransparent:[Se,{overflow:"hidden",background:"transparent"}],closeIconButtonContainer:[ke],closeIcon:[Oe],modal:[Ne],header:[Me],closeBtn:[xe],body:[Re],scrollBody:[{position:"relative",flexGrow:1}],footer:[Le],contentBase:[De],contentFaded:[De,{opacity:0,transform:"scale(.8)"}],content:[De,{opacity:1,transform:"none"}],scroll:[Pe],wrapperResize:[Ue]})},81301:(e,t,n)=>{n.d(t,{dC:()=>r,Iy:()=>i,EQ:()=>f});var r,i,o,s=n(57050),a=n(38983),c=n(5114),l=n(66310),u=n(18625),d=n(95300),p=n(76974),h=n(2834),m=n(40151);!function(e){e.SetGoals="SetGoals",e.Performance="Performance"}(r||(r={})),function(e){e.setGoals=e=>({type:r.SetGoals,source:e}),e.performance={type:r.Performance}}(i||(i={}));class f{constructor(e){this._modalViews=e,this.state=a.h.create(c.none),this._modalFactoryCache=new Map}show(e){return this.preload(e).pipe(l.w((e=>this.showPreloaded(e))))}showPreloaded(e){return u.P((()=>{const t=new d.X("opened");return this.state.set(c.some(e({onClose:()=>{this.state.set(c.none),t.next("closed"),t.complete()}}))),t}))}preload(e){const t=JSON.stringify(e);if(this._modalFactoryCache.has(t)){const e=this._modalFactoryCache.get(t);return p.of(e)}return u.P((()=>this._modalViews.load(e))).pipe(h.b((e=>{this._modalFactoryCache.set(t,e)})))}hideAll(){this.state.set(c.none)}}!function(e){e.Mock=class{constructor(){this.state=a.h.create(c.none),this.hideAll=s.constVoid}show(e){return m.E}showPreloaded(e){return m.E}preload(e){return m.E}}}(o||(o={}))},47861:(e,t,n)=>{n.d(t,{i:()=>f});var r=n(27378);if(3075==n.j)var i=n(5739);if(3075==n.j)var o=n(8125);var s=n(63969),a=n(40219);if(3075==n.j)var c=n(63899);if(3075==n.j)var l=n(2844);if(3075==n.j)var u=n(28043);if(3075==n.j)var d=n(77176);if(3075==n.j)var p=n(14522);if(3075==n.j)var h=n(5802);if(3075==n.j)var m=n(50790);const f=({manager:e,views:t,onNotificationClose:n=o.ZT,theme:s={}})=>{const a=function(e,t,n={}){return i=>{const o=e[i.type],s=e=>()=>{i.actions.next(e)};return i.metadata.viewType===h.P.ViewType.standard?r.createElement(m.DI.Wrapper,{key:i.id,notification:i,onClose:()=>{i.actions.next("closedByUser"),t(i)},theme:n},o(i,s)):r.createElement(r.Fragment,{key:i.id},o(i,s))}}(t,n,s.view),f=void 0!==s.grid?Object.assign({},S,s.grid):S,y=e.state.view((e=>e.filter(g(h.P.Position.bottomLeft)))),_=e.state.view((e=>e.filter(g(h.P.Position.bottomRight)))),v=e.state.view((e=>e.filter(g(h.P.Position.top))));return r.createElement(i.F.div,{className:f.container},l.aj(v,_,v,(e=>e.some(p._.isHighPriority))).pipe(u.x(),d.U((e=>e&&r.createElement("div",{className:f.overlay},r.createElement(c.aV,{positionType:"absolute",key:"notificationOverlay",preventClose:!0,overlayType:"light",alignment:"top-center",animate:!0,theme:{content:I.overlayContent,contentFaded:I.overlayContentFaded}}))))),r.createElement(i.F.div,{className:f.bottomLeft},y.view((e=>e.map(a)))),r.createElement(i.F.div,{className:f.bottomRight},_.view((e=>e.map(a)))),r.createElement(i.F.div,{className:f.top},v.view((e=>e.map(a)))))};function g(e){return t=>t.metadata.position===e}const y={position:"fixed",top:0,left:0,zIndex:a.nt,width:s.u.percent(100),height:s.u.percent(100),pointerEvents:"none"},_={position:"absolute",zIndex:a.nt,display:"flex",flexDirection:"column",width:s.u.rem(27),pointerEvents:"auto",alignItems:"flex-end"},v={right:s.u.rem(a.Ig),bottom:s.u.rem(1.5)},b={bottom:s.u.rem(1.5),left:s.u.rem(2)},E={transition:"transform .1s",transformOrigin:"center"},I=s.u.stylesheet({notificationContainer:[y],notificationWrapper:[_],bottomRightNotificationWrapper:[_,v],bottomLeftNotificationWrapper:[_,b],topNotificationWrapper:[_,{top:0,right:0,left:0,margin:"0 auto"}],overlayContentBase:[E],overlayContent:[E,{transform:"none"}],overlayContentFaded:[E,{transform:"scale(.95)"}]}),S={container:I.notificationContainer,bottomLeft:I.bottomLeftNotificationWrapper,bottomRight:I.bottomRightNotificationWrapper,top:I.topNotificationWrapper}},41966:(e,t,n)=>{n.d(t,{r:()=>r});var r,i=n(32952);!function(e){e.createBuilder=function(){return{build:(e,n)=>{const r=t();return{make:(t,o)=>({metadata:e,data:n,args:o,id:r,type:t,actions:new i.xQ})}}}};const t=(()=>{let e=1;return()=>e++})()}(r||(r={}))},14522:(e,t,n)=>{n.d(t,{_:()=>r});var r,i=n(5802);!function(e){e.isHighPriority=function(e){return e.metadata.priority>i.P.Priority.average},e.isCloseAction=function(e){return"timeout"===e||"closedByUser"===e||"closedByNotificationWithMorePriority"===e||"closedByMaxNotificationOnScreen"===e}}(r||(r={}))},61813:(e,t,n)=>{if(n.d(t,{y:()=>b}),3075==n.j)var r=n(8125);if(3075==n.j)var i=n(81531);if(3075==n.j)var o=n(46680);if(3075==n.j)var s=n(18625);if(3075==n.j)var a=n(80900);if(3075==n.j)var c=n(17343);if(3075==n.j)var l=n(40151);if(3075==n.j)var u=n(95093);if(3075==n.j)var d=n(2768);if(3075==n.j)var p=n(85985);if(3075==n.j)var h=n(8473);if(3075==n.j)var m=n(50628);if(3075==n.j)var f=n(2834);if(3075==n.j)var g=n(9223);if(3075==n.j)var y=n(38194);if(3075==n.j)var _=n(14522);if(3075==n.j)var v=n(5802);class b{constructor(e,t,n,r){this.state=e,this._factory=t,this._maxNotificationsOnScreen=n,this._defaultTimeout=r,this._log=i.Monitoring.Logging.getLogger("notificationsManager")}enqueue(e,t){const n=this._factory[e].make(e,t);return s.P((()=>{const t=n.metadata.timeout!==v.P.TimeoutDisabled?a.H(n.metadata.timeout===v.P.DefaultTimeout?this._defaultTimeout:n.metadata.timeout).pipe(c.h("timeout")):l.E;this.state.modify((e=>{const t=e.filter(((t,r)=>t.metadata.priority<n.metadata.priority?(this._log.debug(`closing ${t.type} notification, ${n.type} have higher priority`),t.actions.next("closedByNotificationWithMorePriority"),!1):t.id!==n.id&&(!(0===r&&e.length>=this._maxNotificationsOnScreen)||(this._log.debug(`closing ${t.type} notification, more than ${this._maxNotificationsOnScreen} notification on the screen`),t.actions.next("closedByMaxNotificationOnScreen"),!1))));return t.push(n),t}));const i=n.actions.pipe(u.T(t.pipe(d.R(n.actions.pipe(p.h(_._.isCloseAction))))));return i.pipe(h.o((0,r.ff)(_._.isCloseAction)),u.T(i.pipe(m.P(_._.isCloseAction))),f.b((t=>{this._log.log(_._.isHighPriority(n)?o.LogLevel.WARN:o.LogLevel.INFO,`Notification ${e} is ${t}`)})),g.x((()=>{this.state.modify((e=>e.filter((e=>e.id!==n.id))))})),y.B())}))}}},71860:(e,t,n)=>{n.d(t,{X:()=>k});var r,i=n(27378),o=n(57050),s=n(19962),a=n(5114),c=n(44060),l=n(63969),u=n(40219),d=n(29881),p=n(40327),h=n(5739),m=n(25781),f=n(83078),g=n(18625),y=n(49708);!function(e){const t="scrollaction";e.emit=e=>self.dispatchEvent(new CustomEvent(t,{detail:e})),e.observe=g.P((()=>y.R(self,t)))}(r||(r={}));var _=n(98403),v=n(85985),b=n(41398),E=n(24209),I=n(17343),S=n(38194),w=n(598),A=n(50628),C=n(97528);class T extends i.Component{constructor(){super(...arguments),this._subs=[],this._outOfTarget=e=>t=>!s.Rect.hasPoint(t.getBoundingClientRect(),e)}componentDidMount(){this._listenTooltipAppearance()}componentWillUnmount(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[],this.context.hide()}render(){return i.createElement(h.F.div,{role:"tooltip"},this.context.state.view(this.props.children))}_listenTooltipAppearance(){const e=y.R(document,"keydown").pipe(v.h((e=>e.keyCode===m.R.ESC_CODE))),t=y.R(document,"mousedown").pipe(b.M(this.context.state),v.h((([e,t])=>(0,p.pipe)(t,a.map((e=>e.target)),a.filter((()=>s.isDisabled(e.target))),f.forAll(this._outOfTarget({x:e.clientX,y:e.clientY})))))),n=E.T(e,t,y.R(document,"scroll"),r.observe.pipe(v.h((e=>"show"===e.detail)))).pipe(I.h(_.PU),S.B());this._subs=[this.context.hasContent.pipe(v.h(Boolean),w.c(n.pipe(A.P()))).subscribe(this.context.hide),this.context.hasContent.pipe(v.h(Boolean),w.c(E.T(_.gw(!0,500),n.pipe(I.h(!1))).pipe(A.P())),v.h(Boolean)).subscribe(this.context.show)]}}T.contextType=C.G.Context;const k=()=>i.createElement(T,null,(0,o.flow)(a.map((e=>i.createElement(d.t.ByAbsoluteRect,Object.assign({rect:s.Rect.fromEl(e.target),className:M.container},d.t.Alignment.toSelector(e.alignment),{withPin:!0}),i.createElement("div",{className:M.content},e.content)))),a.toNullable)),O={position:"fixed",zIndex:u.DY,pointerEvents:"none",$nest:{"@media print":{visibility:"hidden"}}},N={padding:`${l.u.rem(.25)} ${l.u.rem(1)}`,borderRadius:l.u.rem(u.fx),background:c.Il.BackgroundTooltip,color:c.Il.CoreNeutral1,textAlign:"center",whiteSpace:"nowrap",letterSpacing:l.u.px(.25),fontSize:l.u.rem(.75),lineHeight:l.u.rem(1)},M=l.u.stylesheet({container:[O],content:[N]})},6782:(e,t,n)=>{var r;n.d(t,{Q:()=>r}),function(e){e.group=function(e){return Object.values(e.reduce(((e,{group:t,category:n,categoryHuman:r,cost:i})=>(void 0===e[n]&&(e[n]={group:t,category:n,categoryHuman:r,count:0}),e[n].count+=i,e)),{})).sort(((e,t)=>t.count-e.count))}}(r||(r={}))},21311:(e,t,n)=>{n.d(t,{SC:()=>un});var r={};n.r(r),n.d(r,{Schemable:()=>W,URI:()=>B,UnknownArray:()=>E,UnknownRecord:()=>I,WithRefine:()=>H,WithUnion:()=>z,WithUnknownContainers:()=>G,alt:()=>P,array:()=>k,boolean:()=>b,compose:()=>F,id:()=>j,intersect:()=>M,lazy:()=>L,literal:()=>y,nullable:()=>w,number:()=>v,partial:()=>T,readonly:()=>D,record:()=>O,refine:()=>S,string:()=>_,struct:()=>A,sum:()=>R,tuple:()=>N,type:()=>C,union:()=>x,zero:()=>U});var i=n(29909),o=n(57050),s=n(40327),a=n(95195),c=function(e){return{_tag:"Of",value:e}},l=function(e,t){return{_tag:"Concat",left:e,right:t}};var u="required",d="optional",p=function(e,t,n){return{_tag:"Key",key:e,kind:t,errors:n}},h=function(e,t,n){return{_tag:"Index",index:e,kind:t,errors:n}},m=function(e,t){return{_tag:"Member",index:e,errors:t}};function f(){return{concat:l}}var g=n(18164),y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return-1!==e.findIndex((function(e){return e===t}))}}},_={is:function(e){return"string"==typeof e}},v={is:function(e){return"number"==typeof e&&!isNaN(e)}},b={is:function(e){return"boolean"==typeof e}},E={is:Array.isArray},I={is:function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}},S=function(e){return function(t){return{is:function(n){return t.is(n)&&e(n)}}}},w=function(e){return{is:function(t){return null===t||e.is(t)}}},A=function(e){return(0,s.pipe)(I,S((function(t){for(var n in e)if(!(n in t)||!e[n].is(t[n]))return!1;return!0})))},C=A,T=function(e){return(0,s.pipe)(I,S((function(t){for(var n in e){var r=t[n];if(void 0!==r&&!e[n].is(r))return!1}return!0})))},k=function(e){return(0,s.pipe)(E,S((function(t){return t.every(e.is)})))},O=function(e){return(0,s.pipe)(I,S((function(t){for(var n in t)if(!e.is(t[n]))return!1;return!0})))},N=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return Array.isArray(t)&&t.length===e.length&&e.every((function(e,n){return e.is(t[n])}))}}},M=function(e){return function(t){return{is:function(n){return t.is(n)&&e.is(n)}}}},x=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return e.some((function(e){return e.is(t)}))}}},R=function(e){return function(t){return(0,s.pipe)(I,S((function(n){var r=n[e];return r in t&&t[r].is(n)})))}},L=function(e){var t=(0,g.H)(e);return{is:function(e){return t().is(e)}}},D=o.identity,P=function(e){return function(t){return{is:function(n){return t.is(n)||e().is(n)}}}},U=function(){return{is:function(e){return!1}}},F=function(e){return function(t){return{is:function(n){return t.is(n)&&e.is(n)}}}},j=function(){return{is:function(e){return!0}}},B="io-ts/Guard",W={URI:B,literal:y,string:_,number:v,boolean:b,nullable:w,type:C,struct:A,partial:T,record:O,array:k,tuple:N,intersect:M,sum:R,lazy:function(e,t){return L(t)},readonly:D},G={UnknownArray:E,UnknownRecord:I},z={union:x},H={refine:S};function q(e){return function(t,n){return{decode:function(r){return t(r)?e.of(r):e.throwError(n(r))}}}}function Y(e){return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return{decode:function(i){return y.apply(r,n).is(i)?e.of(i):e.throwError(t(i,n))}}}}}function V(e){return function(t){return function(n){return{decode:function(r){return null===r?e.of(null):e.bimap(n.decode(r),(function(e){return t(r,e)}),(function(e){return e}))}}}}}function $(e){var t=ne(e);return function(n){return function(r){return{decode:function(i){return t(r,(function(t,r){return e.mapLeft(r.decode(i[t]),(function(e){return n(t,e)}))}))}}}}}function Q(e){var t=te(e);return function(n){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return{decode:function(i){return t(r,(function(t,r){return e.mapLeft(r.decode(i[t]),(function(e){return n(t,e)}))}))}}}}}function Z(e){return function(t){return function(n){return{decode:function(r){return e.ap(e.map(n.decode(r),(function(e){return function(t){return(0,g.U)(e,t)}})),t.decode(r))}}}}}function X(e){return function(t){return function(n,r){var i=(0,g.H)(r);return{decode:function(r){return e.mapLeft(i().decode(r),(function(e){return t(n,e)}))}}}}}function J(e){return function(t){return function(n){return{decode:function(r){return e.chain(n.decode(r),t.decode)}}}}}var K,ee,te=function(e){return function(t,n){return t.reduce((function(t,r,i){return e.ap(e.map(t,(function(e){return function(t){return e.push(t),e}})),n(i,r))}),e.of([]))}},ne=function(e){return function(t,n){var r=Object.keys(t);if(0===r.length)return e.of({});for(var i=e.of({}),o=function(r){i=e.ap(e.map(i,(function(e){return function(t){return e[r]=t,e}})),n(r,t[r]))},s=0,a=r;s<a.length;s++){o(a[s])}return i}},re=function(e){var t={};for(var n in e){var r=e[n];a.isRight(r)&&(t[n]=r.right)}return t},ie=f(),oe={URI:a.URI,_E:void 0,map:function(e,t){return(0,s.pipe)(e,a.map(t))},ap:function(e,t){return a.isLeft(e)?a.isLeft(t)?a.left(ie.concat(e.left,t.left)):e:a.isLeft(t)?t:a.right(e.right(t.right))},of:a.right,chain:function(e,t){return(0,s.pipe)(e,a.chain(t))},throwError:a.left,bimap:function(e,t,n){return(0,s.pipe)(e,a.bimap(t,n))},mapLeft:function(e,t){return(0,s.pipe)(e,a.mapLeft(t))},alt:function(e,t){if(a.isRight(e))return e;var n=t();return a.isLeft(n)?a.left(ie.concat(e.left,n.left)):n}},se=function(e,t){return c(function(e,t){return{_tag:"Leaf",actual:e,error:t}}(e,t))},ae=(a.right,function(e,t){return function(e,t){return q(oe)(e,(function(e){return se(e,t)}))}(e.is,t)}),ce=Y(oe)((function(e,t){return se(e,t.map((function(e){return JSON.stringify(e)})).join(" | "))})),le=ae(_,"string"),ue=ae(v,"number"),de=ae(b,"boolean"),pe=ae(E,"Array<unknown>"),he=ae(I,"Record<string, unknown>"),me=V(oe)((function(e,t){return l(c(m(0,se(e,"null"))),c(m(1,t)))})),fe=function(e){return $(oe)((function(e,t){return c(p(e,u,t))}))(e)},ge=function(e){return(0,s.pipe)(he,Ce(fe(e)))},ye=ge,_e=function(e){return function(e){var t=ne(e),n=e.of(a.right(void 0)),r=e.of(a.left(void 0));return function(i){return function(o){return{decode:function(s){return e.map(t(o,(function(t,o){var c=s[t];return void 0===c?t in s?n:r:e.bimap(o.decode(c),(function(e){return i(t,e)}),(function(e){return a.right(e)}))})),re)}}}}}(oe)((function(e,t){return c(p(e,d,t))}))(e)},ve=function(e){return function(e){var t=te(e);return function(n){return function(r){return{decode:function(i){return t(i,(function(t,i){return e.mapLeft(r.decode(i),(function(e){return n(t,e)}))}))}}}}}(oe)((function(e,t){return c(h(e,d,t))}))(e)},be=function(e){return function(e){var t=ne(e);return function(n){return function(r){return{decode:function(i){return t(i,(function(t,i){return e.mapLeft(r.decode(i),(function(e){return n(t,e)}))}))}}}}}(oe)((function(e,t){return c(p(e,d,t))}))(e)},Ee=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Q(oe)((function(e,t){return c(h(e,u,t))})).apply(void 0,e)},Ie=Z(oe),Se=function(e){return function(t){return function(e){return function(t){return function(n){return function(r){var i=Object.keys(r);return{decode:function(o){var s=o[n];return s in r?r[s].decode(o):e.throwError(t(n,s,i))}}}}}}(oe)((function(e,t,n){return c(p(e,u,se(t,0===n.length?"never":n.map((function(e){return JSON.stringify(e)})).join(" | "))))}))(e)(t)}},we=X(oe)((function(e,t){return c(function(e,t){return{_tag:"Lazy",id:e,errors:t}}(e,t))})),Ae=o.identity,Ce=J(oe),Te="io-ts/Decoder",ke={URI:Te,literal:ce,string:le,number:ue,boolean:de,nullable:me,type:ye,struct:ge,partial:function(e){return(0,s.pipe)(he,Ce(_e(e)))},record:function(e){return(0,s.pipe)(he,Ce(be(e)))},array:function(e){return(0,s.pipe)(pe,Ce(ve(e)))},tuple:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,s.pipe)(pe,Ce(Ee.apply(void 0,e)))},intersect:Ie,sum:function(e){return function(t){return(0,s.pipe)(he,Ce(Se(e)(t)))}},lazy:we,readonly:Ae},Oe=[],Ne=function(e,t){return void 0===t&&(t=Oe),{value:e,forest:t}},Me=function(e){return e.value+xe("\n",e.forest)},xe=function(e,t){for(var n,r="",i=t.length,o=0;o<i;o++){var s=o===i-1;r+=e+(s?"└":"├")+"─ "+(n=t[o]).value,r+=xe(e+(i>1&&!s?"│  ":"   "),n.forest)}return r},Re=(K={Leaf:function(e,t){return Ne("cannot decode "+JSON.stringify(e)+", should be "+t)},Key:function(e,t,n){return Ne(t+" property "+JSON.stringify(e),Le(n))},Index:function(e,t,n){return Ne(t+" index "+e,Le(n))},Member:function(e,t){return Ne("member "+e,Le(t))},Lazy:function(e,t){return Ne("lazy type "+e,Le(t))},Wrap:function(e,t){return Ne(e,Le(t))}},function(e){switch(e._tag){case"Leaf":return K.Leaf(e.actual,e.error);case"Key":return K.Key(e.key,e.kind,e.errors);case"Index":return K.Index(e.index,e.kind,e.errors);case"Member":return K.Member(e.index,e.errors);case"Lazy":return K.Lazy(e.id,e.errors);case"Wrap":return K.Wrap(e.error,e.errors)}}),Le=function(e){for(var t=[],n=e,r=[];;)switch(n._tag){case"Of":r.push(Re(n.value));var i=t.pop();if(void 0===i)return r;n=i;break;case"Concat":t.push(n.right),n=n.left}},De=function(e){return Le(e).map(Me).join("\n")},Pe=n(73915),Ue=n(38983),Fe=n(80358),je=n(84966),Be=n(67394),We=n(89943),Ge=n(81670),ze=n(8125),He=n(22232),qe=n(5114),Ye=n(19429),Ve=n(81531),$e=n(46680),Qe=n(76513),Ze=n(4390),Xe=n(7410),Je=n(88570),Ke=n(92843),et=n(68983),tt=n(51653),nt=n(21729),rt=n(67434),it=n(2834),ot=n(77176);!function(e){function t(t){return o=>(0,s.pipe)(t,Ke.v.foldMap(e.group)(r,i,n),(0,et.W)(e.group.concat)(o))}e.group=nt.dM.group,e.eq=nt.dM.eq,e.applyDiff=t,e.fromAlerts=function(e){const n=Ve.Monitoring.Logging.getLogger("DocumentCounters");return e.pipe(rt.R(((e,n)=>({alerts:n,counters:t(Ze.p.Diff.toRegistered(Ze.p.diff(e.alerts,n)))(e.counters)})),{alerts:Ze.p.empty,counters:nt.dM.group.empty}),it.b((({counters:e})=>{nt.dM.isValid(e)||n.error("Counters can not be below zero",nt.dM.show.show(e))})),ot.U((({counters:e})=>e)))};const n=e=>tt.R.toUnmutedOnly(e.counters),r=(0,o.flow)(n,e.group.inverse),i=(t,i)=>e.group.concat(n(i),r(t))}(ee||(ee={}));var st,at=n(17771),ct=n(45614),lt=n(93756),ut=n(90329),dt=n(66896),pt=n(2291),ht=n(85985);!function(e){function t(e){const{left:t,right:r}=(0,s.pipe)(e,ct.filterMap(qe.fromNullable),ct.filterWithIndex((e=>"GeneralScore"!==e)),ct.mapWithIndex(((e,t)=>({lensId:n(e),score:pt.T.fromNumber(t)}))),ct.partitionMap((0,at.Y)(a.either))),i=(0,s.pipe)(r,ct.map((({lensId:e,score:t})=>(0,o.tuple)(e,t))),(e=>new Map(Object.values(e))));return(0,s.pipe)(lt.Qp(qe.fromPredicate((0,o.not)(ct.isEmpty))(t),qe.fromPredicate((0,o.not)(ut.xb))(i)),qe.getOrElse((()=>lt.F2(new Map))))}function n(e){return e===dt.R.SpecialId.Plagiarism?a.right(dt.R.SpecialId.Plagiarism):dt.R.OutcomeId.toOutcomeId(e)}e.empty=new Map,e.eq=ut.Eh(dt.R.Id.ord,pt.T.ord),e.fromCapi=function(e){return e.pipe(ht.h((0,ze.Kg)(Fe.h.is("finish"),Fe.h.is("async_check_finished"),Fe.h.is("feedback_ack"))),ot.U((e=>e.outcomeScores)),ht.h(ze.$K),ot.U(t),it.b(lt.Vn((e=>{ct.isEmpty(e)||Ve.Monitoring.Logging.getLogger("LensesScores").error("failed to parse capi scores",e)}))),ht.h((0,ze.Kg)(lt.WP,lt.tO)),ot.U((e=>e.right)))}}(st||(st={}));var mt,ft=n(95983),gt=n(98403),yt=n(32952),_t=n(38194),vt=n(77843),bt=n(93508),Et=n(95093),It=n(598),St=n(24209),wt=n(50628),At=n(17343),Ct=n(36919),Tt=n(51374),kt=n(11064),Ot=n(23330),Nt=n(64015),Mt=n(25938),xt=n(64450),Rt=n(37492),Lt=n(61601),Dt=n(51072),Pt=n(71249),Ut=n(26328),Ft=n(70996),jt=n(32426),Bt=n(36991),Wt=function(){function e(e){this._delta=e,this._cursor={index:0,operationOffset:0}}return e.prototype.next=function(e){(0,He.kG)(e>=0,"Length cannot be negative");var t=this._cursor.index;if(t>=this._delta.ops.length)return qe.none;for(var n=Bt.s.operationLength(this._delta.ops[t]),r=e-(n-this._cursor.operationOffset);r>0&&t<this._delta.ops.length-1;)t++,r-=n=Bt.s.operationLength(this._delta.ops[t]);return r>0?(this._cursor={index:t+1,operationOffset:0},qe.none):(this._cursor={index:t,operationOffset:n+r},qe.some(this._delta.ops[t]))},e}();!function(e){const t=qe.getMonoid((0,jt.getObjectSemigroup)());e.getEnrichedWithFormattingDelta=e=>n=>{const r=new Wt(e);return n.ops.reduce((([e,n],i)=>{const o=r.next(n);return Bt.s.isInsert(i)?[e.insert(i.insert,qe.toUndefined(t.concat(qe.chain(Bt.s.getAttrs)(o),Bt.s.getAttrs(i)))),0]:[e.push(i),Bt.s.operationLength(i)]}),[new xt.Delta,1])[0]}}(mt||(mt={}));var Gt=n(40018);function zt(e){switch(e._raw.point){case"AllCapsBoldification":return Be.JJ.fromAlternativeBoldified;case"Lists":return Be.JJ.fromAlternativeListified;default:return Be.JJ.fromAlternative}}const Ht=(0,ze.HP)(Ve.Monitoring.Logging.getLogger),qt=(0,o.flow)(Nt.UI((({beingAppliedAlert:e,undo:t,reversedAlternative:n})=>Ot.Y3((()=>{const r={action:je.PZ.ACCEPTED,commit:()=>Ht("AlertManager.ops").debug(`_applyTransformJson(${e.toLiteString()}):commit()`),undo:t,reversedAlternative:e.registerReversedAlternative(n)},i=e.switchToApplied(r),o=Gt.xS.create(i.state.from,Ft.h.create(e));return[i.id,o]}),a.toError))),Ot.mg);function Yt(e){const t=Be.r3.compose(e.alternatives.map(i.UI((e=>e.alternative))),e.currentFullText);return(0,s.pipe)(Bt.s.nonEmpty(t.composedDelta)?qe.some(t):qe.none,qe.map((({composedDelta:t,reversedAlternatives:n})=>({changeWithFormatting:(0,s.pipe)(t,mt.getEnrichedWithFormattingDelta(e.currentFullText),(t=>Mt.RI.delta(t,e.originalTextLength))),correctRevAlternatives:(0,s.pipe)(n,Ge.T.tapFailure((({rejected:e})=>Ve.Monitoring.Logging.getLogger("AlertManager.ops").error("failed to generate reverse alternative",e))),Ge.T.foldSuccess(Pt.map((t=>({reversedAlternative:t.reversedAlternative,alternative:i.li(e.alternatives[t.alternativeIndex]),alert:e.alerts[t.alternativeIndex].alert})))))}))))}var Vt;!function(e){const t=(0,o.flow)(((e,t)=>a.tryCatch((()=>Gt.xS.create(e,t)),a.toError)),a.map((e=>(0,o.tuple)(e[0].id,e))),kt.of);e.prepare=kt.tS((0,o.tupled)(t)),e.prepareFromAlert=Ot.tS((e=>t(e.state.from,Ft.h.create(e))))}(Vt||(Vt={}));function $t(e,t){return a.fromPredicate(e,(e=>{const n=new He.ej(t,e.toString());return Ve.Monitoring.Logging.getLogger("AlertManager.ops").error(t,n),n}))}const Qt=e=>$t(Gt.bZ.isNotDisposed,e);function Zt(e){return Ot.tS(qe.fold((0,o.constant)(Ot.F2(void 0)),e))}var Xt;!function(e){e.mock={undoApplied:()=>Ot.F2(void 0)}}(Xt||(Xt={}));class Jt{constructor(e,t,n,r){this._positionManager=e,this._getContent=t,this._capiClient=n,this._alertsRepo=r,this._log=Ve.Monitoring.Logging.getLogger("AlertManager.ops"),this._sendUpdate=e=>Ot.Y3((()=>this.events.next({updated:new Map(e)})),a.toError),this._sendSingleUpdate=Ot.tS((e=>this._sendUpdate([e]))),this._flushChanges=Ot.Y3((()=>this.changes.next(Mt.RI.flush())),a.toError),this.changes=new yt.xQ,this.events=new yt.xQ,this.undoApplied=(e,t)=>{return(0,s.pipe)((()=>this._positionManager.getTextLength()),kt.tS((t=>{const r={alertsToUpdate:[],reversedDelta:new xt.Delta,undo:o.constVoid},i=e.filter(Gt.bZ.isApplied).reduce(((e,t)=>{const r=t.state.undoable;return Gt.VD.isWithAlternative(r)?(0,s.pipe)(r.reversedAlternative,qe.fold((()=>{je.wQ.withTransformJson(t._raw)&&this._log.error("No reversed delta registered for alert",{alert:t.toLiteString()}),n(e,t)}),(0,o.flow)((e=>e()),a.map((e=>e.delta)),a.fold((e=>{this._log.error("Could not retrieve reversed delta",{e:e,alert:t.toLiteString()})}),(r=>{n(e,t),(0,s.pipe)(r,Be.r3.fromRawDelta,(t=>t.rebase(e.reversedDelta)),qe.fold((()=>{e.reversedDelta=e.reversedDelta.compose(r)}),(({delta:t})=>{e.reversedDelta=e.reversedDelta.compose(t)})))}))))):n(e,t),e}),r);return i.alertsToUpdate.length>0?(0,s.pipe)(Ot.Y3((()=>{const e=(0,s.pipe)(i.reversedDelta,mt.getEnrichedWithFormattingDelta(this._getContent()));this.changes.next(Mt.RI.delta(e,t))}),a.toError),Ot.N(this._flushChanges),Ot.N((0,s.pipe)(i.undo,kt.UI(a.right))),Ot.a1((0,s.pipe)(i.alertsToUpdate,Ot.mg,Ot.tS(this._sendUpdate)))):Ot.F2(void 0)})));function n(e,n){e.undo=(0,o.flow)(e.undo,n.state.undoable.undo),e.alertsToUpdate.push(Vt.prepare((()=>[Ft.h.create(n),Ft.h.create(n.changeState(t===Gt.bZ.State.Applied.Method.ByCard?Gt.bZ.State.init:Gt.bZ.State.Removed.create(Gt.bZ.State.Removed.Reason.bulkAcceptUserResponse)))])))}},this._dismissBatch=(e,t)=>(0,s.pipe)(this._flushChanges,Ot.a1((0,s.pipe)(e,Pt.map((0,o.flow)(kt.of,kt.UI(Qt("Cannot send feedback for already disposed")),Ot.tS((e=>this._applyFeedbackToAlert(e,je.PZ.IGNORE,Gt.l$.sidebar,this._commitFeedbackToCapi(e,{kind:je.PZ.IGNORE,subtype:t})))),Vt.prepareFromAlert)),Ot.mg,Ot.tS(this._sendUpdate)))),this._applyAlert=({alert:e,replacementText:t,source:n,method:r,feedbackSubtype:i,reason:o})=>(0,s.pipe)(e,$t(Gt.bZ.isRegistered,"can not apply alert in non registered state"),kt.of,Ot.N(this._flushChanges),Ot.tS((e=>this._switchToBeingApplied(e,n,r))),Ot.tS((({beingAppliedAlert:e,undo:n})=>(0,s.pipe)(e.getReplaceEither.bind(e),Ot.LF,Ot.Pd((()=>new Error("Cannot apply alert with tJSON")),(r=>{this._log.debug(`_applyAlert(${e.toLiteString()}, rrange: ${r})`);const s=r.start,a=r.end-r.start,c=(new xt.Delta).retain(s).delete(t.length).insert(e.replaceText);return{alert:e,undo:n,reverseDelta:c,replacementText:t,removeLen:a,feedbackSubtype:i,pos:s,reason:o}}))))),Ot.tS(this._applyAlertData)),this._applySmartPhrasesAlert=({alerts:e,feedbackSubtype:t,reason:n})=>(0,s.pipe)(this._flushChanges,Ot.a1((0,s.pipe)(e,Ot.pE((e=>(0,s.pipe)(e.alternative,Ot.UI((t=>(0,o.tuple)({alternative:Lt.Alternative.withoutOptionalOps(t.alternative.ops),alternativeIndex:t.alternativeIndex},zt(e.alert))))))))),Ot.tS((t=>Ot.Y3((()=>({alternatives:t,alerts:e,originalTextLength:this._positionManager.getTextLength(),currentFullText:this._getContent()})),a.toError))),Ot.UI(Yt),Zt((e=>(0,s.pipe)(e.correctRevAlternatives,Pt.map((({alert:e,alternative:r})=>(0,s.pipe)(Ot.dk((()=>e)),Ot.mU((e=>Ot.dk(this._sendApplySmartPhrasesFeedback(e,r.alternativeIndex,t,n))))))),Ot.mg,Ot.tS((t=>(0,s.pipe)(Ot.Y3((()=>this.changes.next(e.changeWithFormatting)),a.toError),Ot.N(this._flushChanges),kt.a1((0,s.pipe)((0,o.flow)(Nt.UI((e=>Ot.Y3((()=>{const t=Ft.h.create(e);e.bumpVersion();const n=Gt.xS.create(t,Ft.h.create(e));return[e.id,n]}),a.toError))),Ot.mg)(t),Ot.tS(this._sendUpdate)))))))))),this._applyTransformJson=({alerts:e,source:t,method:n,feedbackSubtype:r,drilldownSuggestionIds:i,reason:c})=>(0,s.pipe)(this._flushChanges,Ot.a1((0,s.pipe)(e,Ot.pE((e=>(0,s.pipe)(e.alternative,Ot.UI((t=>(0,o.tuple)(t,zt(e.alert))))))))),Ot.tS((t=>Ot.Y3((()=>({alternatives:t,alerts:e,originalTextLength:this._positionManager.getTextLength(),currentFullText:this._getContent()})),a.toError))),Ot.UI(Yt),Zt((e=>(0,s.pipe)(e.correctRevAlternatives,Pt.map((({alert:e,alternative:o,reversedAlternative:a})=>(0,s.pipe)(this._switchToBeingApplied(e,t,n),Ot.mU((e=>Ot.dk(this._sendApplyTransformJsonFeedback(e.beingAppliedAlert,o.alternativeIndex,r,i,c)))),Ot.UI((e=>Object.assign(Object.assign({},e),{reversedAlternative:a})))))),Ot.mg,Ot.tS((t=>(0,s.pipe)(Ot.Y3((()=>this.changes.next(e.changeWithFormatting)),a.toError),Ot.N(this._flushChanges),kt.a1((0,s.pipe)(qt(t),Ot.tS(this._sendUpdate)))))))))),this._alertFeedback=(e,t,n)=>{this._log.debug(`_alertFeedback(${e.toLiteString()}, feedbackType: ${t.kind}, source: ${n})`),Gt.bZ.isHidden(e)&&this._log.error("Sending feedback for a hidden alert",{alert:e,feedbackType:t.kind});const r=this._commitFeedbackToCapi(e,t);return(0,s.pipe)(e,Qt("Cannot send feedback for already disposed"),kt.of,Ot.tS((e=>t.kind!==je.PZ.LOOKED||e.isRead?je.nw.willRemoveAlert(t.kind)?(0,s.pipe)(this._flushChanges,Ot.a1(this._applyFeedbackToAlert(e,t.kind,n,r)),Vt.prepareFromAlert,this._sendSingleUpdate):(0,s.pipe)(r,Ot.dk):(0,s.pipe)(Vt.prepare((()=>[Ft.h.create(e),(e.isRead=!0,Ft.h.create(e))])),this._sendSingleUpdate,kt.N(r)))))},this._alertBatchFeedback=(e,t,n)=>(0,s.pipe)(e,Pt.filterMap((e=>e.rawId)),Ut.nI,qe.fold((0,o.constant)(o.constVoid),(e=>this._sendFeedback({kind:t,alertIds:e,subtype:n})))),this._notifyAlertUpdated=(0,o.flow)((e=>[[e[0].id,e]]),this._sendUpdate),this._releaseRef=(e,t)=>(0,s.pipe)(Ot.Y3((()=>{this._log.debug(`_releaseRef ${e} on (${t.toLiteString()}) refs: ${t._refNames}`,{shouldBeRemoved:Gt.bZ.shouldBeRemoved(t)}),Gt.bZ.shouldBeRemoved(t)&&this.events.next({removed:new Map([[t.id,Ft.h.create(t)]])})}),a.toError)),this._changeMuteState=(e,t)=>{const n=(0,s.pipe)(e,Ge.T.fromArray((0,o.flow)(Qt("Cannot send Mute feedback for already disposed"),a.chain($t((e=>qe.isSome(e.muteCategory)||Gt.bZ.belongsToAnySpecialCategory(e)),"Alert is not muting")))));return(0,s.pipe)(n,Ge.T.foldSuccess(Pt.map((e=>Vt.prepare((()=>[Ft.h.create(e),(e.mute=t,Ft.h.create(e))]))))),Ot.mg,Ot.UI(Ut.nI),Zt(this._sendUpdate),Ot.UI((0,o.constant)(n)))},this._changeGapValue=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isOneGap,"can not change gap value for a non one gap alert"),kt.of,Ot.tS((e=>Vt.prepare((()=>[Ft.h.create(e),Ft.h.create(e.changeGapValue(t))])))),this._sendSingleUpdate),this._confirmApplied=(0,o.flow)(Pt.map((e=>Vt.prepare((()=>[Ft.h.create(e),Ft.h.create(e.changeState(Gt.bZ.State.Removed.create(Gt.bZ.State.Removed.Reason.bulkAcceptUserResponse)))])))),Ot.mg,Ot.tS(this._sendUpdate)),this._changeTakeawayFeedback=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isTakeaway,"can not change feedback for non-takeaway alert"),kt.of,Ot.tS((e=>{const n=Ft.h.create(e),r=e.setFeedback(t),i=Ft.h.create(r);return(0,s.pipe)(Vt.prepare((()=>[n,i])),this._sendSingleUpdate,Ot.UI((()=>r)))}))),this._shortenItSummaryNotFound=e=>(0,s.pipe)(e,Qt("Cannot change state to not-found for already disposed"),a.chain($t(Gt.bZ.isShortenIt,"cannot change state to not-found for a non shorten-it alert")),kt.of,Ot.tS((e=>{const t=Ft.h.create(e),n=e.changeSummaryState("notFound"),r=Ft.h.create(n);return(0,s.pipe)(Vt.prepare((()=>[t,r])),this._sendSingleUpdate,Ot.UI((()=>n)))}))),this._commitShortenItSummaryRequest=e=>(0,s.pipe)(e,Qt("Cannot send shorten_it_submit message for already disposed"),a.chain($t(Gt.bZ.isShortenIt,"cannot send shorten_it_submit for a non shorten-it alert")),kt.of,Ot.tS((e=>{const t=Ft.h.create(e),n=e.changeSummaryState("requestSent"),r=Ft.h.create(n);return(0,s.pipe)(Vt.prepare((()=>[t,r])),this._sendSingleUpdate,Ot.UI((()=>n)),kt.N(this._commitShortenItSubmitToCapi(e)))}))),this._dismissShortenItTransformGroup=(e,t)=>(0,s.pipe)(e,Qt("Cannot dismiss transform group for already disposed"),a.chain($t(Gt.bZ.isShortenIt,"cannot dismiss transform group for a non shorten-it alert")),kt.of,Ot.tS((e=>{const n=Ft.h.create(e),r=e.dismissTransformGroup(t),i=Ft.h.create(r);return(0,s.pipe)(Vt.prepare((()=>[n,i])),this._sendSingleUpdate,Ot.UI((()=>r)))}))),this._changeToneAIToneAlternative=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isToneAI,"Cannot change tone for a non-ToneAI alert."),kt.of,Ot.tS((e=>Ot.Y3((()=>{const n=[(0,o.tuple)(e.id,Gt.xS.create(Ft.h.create(e),Ft.h.create(e.setSelectedToneAlternativeIdx(t))))];return this.events.next({updated:new Map(n)}),e}),a.toError)))),this._changeSmartPhrasesFeedback=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isSmartPhrases,"Cannot change feedback for a non-SmartPhrases alert."),kt.of,Ot.tS((e=>Ot.Y3((()=>{const n=[(0,o.tuple)(e.id,Gt.xS.create(Ft.h.create(e),Ft.h.create(e.setFeedback(t))))];return this.events.next({updated:new Map(n)}),e}),a.toError)))),this._rotateSmartPhrasesReplacements=e=>(0,s.pipe)(e,$t(Gt.bZ.isSmartPhrases,"Cannot rotate replacements for a non-SmartPhrases alert."),kt.of,Ot.tS((e=>Ot.Y3((()=>{const t=[(0,o.tuple)(e.id,Gt.xS.create(Ft.h.create(e),Ft.h.create(e.rotateReplacements())))];return this.events.next({updated:new Map(t)}),e}),a.toError)))),this._discardSmartPhrasesReplacement=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isSmartPhrases,"Cannot discard replacement for a non-SmartPhrases alert."),kt.of,Ot.tS((e=>Ot.Y3((()=>{const n=[(0,o.tuple)(e.id,Gt.xS.create(Ft.h.create(e),Ft.h.create(e.discardReplacement(t))))];return this.events.next({updated:new Map(n)}),e}),a.toError)))),this._changeSentenceLevelBrandTonesFeedback=(e,t)=>(0,s.pipe)(e,$t(Gt.bZ.isSentenceLevelBrandTones,"Cannot change feedback for a non-Sentence Level Brand Tones alert."),kt.of,Ot.tS((e=>Ot.Y3((()=>{const n=[(0,o.tuple)(e.id,Gt.xS.create(Ft.h.create(e),Ft.h.create(e.setFeedback(t))))];return this.events.next({updated:new Map(n)}),e}),a.toError)))),this._handleCapiError=e=>t=>{Rt.EP.isDroppedError(t)?this._log.debug(`Stopped listening for ${e} message acknowledge`,t):Rt.YG.isNotConnectedError(t)?this._log.warn(`Failed to send ${e} as CAPI was not connected`,t):this._log.error(`Failed to send ${e}`,t)},this._applyAlertData=({pos:e,removeLen:t,reverseDelta:n,undo:r,replacementText:i,alert:o,feedbackSubtype:c,reason:l})=>(0,s.pipe)(Ot.Y3((()=>{let s=this._positionManager.getTextLength(),a=!1;const u={action:je.PZ.ACCEPTED,replacement:i,commit:()=>{a||this._log.debug(`_applyAlert(${o.toLiteString()}):commit()`)},reversedAlternative:qe.none,undo:()=>{a=!0,this._log.debug(`_applyAlert(${o.toLiteString()}):undo()`);const e=this._positionManager.getTextLength();e!==s&&this._log.error(`Text has changed while uncommitted apply is present. Expected: ${s}, actual: ${e}`);const t=Mt.RI.delta(n,e);this.changes.next(t),this.changes.next(Mt.RI.flush()),r()}};return this._sendApplyTextFeedback(o,i,c,l)(),this.changes.next(Mt.RI.delta((new xt.Delta).retain(e).delete(t).insert(i),s)),this.changes.next(Mt.RI.flush()),s=this._positionManager.getTextLength(),u}),a.toError),Ot.tS((e=>Ot.Y3((()=>o.switchToApplied(e)),a.toError))),Vt.prepareFromAlert,this._sendSingleUpdate),this._sendApplyFeedback=(e,t)=>e.state.method===Gt.bZ.State.Applied.Method.ByCard?this._commitFeedbackToCapi(e,t):o.constVoid,this._sendApplyTextFeedback=(e,t,n,r)=>this._sendApplyFeedback(e,{kind:je.PZ.ACCEPTED,replacementText:t,subtype:n,reason:r}),this._sendApplyTransformJsonFeedback=(e,t,n,r,i)=>{const o={kind:je.PZ.ACCEPTED,alternativeIndex:t,subtype:n,drilldownSuggestionIds:r,reason:i},s=Gt.bZ.isOneGap(e)?Object.assign(Object.assign({},o),{gapValue:e.gapValue}):Gt.bZ.isShortenIt(e)?Object.assign(Object.assign({},o),{dismissedTransformGroups:Array.from(e.dismissedTransformGroups)}):o;return this._sendApplyFeedback(e,s)},this._sendApplySmartPhrasesFeedback=(e,t,n,r)=>{const i={kind:je.PZ.ACCEPTED,alternativeIndex:t,subtype:n,reason:r};return this._commitFeedbackToCapi(e,i)}}_applyFeedbackToAlert(e,t,n,r){return Ot.Y3((()=>{this._alertsRepo.removeFromCapiMapping(e);const i=this._createFeedbackUndoable(e,t,r);return e.changeState(Gt.bZ.State.Applied.create(i,n,Gt.bZ.State.Applied.Method.ByCard,Ft.h.create(e)))}),a.toError)}_createFeedbackUndoable(e,t,n){return{action:t,replacement:e.replaceText,commit:n,undo:()=>this._alertsRepo.addToCapiMapping(e)}}_commitFeedbackToCapi(e,t){return(0,s.pipe)(e.rawId,qe.fold((0,o.constant)((()=>this._log.debug("skip feedback for local alert",e))),(e=>this._sendFeedback(Object.assign({id:e},t)))))}_sendFeedback(e){return()=>{Dt.toPromise(this._capiClient.sendFeedback(e)).catch(this._handleCapiError("alert feedback"))}}_commitShortenItSubmitToCapi(e){return(0,s.pipe)(e.rawId,qe.fold((0,o.constant)((()=>this._log.debug("skip shorten-it-submit for local alert",e))),(e=>this._shortenItSubmit(e))))}_shortenItSubmit(e){return()=>{Dt.toPromise(this._capiClient.shortenItSubmit(e)).catch(this._handleCapiError("shorten-it-submit"))}}_switchToBeingApplied(e,t,n){return Ot.Y3((()=>(this._alertsRepo.removeFromCapiMapping(e),e.switchToBeingAppliedState(t,n))),a.toError)}}var Kt,en,tn,nn,rn,on=n(83078);!function(e){e.toString=a.fold((({id:e})=>`rid:${e}`),(e=>`aid:${e.toString()}`))}(Kt||(Kt={})),function(e){e.match=function(e){return t=>t instanceof Gt.Ev?e.alertAddOrUpdate(t):t instanceof Map?e.rangeChange(t):"_tag"in t?e.alertRemove(t):e.alertChange(t)}}(en||(en={})),function(e){e.defaultValidator=Gt.bZ.isDuplicatedBy}(tn||(tn={}));class sn{constructor(e,t,n){this._positionManager=e,this._alertsRepo=t,this._alertDuplicateValidator=n,this._log=Ve.Monitoring.Logging.getLogger("AlertManager.pipeline",$e.LogLevel.DEBUG),this._heuristicallyRemovedAlerts=new Map,this.process=e=>(this._log.trace(`process, to process = ${e.length}`),this._collectChanges(this._processAlertsBatch(e))),this.reset=e=>(this._cleanupPendingAlerts(e),this._finishAlertsChecking()),this._processAlertsBatch=e=>{const{toAdd:t,toUpdate:n,toAddOrUpdate:r,toRemoveUnfiltered:i,toChangeUnfiltered:c,toDispose:l,rangeChanges:u}=this._processBatch(e),d=e=>(0,s.pipe)(this._alertsRepo.getByAlertId(e),qe.getOrElse((()=>t.get(e)||n.get(e)||l.get(e))));c.forEach((e=>(0,s.pipe)(qe.fromNullable(r.get(e.id)),qe.fold((()=>(0,s.pipe)(this._alertsRepo.getByRawAlertId(e.id),qe.map((t=>{const i=t.copy();i.patchWithRawAlert(sn._prepareUpdate(i,e)),n.set(i.id,i),r.set(e.id,i)})),qe.getOrElse((()=>this._log.info("Change from CAPI: Cannot find internal AlertId."))))),(t=>{const r=sn._prepareUpdate(t,e);n.has(t.id)?t.patchWithRawAlert(r):t.updateAlertWithManagedData(r)})))));const p=i.reduce(((e,i)=>{const o=(0,s.pipe)(i,a.fold((({id:e})=>(0,s.pipe)(this._alertsRepo.getByRawAlertId(e),qe.map((e=>Gt.bZ.isRegistered(e)?e:void 0)),qe.getOrElse((()=>this._heuristicallyRemovedAlerts.has(e)?void this._heuristicallyRemovedAlerts.delete(e):r.get(e))))),d));return void 0===o?(a.isLeft(i)?this._log.debug("Remove from CAPI: Cannot find internal AlertId. capiId: #"+JSON.stringify(i.left)):this._log.error("Cannot find existing alert by id",i.right),e):((0,s.pipe)(this._getMergeTarget(i,r),qe.filter(an((e=>e.lensId!==o.lensId?(this._log.warn("Trying to merge alerts from different lenses",{source:o,target:e}),!1):qe.isNone(o.rawId)?(this._log.warn("Trying to merge into local alert",{source:o,target:e}),!1):o.references>e.references))),qe.fold((()=>{e.set(o.id,{alert:o,reason:(0,s.pipe)(i,a.swap,qe.fromEither,qe.chain((e=>e.hint)),qe.chain((e=>e===Fe.A.NotFixed?qe.some(Gt.bZ.State.Removed.Reason.capiDismiss):qe.none)),qe.getOrElse((()=>Gt.bZ.State.Removed.Reason.capiDone)))})}),a.fold((e=>{this._log.debug("swap raw alerts with new alert",{source:o.toString(),newTarget:e.toString()}),this._alertsRepo.swapRaw(o,e);const i=on.unsafeGet(o.rawId);(0,He.kG)(void 0===n.get(e.id),"Added alert should not be present in the updated alerts map",(()=>n.get(e.id).toString()));const s=o.copy();n.set(s.id,s),r.set(i,s),t.delete(e.id),l.set(e.id,e)}),(t=>{this._log.debug("swap raw alerts with existing alert",{source:o.toString(),existingTarget:t.toString()}),this._alertsRepo.swapRaw(o,t),e.set(t.id,{alert:t,reason:Gt.bZ.State.Removed.Reason.capiDismiss})})))),e)}),new Map),h=new Map;return u&&u.forEach(((e,t)=>{(0,s.pipe)(t,d,qe.fromPredicate((r=>r?Gt.bZ.isInteractable(r)?!n.has(r.id)||(this._log.debug("skip range change on updateHolder alert",r.toLiteString()),!1):(this._log.debug("skip range change on non-interactable alert",r.toLiteString()),!1):(this._log.warn("got range changes for unknown alert",{alertId:t,alertRanges:e}),!1))),qe.chain((n=>(0,s.pipe)(n.onRangeChange(e),qe.map((e=>{switch(e.state){case Gt.bZ.Transition.State.Pending:return h.set(n.id,[n,e.removedRanges]);case Gt.bZ.Transition.State.Dispose:return(0,s.pipe)(n.rawId,qe.fold((()=>this._log.debug("dispose by range change on unknown rid",n.id)),(e=>this._heuristicallyRemovedAlerts.set(e,n)))),p.set(t,{alert:n,reason:Gt.bZ.State.Removed.Reason.textChange});default:return(0,He.vE)(e)}}))))))})),p.forEach((({alert:e})=>{this._log.trace("check cancellations from toRemove: "+e.toLiteString()),(0,s.pipe)(e.rawId,qe.fold((()=>{t.get(e.id)&&(this._log.debug("cancel add local alert for: "+e.toLiteString()),t.delete(e.id),p.delete(e.id),l.set(e.id,e)),(0,He.kG)(!1===n.has(e.id),"Added local alert should not be present in the updated alerts map",(()=>n.get(e.id).toString()))}),(i=>{const o=r.get(i);o&&(r.delete(i),t.delete(o.id)?(this._log.debug("cancel add for: "+o.toLiteString()),this._log.debug("cancel remove for: "+e.toLiteString()),p.delete(e.id),l.set(e.id,e),l.set(o.id,o)):n.delete(o.id)?(this._log.debug("cancel update for: "+o.toLiteString()),o.id!==e.id&&(this._log.debug("marking update to dispose: "+o.toLiteString()),l.set(o.id,o))):this._log.error("_addOrUpdateAlert toAdd || toUpdate mapping in unsync state!",o))}))),this._log.trace("check if local orphan toRemove: "+e.toLiteString()),(0,s.pipe)(this._alertsRepo.getByAlertId(e.id),qe.fold((()=>{this._log.debug("cancel delete for: "+e.toLiteString()),p.delete(e.id)}),o.constVoid))})),l.size>0&&this._log.debug(`_cancelAlerts, to cancel = ${l.size}`,{alerts:Array.from(l.values()).map((e=>e.toLiteString()))}),l.forEach((e=>{h.delete(e.id)&&this._log.debug("cancel startChecking for: "+e.toLiteString());try{e.dispose()}catch(t){this._log.warn("unexpected error on disposing canceled alert",t,e)}})),{toAdd:t,toUpdate:n,toRemove:p,toStartChecking:h}},this._collectChanges=({toAdd:e,toUpdate:t,toRemove:n,toStartChecking:r})=>{const{alertsToAdd:i,alertsToUpdate:o,alertsToRemove:s}=this._addAlerts(Array.from(e.values()),n);return t.size>0&&this._updateAlerts(Array.from(t.values()),o),r.size>0&&this._startAlertsChecking(Array.from(r.values()),o,i),s.size>0&&this._removeAlerts(s,o),{added:i,updated:o}},this._validateAlertAdd=e=>{try{const t=!Gt.bZ.isPremium(e)||void 0!==e.categoryHuman;return e._raw.impact!==je.wQ.Impact.Critical&&e._raw.impact!==je.wQ.Impact.Advanced&&qe.isSome(e.rawId)&&this._log.warn("CAPI provides corrupted impact prop",{alert:e,raw:je.wQ.clearUserTextFields(e._raw)}),t||(this._log.error("CAPI provides corrupted alert",{alert:e,raw:je.wQ.clearUserTextFields(e._raw)}),e.dispose()),(0,s.pipe)(e.rawId,qe.exists((e=>qe.isSome(this._alertsRepo.getByRawAlertId(e)))))?(this._log.warn("unexpected overlap on rawId for non-updatable alert",{alert:e,raw:je.wQ.clearUserTextFields(e._raw)}),e.dispose(),!1):e.lensType===dt.R.Type.Plagiarism&&pt.T.isMax(e.progress)?(this._log.info("CAPI provides a Plagiarism alert with an invalid progress",{alert:e,raw:je.wQ.clearUserTextFields(e._raw)}),e.dispose(),!1):t}catch(t){this._log.error("Cannot validate alert",t);try{e.dispose()}catch(e){this._log.warn("Cannot dispose invalid alert",e)}return!1}},this._recheckedAlerts=new Set,this._terminateAlertChecking=({id:e})=>{this._recheckedAlerts.delete(e)&&this._log.debug("Stopped watching checking state for alert",e)},this._applyRemoveToAlert=({alert:e,reason:t})=>(this._alertsRepo.removeFromCapiMapping(e),t!==Gt.bZ.State.Removed.Reason.textChange&&e.clearCapiId(),e.changeState(Gt.bZ.State.Removed.create(t))),this._finishAlertChecking=e=>{(0,He.kG)(this._recheckedAlerts.delete(e.id),"tried to finish checking on alert which had not been marked as checking"),this._log.debug("Stopped watching checking state for alert",e.id);const t=Ft.h.create(e);return Gt.xS.create(t,Ft.h.create(e.changeState(Gt.bZ.State.Registered.create(Gt.bZ.CheckingState.IDLE))))}}static _prepareUpdate(e,t){const n=Object.assign(Object.assign({},e.toRawAlert()),{rev:t.rev});return je.wQ.withTransformJson(n)&&(0,s.pipe)(t.transformJson,on.tap((e=>n.transformJson=e))),(0,s.pipe)(t.extraProperties,on.tap((e=>n.extra_properties=e))),(0,s.pipe)(t.muted,on.tap((e=>n.muted=e))),(0,s.pipe)(t.sdui,on.tap((e=>n.sdui=e))),n}_processBatch(e){return e.reduce(((e,t)=>(en.match({alertAddOrUpdate:t=>{(0,s.pipe)(t.rawId,qe.fold((()=>{e.toAdd.set(t.id,t)}),(n=>{(0,s.pipe)(this._alertsRepo.getByRawAlertId(n),qe.filter((e=>e.allowUpdate)),qe.map((()=>{(0,s.pipe)(qe.fromNullable(e.toAddOrUpdate.get(n)),qe.map((t=>{this._log.debug("got overlap in batch on update"),e.toUpdate.delete(t.id),e.toDispose.set(t.id,t)}))),e.toUpdate.set(t.id,t)})),qe.getOrElse((()=>{(0,s.pipe)(qe.fromNullable(e.toAddOrUpdate.get(n)),qe.map((t=>{this._log.info("got overlap in batch on add"),e.toAdd.delete(t.id),e.toDispose.set(t.id,t)}))),e.toAdd.set(t.id,t)}))),e.toAddOrUpdate.set(n,t)})))},rangeChange:t=>{(0,He.kG)(void 0===e.rangeChanges,"unexpected rangeChanges duplicate"),e.rangeChanges=t},alertRemove:t=>{e.toRemoveUnfiltered.push(t)},alertChange:t=>{e.toChangeUnfiltered.push(t)}})(t),e)),{toAdd:new Map,toRemoveUnfiltered:[],toChangeUnfiltered:[],toUpdate:new Map,toAddOrUpdate:new Map,rangeChanges:void 0,toDispose:new Map})}_getMergeTarget(e,t){return(0,s.pipe)(e,a.swap,qe.fromEither,qe.chain((e=>e.mergedIn)),qe.chain((e=>{const n=(0,s.pipe)(this._alertsRepo.getByRawAlertId(e),qe.map((e=>a.right(e))),qe.alt((()=>(0,s.pipe)(qe.fromNullable(t.get(e)),qe.map((e=>a.left(e)))))));return qe.isNone(n)&&this._log.warn("Merge from CAPI: Cannot find alert to merge into.",{capiId:e}),n})),qe.filter(an((e=>!!e.allowUpdate||(this._log.warn("Merge from CAPI: Trying to merge in a non-updatable alert, skipping. ",{target:e.toLiteString()}),!1)))))}_addAlerts(e,t){return e.length>0&&this._log.debug("_addAlerts, count = "+e.length,{alerts:e.map((e=>e.toLiteString()))}),(0,s.pipe)(e,Pt.filter(this._validateAlertAdd),Pt.reduce({alertsToAdd:new Map,alertsToUpdate:new Map,alertsToRemove:t},((e,t)=>{this._log.trace("Adding alert: "+t.toLiteString());const n=this._getAlertsWithMatchingRanges(t.getHighlightRanges()[0]),r=this._tryToMatchInvalid(t,n);switch(this._log.trace("Adding alert match result",{inc:t.id,match:r}),r.type){case nn.Type.Merged:{const n=r.result[1];Gt.bZ.isNotRegistered(n.alert)?Gt.bZ.isRemoved(n.alert)&&this._log.warn("unexpected merge into removed alert",{alert:n,newAlert:t}):this._alertsRepo.addToCapiMapping(n.alert),e.alertsToUpdate.set(n.id,r.result);break}case nn.Type.Restored:{const t=r.result[1];(0,He.kG)(!e.alertsToRemove.has(t.id),"can't update alert which we wanted to remove earlier"),this._alertsRepo.addToCapiMapping(t.alert),e.alertsToUpdate.set(t.id,r.result);break}case nn.Type.Unmatched:{const i=r.result,o=n.filter((t=>Gt.bZ.isDuplicateCandidate(t)&&this._alertDuplicateValidator(i,t)&&!e.alertsToRemove.has(t.id)));(0,He.kG)(i.allowDuplicates||Gt.bZ.isApplicableAlert(i),"BaseAlertImpl must allow duplicates or be an ApplicableAlert type"),o.length>0&&this._log.info("Trying to add a duplicated alert",{newAlert:t.toString(),duplicates:o.map((e=>e.toString()))});const a=i.allowDuplicates?{result:rn.Add,toRemove:qe.none}:this._tryAddAlert(i,o);switch(a.result){case rn.Add:case rn.OverwriteExisting:this._log.debug("AllAlerts: Append alert to all alerts",i.toLiteString()),this._alertsRepo.addToCapiMapping(i),(0,He.kG)(!e.alertsToRemove.has(i.id),"can't add alert which we wanted to remove earlier",(()=>i.toLiteString())),this._alertsRepo.add(i),e.alertsToAdd.set(i.id,Ft.h.create(i)),(0,s.pipe)(a.toRemove,on.tap((t=>{if(e.alertsToAdd.has(t.id)){this._alertsRepo.removeFromCapiMapping(t);const e=t.changeState(Gt.bZ.State.Removed.create(Gt.bZ.State.Removed.Reason.canceled));this._terminateAlertChecking(e),this._alertsRepo.remove(e)}else this._log.debug("schedule to remove duplicate",t.toLiteString()),e.alertsToRemove.set(t.id,{alert:t,reason:Gt.bZ.State.Removed.Reason.duplicated});e.alertsToAdd.delete(t.id),e.alertsToUpdate.delete(t.id)})));break;case rn.Skip:this._log.debug("Skip alert with low priority",i.id);break;default:(0,He.vE)(a.result)}break}default:(0,He.vE)(r)}return e})))}_updateAlerts(e,t){this._log.debug(`_updateAlerts, to update = ${e.length}`,{alerts:e.map((e=>e.toLiteString()))}),(0,s.pipe)(e,Pt.reduce(t,((e,t)=>(this._log.trace("Updating alert: "+t.toLiteString()),(0,s.pipe)(this._alertsRepo.getByRawAlertId(on.unsafeGet(t.rawId)),qe.fold((()=>this._log.warn("tried to update unknown alert",t)),(n=>{const r=t._raw;t.dispose();const i=e.has(n.id)?e.get(n.id)[0]:Ft.h.create(n);n.enqueueRawAlertForUpdate(r),e.set(n.id,Gt.xS.create(i,Ft.h.create(n)))}))),e))))}_startAlertsChecking(e,t,n){this._log.debug(`_startAlertsChecking, to update = ${e.length}`,{alerts:e.map((([e,t])=>[e.toLiteString(),t]))});const r=(e,t)=>{const n=e.changeState(Gt.bZ.State.Registered.create(Gt.bZ.CheckingState.CHECKING));return this._recheckedAlerts.add(e.id),Ft.h.create(t.size>0?n.enqueueRangesRemove(t):n)};(0,s.pipe)(e,Pt.reduce({updatedAlerts:t,addedAlerts:n},((e,[t,n])=>((0,s.pipe)(this._alertsRepo.getByAlertId(t.id),qe.fold((()=>{this._log.warn("tried to start checking unknown alert",{alert:t,ranges:n})}),(()=>{if(e.addedAlerts.has(t.id))e.addedAlerts.set(t.id,r(t,n));else{const i=e.updatedAlerts.has(t.id)?e.updatedAlerts.get(t.id)[0]:Ft.h.create(t);e.updatedAlerts.set(t.id,Gt.xS.create(i,r(t,n)))}}))),e))))}_removeAlerts(e,t){e.forEach(((e,n)=>{(0,s.pipe)(this._alertsRepo.getByAlertId(n),qe.fold((()=>{this._log.warn("tried to remove unknown alert",e)}),(()=>{const r=t.has(n)?t.get(n)[0]:Ft.h.create(e.alert),i=this._applyRemoveToAlert(e);this._terminateAlertChecking(i),t.set(n,Gt.xS.create(r,Ft.h.create(i)))})))}))}_getAlertsWithMatchingRanges(e){return(0,s.pipe)(this._positionManager.findIntersections(e),Pt.filter((0,ze.W9)(Tt.P.is,Tt.x.isVisible)),Pt.filterMap((e=>this._alertsRepo.getByAlertId(e.meta.alertId))),Pt.filter((e=>!(Gt.bZ.isApplied(e)&&e.getAppliedRanges().length>0))))}_tryToMatchInvalid(e,t){return(0,He.kG)(!e.isValid,"added alert should be invalid"),(0,He.kG)(Gt.bZ.isRegistered(e),"added alert should be in registered state",(()=>e.toString())),(0,s.pipe)(qe.fromNullable(t.find((t=>!t.isValid&&t.canBeMergedWith(e)))),qe.fold((()=>({result:e,type:nn.Type.Unmatched})),(t=>{(0,He.kG)((0,s.pipe)(t.rawId,on.forAll((0,o.flow)(this._alertsRepo.getByRawAlertId,qe.isNone))),"CAPI mapping should not contain invalid alerts"),this._log.debug(`Merging new alert (${e}) into the existing one aid(${t})`);const n=Ft.h.create(t);return t.patchWithRawAlert(e._raw),e.dispose(),t.allowUpdate&&Gt.bZ.isCapiDone(t)?{result:Gt.xS.create(n,Ft.h.create(t.changeState(Gt.bZ.State.init))),type:nn.Type.Restored}:{result:Gt.xS.create(n,Ft.h.create(t)),type:nn.Type.Merged}})))}_tryAddAlert(e,t){return(0,s.pipe)(Ut.nI(t),qe.map((t=>{(0,He.kG)(1===t.length,"Only one visible alert to one range is expected while _tryEnqueueAlert",`got ${t.map((e=>e.toString()))} with input (${e.toString()})`);const n=t[0];return n.extraProperties.priority<=e.extraProperties.priority?{result:rn.OverwriteExisting,toRemove:qe.some(n)}:(e.dispose(),{result:rn.Skip,toRemove:qe.none})})),qe.getOrElse((()=>({result:rn.Add,toRemove:qe.none}))))}_cleanupPendingAlerts(e){e.removed.forEach((e=>{this._heuristicallyRemovedAlerts.delete(e)&&this._log.info("unexpected alert remove from finish msg",e)})),this._heuristicallyRemovedAlerts.size>0&&this._log.info("we had heuristically removed alerts which were not confirmed by capi",{size:this._heuristicallyRemovedAlerts.size}),this._heuristicallyRemovedAlerts.clear()}_finishAlertsChecking(){return(0,s.pipe)(Array.from(this._recheckedAlerts.values()),Pt.filterMap((e=>{const t=this._alertsRepo.getByAlertId(e);qe.isNone(t)&&(this._log.error("tried to finish checking on missing alert",e),this._recheckedAlerts.delete(e));const n=(0,s.pipe)(t,qe.filter((e=>Gt.bZ.isRegistered(e))),qe.map((e=>(0,o.tuple)(e.id,this._finishAlertChecking(e)))));return qe.isNone(n)&&this._log.error("tried to update checking state on non-registered alert",e),n})),(e=>({updated:new Map(e)})))}}function an(e){return a.fold(e,e)}!function(e){let t;!function(e){e.Unmatched="Unmatched",e.Merged="Merged",e.Restored="Restored"}(t=e.Type||(e.Type={}))}(nn||(nn={})),function(e){e.Skip="Skip",e.Add="Add",e.OverwriteExisting="OverwriteExisting"}(rn||(rn={}));class cn{constructor(){this._log=Ve.Monitoring.Logging.getLogger("AlertManager.repository",$e.LogLevel.DEBUG),this._allAlerts=new Map,this._capiAlertsIdMapping=new Map,this.add=e=>{this._allAlerts.set(e.id,e)},this.remove=e=>{this._log.trace("AllAlerts: Clean alert from all alerts",e.toLiteString()),(0,He.kG)(0===e.references,"can not dispose alert in use",(()=>e.toString())),(0,He.kG)(!1===e.isValid,"can not dispose valid alert",(()=>e.toString())),(0,He.kG)(this._allAlerts.delete(e.id),"alert should exist in alerts list",(()=>e.toString())),e.dispose()},this.addToCapiMapping=e=>{e.isValid||(0,s.pipe)(e.rawId,qe.fold((()=>this._log.debug("skip register of local alert in capi mapping",e)),(t=>{this._log.trace("register alert in capi mapping",e.toLiteString()),(0,He.kG)(void 0===this._capiAlertsIdMapping.get(t),"unexpected overlap of rawid alert",(()=>e.toString())),e.validate(),this._capiAlertsIdMapping.set(t,e.id)})))},this.removeFromCapiMapping=e=>{e.isValid&&((0,s.pipe)(e.rawId,on.tap((t=>{this._log.trace("clean valid alert capi mapping for: "+e.toLiteString()),(0,He.kG)(this._capiAlertsIdMapping.delete(t),"valid alert should had valid raw id",(()=>e.toString()))}))),e.invalidate())},this.getByAlertId=e=>qe.fromNullable(this._allAlerts.get(e)),this.getByRawAlertId=e=>(0,s.pipe)(qe.fromNullable(this._capiAlertsIdMapping.get(e)),qe.chain(this.getByAlertId)),this.swapRaw=(e,t)=>{const n=(0,s.pipe)(e.rawId,qe.exists((e=>this._capiAlertsIdMapping.has(e)))),r=(0,s.pipe)(e.rawId,qe.exists((e=>this._capiAlertsIdMapping.has(e))));(0,He.kG)(n||r,"At least one of the swapped alerts should be registered in the system");const i=e._raw;e.silentPatchWithRawAlert(t._raw),t.silentPatchWithRawAlert(i),n&&this._capiAlertsIdMapping.set(on.unsafeGet(e.rawId),e.id),r&&this._capiAlertsIdMapping.set(on.unsafeGet(t.rawId),t.id)},this.toArray=()=>Array.from(this._allAlerts.values()),this.toMap=()=>this._allAlerts,this.toJSON=()=>({allAlerts:Array.from(this._allAlerts.entries()),idMapping:Array.from(this._capiAlertsIdMapping.entries())})}}var ln=n(96021);class un{constructor(e,t,n,r,c,l,u,d=tn.defaultValidator,p=!1){this._positionManager=e,this._alternativeManager=t,this._getContent=n,this._capiEvents=r,this._capiClient=c,this._documentCounters=l,this._transformRawAlert=u,this._alertDuplicateValidator=d,this._enforceSDUIOnlyMode=p,this._state=Ue.h.create(Je.r.empty),this.state=this._state.view(Je.r.toCheckingResult),this.lensesScores=Ue.h.create(st.empty),this._log=Ve.Monitoring.Logging.getLogger("AlertManager",$e.LogLevel.TRACE,$e.LogColor.Manager.getColor()),this._subs=[],this._addAlerts=new yt.xQ,this._removeAlerts=new yt.xQ,this._changeAlerts=new yt.xQ,this._flush=new yt.xQ,this._alertsPerRevision=0,this._alertsRepository=new cn,this._pipeline=new sn(this._positionManager,this._alertsRepository,this._alertDuplicateValidator),this._invalidateAlerts=()=>{this.flushAlerts();const[e,t]=We.partition(this._getAllAlertsAsArray(),(e=>e.isValid));this._log.debug("Invalidate alerts...",{valid:e.length,invalid:t.length}),e.forEach((e=>{this._alertsRepository.removeFromCapiMapping(e),e.clearCapiId()})),t.forEach((e=>e.clearCapiId()))},this._removeInvalidAlerts=e=>{this._log.debug(`Removing invalid alerts by type '${e}'...`);const t=this._getTypeFilter(e),n=this._getAllAlertsAsArray().filter((e=>!e.isValid&&Gt.bZ.isRegistered(e)&&t(e)));n.forEach((e=>this._removeAlertBuffered(a.right(e.id)))),this._log.debug(`${n.length} invalid alerts removed`),this.flushAlerts(),this._log.isEnabled($e.LogLevel.TRACE)&&this._log.trace("Removed alerts",n.map((e=>e.toString())))},this._onCapiEvent=e=>{try{switch("alert_received"===e.kind&&this._alertsPerRevision++,e.kind){case"alert_received":case"plagiarism_alert_received":if(!1===e.alert.hidden&&void 0===e.alert.cardLayout)return void this._log.warn("got alert with empty mapping",{pname:e.alert.pname});this._isValidSDUI(e.alert.id,e.alert.sdui,"alert_add")&&this._addAlertBuffered(Gt.bZ.create(this._transformRawAlert(e.alert),this._ops,this._positionManager,this._alternativeManager));break;case"alert_removed":this._log.debug(`Remove from capi #${e.alertId}, merged in #${qe.getOrElse((()=>"None"))(e.mergedIn)}, hint: ${qe.getOrElse((()=>"None"))(e.hint)}`);(0,s.pipe)(this._alertsRepository.getByRawAlertId(e.alertId),qe.exists(Gt.bZ.isBulkApplied))||this._removeAlertBuffered(a.left({id:e.alertId,mergedIn:e.mergedIn,hint:e.hint}));break;case"alert_changed":this._log.debug("Alert change from capi #"+e.alertId),(void 0===e.sdui||this._isValidSDUI(e.alertId,e.sdui,"alert_change"))&&this._changeAlertBuffered({id:e.alertId,rev:e.rev,extraProperties:qe.fromNullable(e.extraProperties),transformJson:qe.fromNullable(e.transformJson),muted:qe.fromNullable(e.muted),sdui:qe.fromNullable(e.sdui)});break;case"finish":this._log.debug(`Alerts per revision (#${e.revision}): ${this._alertsPerRevision}`),this._alertsPerRevision=0,"idle"===this._capiClient.checkingState&&this._emitDomainEvent(this._pipeline.reset(e))}}catch(t){this._log.warn("Cannot handle alert event "+e.kind,t)}},this._emitDomainEvent=e=>{(0,s.pipe)(e,this._prepareDiff,Xe.v.createDiff,Ge.T.recover((e=>this._log.error("conflicts on diff creating",e))),(e=>(this._log.debug("_emitDomainEvent",Ze.p.Diff.show.show(e)),e)),Je.r.applyDiff,Ye.UI(Ge.T.recover((e=>this._log.error("conflicts on diff apply",e)))),(e=>this._state.modify(e)))},this._prepareDiff=({added:e,updated:t=new Map,removed:n=new Map})=>(t.forEach(((e,r)=>{(0,s.pipe)(e,i.Yg,Gt.bZ.fromAlertModel,Gt.bZ.shouldBeRemoved)&&(t.delete(r),n.set(r,e[0]))})),n.forEach((0,o.flow)(Gt.bZ.fromAlertModel,this._disposeAlert)),{added:e,updated:t,removed:n}),this._disposeAlert=e=>{if(Gt.bZ.isApplied(e)&&e.state.undoable.commit(),Gt.bZ.isNotRegistered(e))try{this._alertsRepository.remove(e)}catch(t){this._log.error("can not remove alert",t),Gt.bZ.isNotDisposed(e)&&e.dispose()}else this._log.error("unexpected remove of registered alert",e.toString())},this._cardDSLDecoder=Pe.n(ke)(Qe.B),this._isValidSDUI=!1===this._enforceSDUIOnlyMode?o.constTrue:(e,t,n)=>void 0===t?(this._capiClient.sendDebugReport(e,`got unexpected empty sdui content during ${n}`)(),this._log.error(`skip alert on ${n} due to empty sdui content`,e),!1):(0,s.pipe)(this._cardDSLDecoder.decode(t.card),a.mapLeft((t=>{const r=De(t);this._capiClient.sendDebugReport(e,r)(),this._log.error(`skip alert on ${n} due to incorrect sdui content`,{alertId:e,err:r})})),a.isRight),this._ops=new Jt(this._positionManager,this._getContent,this._capiClient,this._alertsRepository),this.loadScores=e=>{this.lensesScores.set(e)},this.undoApplied=this._ops.undoApplied,this.changes=this._ops.changes;const h=e.rangeChanged.pipe(ot.U((({affected:e})=>e)),ht.h((e=>e.length>0)),ot.U((e=>ft.vM((e=>e.meta.alertId),e.filter(Tt.P.is)))),ht.h((e=>e.size>0)),it.b((e=>this._log.debug("Range[s] changed",e))),_t.B()),m=vt.F(250).pipe(bt.O(0),Et.T(this._flush)),f=gt.RX(this._log);this._subs.push(f("_alertsInvalidation",this._capiEvents.pipe(ht.h(Fe.h.is("session_started")),it.b(this._invalidateAlerts),It.c(St.T(this._capiEvents.pipe(ht.h(Fe.h.is("finish")),wt.P(),At.h("alert")),this._capiEvents.pipe(ht.h(Fe.h.is("async_check_finished")),wt.P(),At.h("plagiarism")))),it.b(this._removeInvalidAlerts))),f("_capiEvents",this._capiEvents.pipe(it.b(this._onCapiEvent))),f("_alertsProccesing",this._addAlerts.pipe(Et.T(this._removeAlerts),Et.T(this._changeAlerts),Et.T(h),Ct.f(m),ht.h(ze.Dw),ot.U(this._pipeline.process),it.b(this._emitDomainEvent))),f("_alertsBuffer",h.pipe(Et.T(this._capiEvents.pipe(ht.h(Fe.h.is("before_finish","before_async_check_finish","async_check_finished")))),At.h(gt.PU),it.b(this._flush))),f("_alertOpsAlertChanges",this._ops.events.pipe(it.b(this._emitDomainEvent))),f("_lensesScoresChanges",st.fromCapi(this._capiEvents).pipe(it.b(gt.wW(this.lensesScores)))),f("documentCountersChanges",ee.fromAlerts(this._state.view(Xe.v.iso.wrap)).pipe(it.b(gt.wW(this._documentCounters))))),(0,ze.iR)("alerts",(()=>this.toString())),(0,ze.iR)("triggerRemove",(e=>{this._removeAlertBuffered(a.right(e))}))}flushAlerts(){this._flush.next()}loadAlerts(e){const t=new Map;return(0,ze.Dw)(e)&&(this._log.debug(`${e.length} external alert(s) where loaded`),e.map(ln.I.splitById).map((({id:e,local:t})=>({id:e,alert:Gt.bZ.create((0,s.pipe)(t,je.wQ.matchBy(o.identity,(e=>Object.assign(Object.assign({},e),{transformJson:{highlights:e.transformJson.highlights,alternatives:(0,s.pipe)(e.transformJson.alternatives,qe.map(Be.r3.Group.fromSerialized))}})),o.identity),this._transformRawAlert),this._ops,this._positionManager,this._alternativeManager)}))).forEach((({id:e,alert:n})=>{this._addAlertBuffered(n),e&&t.set(e,n.id)}))),t}toString(){return JSON.stringify(this,void 0,2)}toJSON(){return{repo:this._alertsRepository}}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_getTypeFilter(e){switch(e){case"alert":return e=>!Gt.bZ.isPlagiarism(e);case"plagiarism":return e=>Gt.bZ.isPlagiarism(e);default:return(0,He.vE)(e)}}_addAlertBuffered(e){this._log.trace(`_addAlert(${e.toLiteString()})`),this._addAlerts.next(e)}_changeAlertBuffered(e){this._log.trace(`_changeAlert(${e.id})`),this._changeAlerts.next(e)}_removeAlertBuffered(e){this._log.trace(`_removeAlert(${Kt.toString(e)})`),this._removeAlerts.next(e)}_getAllAlertsAsArray(){return this._alertsRepository.toArray().filter(Gt.bZ.isNotRemoved)}}},6488:(e,t,n)=>{n.d(t,{e:()=>r});var r,i=n(40327),o=n(5114),s=n(4390),a=n(40018);!function(e){e.create=function(e){const t=t=>(0,i.pipe)(e.get(),s.p.get(t),o.map(a.bZ.fromAlertModel)),n=e=>(0,i.pipe)(t(e),o.filter(a.bZ.isInteractable)),r=e=>(0,i.pipe)(t(e),o.filter(a.bZ.isRegistered));return{getById:t,getRegistered:r,getInteractable:n,isRegistered:e=>(0,i.pipe)(r(e),o.isSome),isInteractable:e=>(0,i.pipe)(n(e),o.isSome)}}}(r||(r={}))},43320:(e,t,n)=>{n.d(t,{R:()=>o});var r=n(51072),i=n(32952);class o{static init(e,t,n,r,s,a){const c=new i.xQ;return new o(e,t,n,r,s,a,c),c}constructor(e,t,n,r,i,s,a){const c=o.NamedChangesSink.factory(a),l={pm:c(o.Receiver.PM,r),dm:c(o.Receiver.PM,i),capi:c(o.Receiver.CAPI,n),userTextEcho:c(o.Receiver.UserText,e)};o.Producer.create(o.Producer.UserText,{changes:e.changes})(l.dm,l.pm,l.capi),o.Producer.create(o.Producer.ALERT_APPLY,s)(l.userTextEcho),t.subscribe((t=>{"before_alert"===t.kind&&e.flushChanges()}))}}!function(e){let t,n,i,o;!function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.ALERT_APPLY="alert_synonyms_manager"}(t=e.Producer||(e.Producer={})),function(e){e.create=function(e,t){return(...n)=>t.changes.subscribe((t=>{n.forEach((n=>n.pushChanges(e,t)))}))}}(t=e.Producer||(e.Producer={})),function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.CAPI="checking_service",e.PM="position_manager"}(n=e.Receiver||(e.Receiver={})),function(e){function t(e,t,n){return{pushChanges:(i,o)=>{try{let s=t.pushChanges(o);"function"==typeof s&&(s=r.toPromise(s)),void 0!==s&&s.catch((t=>n.next({exception:t,details:{from:i,to:e}})))}catch(t){n.next({exception:t,details:{from:i,to:e}})}}}}e.factory=function(e){return(n,r)=>t(n,r,e)},e.create=t}(i=e.NamedChangesSink||(e.NamedChangesSink={})),function(e){e.create=e=>({changes:e.changes,pushChanges(t){e.pushChanges(t,"user")},getContents:()=>e.getContents(),flushChanges:()=>e.flushChanges()})}(o=e.UserTextChangesSync||(e.UserTextChangesSync={}))}(o||(o={}))},5008:(e,t,n)=>{n.d(t,{n:()=>r,A:()=>i});var r,i,o=n(57050),s=n(25938),a=n(36991),c=n(8125),l=n(62965),u=n(24209);!function(e){e.noopSync={pushChanges:c.ZT},e.ignoreResult=function(e){return{pushChanges:t=>{e.pushChanges(t)}}},e.ignoreTEResult=function(e){return{pushChanges:(0,o.flow)(e.pushChanges,l.UI(c.ZT))}},e.pushDeleteThenInsert=function(e){return{pushChanges:t=>{(s.RI.isDelta(t)?s.RI.fromArrayOfDeltas(a.s.splitToDeleteThenInsert(t.delta).filter(a.s.nonEmpty),t.prevLen):[t]).forEach((t=>e.pushChanges(t)))}}}}(r||(r={})),function(e){e.merge=function(e){return{changes:u.T(...e.map((e=>e.changes)))}}}(i||(i={}))},89772:(e,t,n)=>{n.d(t,{w:()=>i});var r,i,o=n(57050),s=n(40327),a=n(92843),c=n(68983),l=n(5114),u=n(90329),d=n(66896),p=n(51653),h=n(70996);!function(e){e.modelToCounters=function(e){return h.h.isRegistered(e)?e.counters:p.R.empty}}(r||(r={})),function(e){e.monoid=u.uZ(d.R.Id.ord,d.R.Meta.group),e.eq=u.Eh(d.R.Id.ord,d.R.Meta.eq),e.isEmpty=u.xb,e.lookup=u.P5(d.R.Id.ord),e.applyDiff=t=>r=>l=>(0,s.pipe)(r,a.v.foldMap(e.monoid)(i(t),p(t),n(t)),(0,c.W)(e.monoid.concat)(l),u.hX((0,o.not)(d.R.Meta.isEmpty))),e.updatePercentiles=e=>t=>{let n=t;return e.forEach(((e,t)=>{n=(0,s.pipe)(n,u.cq(d.R.Id.ord)(t,d.R.Meta.ratioToPercentile(e)),l.fold((()=>(0,s.pipe)(n,u.ZQ(d.R.Id.ord)(t,d.R.Meta.fromPercentile(e)))),o.identity))})),n};const t=(0,o.flow)(r.modelToCounters,d.R.Meta.fromAlertCounters),n=e=>n=>h(e)(n,t),i=e=>n=>h(e)(n,(0,o.flow)(t,d.R.Meta.group.inverse)),p=t=>(r,o)=>e.monoid.concat(n(t)(o),i(t)(r)),h=e=>(t,n)=>(0,s.pipe)(e,u.hX((e=>e(t.alert))),u.UI((()=>n(t))))}(i||(i={}))},13313:(e,t,n)=>{n.d(t,{A:()=>r});var r,i=n(38983),o=n(4390),s=n(54216),a=n(93508),c=n(57091),l=n(67434),u=n(98403),d=n(89772);!function(e){e.defaultState={alerts:o.p.empty,lenses:d.w.monoid.empty},e.get=(r,i,s)=>i.pipe(a.O(new Map),c.a(r.pipe(a.O(o.p.empty),l.R(((e,n)=>t(n,s.lensFilters)(e)),e.defaultState)),n)),e.getMock=(t,n)=>{const r=i.h.create(e.defaultState);return e.get(t,n,s.t.create(s.t.defaultLensFilters,s.t.defaultTextFilters)).subscribe(u.wW(r)),r};const t=(e,t)=>n=>{const r=o.p.Diff.toRegistered(o.p.diff(n.alerts,e));return{alerts:e,lenses:d.w.applyDiff(t)(r)(n.lenses)}},n=(e,t)=>Object.assign(Object.assign({},t),{lenses:d.w.updatePercentiles(e)(t.lenses)})}(r||(r={}))},35301:(e,t,n)=>{n.d(t,{J:()=>r});var r,i=n(71249),o=n(22690),s=n(57050),a=n(40327),c=n(38983),l=n(84966),u=n(80358),d=n(45701),p=n(90329),h=n(5114),m=n(43675),f=n(62965),g=n(95195),y=n(8125),_=n(81531),v=n(40018),b=n(32952),E=n(45586),I=n(85985),S=n(77176),w=n(2834),A=n(98403),C=n(16118),T=n(40151),k=n(85654);!function(e){let t,n,r;!function(e){let t;!function(e){e.ord=d.ordString,e.show=o._3,e.create=e=>e}(t=e.Id||(e.Id={})),e.isSpecial=e=>Object.values(l.JW.SpecialCategory).includes(e),e.specialCategoryDescription="Special category"}(t=e.Category||(e.Category={})),function(e){e.filter=e=>p.hX((t=>e(t.id))),e.filterWithCount=(e,t)=>n=>{const r=Array.from(n.keys()),i=k.k.getAlerts(t,r).byCategory;return(0,a.pipe)(n,p.DZ((t=>e(t.id)?h.some(Object.assign(Object.assign({},t),{alertsCount:i.get(t.id).filter(v.bZ.isRegistered).length})):h.none)))}}(n=e.BaseMutedCategories||(e.BaseMutedCategories={})),function(e){let r,o;!function(e){let t;!function(e){e.CategoriesChanged="CategoriesChanged"}(t=e.Type||(e.Type={})),e.isChangedEvent=function(e){return e.type===t.CategoriesChanged}}(r=e.Events||(e.Events={})),e.create=function(e,o,d,p,y){const T=_.Monitoring.Logging.getLogger("MutedAlertsModel"),O=c.h.create(new Map),N=new b.xQ,M=new E.w.Keeper;return M.push(e.pipe(I.h(u.h.is("session_started")),S.U((e=>function(e){const t=e.map((e=>[e.userMuteCategory,{id:e.userMuteCategory,description:e.userMuteCategoryDescription,scope:e.userMuteScope}]));return new Map(t)}(e.userMutedCategories))),w.b(A.wW(O)),w.b((()=>N.next({type:r.Type.CategoriesChanged})))).subscribe(),O.pipe(C.G(),S.U((([e,n])=>function(e,n){return{muted:m.diffKeys(t.Id.ord)(e,n),unmuted:m.diffKeys(t.Id.ord)(n,e)}}(e,n))),S.U(function(e){return({muted:t,unmuted:n})=>({toMute:k.k.getAlerts(e,t).all.filter((e=>e.mute!==v.bZ.MuteStateType.Muted)),toUnmute:k.k.getAlerts(e,n).all.filter((e=>e.mute!==v.bZ.MuteStateType.Unmuted))})}(d)),w.b((({toMute:e,toUnmute:t})=>{e.length>0&&p.changeMuteState(e,v.bZ.MuteStateType.Muted),t.length>0&&p.changeMuteState(t,v.bZ.MuteStateType.Unmuted)}))).subscribe()),{events:N,mutedCategories:O,muteCategories:e=>{(0,a.pipe)(o.sendFeedback({kind:l.Mw.MUTE,userMuteScope:y,userMuteCategories:e}),f.Vn((e=>{T.warn("Alerts could not be muted on CAPI",e)})))();const n=k.k.getAlerts(d,e);0===n.all.filter((e=>e.mute!==v.bZ.MuteStateType.Muted)).length&&T.warn("No alerts were muted on category mute",{categoryIds:e});const s=function(e,n,r){return o=>{const s=new Map(o);return e.forEach(((e,o)=>{t.isSpecial(o)?s.set(o,{id:o,scope:n,description:t.specialCategoryDescription}):(0,a.pipe)(i.lookup(0,e),h.chain((e=>e.muteCategory)),h.fold((()=>r.error("No alerts to mute",o)),(e=>s.set(o,{id:e.id,description:e.description,scope:n}))))})),s}}(n.byCategory,y,T)(O.get());return O.set(s),N.next({type:r.Type.CategoriesChanged}),g.right(void 0)},unmuteCategories:e=>{(0,a.pipe)(o.sendFeedback({kind:l.Mw.UNMUTE,userMuteScope:y,userMuteCategories:e}),f.Vn((e=>{T.warn("Alerts could not be un-muted on CAPI",e)})))();return 0===k.k.getAlerts(d,e).all.filter((e=>e.mute!==v.bZ.MuteStateType.Unmuted)).length&&T.warn("No alerts were unmuted on category unmute",{categoryIds:e}),O.modify(function(e,t){return n=>{const r=new Map(n);return e.forEach((e=>{n.has(e)?r.delete(e):t.error("Tried to unmute a category which is not muted",e)})),r}}(e,T)),N.next({type:r.Type.CategoriesChanged}),g.right(void 0)},getMutedCategories:()=>(0,a.pipe)(O.get(),n.filterWithCount((0,s.not)(t.isSpecial),d)),getMutedSpecialCategories:()=>(0,a.pipe)(O.get(),n.filter(t.isSpecial)),loadCachedMutedCategories:e=>{O.set(e)},dispose:()=>M.dispose()}},function(e){e.create=function(){return{events:T.E,mutedCategories:c.h.create(new Map),getMutedCategories:()=>new Map,getMutedSpecialCategories:()=>new Map,muteCategories:e=>g.right(void 0),unmuteCategories:e=>g.right(void 0),loadCachedMutedCategories:y.ZT,dispose:y.ZT}}}(o=e.Mock||(e.Mock={}))}(r=e.CategoriesModel||(e.CategoriesModel={}))}(r||(r={}))},85654:(e,t,n)=>{n.d(t,{k:()=>r});var r,i=n(40327),o=n(5114),s=n(40018),a=n(4390);!function(e){e.create=e=>({getAlertMuteCategory:t=>(0,i.pipe)(e.getById(t),o.chain((e=>e.muteCategory)))}),e.getAlerts=function(e,t){const n={byCategory:new Map(t.map((e=>[e,[]]))),all:[]};return(0,i.pipe)(e.get(),a.p.reduce(n,((e,{alert:n})=>(0,i.pipe)(n.muteCategory,o.filter((e=>t.includes(e.id))),o.map((e=>e.id)),o.alt((()=>o.fromNullable(t.find(s.bZ.belongsToSpecialCategory(n))))),o.fold((()=>e),(t=>(e.byCategory.get(t).push(n),e.all.push(n),e)))))))}}(r||(r={}))},72720:(e,t,n)=>{n.d(t,{Q:()=>a});var r=n(57050),i=n(37492),o=n(51072),s=n(81531);class a{constructor(e){this._capiSDUIClient=e,this._log=s.Monitoring.Logging.getLogger("SDUIFeedbackServiceImpl")}sendUserAction(e,t){(0,r.pipe)(this._capiSDUIClient.sendUserAction(e,t),o.toPromise,(e=>e.catch((e=>{i.EP.isDroppedError(e)?this._log.debug("Stopped listening for sendUserAction message acknowledge",e):i.YG.isNotConnectedError(e)?this._log.warn("Failed to sendUserAction as CAPI was not connected",e):this._log.error("Failed to sendUserAction",e)}))))}}},21729:(e,t,n)=>{n.d(t,{dM:()=>r,j:()=>i});var r,i,o,s,a=n(73975),c=n(22690),l=n(40327),u=n(38983),d=n(73353),p=n(48837),h=n(5114),m=n(83078);!function(e){e.group=p.getStructGroup({critical:p.groupSum,advanced:p.groupSum,free:p.groupSum,paid:p.groupSum,criticalPriority:p.groupSum,advancedPriority:p.groupSum,freePriority:p.groupSum,paidPriority:p.groupSum,unread:p.groupSum,muted:p.groupSum}),e.eq=a.getStructEq({critical:a.eqNumber,advanced:a.eqNumber,free:a.eqNumber,paid:a.eqNumber,unread:a.eqNumber,criticalPriority:a.eqNumber,advancedPriority:a.eqNumber,freePriority:a.eqNumber,paidPriority:a.eqNumber,muted:a.eqNumber}),e.show=c.aM({critical:c.yt,advanced:c.yt,free:c.yt,paid:c.yt,criticalPriority:c.yt,advancedPriority:c.yt,freePriority:c.yt,paidPriority:c.yt,unread:c.yt,muted:c.yt}),e.isValid=function(e){return e.critical>=0&&e.advanced>=0&&e.unread>=0},e.isEmpty=function(t){return e.eq.equals(t,e.group.empty)}}(r||(r={})),function(e){e.MIN_GOALS=3,e.TOTAL_GOALS=e.MIN_GOALS+2,e.calculateCompleteness=function(t){const n=(0,l.pipe)(t.goals,h.exists((e=>e.size>0))),r=(0,l.pipe)(t.emotions,h.exists((e=>e.size>0)));return d.R$.equals(t,d.R$.unset)||(0,l.pipe)(t.domain,m.forAll((e=>"general"===e)))&&!(h.isSome(t.audience)||h.isSome(t.style)||n||r)?0:Number(n||0)+Number(r||0)+e.MIN_GOALS}}(i||(i={})),function(e){e.zero={full:0,trimmed:0}}(o||(o={})),function(e){let t;!function(e){e[e.Document=0]="Document",e[e.Plagiarism=1]="Plagiarism"}(t=e.CheckingKind||(e.CheckingKind={})),e.Mock={getCheckingForState:()=>u.h.create({kind:e.CheckingKind.Document,type:"idle"})}}(s||(s={}))},54286:(e,t,n)=>{n.d(t,{_:()=>i});var r,i,o=n(38983),s=n(73353),a=n(5114),c=n(20817);!function(e){e.unwrap=function(e){return c.Ri.create(a.getOrElse((()=>e)),a.some)}}(r||(r={})),function(e){e.create=function(e,t,n,i){const c=r.unwrap(t.style),l=r.unwrap(t.audience),u=r.unwrap(t.domain),d=o.h.create(e),p=d.lens("style").lens(c),h=d.lens("domain").lens(u),m={audience:{items:s.R$.audiences,current:d.lens("audience").lens(l),default:a.some(t.audience)},formality:{items:s.R$.formalityLevels,current:p,default:a.some(t.style),shouldDisable:e=>h.view((t=>!!t&&!s.R$.isStyleValidWithDomain(t,e)))},domain:{items:s.R$.domains,current:h,default:a.some(t.domain),shouldDisable:e=>p.view((t=>n.isFree?"general"!==e:!s.R$.isStyleValidWithDomain(e,t)))},intent:{items:s.R$.goals.filter((e=>"sell"!==e)),current:d.lens("goals")},tone:{items:s.R$.tone,current:d.lens("emotions")}};return{localContext:d,blocks:m,showSetGoalsLoader:o.h.create(!n.demoMode&&i)}}}(i||(i={}))},68579:(e,t,n)=>{n.d(t,{A:()=>r});var r,i=n(27378),o=n(5739),s=n(12187),a=n(8125),c=n(5114),l=n(32821),u=n(63969),d=n(34442),p=n(95983),h=n(77176);!function(e){let t;function n(e){return l.UI.List.make(p.aW.getFoldableWithIndex(),r(e))}function r(t){return l.UI.Knot.make(e.IdProvider,{cell:l.UI.Knot.make(d.H.Cell,{item:l.UI.Composite.make(e.CardStyleProvider,t)})})}!function(e){e.onMount="onMount"}(t=e.ActionsKind||(e.ActionsKind={})),e.cardListContent=n,e.cardList=function(t){return l.UI.Knot.make(e.ScrollableBox,{content:n(t)})},e.ScrollableBox=l.UI.Grid.make((({notify:e,view:n,slots:r})=>i.createElement(o.F.div,Object.assign({},(0,s.Sh)(n("disableUserActions").pipe(h.U((0,a.RN)(f.disableUserActions,void 0))),f.scrollContent),{"data-purpose":"scrollable-box",style:{height:n("height")},mount:n=>e({kind:t.onMount,element:c.fromNullable(n)})()}),r.content))),e.cell=r,e.CardStyleProvider=l.UI.Grid.make((({slots:e})=>i.createElement("div",{className:f.cardWrapper},e.children))),e.IdProvider=l.UI.Grid.make((({slots:e,state:t})=>i.createElement(o.F.div,{"data-id":t},e.cell)))}(r||(r={}));const m={margin:`${u.u.rem(.5)} 0`,background:"none",userSelect:"none",$nest:{"&:before":{position:"absolute",left:u.u.rem(-.5),width:u.u.rem(.5),height:u.u.percent(100),background:"none",content:"''"}}},f=u.u.stylesheet({scrollContent:[{position:"relative",boxSizing:"content-box"}],disableUserActions:[{pointerEvents:"none"}],cardWrapper:[m]})},29913:(e,t,n)=>{n.d(t,{X:()=>r});var r,i=n(27378),o=n(32821),s=n(15646),a=n(75316),c=n(91338),l=n(85255),u=n(2834);!function(e){const t=({card:e,actions:t})=>(l.P.useSubscriptionTo(e.pipe(u.b((e=>{a.C.willBeDisposed(e,e.removedAlertsIds)&&requestAnimationFrame((()=>t.next({type:s.eI.Kind.completeTransitionTo,id:e.id,transitionId:e.visualState.transitionId})))})))),i.createElement(c.A.Full,{card:e,actions:t}));e.View=e=>o.UI.Node.make((({view:n})=>{const r=n("view");return i.createElement(t,{card:r,actions:e})}))}(r||(r={}))},92569:(e,t,n)=>{n.d(t,{A:()=>r});var r,i=n(27378),o=n(5739),s=n(8125),a=n(32821),c=n(44060),l=n(63969),u=n(66896),d=n(87380),p=n(21474),h=n(77176),m=n(57091),f=n(85985);!function(e){e.DefaultCounter=a.UI.Node.make((({state:e})=>i.createElement(o.F.Fragment,null,e.pipe(h.U((({count:e,fontSize:t,lensId:n})=>i.createElement(d.x.OutcomeCounter,{count:e,theme:{counterWrapper:w.get(n),counterContent:S.counterContent},type:"gray",fontSize:t}))))))),e.ZeroCounter=a.UI.Node.make((()=>i.createElement(p.JO.CheckmarkOutcomes,{className:S.zeroCounter}))),e.PlagiarismCounter=a.UI.Node.make((({state:e})=>i.createElement(o.F.Fragment,null,e.pipe(h.U((({count:e,fontSize:t})=>i.createElement(d.x.OutcomeCounter,{count:e,theme:{counterWrapper:S.plagiarismCounterWrapper,counterContent:S.plagiarismCounterContent},suffix:"%",type:"gray",fontSize:t}))))))),e.Component=a.UI.Union.make("kind",{plagiarism:e.PlagiarismCounter,default:e.DefaultCounter,zero:e.ZeroCounter});const t=e=>!u.R.isPlagiarismId(e);e.createLensCounterFlow=(e,n,r)=>a.Z.composeUnion({plagiarism:a.Z.fromSideEffect(s.ZT,n.pipe(h.U((e=>({count:e,fontSize:r}))))),default:a.Z.fromSideEffect(s.ZT,n.pipe(m.a(e.pipe(f.h(t))),h.U((([e,t])=>({count:e,lensId:t,fontSize:r}))))),zero:a.Z.fromSideEffect(s.ZT,null)},(()=>e.pipe(m.a(n),h.U((([e,t])=>({kind:0===t?"zero":e===u.R.SpecialId.Plagiarism?"plagiarism":"default"}))))));const n={fill:l.u.important(c.Il.CoreNeutral0)},r={fill:l.u.important(c.Il.CoreNeutral50)},g={fill:l.u.important(c.Il.CoreRed50)},y={fill:l.u.important(c.Il.CoreBlue50)},_={fill:l.u.important(c.Il.CoreGreen50)},v={fill:l.u.important(c.Il.CorePurple50)},b={fill:l.u.important(c.Il.CoreNeutral50)},E={fill:l.u.important(c.Il.CoreCyan50)},I={fill:c.Il.CoreGreen50,minHeight:0,minWidth:l.u.rem(1)},S=l.u.stylesheet({counterWrapper:[],counterContent:[n],zeroCounter:[I],allAlertsCounter:[r],priorityAlertsCounter:[r],correctnessCounter:[g],clarityCounter:[y],engagementCounter:[_],deliveryCounter:[v],voxCounter:[b],plagiarismCounterWrapper:[E],plagiarismCounterContent:[n,{}]}),w=new Map([[u.R.SpecialId.AllAlerts,S.allAlertsCounter],[u.R.SpecialId.Priority,S.priorityAlertsCounter],[u.R.SpecialId.Correctness,S.correctnessCounter],[u.R.SpecialId.Clarity,S.clarityCounter],[u.R.SpecialId.Engagement,S.engagementCounter],[u.R.SpecialId.Delivery,S.deliveryCounter],[u.R.SpecialId.Vox,S.voxCounter],[u.R.SpecialId.CorrectnessPriority,S.correctnessCounter],[u.R.SpecialId.ClarityPriority,S.clarityCounter],[u.R.SpecialId.EngagementPriority,S.engagementCounter],[u.R.SpecialId.DeliveryPriority,S.deliveryCounter],[u.R.SpecialId.VoxPriority,S.voxCounter]])}(r||(r={}))},40743:(e,t,n)=>{n.d(t,{C:()=>g});var r=n(27378),i=n(40327),o=n(5739),s=n(5114),a=n(32821),c=n(44060),l=n(63969),u=n(40219),d=n(66896),p=n(7046),h=n(24811),m=n(3656),f=n(77176);const g=a.UI.Node.make((({state:e,notify:t})=>r.createElement(o.F.Fragment,null,e.pipe(f.U((({previews:e,disabled:n,activeLensId:a})=>r.createElement(o.F.div,{className:T.lensNavigation},e.map((e=>r.createElement(p.zx.Flat,{name:e.id,key:e.id,className:T.lensButton,active:(0,i.pipe)(a,s.exists((t=>t===e.id))),disabled:n,title:e.description,titleAlign:"bottomCenter",onClick:t({kind:"lensClicked",lens:e})},r.createElement(h.B,{value:e.progress,wrapperClass:T.progressBarWrapper,progressClass:y(e.id)}),r.createElement(m.XY,{className:T.lensButtonText},e.title)))))))))));function y(e){switch(e){case d.R.SpecialId.Correctness:return T.correctnessProgressBar;case d.R.SpecialId.Clarity:return T.clarityProgressBar;case d.R.SpecialId.Engagement:return T.engagementProgressBar;case d.R.SpecialId.Delivery:return T.deliveryProgressBar;case d.R.SpecialId.Vox:return T.voxProgressBar;default:return}}const _={display:"flex",height:l.u.percent(100),justifyContent:"space-between",alignItems:"center"},v={display:"flex",flexDirection:"column",marginRight:l.u.rem(.3125),padding:`${l.u.rem(.375)} ${l.u.rem(.25)} 0`,borderRadius:l.u.rem(u.fx),$nest:{"&:last-child":{marginRight:0},"&:hover:not([data-disabled='true'])":{backgroundColor:c.Il.CoreNeutral10},"&[data-active='true']":{backgroundColor:c.Il.CoreNeutral10,color:c.Il.CoreNeutral90}}},b={textTransform:"uppercase",fontSize:l.u.px(8)},E={width:l.u.rem(2),backgroundColor:c.Il.CoreNeutral20},I={backgroundColor:c.Il.CoreRed50},S={backgroundColor:c.Il.CoreBlue50},w={backgroundColor:c.Il.CoreGreen50},A={backgroundColor:c.Il.CorePurple50},C={backgroundColor:c.Il.CoreNeutral50},T=l.u.stylesheet({lensNavigation:[_],lensButton:[v],lensButtonText:[b],progressBarWrapper:[E],correctnessProgressBar:[I],clarityProgressBar:[S],engagementProgressBar:[w],deliveryProgressBar:[A],voxProgressBar:[C]})},52249:(e,t,n)=>{if(n.d(t,{A:()=>d}),3075==n.j)var r=n(22232);var i=n(32821);if(3075==n.j)var o=n(66896);if(3075==n.j)var s=n(40018);if(3075==n.j)var a=n(85985);if(3075==n.j)var c=n(77176);if(3075==n.j)var l=n(28043);if(3075==n.j)var u=n(15774);function d(e,t,n,d){const p=t.pipe(a.h((e=>e!==o.R.SpecialId.Premium)),c.U((e=>e===o.R.SpecialId.Priority?u.H.LensMode.priority:u.H.LensMode.all)),l.x());return i.Z.fromSideEffect((t=>{switch(t.kind){case u.H.Action.Kind.select:e.events.next({type:"switchToLens",id:t.selected===u.H.LensMode.priority?o.R.SpecialId.Priority:o.R.SpecialId.AllAlerts,focusFirst:!1,actionSource:s.l$.sidebar});break;default:(0,r.vE)(t.kind)}}),p.pipe(c.U((e=>({ord:"priority"===n?u.H.Order.priorityFirst:u.H.Order.allFirst,layoutMode:d,lensMode:e})))))}},15774:(e,t,n)=>{n.d(t,{H:()=>T});var r=n(27378),i=n(5739),o=n(12187),s=n(22232),a=n(45701),c=n(32821),l=n(30763),u=n(7046),d=n(21474),p=n(16951),h=n(77176),m=n(44060),f=n(63969),g=n(40219),y=n(2040);const _=f.u.style({display:"inline-flex",overflow:"visible",border:`2px solid ${m.Il.CoreNeutral10}`,borderRadius:f.u.rem(g.fx),backgroundColor:m.Il.CoreNeutral10}),v=f.u.joinClasses([f.u.style({padding:`0 ${f.u.rem(.5)} 0 ${f.u.rem(.5)}`,display:"inline-flex",justifyContent:"space-around",textAlign:"center",$nest:{"&:first-child":{marginRight:f.u.px(2)}}}),y.base]),b=f.u.style({fontSize:f.u.rem(m.xv.SmallSize)}),E=f.u.style({width:f.u.rem(2.5)}),I=f.u.style({width:f.u.rem(9.5)}),S=f.u.joinClasses([f.u.style({width:f.u.rem(2.25)}),b]),w=f.u.joinClasses([f.u.style({width:f.u.rem(8.75)}),b]),A=f.u.joinClasses([f.u.style({borderRadius:f.u.rem(g.fx),backgroundColor:m.Il.CoreNeutral0,boxShadow:m.uc.Z100,fontWeight:600,$nest:{"&[data-disabled='true']":{backgroundColor:m.Il.CoreNeutral0}}}),v]),C=f.u.style({display:"inline-flex",width:f.u.rem(1.25),minWidth:0,minHeight:0,fill:m.Il.CoreNeutral50,stroke:m.Il.CoreNeutral50,$nest:{"&[data-disabled='true']":{fill:m.Il.CoreNeutral50,stroke:m.Il.CoreNeutral50}}});var T;!function(e){let t,n,m;!function(e){e.priority="priority",e.all="all"}(t=e.LensMode||(e.LensMode={})),function(e){let t;!function(e){e.select="select"}(t=e.Kind||(e.Kind={}))}(n=e.Action||(e.Action={})),function(t){t.priorityFirst=a.fromCompare((t=>t===e.LensMode.priority?-1:1)),t.allFirst=a.fromCompare((t=>t===e.LensMode.all?-1:1))}(m=e.Order||(e.Order={})),e.Component=c.UI.Node.make((({state:e,notify:s})=>r.createElement(i.F.div,{key:"feedModeSelector",className:_},e.pipe(h.U((({lensMode:e,layoutMode:i,ord:a})=>[t.all,t.priority].sort(a.compare).map((t=>r.createElement(u.zx,Object.assign({name:`${t}-lens`,key:`${t}-lens`,disabled:e===t,onClick:()=>s({kind:n.Kind.select,selected:t})()},(0,o.Sh)(e===t?A:v,g(t,i))),r.createElement(f,{selected:t}))))))))));const f=({selected:e})=>{const n=r.useContext(l.m.Context).feedModeSelector;switch(e){case t.all:return r.createElement(r.Fragment,null,n.all);case t.priority:return r.createElement(r.Fragment,null,n.priority,r.createElement(p.u,{align:"bottomCenter",title:n.priorityDescription},r.createElement(d.JO.Info,{width:10,className:C})));default:(0,s.vE)(e)}},g=(e,n)=>{switch(e){case t.all:return"compact"===n?S:E;case t.priority:return"compact"===n?w:I;default:(0,s.vE)(e)}}}(T||(T={}))},84317:(e,t,n)=>{n.d(t,{HP:()=>a});var r=n(32821);if(3075==n.j)var i=n(92569);if(3075==n.j)var o=n(66310);if(3075==n.j)var s=n(52249);function a(e,t,n,a,c,l){return r.Z.composeKnot({info:i.A.createLensCounterFlow(t,t.pipe(o.w((e=>c.getLens(e).view("count")))),l),switcher:(0,s.A)(e,t,n,a)})}},89186:(e,t,n)=>{n.d(t,{B:()=>v});var r=n(27378),i=n(5739),o=n(32821),s=n(92569),a=n(7046),c=n(21474),l=n(77176),u=n(15774),d=n(63969),p=n(2040);const h=d.u.style({display:"inline-flex",verticalAlign:"middle",marginRight:d.u.rem(.75),alignItems:"center"}),m=d.u.joinClasses([d.u.style({fontWeight:"bold"}),p.base]),f=d.u.style({minHeight:d.u.rem(1.5)}),g=d.u.style({$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:"transparent"}}}),y=d.u.style({display:"flex",justifyContent:"space-between",alignItems:"center"}),_=d.u.style({marginTop:d.u.rem(.35)});var v;!function(e){let t,n;e.Grid=o.UI.Grid.make((({slots:e})=>r.createElement(r.Fragment,null,r.createElement("span",{className:h},e.info),e.switcher))),e.GridWithBulkAccept=o.UI.Grid.make((({slots:e})=>r.createElement("div",{className:y},r.createElement("span",{className:_},e.headerContent),e.bulkAccept))),function(e){let t;!function(e){let t;!function(e){e.switchBack="switchBack"}(t=e.Kind||(e.Kind={}))}(t=e.Action||(e.Action={})),e.Component=o.UI.Node.make((({state:e,notify:n})=>r.createElement(i.F.Fragment,null,e.pipe(l.U((({lensTitle:e})=>r.createElement(r.Fragment,null,r.createElement("span",{className:m},e),r.createElement(a.zx.Flat,{name:"switch-back",title:"Back to all suggestions",className:g,onClick:()=>n({kind:t.Kind.switchBack})()},r.createElement(c.JO.Close,{className:f})))))))))}(t=e.LensFilter||(e.LensFilter={})),function(e){e.Component=o.UI.Grid.make((({slots:e})=>r.createElement(r.Fragment,null,r.createElement("span",{className:h},e.counter),e.filter)))}(n||(n={})),e.DefaultHeader=o.UI.Knot.make(e.Grid,{info:s.A.Component,switcher:u.H.Component}),e.LensInfoComponent=o.UI.Knot.make(n.Component,{counter:s.A.Component,filter:t.Component}),e.WithFilterHeader=o.UI.Knot.make(e.Grid,{info:e.LensInfoComponent,switcher:u.H.Component}),e.Component=o.UI.Union.make("kind",{withFilter:e.WithFilterHeader,withoutFilter:e.DefaultHeader})}(v||(v={}))},92644:(e,t,n)=>{if(n.d(t,{i:()=>h}),3075==n.j)var r=n(22232);var i=n(32821);if(3075==n.j)var o=n(66896);if(3075==n.j)var s=n(40018);if(3075==n.j)var a=n(24713);if(3075==n.j)var c=n(28043);if(3075==n.j)var l=n(85985);if(3075==n.j)var u=n(77176);if(3075==n.j)var d=n(57091);if(3075==n.j)var p=n(87667);function h(e,t,n){const h=e.getLens(o.R.SpecialId.AllAlerts).pipe(a.j("count"),c.x()),m=e.getLens(o.R.SpecialId.Priority).pipe(a.j("count"),c.x()),f=n.pipe(l.h((e=>e!==o.R.SpecialId.Premium)),u.U((e=>e===o.R.SpecialId.Priority?"priority":"all")),c.x());return i.Z.fromSideEffect((e=>{switch(e){case p.n.Actions.switchToAll:t.events.next({type:"switchToLens",id:o.R.SpecialId.AllAlerts,focusFirst:!1,actionSource:s.l$.sidebar});break;case p.n.Actions.switchToPriority:t.events.next({type:"switchToLens",id:o.R.SpecialId.Priority,focusFirst:!1,actionSource:s.l$.sidebar});break;case p.n.Actions.openSetGoals:t.events.next({type:"setGoals"});break;default:(0,r.vE)(e)}}),f.pipe(d.a(h,m,((e,t,n)=>({allAlertsCount:t,priorityAlertsCount:n,selectedLens:e})))))}},87667:(e,t,n)=>{n.d(t,{n:()=>r});var r,i=n(27378),o=n(38983),s=n(5739),a=n(32821),c=n(44060),l=n(63969),u=n(40219),d=n(30763),p=n(7046),h=n(95286),m=n(21474),f=n(2844),g=n(77176);!function(e){let t;!function(e){e.switchToPriority="switchToPriority",e.switchToAll="switchToAll",e.openSetGoals="openSetGoals"}(t=e.Actions||(e.Actions={}));e.Switch=a.UI.Node.make((({state:e,notify:n})=>{const r=i.useContext(d.m.Context).priorityLens,a=o.h.create(!1);return i.createElement(h.L,{name:"priorityLensSwitch",appearanceBehavior:"mouseClick",showDelay:0,closeDelay:100,vAlign:"bottom",theme:{dropdownContainer:O.dropdownContainer,dropdownList:O.dropdownContent},onVisibilityChange:e=>a.set(e),label:i.createElement(s.F.Fragment,null,f.aj([e,a]).pipe(g.U((([{selectedLens:e,priorityAlertsCount:t,allAlertsCount:n},o])=>{const s="priority"===e,a=s?t:n;return i.createElement("div",{className:o?O.labelOpened:O.labelClosed},s?r.prioritySuggestion:r.allSuggestion,a>0&&i.createElement("span",{className:O.alertCount}," ","· ",a," "),i.createElement(m.JO.Arrow,{direction:o?m.n4.up:m.n4.down,className:O.labelArrow}))}))))},i.createElement(s.F.Fragment,null,e.pipe(g.U((({selectedLens:e,priorityAlertsCount:o,allAlertsCount:s})=>{const a="priority"===e;return i.createElement(i.Fragment,null,i.createElement(p.zx.Flat,{name:"priorityAlerts",className:a?O.boldLensButton:O.lensButton,onClick:n(t.switchToPriority)},i.createElement(m.JO.Star,{width:12}),r.prioritySuggestion,a?i.createElement(m.JO.Yes,{className:O.checkMarkIcon}):null),a&&o===s?i.createElement("div",{className:O.disabledLensButton},i.createElement(m.JO.Formatting.BulletList,{width:21}),r.disabledAllSuggestion):i.createElement(p.zx.Flat,{name:"allAlerts",className:a?O.lensButton:O.boldLensButton,onClick:n(t.switchToAll)},i.createElement(m.JO.Formatting.BulletList,{width:21}),r.allSuggestion,a?null:i.createElement(m.JO.Yes,{className:O.checkMarkIcon})),i.createElement("div",{className:O.separator}),i.createElement("div",{className:O.description},i.createElement(m.JO.Info,{className:O.descriptionIcon}),i.createElement("div",null,r.description)))})))))}))}(r||(r={}));const y={display:"flex",width:l.u.rem(16)},_={zIndex:u.FY,marginTop:0,fontSize:l.u.rem(.875),lineHeight:l.u.rem(1.3125)},v={display:"flex",boxSizing:"border-box",padding:`${l.u.rem(.1875)} ${l.u.rem(.25)} ${l.u.rem(.1875)} ${l.u.rem(.25)}`,height:l.u.rem(1.5),borderRadius:l.u.rem(u.fx),color:c.Il.CoreNeutral90,textTransform:"uppercase",letterSpacing:l.u.rem(.025),fontSize:l.u.rem(.625),lineHeight:l.u.rem(1.125),cursor:"pointer",userSelect:"none",$nest:{"&:hover":{backgroundColor:c.Il.CoreNeutral20}}},b={backgroundColor:c.Il.CoreNeutral10},E={color:c.Il.CoreNeutral50,whiteSpace:"pre"},I={minWidth:l.u.rem(1),minHeight:l.u.rem(1),marginLeft:l.u.rem(.5625)},S={padding:`0 ${l.u.rem(.5)}`,color:c.Il.CoreNeutral90,$nest:{"& i:first-child":{margin:0}}},w={display:"flex",padding:`0 ${l.u.rem(.5)}`,height:l.u.rem(2),color:c.Il.CoreNeutral50,alignItems:"center",cursor:"not-allowed"},A={margin:`${l.u.rem(.5)} ${l.u.rem(1)}`,width:`calc(100% - ${l.u.rem(2)})`,height:l.u.px(1),backgroundColor:c.Il.CoreNeutral20},C={display:"flex",padding:`0 ${l.u.rem(.5)} ${l.u.rem(.5)} ${l.u.rem(.5)}`,fontSize:l.u.rem(.75),lineHeight:l.u.rem(1.125),alignItems:"center"},T={marginBottom:"auto",minHeight:l.u.rem(1.25)},k={color:c.Il.CoreBlue60,cursor:"pointer"},O=l.u.stylesheet({dropdownContainer:[y],dropdownContent:[_],labelClosed:[v],labelOpened:[v,b],alertCount:[E],labelArrow:[I],lensButton:[S],disabledLensButton:[w],boldLensButton:[S,{fontWeight:"bold"}],checkMarkIcon:[{marginLeft:"auto"}],separator:[A],description:[C],descriptionIcon:[T],descriptionLink:[k]})},22621:(e,t,n)=>{n.d(t,{R:()=>le});var r=n(27378),i=n(5739),o=n(32821),s=n(63899),a=n(40327),c=n(38983),l=n(12187),u=n(5114),d=n(71284),p=n(30763),h=n(7046),m=n(77797),f=n(29245),g=n(3656),y=n(44060),_=n(63969),v=n(24588),b=n(40219),E=n(21474);const I=({upgradeAction:e,size:t,title:n,className:i})=>{const o=r.useContext(p.m.Context).goPremium,s=n||o;return r.createElement(h.zx,Object.assign({name:"upgrade"},(0,l.Sh)(i,"big"===t?D.baseBig:"link"===t?D.link:D.baseSmall),{onClick:e}),"link"===t?r.createElement(E.JO.PaidLink,{width:14,className:D.linkIcon}):r.createElement(E.JO.Paid,{className:"big"===t?D.bigIcon:D.icon}),s)},S={background:y.Il.CoreGreen60,borderRadius:_.u.rem(b.fx),boxShadow:`0 2px 5px ${_.u.color(v.UE).fade(.35).toRGBA().toString()}`,color:y.Il.CoreNeutral0,textTransform:"uppercase",letterSpacing:_.u.rem(b.rX),fontWeight:"bold",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:_.u.color(y.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:_.u.color(y.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},w={padding:`0 ${_.u.rem(3)} 0 ${_.u.rem(2)}`,fontSize:_.u.rem(.8125),lineHeight:_.u.rem(3)},A={padding:`0 ${_.u.rem(2)} 0 ${_.u.rem(.5)}`,fontSize:_.u.rem(.6875),lineHeight:_.u.rem(2)},C={background:y.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:_.u.color(y.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:_.u.color(y.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},T={padding:`0 ${_.u.rem(3)} 0 ${_.u.rem(2)}`,fontSize:_.u.rem(.8125),lineHeight:_.u.rem(3)},k={padding:`0 ${_.u.rem(2)} 0 ${_.u.rem(.5)}`,fontSize:_.u.rem(.6875),lineHeight:_.u.rem(2)},O={fill:y.Il.CoreNeutral0,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{fill:y.Il.CoreNeutral0}}},N={marginRight:_.u.rem(.2)},M={color:y.Il.CoreGreen60,fontSize:_.u.rem(.75),transition:"transform .2s ease-out",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{transform:"scale(1.05)"},"&:not([data-disabled='true']):active":{transition:"none",transform:"scale(1)"}}},x={color:y.Il.CoreGreen60},R={fill:y.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{fill:y.Il.CoreGreen60}}},L={fill:y.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{fill:y.Il.CoreGreen60}}},D=_.u.stylesheet({base:[S],baseBig:[S,w],baseSmall:[S,A],baseUpHookRedesign:[S,C],baseBigUpHookRedesign:[w,C,T],baseSmallUpHookRedesign:[A,C,k],icon:[O],bigIcon:[O,N],link:[M],linkUpHookRedesign:[M,x],linkIconUpHookRedesign:[R],linkIcon:[L]});var P=n(85255),U=n(2834),F=n(57050);const j=.8125,B={display:"flex",flexDirection:"column",maxHeight:"90vh",width:_.u.rem(41.5),backgroundColor:y.Il.CoreNeutral0,textAlign:"left"},W={padding:`${_.u.rem(1.125)} ${_.u.rem(2)} ${_.u.rem(1)}`,paddingBottom:_.u.rem(1)},G={paddingBottom:0,backgroundColor:y.Il.CoreNeutral0,flexShrink:0,$nest:{"&:after":{position:"absolute",bottom:0,display:"block",width:`calc(100% - ${_.u.rem(4)})`,height:_.u.px(1),background:y.Il.CoreNeutral20,content:"''"}}},z={display:"block",margin:`${_.u.rem(j)} 0`,color:y.Il.CoreNeutral90,fontWeight:y.xv.SmallLightWeight,lineHeight:_.u.rem(1.5)},H={minHeight:_.u.rem(4)},q={display:"flex",$nest:{"&:not(:last-child)":{marginBottom:_.u.rem(1.25),borderBottom:`1px solid ${y.Il.CoreNeutral20}`}}},Y="setGoalsToneButton",V={marginBottom:_.u.rem(-.5),maxWidth:_.u.rem(27),justifyContent:"initial",flexWrap:"wrap",$nest:{[`& > .${Y}`]:{margin:`0 0 ${_.u.rem(.5)}`,marginLeft:_.u.important(0),$nest:{"&:not(:last-child)":{marginRight:_.u.rem(.5)}}}}},$={width:_.u.rem(7),textTransform:"capitalize",lineHeight:_.u.rem(2)},Q={marginTop:_.u.rem(j)},Z={margin:`0 0 ${_.u.rem(1.5)} ${_.u.rem(7)}`},X={margin:`0 0 ${_.u.rem(1.5)} ${_.u.rem(7)}`},J={display:"flex",width:_.u.percent(100),justifyContent:"space-between"},K={color:y.Il.CoreNeutral90,fontWeight:300,fontSize:_.u.rem(.8125)},ee=_.u.stylesheet({wrapper:[B],modalBody:[W],modalHeader:[G],itemDescription:[z],modalFooter:[H],row:[q],toneButtons:[V],rowHeader:[$],extraContent:[Q],title:[Z],description:[X],image:[{position:"absolute"}],footerWrapper:[J],checkboxText:[K]}),te=({name:e,items:t,sticky:n,theme:i={},extraContent:o,children:s})=>r.createElement("div",{className:ee.row},r.createElement("div",null,r.createElement(g.H3,{className:ee.rowHeader},e),o),r.createElement("div",null,r.createElement(h.zx.Group,{sticky:n,className:i.buttonsGroup},t.map((t=>r.createElement(h.zx.White,Object.assign({className:i.button,name:`context-${e}-${t.key}`},t))))),r.createElement(g.x4,{className:ee.itemDescription},s))),ne=({items:e,current:t,shouldDisable:n,itemTitle:r=F.identity})=>({sticky:!0,items:e.map((e=>({key:e,active:t.view((t=>t===e)),onClick:()=>t.set(e),disabled:n&&n(e),children:r(e)})))}),re=({items:e,current:t},n)=>({items:e.map((e=>({key:e,active:t.view((t=>(0,a.pipe)(t,u.exists((t=>t.has(e)))))),onClick:()=>t.modify((t=>{const n=(0,a.pipe)(t,u.fold((()=>new Set),(e=>new Set(e))));return n.has(e)?n.delete(e):n.add(e),u.some(n)})),children:n(e)})))}),ie=({blocks:e,features:t,showOnLoad:n,close:i,upgrade:o,reset:a,showOnLoadChanged:c})=>{const l=r.useContext(d.a.Context);return r.createElement(s.u_,{className:ee.wrapper},r.createElement(s.u_.Header,{className:ee.modalHeader},r.createElement(se,null)),r.createElement(s.u_.Body,{name:"goalsBody",className:ee.modalBody},r.createElement(oe,{features:t,upgradeAction:o,blocks:e})),r.createElement(s.u_.Footer,{className:ee.modalFooter},r.createElement(ae,{supportsSetGoalsLoader:!t.demoMode&&l.has(d.a.Flag.supportsSetGoalsLoader),onDone:i,reset:a,showOnLoad:n,showOnLoadChanged:c})))},oe=({blocks:e,features:t,upgradeAction:n})=>{const o=r.useContext(p.m.Context).goals,{audience:s,formality:c,domain:l,tone:d,intent:h}=e;return r.createElement(r.Fragment,null,r.createElement(te,Object.assign({name:"audience"},ne(s)),s.current.view((t=>t&&o.sections.audience[t]((0,a.pipe)(e.audience.default,u.exists((e=>e===t))))))),r.createElement(te,Object.assign({name:"formality"},ne(c)),c.current.view((e=>e?o.sections.formality[e]:""))),r.createElement(te,Object.assign({name:"domain"},ne(Object.assign(Object.assign({},l),{itemTitle:e=>"mail"===e?"email":e})),{extraContent:r.createElement(i.F.div,{className:ee.extraContent},t.isFree?r.createElement(I,{size:"link",upgradeAction:n}):null)}),l.current.view((e=>t.isFree?o.sections.domain.free:e?o.sections.domain[e]:""))),r.createElement(te,Object.assign({name:"tone",theme:{buttonsGroup:ee.toneButtons,button:Y}},re(d,(e=>r.createElement(f.dy,{key:e},o.sections.tone.options[e])))),o.sections.tone.experimental),r.createElement(te,Object.assign({name:"intent"},re(h,(e=>o.sections.intent.options[e]))),o.sections.intent.experimental))},se=()=>{const e=r.useContext(p.m.Context).goals;return r.createElement(r.Fragment,null,r.createElement(ce,null),r.createElement(g.H1,{className:ee.title},e.title),r.createElement(g.XY,{className:ee.description},e.header))},ae=({supportsSetGoalsLoader:e,showOnLoad:t,showOnLoadChanged:n,reset:i,onDone:o})=>{const s=r.useContext(p.m.Context),a=c.h.create(t);return P.P.useSubscriptionTo(a.pipe(U.b(n))),r.createElement("div",Object.assign({},(0,l.Sh)(e&&ee.footerWrapper)),e&&r.createElement(m.Ys,{checked:a,name:"set-goals"},r.createElement(g.x4,{className:ee.checkboxText},s.goals.footer.showModalOnStart)),r.createElement(h.zx.Group,null,r.createElement(h.zx.Ghost,{name:"reset",onClick:i},s.goals.footer.reset),r.createElement(h.zx.Primary,{name:"closeSetContext",onClick:o},s.done)))},ce=()=>r.createElement("svg",{className:ee.image,width:"69",height:"80",viewBox:"0 0 69 80"},r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M28.935 70C12.955 70 0 57.045 0 41.065 0 25.085 12.955 12.13 28.935 12.13c15.98 0 28.936 12.954 28.936 28.935C57.87 57.045 44.917 70 28.936 70zm0-12.242c9.22 0 16.694-7.474 16.694-16.693 0-9.22-7.475-16.694-16.695-16.694s-16.693 7.475-16.693 16.695 7.474 16.693 16.693 16.693z",fill:"#4C7AF1"}),r.createElement("path",{d:"M28.935 57.758c-9.22 0-16.693-7.474-16.693-16.693 0-9.22 7.474-16.694 16.693-16.694 9.22 0 16.694 7.475 16.694 16.695s-7.475 16.693-16.695 16.693zm0-11.13a5.564 5.564 0 1 0 0-11.128 5.565 5.565 0 0 0 .001 11.129z",fill:"#BCDBFB"}),r.createElement("circle",{fill:"#FFF",cx:"28.935",cy:"41.065",r:"5.565"}),r.createElement("path",{stroke:"#4C7AF1",strokeLinecap:"round",strokeWidth:"1.5",d:"M15.024 68.016L9.46 78.5m32.274-10.484L47.298 78.5"}),r.createElement("path",{d:"M61.96 13.367a.65.65 0 0 1 .645.656.65.65 0 0 1-.646.655h-6.075L29.35 41.7a.636.636 0 0 1-.913 0 .663.663 0 0 1 0-.927L54.972 13.75V7.59a.65.65 0 0 1 .645-.656.65.65 0 0 1 .646.656v5.777h5.696zm3.17-3.215a.65.65 0 0 1 .646.655.65.65 0 0 1-.646.655h-6.34a.65.65 0 0 1-.647-.655V4.372a.65.65 0 0 1 .646-.655.65.65 0 0 1 .644.655v5.78h5.696zm3.17-3.218a.65.65 0 0 1 .647.656.65.65 0 0 1-.646.655h-6.34a.65.65 0 0 1-.647-.655V1.155A.65.65 0 0 1 61.96.5a.65.65 0 0 1 .645.655v5.78H68.3z",fill:"#4C7AF1"}),r.createElement("path",{d:"M49.267 20.486l-8.586 8.757",stroke:"#FFF",strokeWidth:"1.3"})));var le,ue=n(50628),de=n(77176);!function(e){let t;e.Modal=o.UI.Node.make((({state:e,notify:n})=>(P.P.useSubscriptionTo(e.pipe(ue.P(),U.b((e=>n({kind:t.open,source:e.source})())))),r.createElement(i.F.Fragment,null,e.pipe(de.U((e=>{const i=n({kind:t.close,source:e.source,context:e.context,showOnLoad:e.showOnLoad});return r.createElement(s.ay,{positionType:"fixed",animate:!0,smallResolution:"resize",onClose:i},r.createElement(ie,{blocks:e.blocks,features:e.features,close:i,upgrade:n({kind:t.upgrade}),reset:n({kind:t.reset}),showOnLoad:e.showOnLoad,showOnLoadChanged:e=>n({kind:t.showOnLoadChanged,value:e})()}))}))))))),function(e){e.open="open",e.close="close",e.upgrade="upgrade",e.reset="reset",e.showOnLoadChanged="showOnLoadChanged"}(t=e.ActionsKind||(e.ActionsKind={}))}(le||(le={}))},16797:(e,t,n)=>{n.d(t,{p:()=>d});var r=n(57050),i=n(5114),o=n(83078),s=n(32821),a=n(35416),c=n(25975),l=n(76974),u=n(77176);function d(e,t){return s.Z.composeKnot({content:s.Z.fromSideEffect(r.constVoid,h(e,t)),root:p()})}const p=()=>()=>l.of({});function h(e,t){const n=e.view(t.getActiveAlertsCount).view((e=>0===e)),s=e.view(c.v.Prism.getFeedItems());return e.pipe(u.U(a.In.getActiveItem),u.U((e=>{if(i.isNone(e))return{root:"empty",card:{kind:"empty"}};const a=o.unsafeGet(e),c=s.get(),l=(0,r.pipe)(c.getAt(c.size-1),i.exists((e=>e.id===a.id)));return{root:a.id,card:t.viewState(n.get(),l)(a)}})))}},43314:(e,t,n)=>{n.d(t,{c:()=>r});var r,i=n(27378),o=n(5739),s=n(5114),a=n(32821),c=n(63969);!function(e){let t;function n(t){return a.UI.Knot.make(e.IdProvider,{card:a.UI.Composite.make(e.CardStyleProvider,t)})}!function(e){e.onMount="onMount"}(t=e.ActionsKind||(e.ActionsKind={})),e.assistant=function(t){return a.UI.Knot.make(e.AssistantBox,{content:n(t)})},e.AssistantBox=a.UI.Grid.make((({notify:e,slots:n})=>i.createElement(o.F.div,{id:"assistant-feed-wrapper",mount:n=>e({kind:t.onMount,element:s.fromNullable(n)})()},n.content))),e.card=n,e.CardStyleProvider=a.UI.Grid.make((({slots:e})=>i.createElement("div",{className:u.cardWrapper},e.children))),e.IdProvider=a.UI.Grid.make((({slots:e,state:t})=>i.createElement(o.F.div,{"data-id":t},e.card)))}(r||(r={}));const l={margin:`${c.u.rem(.5)} 0`,background:"none",userSelect:"none",$nest:{"&:before":{position:"absolute",left:c.u.rem(-.5),width:c.u.rem(.5),height:c.u.percent(100),background:"none",content:"''"}}},u=c.u.stylesheet({disableUserActions:[{pointerEvents:"none"}],cardWrapper:[l]})},29317:(e,t,n)=>{n.d(t,{N:()=>r});var r,i=n(64015),o=n(57050),s=n(77176),a=n(60797),c=n(41398),l=n(85985),u=n(5114),d=n(51838),p=n(15646),h=n(35416);!function(e){let t;!function(e){let t;!function(e){e.fromCardActions=(0,o.flow)(s.U((e=>{if(p.lY.isSDUICardAction(e)){const t=(0,o.pipe)(e.actions,i.hX(d.zx.Action.isTransitionAction));return e.actions.find((e=>e.type===d.zx.ActionType.prevCard))?u.some({kind:"prevClicked",transitions:t}):e.actions.find((e=>e.type===d.zx.ActionType.nextCard))?u.some({kind:"nextClicked",transitions:t}):u.none}return u.none})),a.oA)}(t=e.Events||(e.Events={})),e.sideEffect=(e,t,n)=>({id:"SingleCardAssistant.prevNextNavigation",when:h.nL.Effect.When.isSidebarOpen,what:h.nL.Effect.ItemsApplicator.create((0,o.pipe)(e,c.M(t.pipe(l.h(h.nL.hasCards))),s.U((([e,t])=>(0,o.pipe)(t.currentLens.cardIndex,u.chain((n=>(0,o.pipe)(t.currentLens.items.getAt("nextClicked"===e.kind?n+1:n-1),u.map((t=>(0,o.tuple)(t,e))))))))),a.oA,s.U((([e,t])=>r=>h.nL.Prism.getLensWithItems().modify(n.selectItemById(e.id,t.transitions),r)))))})}(t=e.PrevNextNavigation||(e.PrevNextNavigation={}))}(r||(r={}))},39321:(e,t,n)=>{n.d(t,{q:()=>ke});var r=n(27378),i=n(5739),o=n(22232),s=n(32821),a=n(30763),c=n(25970),l=n(7046),u=n(63899);const d=()=>r.createElement("svg",{width:"128",height:"177"},r.createElement("defs",null,r.createElement("rect",{id:"a",y:"14",width:"128",height:"128",rx:"64"})),r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("ellipse",{fill:"#F1F2FA",cx:"64",cy:"173",rx:"48",ry:"4"}),r.createElement("path",{d:"M27 0h62a5 5 0 0 1 5 5v91a5 5 0 0 1-5 5H24a5 5 0 0 1-5-5V8a8 8 0 0 1 8-8z",fill:"#F1F2FA"}),r.createElement("mask",{id:"b",fill:"#fff"},r.createElement("use",{xlinkHref:"#a"})),r.createElement("use",{fill:"#A2BCFF",xlinkHref:"#a"}),r.createElement("path",{d:"M116.708 48.783a4.144 4.144 0 0 1 5.672-1.465 4.138 4.138 0 0 1 1.466 5.667l-17.955 30.462a4.141 4.141 0 0 1-3.57 2.039 4.145 4.145 0 0 1-2.879-1.164l-12.527-12.1a4.138 4.138 0 0 1-.099-5.855 4.144 4.144 0 0 1 5.858-.099l8.747 8.45 15.287-25.935zm-63.446 45.53h58.877a4.141 4.141 0 0 1 4.142 4.139 4.141 4.141 0 0 1-4.142 4.14H53.262a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zM8.793 17.33h31.735a4.141 4.141 0 0 1 4.143 4.14 4.141 4.141 0 0 1-4.143 4.14H8.793a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zm0 17.526h31.735a4.141 4.141 0 0 1 4.143 4.14 4.141 4.141 0 0 1-4.143 4.14H8.793a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zm4.99 68.985a4.74 4.74 0 0 1-4.686 4.794 4.74 4.74 0 0 1-.111-9.477 4.74 4.74 0 0 1 4.798 4.683zm16.757 16.106a4.141 4.141 0 0 1 4.142-4.14 4.141 4.141 0 0 1 4.143 4.14c0 9.416-7.665 17.076-17.087 17.076S4.65 129.363 4.65 119.947a4.141 4.141 0 0 1 4.143-4.14 4.141 4.141 0 0 1 4.143 4.14c0 4.85 3.948 8.796 8.802 8.796 4.853 0 8.802-3.946 8.802-8.796zM8.793 76.46c-1.06 0-2.12-.405-2.93-1.213a4.138 4.138 0 0 1 0-5.855l4.274-4.27-4.273-4.27a4.138 4.138 0 0 1 0-5.855 4.145 4.145 0 0 1 5.859 0l4.273 4.27 4.273-4.27a4.144 4.144 0 0 1 5.858 0 4.138 4.138 0 0 1 0 5.855l-4.273 4.27 4.274 4.27a4.138 4.138 0 0 1-2.93 7.068c-1.06 0-2.12-.405-2.929-1.213l-4.273-4.27-4.273 4.27a4.133 4.133 0 0 1-2.93 1.213zm87.342 44.285l13.678 9.075a4.138 4.138 0 0 1 1.16 5.739 4.144 4.144 0 0 1-5.743 1.159l-11.387-7.555-11.386 7.555a4.143 4.143 0 0 1-4.378.128l-12.844-7.478-11.078 7.35c-.705.468-1.5.691-2.288.691a4.14 4.14 0 0 1-2.295-7.589l13.227-8.776a4.144 4.144 0 0 1 4.377-.128l12.844 7.478 11.53-7.65a4.145 4.145 0 0 1 4.583 0zM31.23 86.814a4.141 4.141 0 0 1 4.142-4.14 4.141 4.141 0 0 1 4.143 4.14v19.402a4.141 4.141 0 0 1-4.143 4.14 4.141 4.141 0 0 1-4.142-4.14V86.814z",fill:"#BDCFFF",mask:"url(#b)"}),r.createElement("path",{d:"M36 12h65a5 5 0 0 1 5 5v88a8 8 0 0 1-8 8H36a5 5 0 0 1-5-5V17a5 5 0 0 1 5-5z",fill:"#7CA1FF",mask:"url(#b)"}),r.createElement("rect",{fill:"#FFF",x:"25",y:"6",width:"75",height:"101",rx:"5"}),r.createElement("path",{d:"M38 21h49a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H38a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1zm0 13h32a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H38a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1z",fill:"#F1F2FA"})));var p,h=n(42329),m=n(3656),f=n(77176),g=n(12187),y=n(76024);!function(e){function t(e,t){var n=t/60,r=y.secondsToTime(e/n);return r.s=r.h>0&&r.m>10?0:Math.floor(r.s),r}e.calculateReadingTime=function(e){return t(e,250)},e.calculateSpeakingTime=function(e){return t(e,130)},e.generateStats=function(t,n){var r={words:t,chars:n,sentences:Math.floor(t/5),readingTime:{},speakingTime:{},uniqueWords:40*Math.random(),uniqueWordsIndex:100*Math.random(),rareWords:20*Math.random(),rareWordsIndex:100*Math.random(),wordLength:5.4,wordLengthIndex:100*Math.random(),sentenceLength:16.7,sentenceLengthIndex:100*Math.random(),readabilityScore:73,readabilityDescription:"Your text is likely to be understood by a reader who has at least 7th grade education (age 12)"};return r.readingTime=e.calculateReadingTime(r.words),r.speakingTime=e.calculateSpeakingTime(r.words),r}}(p||(p={}));var _=n(18208),v=n(5114),b=n(44060),E=n(63969),I=n(24588),S=n(40219),w=n(21474),A=n(40327),C=n(38983),T=n(2844),k=n(66310),O=n(93508),N=n(16118),M=n(76974),x=n(13444);const R=e=>{const{score:t,documentIsEmpty:n,sidebarOpen:o=C.h.create(!0),successIcon:s,progressIcon:a,zeroIcon:c=null}=e,l=t.pipe(f.U(v.map((e=>e.rank)))),u=T.aj(t,n,((e,t)=>(0,A.pipe)(e,v.fold((()=>!1),(({rank:e})=>100===e&&!t))))),d=o.pipe(k.w((e=>e?l.pipe(O.O(v.none),N.G(),k.w((([e,t])=>(0,A.pipe)(t,v.fold((()=>M.of(c)),(t=>u.pipe(O.O(!1),N.G(),k.w((([n,r])=>r?M.of(s):(0,A.pipe)(e,v.filter((()=>!n)),v.fold((()=>M.of(a(t)).pipe(x.g(1),O.O(a(0)))),(()=>M.of(a(t)))))))))))))):M.of(null))),O.O(null));return r.createElement(i.F.Fragment,null,d)};var L=n(98403);function D({value:e,className:t,leftCustomClass:n,rightCustomClass:o}){const s=C.h.create(!1);requestAnimationFrame((()=>requestAnimationFrame((()=>s.set(!0)))));const a=T.aj(L.Dx(e),s,((e,t)=>t?`${Math.max(5,Math.abs(e-50))}%`:0)),c=(e,t,n)=>L.Dx(e).pipe(f.U((e=>e<50?t:n)));return r.createElement(i.F.div,Object.assign({},(0,g.Sh)((e=>L.Dx(e).pipe(f.U((e=>e<50?B.leftSideWrapper:B.rightSideWrapper))))(e),t)),r.createElement(i.F.div,Object.assign({},(0,g.Sh)(c(e,B.leftSideProgress,B.rightSideProgress),n&&o&&c(e,n,o)),{style:{width:a}})))}!function(e){e.Label=({value:e,className:t})=>{const n=r.useContext(a.m.Context).performance,i=e>66?n.aboveAverage:e>50?n.average:n.belowAverage;return r.createElement(m.x4,{className:t},i)}}(D||(D={}));const P={position:"relative",zIndex:1,display:"flex",width:E.u.percent(100),height:E.u.rem(.25),borderRadius:E.u.rem(S.fx)},U={height:E.u.percent(100),backgroundColor:I.FW,transition:"width .8s ease-in-out 0s"},F={marginRight:E.u.percent(50),borderTopLeftRadius:E.u.rem(.25),borderBottomLeftRadius:E.u.rem(.25)},j={marginLeft:E.u.percent(50),borderTopRightRadius:E.u.rem(.25),borderBottomRightRadius:E.u.rem(.25)},B=E.u.stylesheet({wrapper:[P],leftSideWrapper:[P,{justifyContent:"flex-end"}],rightSideWrapper:[P,{justifyContent:"flex-start"}],progress:[U],leftSideProgress:[U,F],rightSideProgress:[U,j]});var W=n(63847);const G={display:"flex",flexDirection:"column",maxHeight:"90vh",width:E.u.rem(32),height:E.u.rem(41),background:b.Il.CoreNeutral0},z={padding:`${E.u.rem(2.75)} ${E.u.rem(1)} 0 ${E.u.rem(2)}`,minHeight:E.u.rem(5.1),height:E.u.rem(5.1),backgroundColor:b.Il.CoreNeutral0},H={marginRight:E.u.rem(1),paddingBottom:E.u.rem(.3),borderBottom:`1px solid ${I.xO}`},q={padding:`0 ${E.u.rem(1)} ${E.u.rem(1)} ${E.u.rem(2)}`},Y={padding:`0 ${E.u.rem(1.9)}`,minHeight:E.u.rem(4),height:E.u.rem(4)},V={position:"absolute",top:E.u.rem(-5.15),right:0,bottom:0,left:0,margin:"auto"},$={display:"flex",flexDirection:"column",marginTop:E.u.rem(7.15),marginBottom:E.u.rem(2),paddingRight:E.u.rem(1),alignItems:"center"},Q={wordSpacing:E.u.rem(.05),fontSize:E.u.rem(.875),lineHeight:E.u.rem(1.5)},Z={padding:`${E.u.rem(1.3)} ${E.u.rem(2.6)}`,textAlign:"center"},X=E.u.prefixedStylesheet("statistics",{wrapper:[G],modalHeader:[z],modalHeaderUnderline:[H],modalReady:[{transition:"opacity .2s"}],modalEmpty:[{opacity:0}],modalBody:[q],modalFooter:[Y],loader:[V],zeroStateContainer:[$],performanceText:[Q],zeroStateText:[Q,Z]});var J;!function(e){e.number="number",e.time="time",e.percentage="percentage"}(J||(J={}));const K=e=>{switch(e){case J.number:case J.percentage:return Ce.numberRowData;case J.time:return Ce.timeRowData;default:return(0,o.vE)(e)}},ee=({type:e,value:t,info:n,children:i,dataName:s})=>r.createElement("div",{className:Ce.row,"data-name":s},r.createElement("div",{className:K(e)},r.createElement("div",{className:Ce.metricTitle},i),r.createElement("div",{className:Ce.metric},((e,t)=>{switch(e){case J.number:return(Math.round(10*t)/10).toLocaleString();case J.time:return y.convertTimeToShortString(t);case J.percentage:return Math.round(t)+"%";default:return(0,o.vE)(e)}})(e,t))),n&&r.createElement(l.RZ,{title:n})),te=({state:e})=>{const t=r.useContext(a.m.Context).performance,{stats:n,score:o,documentIsEmpty:s}=e;return r.createElement(r.Fragment,null,r.createElement("section",{className:Ce.titleSection},r.createElement("div",{className:Ce.titleColumns},r.createElement(i.F.div,Object.assign({},(0,g.Sh)(X.performanceText,Ce.headerDescription)),100===o.rank?t.score100:t.scoreUnder100(o.rank)),r.createElement(R,{score:M.of(v.some(o)),documentIsEmpty:M.of(s),successIcon:r.createElement(w.JO.CheckmarkAnimated,{key:"modal-checkmark",width:50,className:Ce.checkmark}),progressIcon:e=>r.createElement(W.P,{key:"modal-performance-progress",colorType:W.P.ColorType.royalBlue,fontSize:W.P.FontSize.small,percentage:e,theme:Te})}))),r.createElement("section",{className:Ce.wordCountSection},r.createElement(m.H2,{className:Ce.sectionHeaderUnderline},t.wordCount),r.createElement("div",{className:Ce.wordCountColumns},r.createElement("div",{className:Ce.firstColumn},r.createElement(ee,{type:J.number,value:Math.max(n.chars-1,0)},t.characters),r.createElement(ee,{type:J.number,value:n.words},t.words),r.createElement(ee,{type:J.number,value:n.sentences},_.pluralize(n.sentences,t.sentence,t.sentences))),r.createElement("div",{className:Ce.secondColumn},r.createElement(ee,{type:J.time,value:p.calculateReadingTime(n.words)},t.readingTime),r.createElement(ee,{type:J.time,value:p.calculateSpeakingTime(n.words)},t.speakingTime)))),r.createElement("section",{className:Ce.readabilitySection},r.createElement("div",{className:Ce.sectionHeaderWrapper},r.createElement(m.H2,null,t.readability),r.createElement(m.CL,null,t.sectionTitleDescription)),r.createElement("div",{className:Ce.readabilityColumns},r.createElement("div",{className:Ce.firstColumn},r.createElement(ee,{type:J.number,value:n.wordLength},t.wordLengthTitle),r.createElement(ee,{type:J.number,value:n.sentenceLength},t.sentenceLengthTitle),r.createElement(ee,{type:J.number,value:n.readabilityScore,info:t.readabilityDescription,dataName:"readability"},t.readabilityScore)),r.createElement("div",{className:Ce.secondColumn},r.createElement("div",{className:Ce.row},r.createElement(D,{value:n.wordLengthIndex,className:Ce.progressBar,leftCustomClass:Ce.leftProgress,rightCustomClass:Ce.rightProgress}),r.createElement(D.Label,{value:n.wordLengthIndex,className:Ce.progressLabel})),r.createElement("div",{className:Ce.row},r.createElement(D,{value:n.sentenceLengthIndex,className:Ce.progressBar,leftCustomClass:Ce.leftProgress,rightCustomClass:Ce.rightProgress}),r.createElement(D.Label,{value:n.sentenceLengthIndex,className:Ce.progressLabel})),r.createElement("div",{className:Ce.verticalPillar}))),r.createElement(m.CL,{className:Ce.readabilityDescr},n.readabilityDescription)),r.createElement("section",null,r.createElement("div",{className:Ce.sectionHeaderWrapper},r.createElement(m.H2,null,t.vocabulary),r.createElement(m.CL,null,t.sectionTitleDescription)),r.createElement("div",{className:Ce.vocabularyColumns},r.createElement("div",{className:Ce.firstColumn},r.createElement(ee,{type:J.percentage,value:n.uniqueWords,info:t.uniqueWords},t.uniqueWordsTitle),r.createElement(ee,{type:J.percentage,value:n.rareWords,info:t.rareWords},t.rareWordsTitle)),r.createElement("div",{className:Ce.secondColumn},r.createElement("div",{className:Ce.row},r.createElement(D,{value:n.uniqueWords,className:Ce.progressBar,leftCustomClass:Ce.leftProgress,rightCustomClass:Ce.rightProgress}),r.createElement(D.Label,{value:n.uniqueWords,className:Ce.progressLabel})),r.createElement("div",{className:Ce.row},r.createElement(D,{value:n.rareWords,className:Ce.progressBar,leftCustomClass:Ce.leftProgress,rightCustomClass:Ce.rightProgress}),r.createElement(D.Label,{value:n.rareWords,className:Ce.progressLabel})),r.createElement("div",{className:Ce.verticalPillar})))))},ne={marginBottom:E.u.rem(2.4)},re={display:"flex",marginTop:E.u.rem(.9),marginRight:E.u.rem(1),justifyContent:"space-between"},ie={marginBottom:E.u.rem(1.5)},oe={display:"flex",marginTop:E.u.rem(.8)},se={marginBottom:E.u.rem(2.4)},ae={display:"flex",marginTop:E.u.rem(.8)},ce={display:"flex",marginTop:E.u.rem(.8)},le={flexBasis:E.u.percent(50)},ue={position:"relative",paddingLeft:E.u.rem(.5),flexBasis:E.u.percent(50)},de={display:"flex",height:E.u.rem(2),alignItems:"center"},pe={display:"flex",justifyContent:"space-between"},he={width:E.u.rem(10),fontFeatureSettings:`${S.Q9}, ${S.g_}`},me={width:E.u.rem(13)},fe={marginRight:E.u.rem(1),paddingBottom:E.u.rem(.5),borderBottom:`1px solid ${I.xO}`},ge={width:E.u.percent(80),whiteSpace:"pre-line"},ye={display:"inline-block",color:b.Il.CoreBlue50,textAlign:"right",fontWeight:"bold",fontSize:E.u.rem(.875),lineHeight:E.u.rem(2)},_e={display:"inline-block",color:b.Il.CoreNeutral90,fontSize:E.u.rem(.875),lineHeight:E.u.rem(2)},ve={width:E.u.rem(3.2),height:E.u.rem(3.2),fontWeight:"bold"},be={width:E.u.rem(6),backgroundColor:I.xO},Ee={marginLeft:E.u.rem(1.125)},Ie={backgroundImage:I.BZ},Se={backgroundImage:I.Xd},we={display:"block",paddingTop:E.u.rem(.5)},Ae={position:"absolute",top:E.u.rem(.5),left:E.u.rem(3.5),width:E.u.rem(.0625),height:E.u.rem(3),backgroundColor:I.jj},Ce=E.u.stylesheet({titleSection:[ne],titleColumns:[re],wordCountSection:[ie],wordCountColumns:[oe],readabilitySection:[se],readabilityColumns:[ae],vocabularyColumns:[ce],firstColumn:[le],secondColumn:[ue],row:[de],rowData:[pe],numberRowData:[pe,he],timeRowData:[pe,me],sectionHeaderUnderline:[fe],sectionHeaderWrapper:[fe,{display:"flex",alignItems:"baseline",justifyContent:"space-between"}],headerDescription:[ge],metric:[ye],metricTitle:[_e],checkmark:[{alignItems:"center"}],circleProgressBar:[ve],progressBar:[be],progressLabel:[Ee],leftProgress:[Ie],rightProgress:[Se],readabilityDescr:[we],verticalPillar:[Ae]}),Te={radialProgressBar:Ce.circleProgressBar};var ke;!function(e){let t;e.ModalView=s.UI.Grid.make((({slots:n,state:i,notify:o})=>{const s=o({kind:t.close});return r.createElement(u.ay,{positionType:"fixed",animate:!0,smallResolution:"resize",onClose:s},r.createElement(e.ModalContent,{state:i,downloadButton:n.downloadButton,onClose:s}))})),function(e){e.close="close"}(t=e.ActionsKind||(e.ActionsKind={})),e.ModalContent=({state:t,downloadButton:n,onClose:i})=>r.createElement(u.u_,{className:X.wrapper},r.createElement(u.u_.Header,{className:X.modalHeader},r.createElement(e.Header,{state:t})),r.createElement(u.u_.Body,{name:"performanceBody",className:X.modalBody,wrapperClassName:t.pipe(f.U((e=>e.type===c.g.State.Type.EMPTY?X.modalEmpty:X.modalReady)))},r.createElement(e.Body,{state:t})),r.createElement(u.u_.Footer,{className:X.modalFooter},r.createElement(g,{downloadButton:n,onClose:i})));const n=()=>{const e=r.useContext(a.m.Context);return r.createElement("div",{className:X.zeroStateContainer},r.createElement(d,null),r.createElement("div",{className:X.zeroStateText},e.performance.notEnoughTextToCalculateStats))};e.Header=({state:e})=>{const t=r.useContext(a.m.Context);return r.createElement(i.F.Fragment,null,e.pipe(f.U((e=>r.createElement(m.H2,{key:"statisticsHeader",className:e.type===c.g.State.Type.READY?X.modalHeaderUnderline:""},t.performance.title)))))};const p=()=>r.createElement(h.$,{size:64,className:X.loader,variation:"blue"});e.Body=({state:e})=>r.createElement(i.F.Fragment,null,e.pipe(f.U((e=>{switch(e.type){case c.g.State.Type.EMPTY:return null;case c.g.State.Type.LOADING:case c.g.State.Type.ERROR:return r.createElement(p,{key:"statisticsLoading"});case c.g.State.Type.SHORT_CONTENT:return r.createElement(n,{key:"statisticsEmpty"});case c.g.State.Type.READY:return r.createElement(te,{key:"statisticsContent",state:e});default:return(0,o.vE)(e)}}))));const g=({downloadButton:e,onClose:t})=>r.createElement(r.Fragment,null,e,r.createElement(l.zx.Primary,{name:"close-stats",onClick:t},"Close"))}(ke||(ke={}))},89379:(e,t,n)=>{n.d(t,{wK:()=>m,JT:()=>f,hM:()=>g});var r=n(40327),i=n(5114),o=n(8125),s=n(22232),a=n(93756),c=n(32821),l=n(27125),u=n(77176);function d(e){return{title:e.title,firstLine:i.fromNullable(e.firstLine)}}const p=(e,t)=>{const n=t.successLens;switch(e){case l.g.SuccessType.zero:return n.emptyText;case l.g.SuccessType.small:return n.smallText;case l.g.SuccessType.large:return n.largeText;case l.g.SuccessType.applied:return{title:n.fixedText.titles[(0,o.TN)(9)]};case l.g.SuccessType.premiumOnboardingStart:return n.premiumOnboardingStartText;case l.g.SuccessType.premiumOnboardingComplete:return n.premiumOnboardingCompleteText;default:return(0,s.vE)(e)}};function h(e){switch(e){case l.g.SuccessType.applied:case l.g.SuccessType.large:return"growComplete";case l.g.SuccessType.premiumOnboardingStart:return"premiumOnboardingStart";case l.g.SuccessType.premiumOnboardingComplete:return"premiumOnboardingComplete";default:return"growStart"}}function m(e,t){return()=>e.pipe(u.U((e=>{const n=p(e,t);return{kind:h(e),caption:i.some(d(n))}})))}function f(e,t){return()=>e.pipe(u.U((e=>{const n=p(e,t);return{kind:h(e),caption:i.some(d(n))}})))}function g(e){return c.Z.animatingFlow(e,(e=>(0,r.pipe)(e,i.fold((()=>i.some(a.F2("fadein"))),(()=>i.some(a.Hk("fadeout","fadein")))))))}},28378:(e,t,n)=>{n.d(t,{q:()=>P});var r=n(27378),i=n(40327),o=n(5739),s=n(83078),a=n(32821),c=n(44060),l=n(63969),u=n(3656),d=n(77176),p=n(34685);const h=a.UI.Node.make((()=>r.createElement("svg",{width:"112",height:"126",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("g",{clipPath:"url(#clip0)"},r.createElement("rect",{x:"27.482",y:"24.867",width:"57.037",height:"76.267",rx:"28.518",fill:"#D7F7F0"}),r.createElement("path",{d:"M62.399 71.25l11.766-6.85c1.994-1.14 4.587-.83 6.182.831L60.504 77.164",fill:"#D1CEF4"}),r.createElement("path",{d:"M62.399 71.25l11.766-6.85c1.994-1.14 4.587-.83 6.182.831L60.504 77.164",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M63.994 66.787l9.074-10.48c1.795-2.075 4.787-2.801 7.28-1.66L64.194 74.674",fill:"#D1CEF4"}),r.createElement("path",{d:"M63.994 66.787l9.074-10.48c1.795-2.075 4.787-2.801 7.28-1.66L64.194 74.674",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M62.897 59.213l2.393-5.396-.199-2.075c-.399-3.32 1.396-6.434 4.288-7.679l.997 10.377-5.883 20.234S47.442 87.229 46.743 89.2c-.598 1.66.2 11.311.698 15.046.4 3.217-20.64 4.047-19.943 1.246 1.297-4.462 4.587-15.046 5.186-17.537.997-3.528-.599-12.348 2.991-18.677 1.596-2.802 5.983-9.858 7.18-13.075 1.396-3.424 1.595-7.678 1.595-7.678 5.385 1.349 3.69 9.961 1.595 14.942-2.193 5.292 6.382 4.67 8.676.726 1.695-3.009 2.891-5.292 2.891-5.292l-.398-5.5-.4-.31c-2.492-2.283-3.29-6.019-1.794-9.235l6.382 7.263 1.495 8.094-1.495 11.206 1.495-11.206z",fill:"#D1CEF4"}),r.createElement("path",{d:"M62.897 59.213l2.393-5.396-.199-2.075c-.399-3.32 1.396-6.434 4.288-7.679l.997 10.377-5.883 20.234S47.442 87.229 46.743 89.2c-.598 1.66.2 11.311.698 15.046.4 3.217-20.64 4.047-19.943 1.246 1.297-4.462 4.587-15.046 5.186-17.537.997-3.528-.599-12.348 2.991-18.677 1.596-2.802 5.983-9.858 7.18-13.075 1.396-3.424 1.595-7.678 1.595-7.678 5.385 1.349 3.69 9.961 1.595 14.942-2.193 5.292 6.382 4.67 8.676.726 1.695-3.009 2.891-5.292 2.891-5.292l-.398-5.5-.4-.31c-2.492-2.283-3.29-6.019-1.794-9.235l6.382 7.263 1.495 8.094zm0 0l-1.495 11.206",stroke:"#0E101A",strokeMiterlimit:"10"})),r.createElement("path",{d:"M54.822 50.297c0 1.948-1.496 3.59-3.49 3.59-1.995 0-3.49-1.54-3.49-3.59 0-2.052 1.495-5.231 3.49-5.231 1.994 0 3.49 3.282 3.49 5.23z",fill:"#F6DF6C",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M58.411 32.86s-2.194-4.307 1.596-7.897c3.09-2.974 8.276-4.41 10.07-4.923.3-.102.6.205.6.513-.1 1.436-.5 5.026-1.995 7.795-1.695 3.18-6.183 6.359-10.27 4.513zM54.123 37.066s3.49-8.41-9.273-13.334c-.3-.102-.698.206-.599.513.2 1.026.5 3.077.699 5.026.398 4.82 1.396 10.462 9.173 7.795z",fill:"#15C39A",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M51.431 45.066c.598-4.41 2.393-9.334 7.28-12.513",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("defs",null,r.createElement("clipPath",{id:"clip0"},r.createElement("rect",{x:"27.482",y:"24.867",width:"57.037",height:"76.267",rx:"28.518",fill:"#fff"})))))),m=a.UI.Node.make((()=>r.createElement("svg",{width:"112",height:"126",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("rect",{x:"28",y:"26.25",width:"56",height:"73.5",rx:"28",fill:"#DBEBFF"}),r.createElement("path",{d:"M78.5 103.284S73.702 64.99 25.9 42.79",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M73.797 88.742s-4.895-9.307 4.512-21.619c0 0 6.91 7.465-4.512 21.619z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M73.701 88.839S69.958 78.95 54.696 77.98c0 0 .96 10.082 19.005 10.858zM63.239 71.195s-6.335-6.496-1.728-19.001c0 .096 7.583 4.362 1.728 19z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M63.143 71.292s-5.567-7.174-18.43-4.072c0 0 3.36 8.143 18.43 4.072zM50.089 57.526s-5.952-4.363-3.84-15.027c0 0 6.623 2.52 3.84 15.026z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M49.993 57.623s-5.376-5.042-15.358-.873c0 0 3.743 6.108 15.358.873z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M42.314 52.097c-4.8-3.297-10.27-6.399-16.414-9.21",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M36.65 48.413s-4.607-2.327-4.319-9.986c0-.097 4.895.97 4.32 9.986z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M36.65 48.51S32.331 45.6 25.9 49.673c0-.097 3.264 3.78 10.75-1.163z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M42.778 85.615c0-2.917-2.194-5.216-4.978-5.216 2.785 0 4.978-2.298 4.978-5.216 0 2.918 2.194 5.216 4.979 5.216-2.785 0-4.979 2.299-4.979 5.216z",fill:"#D1CEF4",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M56.597 42.094c0-2.652-1.994-4.742-4.525-4.742 2.531 0 4.525-2.09 4.525-4.741 0 2.652 1.995 4.742 4.526 4.742-2.531 0-4.526 2.09-4.526 4.741z",fill:"#FCF5D0",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M80.06 61.062c0-3.13-2.354-5.596-5.341-5.596 2.987 0 5.34-2.465 5.34-5.595 0 3.13 2.354 5.595 5.341 5.595-2.987 0-5.34 2.466-5.34 5.596z",fill:"#F8C6DA",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),r.createElement("path",{d:"M77 43.212c5.412 0 9.8-4.43 9.8-9.895 0-5.464-4.388-9.894-9.8-9.894-5.412 0-9.8 4.43-9.8 9.894 0 5.465 4.388 9.895 9.8 9.895z",fill:"#15C39A",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M83.037 29.695c-.35-.353-1.05-.353-1.487 0l-6.125 6.184-2.625-2.65c-.35-.353-1.05-.353-1.487 0-.175.177-.263.442-.263.707 0 .265.088.53.263.706l3.412 3.446c.175.176.438.265.7.265.263 0 .525-.089.7-.265l6.825-6.89c.438-.443.438-1.061.087-1.503z",fill:"#fff"})))),f=a.UI.Node.make((()=>r.createElement("video",{className:y.premiumOnboardingStartVideo,autoPlay:!0,loop:!0,muted:!0,poster:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjY0IiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDI2NCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xMTIuODA5IDgxLjcwNDVDMTEyLjgwOSA4OS4xMDY3IDEyOS40NDEgOTcuOTcxMiAxMjkuNDQxIDk3Ljk3MTJMMTI0LjE0MSAxMDkuMzk0IiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTEzLjA4MyA4Mi44OTI1QzExMy45OTcgODIuNjE4MyAxMTQuNDU0IDgyLjA3IDExNC42MzYgODEuNjEzMUMxMTQuOTExIDgxLjA2NDggMTE0LjgxOSA4MC40MjUxIDExNC40NTQgNzkuOTY4MUwxMTAuOTgxIDc1Ljk0NzFMMTEwLjM0MSA4MS4yNDc1QzExMC4yNSA4MS43OTU4IDExMC41MjQgODIuNDM1NSAxMTEuMDcyIDgyLjcwOTdDMTExLjUyOSA4Mi45ODM5IDExMi4xNjkgODMuMTY2NiAxMTMuMDgzIDgyLjg5MjVaIiBmaWxsPSIjMTVDMzlBIiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMTguNjU4IDcyLjIwMDRDMTE3LjEwNCA3NS43NjQ1IDExNC44MTkgNzguNTk3NCAxMTIuMDc4IDc5LjQxOTlDMTA1LjU4OSA4MS40MzA0IDk0Ljg5NzMgNzIuNjU3MyA5Mi42MTI2IDY0Ljk4MDlDOTAuNDE5NCA1Ny42NzAxIDk0LjI1NzYgNTAuMDg1IDEwMS4yMDMgNDcuMzQzNUMxMDEuNTY4IDQ3LjE2MDcgMTAxLjkzNCA0Ny4wNjkzIDEwMi4zIDQ2Ljk3NzlDMTA5Ljg4NSA0NC42OTMzIDExOC4wMTggNDguOTg4NCAxMjAuMzAzIDU2LjU3MzRDMTIxLjU4MiA2MS4wNTEzIDEyMC43NTkgNjcuMjY1NiAxMTguNjU4IDcyLjIwMDRaIiBmaWxsPSIjMTVDMzlBIiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIG9wYWNpdHk9IjAuNSIgZD0iTTEwMS41NjggNzEuMDEyM0MxMDMuODUzIDY5LjgyNDMgMTAwLjE5OCA2MS40MTY4IDk2Ljk5OSA2My4wNjE3QzkzLjE2MDggNjUuMDcyMiA5OC4wOTU2IDcyLjg0IDEwMS41NjggNzEuMDEyM1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIG9wYWNpdHk9IjAuMjUiIGQ9Ik0xMjAuMjExIDU2LjY2NDdDMTIxLjU4MiA2MS4wNTEzIDEyMC43NTkgNjcuMzU2OSAxMTguNjU3IDcyLjIwMDNDMTEwLjYxNSA2My45NzU2IDEwMS4xMTEgNTIuMjc4MiAxMDEuMTExIDQ3Ljg5MTdDMTAxLjExMSA0Ny43MDg5IDEwMS4xMTEgNDcuNTI2MiAxMDEuMjAzIDQ3LjM0MzRDMTAxLjU2OCA0Ny4xNjA2IDEwMS45MzQgNDcuMDY5MiAxMDIuMjk5IDQ2Ljk3NzhDMTA5Ljg4NCA0NC42OTMyIDExNy45MjYgNDguOTg4MyAxMjAuMjExIDU2LjY2NDdaIiBmaWxsPSIjMUYyNDNDIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTUxLjAwOCA3Mi42NTczQzE0NS43MDggODQuNTM3NSAxMjkuNDQxIDk3Ljk3MTIgMTI5LjQ0MSA5Ny45NzEyTDEzNC41NTkgMTA3LjExIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTUwLjkxNyA3My45MzY3QzE1MC4wMDMgNzMuNjYyNSAxNDkuNTQ2IDczLjExNDIgMTQ5LjM2MyA3Mi42NTczQzE0OS4wODkgNzIuMTA4OSAxNDkuMTggNzEuNDY5MiAxNDkuNTQ2IDcxLjAxMjNMMTUzLjAxOSA2Ni45OTEzTDE1My42NTggNzIuMjkxN0MxNTMuNzUgNzIuODQgMTUzLjQ3NiA3My40Nzk3IDE1Mi45MjcgNzMuNzUzOUMxNTIuNDcgNzQuMDI4IDE1MS44MzEgNzQuMTE5NCAxNTAuOTE3IDczLjkzNjdaIiBmaWxsPSIjODc4MEU0IiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNzEuMzg3IDU2LjAyNTFDMTY5LjEwMyA2My42MTAxIDE1OC41MDIgNzIuNDc0NiAxNTEuOTIyIDcwLjQ2NDFDMTQ1LjQzNCA2OC40NTM2IDE0MS40MTMgNTUuMjk0IDE0My42OTcgNDcuNzA5QzE0NS45ODIgNDAuMTI0IDE1NC4wMjQgMzUuNzM3NCAxNjEuNyAzOC4xMTM1QzE2OS4zNzcgNDAuMzA2NyAxNzMuNjcyIDQ4LjM0ODcgMTcxLjM4NyA1Ni4wMjUxWiIgZmlsbD0iIzg3ODBFNCIgc3Ryb2tlPSIjMUMyNTNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8cGF0aCBvcGFjaXR5PSIwLjQiIGQ9Ik0xNjcuOTE1IDUyLjkxOEMxNjMuODk0IDU0LjE5NzQgMTYxLjA2MSA0NC42MDE5IDE2NS4zNTYgNDQuMjM2M0MxNjkuMjg1IDQzLjg3MDggMTcwLjU2NSA1Mi4wOTU1IDE2Ny45MTUgNTIuOTE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggb3BhY2l0eT0iMC4yNSIgZD0iTTE2Mi43OTcgMzguOTM1OUMxNjIuNzk3IDQzLjMyMjUgMTUzLjM4NCA1NC45Mjg1IDE0NS4zNDIgNjMuMTUzMkMxNDMuMjQgNTguMzA5NyAxNDIuNTA5IDUyLjA5NTUgMTQzLjc4OSA0Ny43MDlDMTQ2LjA3MyA0MC4xMjQgMTU0LjExNSAzNS43Mzc0IDE2MS43OTIgMzguMTEzNUMxNjIuMDY2IDM4LjIwNDkgMTYyLjQzMSAzOC4yOTYyIDE2Mi43MDUgMzguMzg3NkMxNjIuNzA1IDM4LjU3MDQgMTYyLjc5NyAzOC43NTMyIDE2Mi43OTcgMzguOTM1OVoiIGZpbGw9IiMxRjI0M0MiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIGQ9Ik0xMjkuNDQxIDY2LjgwODdWMTEyLjEzNiIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTEyOS40NDEgNzQuNTc2NUMxMjguNDM2IDc0LjU3NjUgMTI3Ljc5NiA3NC4yMTEgMTI3LjQzMSA3My43NTQxQzEyNi45NzQgNzMuMjk3MSAxMjYuODgyIDcyLjU2NjEgMTI3LjE1NiA3Mi4wMTc3TDEyOS41MzIgNjYuNjI2TDEzMS45MDggNzIuMDE3N0MxMzIuMTgzIDcyLjU2NjEgMTMyLjA5MSA3My4yOTcxIDEzMS42MzQgNzMuNzU0MUMxMzEuMDg2IDc0LjIxMSAxMzAuNDQ2IDc0LjU3NjUgMTI5LjQ0MSA3NC41NzY1WiIgZmlsbD0iI0ZGQzk0MCIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTE0My41MTQgMjQuNDA1N0MxNDEuNDEzIDIzLjU4MzIgMTE3LjU2MSAyMy41ODMyIDExNS40NTkgMjQuNDA1N0MxMTMuMzU3IDI1LjIyODEgMTAyLjU3NCAzNS4zNzIgMTAyLjU3NCAzOS4zMDE2QzEwMi41NzQgNDUuOTcyNyAxMjUuNzg2IDcwLjY0NjkgMTI5LjUzMiA3MC42NDY5QzEzMy4yNzkgNzAuNjQ2OSAxNTYuNDkxIDQ1Ljk3MjcgMTU2LjQ5MSAzOS4zMDE2QzE1Ni40IDM1LjQ2MzQgMTQ1LjYxNiAyNS4yMjgxIDE0My41MTQgMjQuNDA1N1oiIGZpbGw9IiNGRkM5NDAiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIG9wYWNpdHk9IjAuOCIgZD0iTTE0MS41MDQgMjYuMzI0OEMxMzkuMjE5IDI2LjIzMzQgMTM5LjIxOSAyOC44ODM2IDE0MC41OSAzMS4wNzY5QzE0Mi45NjYgMzUuMDA2NSAxNDYuMjU2IDM2LjY1MTQgMTQ3LjYyNyAzNi4xMDMxQzE1MS42NDggMzQuNjQwOSAxNDYuMzQ3IDI2LjQxNjIgMTQxLjUwNCAyNi4zMjQ4WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC44Ii8+CjxwYXRoIGQ9Ik0xNTYuNCAzOS4yMTAyTDE0MC44NjQgNDEuNjc3NkgxMTguMDE4TDEwMi40ODIgMzkuMjEwMiIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTEzNS4wMTUgMjQuMDQwMkMxMzcuNTc0IDI4Ljc5MjIgMTQwLjg2NCAzOS45NDEzIDE0MC44NjQgNDEuNjc3NkMxNDAuODY0IDQzLjQxNCAxMzUuODM4IDU5LjA0MDkgMTI5LjQ0MSA3MC42NDY5IiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTIzLjg2NiAyNC4wNDAyQzEyMS4zMDggMjguNzkyMiAxMTguMDE4IDM5Ljk0MTMgMTE4LjAxOCA0MS42Nzc2QzExOC4wMTggNDMuNDE0IDEyMy4wNDQgNTkuMDQwOSAxMjkuNDQxIDcwLjY0NjkiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIG9wYWNpdHk9IjAuOCIgZD0iTTExNy41NjEgNTUuNzUxMUMxMTYuMTkgNTYuMDI1MyAxMTAuNjE1IDUwLjM1OTQgMTA4LjMzMSA0Ni4zMzg0QzEwNy4yMzQgNDQuNDE5MyAxMDguMjM5IDQzLjMyMjcgMTA5LjMzNiA0My4wNDg1QzExMi41MzQgNDIuMjI2IDExMy45MDUgNDQuMzI3OSAxMTYuMDA3IDQ3Ljg5MkMxMTcuOTI2IDUxLjA5MDUgMTE5LjIwNiA1NS4zODU2IDExNy41NjEgNTUuNzUxMVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8cGF0aCBkPSJNMTQxLjg2OSA5OS44OTA0QzE0My44OCA5MC4zODYzIDEyOS40NDEgOTcuNzg4NSAxMjkuNDQxIDk3Ljc4ODVDMTI5LjQ0MSA5Ny43ODg1IDE0MC4wNDIgMTA5LjAyOSAxNDEuODY5IDk5Ljg5MDRaIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTE3LjAxMyA5OS44OTA0QzExNS4wMDIgOTAuMzg2MyAxMjkuNDQxIDk3Ljc4ODUgMTI5LjQ0MSA5Ny43ODg1QzEyOS40NDEgOTcuNzg4NSAxMTguODQgMTA5LjAyOSAxMTcuMDEzIDk5Ljg5MDRaIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K"},r.createElement("source",{src:`${p.yr}premiumOnboardingStart.mp4`})))),g=a.UI.Node.make((()=>r.createElement("svg",{width:"130",height:"82",viewBox:"0 0 130 82",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{opacity:"0.25",d:"M82.084 40.757L72.7367 30.3437C72.1869 29.6495 71.4996 29.3718 70.6748 29.3718H46.8943C46.0695 29.3718 45.3822 29.6495 44.8324 30.3437L35.4851 40.757C34.5229 41.8677 34.5229 43.5338 35.4851 44.6446L57.3412 68.9421C57.7536 69.3586 58.3034 69.6363 58.8533 69.6363C59.4031 69.6363 59.953 69.3586 60.3653 68.9421L82.084 44.6446C83.1837 43.5338 83.1837 41.8677 82.084 40.757Z",fill:"#494393"}),r.createElement("path",{d:"M66.1044 65.0148L87.9605 40.7173C88.6478 39.8843 88.6478 38.6347 87.9605 37.8016L78.4758 27.3884C78.0634 26.9719 77.5136 26.6942 76.8263 26.6942H53.1832C52.6333 26.6942 51.946 26.9719 51.5336 27.3884L42.1864 37.8016C41.4991 38.6347 41.4991 39.8843 42.1864 40.7173L64.0425 65.0148C64.5923 65.7091 65.5546 65.7091 66.1044 65.0148Z",fill:"#FFDF80",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M88.5103 39.3289H41.6365",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M60.4684 26.6942L55.7947 38.4958C55.6573 39.0512 55.6573 39.6066 55.7947 40.0231L65.142 65.5702",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("path",{d:"M69.6783 26.6942L74.3519 38.4958C74.4894 39.0512 74.4894 39.6066 74.3519 40.0231L65.0046 65.5702",stroke:"#0E101A",strokeMiterlimit:"10"}),r.createElement("rect",{x:"77.5491",y:"1",width:"8",height:"8",rx:"2",transform:"rotate(14.9627 77.5491 1)",fill:"#F8C6DA",stroke:"#0E101A"}),r.createElement("rect",{x:"13",y:"53.5762",width:"8",height:"8",rx:"2",transform:"rotate(-36.5938 13 53.5762)",fill:"#B8B4EF",stroke:"#0E101A"}),r.createElement("circle",{cx:"96",cy:"73",r:"4",fill:"#87E8D1",stroke:"#0E101A"}),r.createElement("path",{d:"M37 66V72",stroke:"#0E101A"}),r.createElement("path",{d:"M37 76V82",stroke:"#0E101A"}),r.createElement("path",{d:"M45 74L39 74",stroke:"#0E101A"}),r.createElement("path",{d:"M35 74L29 74",stroke:"#0E101A"}),r.createElement("path",{d:"M37.5 10V14.125",stroke:"#0E101A"}),r.createElement("path",{d:"M37.5 16.875V21",stroke:"#0E101A"}),r.createElement("path",{d:"M43 15.5L38.875 15.5",stroke:"#0E101A"}),r.createElement("path",{d:"M36.125 15.5L32 15.5",stroke:"#0E101A"}),r.createElement("path",{d:"M103 21V27",stroke:"#0E101A"}),r.createElement("path",{d:"M103 31V37",stroke:"#0E101A"}),r.createElement("path",{d:"M111 29L105 29",stroke:"#0E101A"}),r.createElement("path",{d:"M101 29L95 29",stroke:"#0E101A"})))),y=l.u.stylesheet({premiumOnboardingStartVideo:[{width:264,height:120}]}),_=a.UI.Node.make((({view:e})=>r.createElement("div",{"data-name":"success-lens-text",className:L.newSuccessText},r.createElement(u.H4,{key:"title"},e("title")),r.createElement("div",{className:L.newSuccessDescription},r.createElement(o.F.div,{className:L.newSuccessDescriptionText},(0,i.pipe)(e("firstLine"),d.U(s.orNull))))))),v=a.UI.Union.asOption(_),b=a.UI.Grid.make((({slots:e})=>r.createElement(o.F.div,{className:L.newSuccessContainer},e.image,e.caption))),E=a.UI.Knot.make(b,{image:h,caption:v}),I=a.UI.Knot.make(b,{image:m,caption:v}),S=a.UI.Knot.make(a.UI.Grid.make((({slots:e})=>r.createElement(o.F.div,{className:L.premiumOnboardingStartSuccessContainer},e.animation,e.caption))),{animation:f,caption:v}),w=a.UI.Knot.make(b,{image:g,caption:v}),A=a.UI.Union.make("kind",{growStart:E,growComplete:I,premiumOnboardingStart:S,premiumOnboardingComplete:w}),C=l.u.keyframes({"0%":{opacity:0},"100%":{opacity:1}}),T=l.u.keyframes({"0%":{opacity:1},"100%":{opacity:0}}),k={animation:`${C} 300ms linear forwards`},O={position:"absolute",top:0,width:l.u.percent(100),animation:`${T} 200ms linear forwards`},N={textAlign:"center",background:c.Il.CoreNeutral0,padding:l.u.rem(.5)},M={width:l.u.percent(100),marginTop:l.u.rem(.5)},x={marginTop:l.u.rem(.25)},R={fontSize:l.u.rem(c.xv.NewSuccessDescriptionSize),color:c.Il.CoreNeutral50,letterSpacing:c.xv.NewSuccessDescriptionLetterSpacing,lineHeight:l.u.rem(c.xv.NewSuccessDescriptionLineHeight),fontWeight:c.xv.NewSuccessDescriptionWeight},L=l.u.stylesheet({success_fadein:[k],success_fadeout:[O],premiumOnboardingStartSuccessContainer:[N],newSuccessContainer:[{textAlign:"center"}],newSuccessText:[M],newSuccessDescription:[x],newSuccessDescriptionText:[R]}),D=a.UI.Transition.make({fadein:L.success_fadein},{fadeout:L.success_fadeout}),P=a.UI.Animated.make(D,A)},38819:(e,t,n)=>{n.d(t,{r:()=>g});var r=n(27378),i=n(40327),o=n(5114),s=n(32821),a=n(63969),c=n(61903),l=n(30763),u=n(21474),d=n(3656);const p=s.UI.Grid.make((({slots:e})=>r.createElement("div",{className:b.grid},r.createElement("div",{className:b.iconWrapper},e.icon),r.createElement("div",{className:b.titleWrapper},e.title),r.createElement("div",{className:b.bottomWrapper},e.bottom)))),h=s.UI.Node.make((()=>{const e=r.useContext(l.m.Context).successLens.paidView;return r.createElement(d.H4,null,e.title)})),m=s.UI.Node.make((()=>r.createElement(u.JO.GreenOk,{width:32}))),f=s.UI.Knot.make(p,{icon:m,title:h,bottom:s.UI.Union.make("kind",{[c.n.State.hidden]:s.UI.Node.empty,[c.n.State.expanded]:c.n.TogglableExpandedPanel})}),g=(0,i.pipe)(s.UI.squash(f),s.UI.contramapState((e=>(0,i.pipe)(e,o.fold((()=>({bottom:{kind:c.n.State.hidden}})),(e=>({bottom:{kind:c.n.State.expanded,showCloseButton:!1,alertsState:e}}))))))),y={marginTop:a.u.rem(3.5)},_={marginTop:a.u.rem(1.375)},v={marginTop:a.u.rem(2.675)},b=a.u.stylesheet({grid:[{display:"flex",flexDirection:"column",alignItems:"center"}],iconWrapper:[y],titleWrapper:[_],bottomWrapper:[v]})},70023:(e,t,n)=>{n.d(t,{d:()=>d});var r=n(57050),i=n(5114),o=n(22232),s=n(77176),a=n(60797),c=n(93508),l=n(66310),u=n(61903);function d(e){return(0,r.flow)(s.U((e=>{switch(e.key){case u.n.State.expanded:switch(e.action.kind){case"collapse":return i.some(u.n.State.minimized);case"upgrade":case"onUpgradeButtonMount":return i.none;default:return(0,o.vE)(e.action)}case u.n.State.minimized:switch(e.action.action){case"onClick":return i.some(u.n.State.expanded);default:return(0,o.vE)(e.action.action)}default:return(0,o.vE)(e)}})),a.oA,c.O(u.n.State.minimized),l.w((t=>e.pipe(s.U(i.fold((()=>({kind:u.n.State.hidden})),(e=>{switch(t){case u.n.State.minimized:return{kind:u.n.State.minimized,alertsCount:e.count};case u.n.State.expanded:return{kind:u.n.State.expanded,showCloseButton:!0,alertsState:{count:e.count,alerts:e.alerts()}};case u.n.State.hidden:return{kind:u.n.State.hidden};default:return(0,o.vE)(t)}})))))))}},61903:(e,t,n)=>{n.d(t,{n:()=>H});var r=n(32821),i=n(27378),o=n(40327),s=n(5739),a=n(22232),c=n(5114),l=n(30763),u=n(7046),d=n(87380),p=n(21474),h=n(3656),m=n(77176),f=n(44060),g=n(63969),y=n(40219);const _={position:"relative",borderRadius:g.u.rem(y.fx),boxShadow:"0 1px 7px 0 rgba(129, 137, 169, .2)",userSelect:"none",backgroundColor:f.Il.CoreNeutral0},v={padding:`${g.u.rem(1)} ${g.u.rem(2)}`},b={position:"absolute",top:g.u.rem(.75),left:g.u.rem(.5)},E={display:"flex",boxSizing:"border-box",padding:g.u.rem(.5),height:g.u.rem(2.5),cursor:"pointer",justifyContent:"flex-start",alignItems:"center"},I={marginLeft:g.u.rem(.8),fontSize:g.u.rem(.85),lineHeight:g.u.rem(1)},S={display:"flex",width:g.u.percent(100),alignItems:"center",justifyContent:"space-between"},w={position:"absolute",top:g.u.rem(.2),right:g.u.rem(.3),cursor:"pointer"},A={paddingRight:g.u.rem(1),textAlign:"left",fontSize:g.u.rem(.75),lineHeight:g.u.rem(1.15)},C={marginTop:g.u.rem(.6),fontSize:g.u.rem(.875),flexShrink:0},T={display:"flex",marginBottom:g.u.rem(.6),justifyContent:"flex-end",flexShrink:0},k={marginRight:"auto",lineHeight:g.u.rem(1.3125)},O={marginTop:g.u.rem(.21),minWidth:g.u.rem(1.5),flexShrink:0},N={marginTop:g.u.rem(1)},M={display:"flex",justifyContent:"center",alignItems:"center",height:g.u.rem(2),backgroundColor:f.Il.CoreGreen60,borderRadius:g.u.rem(.25),fontSize:g.u.rem(.875),fontWeight:700,color:f.Il.CoreNeutral0,lineHeight:g.u.rem(2),$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:g.u.color(f.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:g.u.color(f.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},x=g.u.stylesheet({wrapper:[_],maximizedWrapper:[v],minimizedWrapper:[E],maximizedWrapperIcon:[b],shadowWrapper:[{position:"relative",zIndex:1}],minimizedText:[I],minimizedContent:[S],maximizedCloseButtonContainer:[w],maximizedHeader:[A],alertCategoryContainer:[C],alertCategory:[T],categoryHumanContainer:[k],alertCounterContainer:[O],premiumButtonContainer:[N],premiumButton:[M]});var R=n(12187);const L=(e,t)=>r.UI.Grid.make((({slots:n})=>i.createElement(s.F.div,Object.assign({},(0,R.Sh)(x.wrapper,e)),i.createElement(p.JO.UpgradeHookPanel.TitleDiamond,{className:t}),n.body))),D=r.UI.Node.make((({notify:e})=>i.createElement(s.F.div,{className:x.maximizedCloseButtonContainer},i.createElement(h.zx,{name:"close",onClick:e("onClick")},i.createElement(p.JO.Arrow,{width:11,direction:p.n4.up})))));var P;!function(e){let t,n;!function(e){e.onUpgrade="onUpgrade",e.onUpgradeButtonMount="onUpgradeButtonMount"}(t=e.ActionsKind||(e.ActionsKind={})),function(e){e.isOnUpgrade=function(e){return"onUpgrade"===e.kind},e.isOnUpgradeButtonMount=function(e){return"onUpgradeButtonMount"===e.kind}}(n=e.Actions||(e.Actions={}))}(P||(P={}));const U=r.UI.Node.make((({state:e,notify:t})=>{const n=i.useContext(l.m.Context);return i.createElement(i.Fragment,null,i.createElement("div",{className:x.maximizedHeader},i.createElement(s.F.Fragment,null,e.pipe(m.U((({count:e})=>e>0?e>1?i.createElement(i.Fragment,{key:"plural"},n.sidebar.content.premiumIssues.foundTitlePlural.description1," ",e," ",n.sidebar.content.premiumIssues.foundTitlePlural.description2):i.createElement(i.Fragment,{key:"singular"},n.sidebar.content.premiumIssues.foundTitleSingular.description1," ",e," ",n.sidebar.content.premiumIssues.foundTitleSingular.description2):null))))),i.createElement(s.F.div,{className:x.alertCategoryContainer},e.pipe(m.U((({alerts:e})=>e.map((e=>i.createElement("div",{key:e.category,className:x.alertCategory},i.createElement("div",{className:x.categoryHumanContainer},e.categoryHuman),i.createElement("div",{className:x.alertCounterContainer},i.createElement(d.x.Counter,{count:e.count,type:"yellowPremium"}))))))))),i.createElement("div",{className:x.premiumButtonContainer},i.createElement("div",{ref:e=>{t({type:"upgradeHookAction",kind:P.ActionsKind.onUpgradeButtonMount,element:c.fromNullable(e)})()}},i.createElement(u.zx,{name:"upgrade",className:x.premiumButton,onClick:t({type:"upgradeHookAction",kind:P.ActionsKind.onUpgrade})},i.createElement(p.JO.UpgradeHookPanel.ButtonDiamond,null),n.goPremium))))})),F=r.UI.Composite.make(L(x.maximizedWrapper,x.maximizedWrapperIcon),r.UI.Group.make({closeButton:r.UI.Union.make("kind",{hidden:r.UI.Node.empty,visible:D}),content:U})),j=(0,o.pipe)(r.UI.squash(F),r.UI.mapAction((e=>{switch(e.key){case"content":switch(e.action.kind){case P.ActionsKind.onUpgrade:return{kind:"upgrade"};case P.ActionsKind.onUpgradeButtonMount:return{kind:"onUpgradeButtonMount",element:e.action.element};default:return(0,a.vE)(e.action)}case"closeButton":switch(e.action.action){case"onClick":return{kind:"collapse"};default:return(0,a.vE)(e.action.action)}default:return(0,a.vE)(e)}})),r.UI.contramapState((e=>({closeButton:{kind:e.showCloseButton?"visible":"hidden"},content:e.alertsState})))),B=r.UI.Node.make((({state:e})=>{const t=i.useContext(l.m.Context);return i.createElement(s.F.div,{className:x.minimizedContent},i.createElement("div",{className:x.minimizedText},t.premiumSuggestions),e.pipe(m.U((({alertsCount:e})=>e>0&&i.createElement(d.x.Counter,{type:"yellowPremium",key:"advancedCounter-counter",count:e})))))})),W=r.UI.Grid.make((({slots:e,notify:t})=>i.createElement("div",{className:x.shadowWrapper,onClick:t("onClick")},e.body))),G=r.UI.Knot.make(W,{body:r.UI.Composite.make(L(x.minimizedWrapper),B)}),z=(0,o.pipe)(r.UI.squash(G),r.UI.contramapState((e=>({body:e}))));var H;!function(e){let t;!function(e){e.hidden="hidden",e.minimized="minimized",e.expanded="expanded"}(t=e.State||(e.State={})),e.TogglableExpandedPanel=r.UI.Union.make("kind",{[t.hidden]:r.UI.Node.empty,[t.expanded]:j}),e.TogglablePanel=r.UI.Union.make("kind",{[t.hidden]:r.UI.Node.empty,[t.minimized]:z,[t.expanded]:j})}(H||(H={}))},43743:(e,t,n)=>{n.d(t,{f:()=>r});var r,i=n(49708),o=n(77176),s=n(93508),a=n(85985),c=n(17343),l=n(36303),u=n(24209),d=n(83840),p=n(8473),h=n(15789),m=n(2768),f=n(50628),g=n(44586),y=n(28043),_=n(32952),v=n(66310),b=n(76974);!function(e){class t{static get observable(){return this._obs||(this._obs=i.R(document,"visibilitychange").pipe(o.U((()=>document.hidden)),s.O(document.hidden),a.h(Boolean),c.h(void 0),l.r(1)))}}function n(...e){return u.T(...e.map((e=>e.pipe(d.i())))).pipe(p.o((e=>e.hasValue)),h.D())}e.Hidden=t,e.mergeUntilAnyCompletes=n,e.createAnimationObservable=function(e,r,i){return n(function(e,t,n){return g.y.create((r=>{let i,o=self.requestAnimationFrame(s);function s(a){i||(i=a);const c=a-i;c<n?(r.next(Math.round(e+c/n*(t-e))),o=self.requestAnimationFrame(s)):(r.next(t),r.complete())}return()=>self.cancelAnimationFrame(o)})).pipe(y.x())}(e,r,i).pipe(m.R(t.observable)),t.observable.pipe(c.h(r),f.P()))},e.fadeOutState=function(e){const t=new _.xQ;return{state:e.pipe(v.w((e=>e?b.of("inProgress"):u.T(b.of("fadeOut"),t.pipe(c.h("end")))))),complete:()=>t.next(!0)}},e.rafSequence=function(e,t=!1){return g.y.create((n=>{let r;function i(){n.next(e.shift()),e.length&&(r=requestAnimationFrame(i))}return t?i():r=requestAnimationFrame(i),()=>cancelAnimationFrame(r)}))}}(r||(r={}))},21619:(e,t,n)=>{n.d(t,{mN:()=>w});var r,i,o=n(71249),s=n(57050),a=n(40327),c=n(38983),l=n(5114),u=n(45701),d=n(89943),p=n(8125),h=n(55415),m=n(83078),f=n(66896),g=n(77176),y=n(32952),_=n(67434),v=n(28043),b=n(41398),E=n(19751),I=n(17594),S=n(35416);!function(e){const t=e=>t=>(0,a.pipe)(t,l.map((0,s.flow)(o.filterMap((t=>e.getAlertByMark(t))),o.sort(u.contramap((({alert:{lensType:e,lensPriority:t}})=>({type:e,priority:t})))(f.R.ord)))));e.fromMarksEvents=(e,n)=>({activeHighlights:(0,a.pipe)(n.activeMarks,g.U(t(e))),hoveredHighlights:(0,a.pipe)(n.hoveredMarks,g.U(t(e)))})}(r||(r={})),function(e){e.Mock=class{constructor(){this.alertHovered=new y.xQ,this.alertClicked=new y.xQ,this.highlightedAlert=c.h.create(l.none)}}}(i||(i={}));class w{constructor(e,t,n,i,o,s){this._ded=e,this._state=t,this._markAlertMapper=n,this._alertsReader=i,this._getActiveItemWithAlert=o,this._resolveClickedAlert=s,this._impl=new A(r.fromMarksEvents(this._markAlertMapper,this._ded),this._state,this._alertsReader,this._getActiveItemWithAlert,this._resolveClickedAlert),this.alertHovered=this._impl.alertHovered,this.alertClicked=this._impl.alertClicked}}class A{constructor(e,t,n,r,i){this._highlightEvents=e,this._state=t,this._alertsReader=n,this._getActiveItemWithAlert=r,this._resolveClickedAlert=i,this._focusedItem=this._state.view(S.nL.getActiveItem(this._getActiveItemWithAlert)),this._focusedLens=this._state.view("currentLens"),this.alertHovered=this._highlightEvents.hoveredHighlights.pipe(g.U(l.map(o.map((({alert:e})=>e)))),_.R(((e,t)=>(0,a.pipe)(t,l.chain((t=>(0,a.pipe)(e,l.filter((e=>-1!==t.indexOf(e))),l.fold((()=>l.fromNullable(t[0])),l.some)))))),l.none),g.U(l.filter((e=>this._alertsReader.isInteractable(e.id)&&!I.$.isPlagiarism(e)))),v.x()),this.alertClicked=this._highlightEvents.activeHighlights.pipe(b.M(this._focusedItem,this._focusedLens),_.R(((e,[t,n,r])=>{const i=t=>(0,a.pipe)(e,l.exists((e=>e.alert.id===t.alert.id))),o=e=>(0,a.pipe)(n,l.exists((t=>t.activeAlert.id===e.alert.id))),s=e=>r.meta.filter(e.alert);return(0,a.pipe)(t,l.chain((e=>{var t;return(0,a.pipe)(e,null!==(t=this._resolveClickedAlert)&&void 0!==t?t:d.findByPredicateList([(0,p.W9)(i,o),o,(0,p.W9)(i,s),s,i]),l.fold((()=>l.fromNullable(e[0])),l.some),l.map((e=>h.update(e,{highlightIndex:e.alert.hasNestedHighlights?0:e.highlightIndex}))))})))}),m.empty()),E.d({refCount:!0,bufferSize:1}))}}},54216:(e,t,n)=>{n.d(t,{t:()=>p});var r=n(57050),i=n(77176),o=n(28043),s=n(8125),a=n(40018),c=n(66896),l=n(25975);const u=(0,s.W9)(a.bZ.isRegistered,(0,r.not)(a.bZ.isMuted)),d=e=>t=>(0,s.W9)(u,e(t));var p;!function(e){e.create=function(e,t){const n=d((t=>e[t]));return{lensFilters:new Map(Object.entries(e)),alertVisibleInText:(e,n)=>(0,s.W9)(d((e=>t[e]))(e),(e=>t=>e||a.bZ.isPriority(t))(n)),alertVisibleInSidebar:n,getLensesFilter:t=>e[t],alertCanBeDisplayed:u,alertIsBulkAcceptable:e=>(0,s.W9)(n(e),a.bZ.isBulkAcceptable)}};const t=e=>t=>e===t.lensId,n=e=>(0,s.W9)(t(c.R.OutcomeId.fromPriorityOutcomeId(e)),a.bZ.isPriority);e.getAlertVisibleInTextFilter=function(e,t){return t.pipe(i.U((e=>({id:e.currentLens.id,nonPriorityAlertsVisible:l.v.WithPriority.nonPriorityAlertsVisible(e)}))),o.x(((e,t)=>e.id===t.id&&e.nonPriorityAlertsVisible===t.nonPriorityAlertsVisible)),i.U((({id:t,nonPriorityAlertsVisible:n})=>e.alertVisibleInText(t,n))))},e.defaultLensFilters={[c.R.SpecialId.Clarity]:t(c.R.SpecialId.Clarity),[c.R.SpecialId.Correctness]:t(c.R.SpecialId.Correctness),[c.R.SpecialId.Delivery]:t(c.R.SpecialId.Delivery),[c.R.SpecialId.Engagement]:t(c.R.SpecialId.Engagement),[c.R.SpecialId.Vox]:t(c.R.SpecialId.Vox),[c.R.SpecialId.ClarityPriority]:n(c.R.SpecialId.ClarityPriority),[c.R.SpecialId.CorrectnessPriority]:n(c.R.SpecialId.CorrectnessPriority),[c.R.SpecialId.DeliveryPriority]:n(c.R.SpecialId.DeliveryPriority),[c.R.SpecialId.EngagementPriority]:n(c.R.SpecialId.EngagementPriority),[c.R.SpecialId.VoxPriority]:n(c.R.SpecialId.VoxPriority),[c.R.SpecialId.Plagiarism]:t(c.R.SpecialId.Plagiarism),[c.R.SpecialId.DraftAI]:r.constFalse,[c.R.SpecialId.Premium]:t(c.R.SpecialId.Premium),[c.R.SpecialId.AllAlerts]:a.bZ.belongsToAllAlerts,[c.R.SpecialId.Closed]:r.constFalse,[c.R.SpecialId.Priority]:a.bZ.belongsToPriorityLens,[c.R.SpecialId.PredictionTakeaways]:a.bZ.belongsToPredictionTakeaways,[c.R.SpecialId.PredictionEmogenie]:a.bZ.belongsToPredictionEmogenie,[c.R.SpecialId.RealTimeProofit]:t(c.R.SpecialId.RealTimeProofit)},e.defaultTextFilters=Object.assign(Object.assign({},e.defaultLensFilters),{[c.R.SpecialId.Closed]:a.bZ.isCriticalImpact,[c.R.SpecialId.Premium]:(0,s.Kg)(e.defaultLensFilters[c.R.SpecialId.Premium],a.bZ.belongsToAllAlerts)}),e.priorityTextFilters=e=>({[c.R.SpecialId.Premium]:(0,s.W9)(e[c.R.SpecialId.Premium],a.bZ.isPriority)})}(p||(p={}))},59368:(e,t,n)=>{n.d(t,{Oe:()=>r,rG:()=>i,Bd:()=>o});var r,i,o,s=n(73975),a=n(40018);!function(e){e.eq=(0,s.contramap)((e=>e.alert))(a.h$.ordId),e.isPending=e=>null!==e.state.scheduled&&(e.state.scheduled.visualState!==e.state.current.visualState||e.state.scheduled.updateRanges||e.state.scheduled.forceUpdate),e.isOneOf=(...e)=>t=>e.some((e=>e===t.state.current.visualState)),e.notAnyOf=(...e)=>t=>e.every((e=>e!==t.state.current.visualState)),e.canBeChanged=t=>n=>t&&o.applied===n.state.current.visualState?t===o.disposed:a.bZ.State.isBulkApplied(n.alert.state)||e.notAnyOf(o.applied,o.disposed)(n),e.isOrWillBe=e=>t=>null===t.state.scheduled?t.state.current.visualState===e:t.state.scheduled.visualState===e,e.willBe=e=>t=>null!==t.state.scheduled&&t.state.scheduled.visualState===e}(r||(r={})),function(e){e.updateRanges=function(e,t){return Object.assign(Object.assign({},e),{updateRanges:t})},e.forceUpdate=function(e,t){return Object.assign(Object.assign({},e),{forceUpdate:t})},e.updateVisualState=function(e,t){return Object.assign(Object.assign({},e),{visualState:t})},e.from=function(e){return{visualState:e,updateRanges:!1,forceUpdate:!1}}}(i||(i={})),function(e){e.initial="initial",e.highlighted="highlighted",e.visible="visible",e.faded="faded",e.hidden="hidden",e.success="success",e.applied="applied",e.disposed="disposed"}(o||(o={})),function(e){e.isApplied=function(t){return t===e.applied}}(o||(o={}))},16746:(e,t,n)=>{n.d(t,{v:()=>I});var r=n(71249),i=n(57050),o=n(40327),s=n(49524),a=n(25656),c=n(24645),l=n(51996),u=n(95195),d=n(5114),p=n(22232),h=n(83078),m=n(89943),f=n(68983),g=n(8125),y=n(81531),_=n(40018),v=n(17594),b=n(36156),E=n(59368);class I{constructor(e,t,n,r,a,c,l,p){this._alert=e,this._alertsService=t,this._alertRangeService=n,this._changeMarksInDEd=r,this._create=a,this._update=c,this._remove=l,this._onTransitionEnd=p,this._currentState=E.rG.from(E.Bd.initial),this._scheduledState=E.rG.from(E.Bd.visible),this.id=this._alert("id").id,this._marksMap=new Map,this._alertRef=this._alertsService.takeReference(this._alert("_alertRef"),"mark"),this._shouldInitMark=!0,this._tryToUpdateRangesInAlert=e=>{if(!e.to.updateRanges||!(0,o.pipe)(this._alertRangeService.hasNewRangesForUpdate(this.id),u.fold(i.constFalse,s.y)))return d.none;const t=(0,o.pipe)(this._alertRangeService.applyPendingRangesUpdate(this.id),u.mapLeft((e=>S("markAlert").error("cannot apply pending ranges",e))),d.fromEither,d.chain(s.y),d.filter((({addedHighlightedRanges:e,removedHighlightedRanges:t})=>e.length>0||t.length>0)));return(0,o.pipe)(t,d.map((e=>({commit:()=>e.removedHighlightedRanges[1](),ranges:{added:e.addedHighlightedRanges,removed:e.removedHighlightedRanges[0]}}))))},this._dispose=()=>{this._marksMap.clear(),u.either.map(this._alertRef,(e=>e.dispose()))},this._disposeIfEmpty=()=>{0===this._marksMap.size&&this._dispose()},u.either.mapLeft(this._alertRef,(e=>S("markAlert").warn("can not take alertRef",e)))}get state(){return{current:this._currentState,scheduled:this._scheduledState}}get alert(){return this._alert()}scheduleApply(e){return this._throwWhenNotAllowedState(e),this._throwWhenInFinaleState(e),(0,p.kG)(e!==E.Bd.initial,`Cannot schedule change ${this.id} from ${this._currentState.visualState} to initial state`),this._currentState.visualState!==E.Bd.initial||e!==E.Bd.disposed&&!E.Bd.isApplied(e)?this._scheduledState&&this._scheduledState.forceUpdate?this._scheduledState=E.rG.updateVisualState(this._scheduledState,e):this._currentState.visualState!==e||this._currentState.updateRanges?this._scheduledState=E.rG.updateVisualState(this._currentState,e):this._scheduledState=null:(this._scheduledState=null,this._currentState=E.rG.from(E.Bd.disposed),this._dispose()),this}scheduleUpdate(){this._throwWhenInFinaleState(),this._scheduledState=E.rG.updateRanges(this._scheduledState||this._currentState,!0)}scheduleForceUpdate(){this._throwWhenInFinaleState(),this._scheduledState=E.rG.forceUpdate(this._scheduledState||this._currentState,!0)}apply(){if(!E.Oe.isPending(this))return;this._throwWhenInFinaleState();const e=this._getTransition();(0,o.pipe)(this.change(),d.filter((e=>e.rawMark.length>0)),d.map((t=>{this._handleBasicEvent(t.rawMark),t.commit(),this._onTransitionEnd(e,this)})))}applyWith(e){const t=[this,...e];this._handleMultipleHighlights(t,(e=>e.change()))}markByIndex(e){try{return this._throwWhenInFinaleState(),this._shouldInitMark&&(this._shouldInitMark=!1,this.apply()),this._markbyIndex(e)}catch(e){return d.none}}get mark(){return this.markByIndex(0)}_iterateOverMarkAlerts(e,t){e.forEach((({change:e,ma:n})=>{e.rawMark.forEach((e=>{"create"===e.action?n._setMarkAndCheckFinaleState(e.id,(0,o.pipe)(t.created.get(e.id)||u.left(new Error("Cannot get unknown mark")),d.fromEither)):"remove"===e.action&&n._removeMark(e.id)})),e.commit(),n._disposeIfEmpty()}))}_handleMultipleHighlights(e,t){const n=e.map((e=>[e,t(e)])).filter((([e,t])=>(0,o.pipe)(t,d.filter((t=>0!==t.rawMark.length||(S("markAlert").warn("rawAction must have rawMark array",{rawAction:t.action,state:Object.assign(Object.assign({},e.toJSON()),{alert:void 0})}),!1))),d.isSome))).map((([e,t])=>({ma:e,change:h.unsafeGet(t)})));if(0===n.length)return;const r=m.flatMap(n.map((e=>e.change.rawMark))),i=this._changeMarksInDEd(r);this._iterateOverMarkAlerts(n,i)}get _mark(){return this._markbyIndex(0)}_markbyIndex(e){return this._marksMap.size>e?0===e?this._marksMap.values().next().value:Array.from(this._marksMap.values())[e]:d.none}_setMarkAndCheckFinaleState(e,t){this._throwWhenInFinaleState(),this._setMark(e,t)}_setMark(e,t){this._shouldInitMark=!1,this._marksMap.set(e,t)}_removeMark(e){this._marksMap.delete(e)}change(){(0,p.kG)(E.Oe.isPending(this),"Next state should be scheduled to change it",(()=>JSON.stringify({currentState:this._currentState,aid:this.id})));const e=this._commitTransition();return e.from.visualState!==e.to.visualState||e.to.forceUpdate||e.to.updateRanges?d.some(this._getRawActionForApply(e)):d.none}_handleBasicEvent(e){const t=this._changeMarksInDEd(e);e.forEach((e=>{if(e.action===c.v.Change.ActionType.remove)this._removeMark(e.id);else{const n=(0,o.pipe)(d.fromNullable(this._marksMap.get(e.id)),d.chain(s.y),d.alt((()=>(0,o.pipe)((e.action===c.v.Change.ActionType.create?t.created.get(e.id):t.updated.get(e.id))||u.left(new Error("Cannot get unknown mark")),d.fromEither))));this._setMark(e.id,n)}})),this._disposeIfEmpty()}_getTransition(){return(0,p.kG)(E.Oe.isPending(this),"Next state should be scheduled to change it",(()=>JSON.stringify({currentState:this._currentState,aid:this.id}))),{from:this._currentState,to:this._scheduledState}}_commitTransition(){const e=this._getTransition();return this._currentState=Object.assign(Object.assign({},e.to),{updateRanges:!1,forceUpdate:!1}),this._scheduledState=null,e}_getRawActionForApply(e){switch(e.from.visualState){case E.Bd.initial:return(0,o.pipe)(this._tryToUpdateRangesInAlert(e),d.map((e=>e.commit()))),{action:"create",commit:a.Z,rawMark:this._getHighlightRanges((t=>this._create((()=>t),e)(t.meta.id)))};default:switch(e.to.visualState){case E.Bd.disposed:const t=E.Bd.isApplied(e.from.visualState)||_.bZ.State.isRemoved(this.alert.state)&&v.$.isApplicableAlert(this.alert)&&this._getAppliedRanges(i.constVoid).length>0?this._getAppliedRanges(((e,t)=>({id:t().meta.id,range:t}))):this._getHighlightRanges((e=>({id:e.meta.id,range:()=>e})));return{action:"remove",commit:(0,o.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:e})=>e)),d.getOrElse((()=>i.constVoid))),rawMark:t.map((e=>this._remove(e.range)(e.id)))};case E.Bd.applied:const n=this._getHighlightRanges((e=>this._remove((()=>e))(e.meta.id)));return{action:"replace",commit:(0,o.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:e})=>e)),d.getOrElse((()=>i.constVoid))),rawMark:[...n,...this._getAppliedRanges(((t,n)=>this._create(n,e)(n().meta.id)))]};default:const r=()=>_.bZ.State.isBulkApplied(this._alert("_getRawActionForApply").state)?this._getAppliedRanges(((e,t)=>t())):this._getHighlightRanges(s.y);return(0,o.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:t,ranges:n})=>this._getReplaceAction(e,r(),n.removed,t))),d.getOrElse((()=>({action:"update",commit:a.Z,rawMark:r().map((t=>this._update((()=>t),e)(t.meta.id)))}))))}}}_getReplaceAction(e,t,n,r){return{action:"replace",commit:r,rawMark:[...n.map((e=>this._remove((()=>e))(e.meta.id))),...t.map((t=>this._create((()=>t),e)(t.meta.id)))]}}_getAppliedRanges(e){return(0,o.pipe)(this._alertRangeService.getAppliedRanges(this.id),u.fold((e=>(S("markAlert").error("cannot get applied ranges",{error:e.message,alert:v.$.snapshot(this._alert("_getAppliedRanges"))}),[])),r.mapWithIndex(e)))}_getHighlightRanges(e){return(0,o.pipe)(this._alertRangeService.getHighlightRanges(this.id),u.fold((t=>(S("markAlert").warn("cannot get highlight ranges via range service",{error:t,alert:this._alert("_getHighlightRanges")}),(0,o.pipe)(this._alert("_getHighlightRanges_Fallback").getHighlightRanges(),r.map(e)))),r.map(e)))}_throwWhenNotAllowedState(e){const t=this._alert("_throwWhenNotAllowedState");(0,p.kG)(!(!v.$.isDefault(t)&&!v.$.isSuper(t))||(!e||_.bZ.State.isBulkApplied(t.state)||!E.Bd.isApplied(e)),`Applied state isn't allowed for ${this.id}`)}_throwWhenInFinaleState(e){(0,p.kG)(e&&E.Oe.isOneOf(E.Bd.applied)(this)?e===E.Bd.disposed||_.bZ.State.isBulkApplied(this._alert("_throwWhenInFinaleState").state):E.Oe.notAnyOf(E.Bd.disposed)(this),`'${this._currentState.visualState}' MarkAlert '${this.id}' cannot be changed${e?` to '${e}' `:""}`)}toJSON(){return{current:this._currentState,scheduled:this._scheduledState,mark:{id:(0,o.pipe)(this._mark,d.map((e=>e.id)),d.toUndefined),range:(0,o.pipe)(this._mark,d.map((e=>e.range)),d.toUndefined)},alert:this._alert("toJSON")}}equals(e){return E.Oe.eq.equals(this,e)}hashCode(){return(0,b.AC)(this.id)}}!function(e){e.compareTo=e=>{const t=(0,f.W)(l.SV.distanceFrom)(e);return(e,n)=>(0,g.qu)(Math.min(...e.alert.getHighlightRanges().map(t)),Math.min(...n.alert.getHighlightRanges().map(t)))}}(I||(I={}));const S=(0,g.HP)(y.Monitoring.Logging.getLogger)},25980:(e,t,n)=>{n.d(t,{v:()=>r});var r,i=n(57050),o=n(59443),s=n(95574),a=n(5114),c=n(81531),l=n(60797),u=n(66310),d=n(28043),p=n(17343),h=n(98403),m=n(91224),f=n(40151),g=n(38194),y=n(76974),_=n(77176),v=n(24209),b=n(74238),E=n(4890);!function(e){let t;!function(e){e[e.ANIMATE_ALL=0]="ANIMATE_ALL",e[e.ANIMATE_MARK=1]="ANIMATE_MARK",e[e.NO_ANIMATION=2]="NO_ANIMATION"}(t=e.Animation||(e.Animation={})),e.alignMarkToItem=function(e,n){return({animation:r,suggestedPosition:y})=>({id:_,renderOptions:{features:v},activeHighlightIndex:I,activeAlert:S})=>(0,i.pipe)(e.getMarkAlertPosition({alert:S,highlightIndex:I}),l.oA,u.w((e=>{const t=s.unsafeGet(n.getCardSuggestedPositionInViewport(_,v.has(E.j.Features.showLabel),a.none,"cardContentTop"));return n.setCardPosition(_,v.has(E.j.Features.showLabel),!1,b.r.FromWindowTop.ISO.modify(b.L.concatC(-t.contentOffset))(e)).pipe(d.x(),p.h((0,i.pipe)(y,a.filter((e=>n.willFitViewport(_,b.r.FromWindowTop.ISO.modify(b.L.concatC(-t.contentOffset))(e)))),a.getOrElse((()=>b.r.FromWindowTop.ISO.modify(b.L.concatC(t.contentOffset))(t.top))))))})),u.w((n=>e.moveAlertHighlightInViewport({alert:S,highlightIndex:I},n,r===t.ANIMATE_ALL?o.uq.fake:o.uq.none))),p.h(h.PU),m.K((e=>(c.Monitoring.Logging.root.getLogger("AlignmentViewModel").error("Cannot align mark to card",e),f.E))),g.B())},e.alignItemToMark=function(t,n){return({animation:r,fitCardIntoViewport:l})=>({id:d,renderOptions:{features:I},activeAlert:S,activeHighlightIndex:w})=>(0,i.pipe)(t.getMarkAlertPosition({alert:S,highlightIndex:w}),u.w(a.fold((()=>f.E),(e=>y.of(e)))),_.U((e=>({mark:e,card:s.unsafeGet(n.getCardSuggestedPositionInViewport(d,I.has(E.j.Features.showLabel),a.some(e),"cardContentTop"))}))),u.w((({card:i,mark:s})=>v.T(n.setCardPosition(d,I.has(E.j.Features.showLabel),r===e.Animation.ANIMATE_ALL,b.r.FromWindowTop.ISO.modify(b.L.concatC(-i.contentOffset))(s)),h.Ft(t.moveAlertHighlightInViewport({alert:S,highlightIndex:w},b.r.FromWindowTop.ISO.modify(b.L.concatC(i.contentOffset))(i.top),r===e.Animation.ANIMATE_ALL?o.uq.initial:o.uq.none))(l)))),p.h(h.PU),m.K((e=>(c.Monitoring.Logging.root.getLogger("AlignmentViewModel").error("Cannot align card to mark",e),f.E))),g.B())}}(r||(r={}))},58562:(e,t,n)=>{n.d(t,{eZ:()=>H,UC:()=>q});var r=n(57050),i=n(40327),o=n(49524),s=n(12447),a=n(22232),c=n(95574),l=n(83078),u=n(8125),d=n(55415),p=n(5114),h=n(95195),m=n(40018),f=n(66896),g=n(60797),y=n(98403),_=n(85089),v=n(76974),b=n(77176),E=n(17343),I=n(93508),S=n(28043),w=n(40151),A=n(66310),C=n(598),T=n(83401),k=n(41398),O=n(55721),N=n(95093),M=n(24209),x=n(16118),R=n(85985),L=n(25980),D=n(15646),P=n(91402),U=n(35416),F=n(74238),j=n(14990),B=n(99116);var W,G,z;!function(e){e.CARD_CONTENT_OFFSET_REM=3.4,e.WITH_LABEL_CARD_CONTENT_OFFSET_REM=e.CARD_CONTENT_OFFSET_REM+1,e.contentOffsetGetter=(t=e.CARD_CONTENT_OFFSET_REM,n=e.WITH_LABEL_CARD_CONTENT_OFFSET_REM)=>(e,r)=>Math.round((e?n:t)*r)}(W||(W={})),function(e){e.cardPositionGetter=(e,t)=>(n,o)=>{const s=new j.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return c.tryCatchError((()=>(0,i.pipe)(e.view(U.nL.getLens).get(),p.chain((({items:e})=>(0,i.pipe)(e.get(n),p.map((({value:e})=>(0,i.pipe)(o,p.fold((()=>(0,r.flow)(F.L.AbsTop.ISO.wrap,s.converters.absTopToViewportTop,s.converters.viewportToWindow)(e.positionState.absTop)),r.identity))))))),l.unsafeGet)))},e.cardPositionInViewportGetter=(e,t)=>(n,o)=>{const s=new j.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,i.pipe)(e.view(U.nL.getLens).get(),h.fromOption((()=>new Error("Current lens is not WithItemsLensState"))),h.chain((({items:e,id:t})=>(0,i.pipe)(e.get(n),h.fromOption((()=>new Error(`The item with id: ${n} does not exist in lens ${t}`))),h.chain((({value:t})=>{return(0,i.pipe)(o,p.map(s.converters.windowToViewport),p.alt((()=>p.some((0,r.flow)(F.L.AbsTop.ISO.wrap,s.converters.absTopToViewportTop)(t.positionState.absTop)))),p.map((a=t,c=((e,t)=>(0,i.pipe)(t.get(e),p.map((({index:e})=>({before:(0,i.pipe)(t.getAt(e-1),p.map((e=>e.positionState.height)),p.getOrElse((()=>0))),after:(0,i.pipe)(t.getAt(e+1),p.map((e=>e.positionState.height)),p.getOrElse((()=>0)))}))),p.getOrElse((()=>({before:0,after:0})))))(n,e),l=s.viewport,e=>{const t=(0,B.v_)({cardTop:e,cardHeight:a.positionState.height,viewportHeight:l.height,padding:c});return F.L.FromViewportTop.ISO.modify(F.L.concatC(-t))(e)})),p.map(s.converters.viewportToWindow),h.fromOption((()=>new Error("Cannot get card position in viewport"))));var a,c,l}))))))}}(G||(G={})),function(e){const t=(e,t,n,r)=>{const o=r.viewport.get(),s=r.scrollTop.get(),l=F.L.converters(s,F.r.FromWindowTop.ISO.unwrap(o.top),r.paddingTop.get());return c.tryCatchError((()=>(0,i.pipe)(U.nL.getLens(n),p.chain((t=>t.items.get(e))),p.map((e=>F.L.AbsTop.ISO.wrap(e.value.positionState.absTop))),p.map((e=>l.absTopToViewportTop(e))),p.fold((()=>{throw new a.ej("Cannot get offset for unknown card")}),(e=>{const n=l.windowToViewport(t);return F.L.FromViewportTop.ISO.unwrap(e)-F.L.FromViewportTop.ISO.unwrap(n)})))))};e.moveCardToPositionSyncGetter=(e,n)=>r=>(0,i.pipe)(t(r.id,r.position,e.get(),n),h.chain((e=>n.moveCardsBy(e,"moveCardToPositionAnimated")))),e.moveCardToPositionAnimatedGetter=(e,n)=>r=>(0,i.pipe)(t(r.id,r.position,e.get(),n),h.fold((e=>P._(e)),(e=>n.moveCardsByAnimated(e,"moveCardToPositionAnimated"))))}(z||(z={}));var H,q,Y,V,$=n(71841);class Q extends a.sH{}!function(e){e.cardSuggestedPositionGetter=(e,t)=>(n,r,o,s)=>{const a="cardTop"===s?0:t(r);return(0,i.pipe)(e(n,(0,i.pipe)(o,p.map(F.r.FromWindowTop.ISO.modify(F.L.concatC(-a))))),h.map((e=>({top:e,contentOffset:a}))))},e.getSuperScrollMapper=(t,n,r)=>{const o=z.moveCardToPositionAnimatedGetter(t,n),s=z.moveCardToPositionSyncGetter(t,n),a=W.contentOffsetGetter();return{setCardPosition:(e,t,n,i)=>{const l={top:i,contentOffset:a(t,r.get())};return(n?o({id:e,position:i}):v.of(s({id:e,position:i})).pipe(b.U(c.unsafeGet))).pipe(E.h(l),I.O(l),S.x())},getCardSuggestedPosition:e.cardSuggestedPositionGetter(G.cardPositionGetter(t,n),(e=>a(e,r.get()))),getCardSuggestedPositionInViewport:e.cardSuggestedPositionGetter(G.cardPositionInViewportGetter(t,n),(e=>a(e,r.get()))),willFitViewport:(e,r)=>(0,i.pipe)(t.get(),(t=>!!U.nL.hasItems(t)&&((e,t)=>(n,r)=>{const o=new j.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,i.pipe)(e.currentLens.items,(e=>(0,i.pipe)(e.get(n),p.map((({value:e})=>0===(0,B.v_)({cardTop:o.converters.windowToViewport(r),cardHeight:e.positionState.height,viewportHeight:o.viewport.height,padding:{before:0,after:0}}))))),l.unsafeGet)})(t,n)(e,r))),isAboveViewportTop:(u=n,e=>F.r.FromWindowTop.ISO.modify(F.L.concatC(u.scrollTop.get()+u.paddingTop.get()))(e)<u.viewport.get().top)};var u}}(H||(H={})),function(e){e.getMapper=(e,t,n)=>({moveAlertHighlightInViewport:(t,n,r)=>e.ensureAlertHighlightInViewport(t,F.r.FromWindowTop.ISO.unwrap(n),r),getMarkAlertPosition:r=>(0,i.pipe)(e.getMarkByAlert(r),h.fromOption((()=>new Q("getMarkByAlert returned O.none"))),h.chain((o=>(0,i.pipe)(o.getRect(),h.map(s.n.relativeToViewport),h.map((e=>e.top)),h.orElse((()=>(n.debug("Cached alert is missing, falling back to flush"),(n=>(t.flushChanges(),(0,i.pipe)(e.getMarkByAlert(n),h.fromOption((()=>new Error("getMarkByAlert returned O.none"))),h.chain((e=>(0,i.pipe)(e.getRect(),h.map(s.n.relativeToViewport),h.map((e=>e.top))))))))(r)))),h.map(F.r.FromWindowTop.ISO.wrap)))),h.mapLeft((e=>(e instanceof Q||n.warn("Cannot getMarkAlertPosition",e),e))),p.fromEither,(e=>v.of(e)))})}(q||(q={}));!function(e){e.Mock=class{constructor(){this.alignCardToMark=()=>w.E,this.alignCardTo=()=>w.E,this.alignMarkTo=()=>w.E,this.alignMarkToCard=()=>w.E}}}(Y||(Y={})),function(e){let t,n;!function(e){let t;!function(e){e.below="below",e.above="above",e.intersects="intersects"}(t=e.RelativePosition||(e.RelativePosition={})),e.getRelativePosition=(e,n,r)=>n.top+r>e.bottom?t.below:e.top>n.bottom?t.above:t.intersects}(t||(t={})),e.createAlignmentOnTypingEffect=(e,t,n,r,o)=>{const s=e.view(U.nL.mapper((({currentLens:e})=>(0,i.pipe)(p.some(e),p.filter((0,B.Bk)(o)))))).pipe(b.U(p.chain(r),p.filter(o.isValidToAlign)),g.cp((e=>n.pipe(A.w(y.b2.rafScheduler),A.w((()=>t.alignCardToMark(e,L.v.Animation.NO_ANIMATION,!1)))))));return{id:"alignmentOnTyping",when:f.R.isWithAlertsId,what:U.nL.Effect.Applicator.create(s.pipe(C.c(T.C)))}},e.createAlignOnDisjointedAreasEffect=(e,n,s,c)=>{const u=e.view((0,r.flow)(U.nL.getLens,p.filter((e=>p.isNone(U.In.getActiveItem(e))&&e.isCardsHeightValid&&e.items.size>0)))),d=u.pipe(b.U(p.isSome),S.x(),A.w(y.Ft(s.changes.pipe(I.O(y.PU),A.w(y.b2.rafScheduler),b.U((()=>p.some((e=>{const t=e.viewport.getValue();return{top:Math.min(t.text.top,t.wrapper.top),bottom:t.text.bottom}})(s)))),b.U(p.filter((e=>e.top-e.bottom!=0)))))),k.M(u.pipe(b.U(p.map((({items:e})=>e)))),l.map2(((r,o)=>(0,i.pipe)($.YA(e,c),p.map((e=>({top:F.r.FromWindowTop.ISO.unwrap(e.top),bottom:F.r.FromWindowTop.ISO.unwrap(e.bottom)}))),p.chain((e=>(0,i.pipe)(((e,n,r)=>{const o=(0,i.pipe)(e.getAt(0),p.map((e=>e.positionState.height)),p.getOrElse((()=>0))),s=t.getRelativePosition(n,r,o);switch(s){case t.RelativePosition.above:return(0,i.pipe)(e.getAt(0),p.map((e=>({card:e,top:n.top}))));case t.RelativePosition.below:return(0,i.pipe)(e.getAt(0),p.map((e=>({card:e,top:n.bottom-e.positionState.height}))));case t.RelativePosition.intersects:return p.none;default:return(0,a.vE)(s)}})(o,r,e),p.map((({card:e,top:t})=>n.alignCardTo(e,F.r.FromWindowTop.ISO.wrap(t),L.v.Animation.NO_ANIMATION)))))),p.getOrElse((()=>w.E)))))),A.w(p.fold((()=>w.E),o.y)));return{id:"alignOnDisjointedAreas",when:f.R.isWithAlertsId,what:U.nL.Effect.Applicator.create(d.pipe(C.c(T.C)))}},e.createAlignOnResizeSideEffect=(e,t,n,r,o,s=y.b2.rafScheduler)=>{const a=e.view(U.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))).view(p.filter((({currentLens:e})=>(0,B.Bk)(o)(e)))).view(p.chain((({currentLens:e,alertSource:t})=>(0,i.pipe)(r(e),p.filter(o.isValidToAlign),p.map((n=>({item:n,source:t,lensId:e.id}))))))),c=_.Qr.pipe(O.p(100),N.T(n),k.M(a,((e,t)=>t)),A.w(s),A.w(p.fold((()=>w.E),(({item:e})=>t.alignCardToMark(e,L.v.Animation.NO_ANIMATION,!1)))));return{id:"alignOnResizeSideEffect",when:f.R.isWithAlertsId,what:U.nL.Effect.Applicator.create(c.pipe(C.c(T.C)))}},function(e){e.skip="skip"}(n=e.SkipAlertActionSource||(e.SkipAlertActionSource={})),e.createAlignmentSideEffect=(t,n,r=((e,t)=>t),i,o,s,a,c=y.b2.rafScheduler)=>{const l=e._createAlignmentSource(t,n,r,i,o,s,a,c);return{id:"alignmentSideEffect",when:f.R.isWithAlertsId,what:U.nL.Effect.Applicator.create(l.pipe(C.c(w.E)))}},e._createAlignmentSource=(e,t,s=((e,t)=>t),a,c,h,f,g=y.b2.rafScheduler)=>{const _=(0,u.Kg)(D.lY.isAlertMinicardButtonClick,D.lY.isSwitchToClosestByViewport,D.lY.isAlertCardShow,D.eI.isCardExpand,D.lY.isBulkAcceptItemShow,D.lY.isBulkHighlight),v=M.T(e.pipe(b.U(U.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))),I.O(p.none),b.U(p.map((e=>e.currentLens.id))),x.G(),R.h((([e,t])=>(0,i.pipe)(l.map2(((e,t)=>e!==t))(e,t),p.exists(o.y)))),E.h(p.none)),e.pipe(b.U(U.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))),R.h(p.exists((({currentLens:e})=>(0,B.Bk)(c)(e)))),b.U(p.chain((({currentLens:e,alertSource:t})=>(0,i.pipe)(a(e),p.filter(c.isValidToAlign),p.map((n=>({item:n,source:t,lensId:e.id}))))))))).pipe(S.x((0,r.flow)(l.map2(((e,t)=>e.lensId===t.lensId&&e.source===t.source&&e.item.activeAlert.id===t.item.activeAlert.id&&e.item.visualState.transition.type===t.item.visualState.transition.type&&e.item.activeHighlightIndex===t.item.activeHighlightIndex)),p.exists(o.y)))),C=(0,u.Kg)(D.lY.isBulkHighlight,D.lY.isAlertMinicardButtonClick),O=t.pipe(R.h(_),b.U(p.some),I.O(p.none),x.G(),R.h((0,r.flow)((0,r.tupled)(l.map2(((e,t)=>!D.lY.isAlertCardShow(t)||!D.lY.isAlertMinicardButtonClick(e)))),p.getOrElse(r.constFalse))),b.U((([,e])=>(0,i.pipe)(e,p.filter(C)))),I.O(p.none)).pipe(A.w((e=>v.pipe(R.h(p.exists((e=>e.source===m.l$.sidebar))),b.U(p.chain((t=>p.some(Object.assign(Object.assign({},t),{clickPoint:(0,i.pipe)(e,p.map(d.pick("clickPoint")))}))))))))),N=v.pipe(R.h(p.exists((e=>e.source!==m.l$.sidebar))),b.U((e=>(0,i.pipe)(e,p.chain((e=>p.some(Object.assign(Object.assign({},e),{clickPoint:p.none}))))))));return M.T(O,N).pipe(I.O(p.none),x.G(),b.U((([e,t])=>(0,i.pipe)(t,p.map((n=>({lensId:n.lensId,card:n.item,source:n.source,animate:(0,i.pipe)(e,l.forAll((({lensId:e})=>e===n.lensId))),clickPoint:(0,i.pipe)(t,p.chain(d.pick("clickPoint")),p.map((0,r.flow)(d.pick("y"),F.r.FromWindowTop.ISO.wrap)))})))))),A.w(p.fold((()=>w.E),g)),k.M(e),A.w((([{card:e,source:t,animate:r,clickPoint:o,lensId:a},c])=>(0,i.pipe)(s(e,t),(t=>U.nL.hasItems(c)&&c.currentLens.items.has(e.id)&&a===c.currentLens.id&&t!==n.skip?((e,t,n,r)=>{if(n===m.l$.text)return(0,i.pipe)(e,f({animation:t?L.v.Animation.ANIMATE_ALL:L.v.Animation.NO_ANIMATION,fitCardIntoViewport:!0}));if(n===U.h8.forceText)return(0,i.pipe)(e,f({animation:L.v.Animation.NO_ANIMATION,fitCardIntoViewport:!1}));{const o=n===m.l$.sidebar?t?L.v.Animation.ANIMATE_ALL:L.v.Animation.ANIMATE_MARK:L.v.Animation.NO_ANIMATION;return(0,i.pipe)(e,h({animation:o,suggestedPosition:r}))}})(e,r,t,o):T.C)))))}}(V||(V={}))},83436:(e,t,n)=>{n.d(t,{sU:()=>X,dv:()=>Z,Xx:()=>oe});var r={};n.r(r),n.d(r,{sendToIdeasGallery:()=>Q,sendToSignIn:()=>$});var i=n(11064),o=n(57050),s=n(40327),a=n(32952),c=n(38983),l=n(84966),u=n(22232),d=n(83078),p=n(8125),h=n(95574),m=n(39160),f=n(5114),g=n(71249),y=n(95195),_=n(81531),v=n(46680),b=n(51838),E=n(71284),I=n(40018),S=n(79227),w=n(66896),A=n(15646);class C{constructor(e,t=new URLSearchParams){this.base=e,this.params=t;const n=C._toString(e,t).length;(0,u.kG)(n<C.MAX_URL_LENGTH,"url exceeded length limit",String(n))}addParams(e){const t=Object.entries(e).reduce(((e,[t,n])=>(e.append(t,n),e)),(n=this.params,new URLSearchParams(n.toString())));var n;return new C(this.base,t)}toString(){return C._toString(this.base,this.params)}static _toString(e,t){const n=t.toString();return`${e}${n.length?`?${n}`:""}`}}C.MAX_URL_LENGTH=2083;var T=n(45586),k=n(95983),O=n(598),N=n(40151),M=n(76974),x=n(66310),R=n(91402),L=n(77176),D=n(44586),P=n(83401),U=n(77843),F=n(93508),j=n(95093),B=n(85985),W=n(36919),G=n(2834),z=n(67434),H=n(38194),q=n(49524),Y=n(5920),V=n(25980);const $=(e,t)=>(0,o.flow)(B.h((e=>e.type===A.lY.Type.toSignIn)),L.U((()=>n=>(e.actions.openUrl(new C(t.funnel.signin).addParams({utm_medium:"internal",utm_source:"upHook",utm_campaign:"editorDenalianonymousUserGenericSignInPrompt"})),n)))),Q=(e,t)=>(0,o.flow)(B.h(A.lY.isOpenIdeasGallery),G.b((()=>e.actions.openPopup(new C(t.ideas.galleryURL)))),O.c(N.E));var Z,X,J=n(17594),K=n(84313),ee=n(20594),te=n(16892),ne=n(48521),re=n(35416),ie=n(25975);!function(e){e.changeAlertEffect=(e,t,n,r,i,o,a,c)=>({id:"changeAlertEffect",when:w.R.isWithAlertsId,what:re.nL.Effect.SwitchAlert.create(t.actionEvents.pipe(x.w((t=>{const l=e.get();if(!re.nL.hasCards(l))return R._(new u.ej("Cannot update state without cards"));switch(t.type){case A.lY.Type.alertMinicardButtonClick:return(0,s.pipe)(i.getRegistered(t.alertHighlight.alert.id),f.fold((()=>(c.error("somehow we got click on non registered alert",{alert:J.$.snapshot(t.alertHighlight.alert),alertInRepo:(0,s.pipe)(i.getById(t.alertHighlight.alert.id),f.map(J.$.fromModel),f.map(J.$.snapshot)),state:re.nL.snapshot(ee.Mq.snapshot,r)(l)}),N.E)),(()=>M.of(t.alertHighlight))));case A.lY.Type.cardMatchesNavigationButtonClick:const e=t.transitionTo;switch(e.kind){case"anotherAlert":return(0,s.pipe)("right"===t.direction?n.nextAlert(e.card):(0,s.pipe)(n.prevAlert(e.card),d.orElse(n.anyRegisteredAlert(e.card))),f.fold((()=>N.E),(e=>M.of({alert:e,highlightIndex:0}))));case"sameAlert":return(0,s.pipe)(i.getRegistered(e.card.activeAlert.id),f.fold((()=>N.E),(()=>M.of({alert:e.card.activeAlert,highlightIndex:e.highlightIndex}))));default:return(0,u.vE)(e)}case A.lY.Type.switchToClosestByViewport:return((e,t,n,r)=>{const i=e=>(0,s.pipe)(t,f.map((t=>t.alignMarkToCard(e,V.v.Animation.ANIMATE_ALL,f.none).pipe(O.c(N.E)))),f.getOrElse((()=>N.E)));return(0,s.pipe)(r((t=>(t.lensId===e.id||w.R.isMainLens(e.id))&&!I.bZ.isPremium(t)),"middleOfTheViewport"),f.fold((()=>N.E),(t=>(0,s.pipe)(n(e),f.filter((e=>e.activeAlert.id===t.alert.id)),f.fold((()=>M.of(t)),i)))))})(l.currentLens,o,r,a);default:return N.E}})),L.U((e=>({alertHighlight:e,alertSource:I.l$.sidebar,options:{order:"lensOrder"}})))))}),e.createSendActiveAlertFeedbacksEffect=function(e,t,n,r,i){const a=e.view(re.nL.getActiveAlert(t)).pipe(L.U(f.filter((e=>f.isSome(r.getRegistered(e.id))&&!I.bZ.isInPremiumLens(e)))),x.w(f.fold((()=>N.E),(t=>D.y.create((()=>((0,s.pipe)(n.applyFeedback(t.id,{kind:l.PZ.LOOKED,subtype:S.J.getSubTypeFromLens(e.get().currentLens.id)},I.l$.sidebar),y.fold(i.handler("Failed to send LOOKED feedback").error,o.constVoid)),()=>{f.isSome(r.getRegistered(t.id))&&(0,s.pipe)(n.applyFeedback(t.id,{kind:l.PZ.CLOSED,subtype:S.J.getSubTypeFromLens(e.get().currentLens.id)},I.l$.sidebar),y.fold(i.handler("Failed to send CLOSED feedback: ").error,o.constVoid))})))))));return{id:"sendActiveAlertFeedbacksEffect",when:o.constTrue,what:re.nL.Effect.Applicator.create(a.pipe(O.c(P.C)))}}}(Z||(Z={}));class oe{constructor(e,t,n,r,i,c,h,m,w,C,O,N,M,x=new E.A,R={bufferTransitions:!0}){this._ops=e,this._navigationEvents=t,this._cardFactory=n,this._alertsService=r,this._sduiService=i,this._markOnboardingAsSeen=c,this._markMuteQuotedAdviceAsDismissed=h,this._sendToSignInExperiment=w,this._getActiveItemWithAlert=O,this._checksFeedCapabilities=N,this._lensState=M,this._platformEnvironment=x,this._settings=R,this._log=_.Monitoring.Logging.getLogger("CardsViewModelImpl",v.LogLevel.DEBUG),this._subs=new T.w.Keeper,this._flushCompleteTransition=new a.xQ,this._flushPositionAnimation=new a.xQ,this.actionEvents=new a.xQ,this.completePositionAnimation=new a.xQ,this.changePosition=new a.xQ,this._transitionBuffer=U.F(100).pipe(F.O(0),j.T(this._flushCompleteTransition)),this._positionAnimationBuffer=U.F(100).pipe(F.O(0),j.T(this._flushPositionAnimation)),this._startTransitionStateChanges=this.actionEvents.pipe(B.h(A.eI.isStartTransitionTo),L.U((e=>t=>X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,e.transition]]),t)))),this._completeTransitionStateChanges=this.actionEvents.pipe(B.h(A.eI.isCompleteTransitionTo),this._settings.bufferTransitions?W.f(this._transitionBuffer):L.U((e=>[e])),B.h(p.Dw),L.U((e=>t=>{const n=t.currentLens,r=this._applyCompleteVSChange(n,e.map((e=>[e.id,e.transitionId])));return this._log.isEnabled(v.LogLevel.TRACE)&&this._log.trace("batch transition complete",{events:e,diff:k.aW.diff(n.items,r.items)}),re.nL.Prism.getLens().set(r,t)}))),this._changePositionEffect=this.changePosition.pipe(L.U((({id:e,height:t})=>n=>{const r=(0,s.pipe)(Y.l.update(n.currentLens.items,e,(e=>this._checksFeedCapabilities.changePosition(te.s.PositionState.changeHeight(e.positionState,t))(e))),y.fold((()=>n.currentLens.items),o.identity));return X.itemsLens.set(r,n)}))),this._transitionEndStateChanges=this.completePositionAnimation.pipe(W.f(this._positionAnimationBuffer),B.h(p.Dw),L.U((e=>t=>{const n=t.currentLens.items,r=e.map((e=>[e,!1])).reduce(((e,[t,n])=>(0,s.pipe)(Y.l.update(e,t,(e=>this._checksFeedCapabilities.changePosition(te.s.PositionState.changeAnimationInProgress(e.positionState,n))(e))),y.fold((()=>e),o.identity))),n);return X.itemsLens.set(r,t)}))),this._switchToNextChanges=this.actionEvents.pipe(B.h((e=>e.type===A.lY.Type.switchToNext)),L.U((()=>e=>e.patch({currentLens:(0,s.pipe)(re.nL.hasItems(e)?this._checksFeedCapabilities.findNextAlert(e.currentLens):f.none,f.fold((()=>(0,s.pipe)(re.nL.getActiveAlert(this._getActiveItemWithAlert)(e),f.fold((()=>{throw new u.ej("Can not switch from non-existing card")}),(t=>this._checksFeedCapabilities.release(t)(e.currentLens))))),(t=>re.nL.hasItems(e)?this._checksFeedCapabilities.selectItemByAlert(t,[])(e.currentLens):e.currentLens))),switchOrder:"lensOrder",alertSource:I.l$.sidebar})))),this._dismissMuteQuotedAdvice=this.actionEvents.pipe(B.h(A.lY.isDismissMuteQuotedAdvice),G.b(this._markMuteQuotedAdviceAsDismissed),L.U((()=>e=>{const t=e.currentLens.items.filter((0,o.flow)(this._checksFeedCapabilities.hasActiveAlert,f.exists(J.$.isInQuotes))).keys().map((e=>[e,!1])).reduce(((e,[t])=>(0,s.pipe)(Y.l.update(e,t,this._cardFactory.hideMuteQuotedAdvice),y.fold((()=>e),o.identity))),e.currentLens.items);return X.itemsLens.set(t,e)}))),this._changeUserInput=this.actionEvents.pipe(B.h(A.lY.isChangeUserInput),G.b((({alertId:e,userInput:t})=>{this._alertsService.changeGapValue(e,t)})),L.U((({cardId:e,userInput:t})=>n=>{const r=(0,s.pipe)(n.currentLens.items.update(e,this._checksFeedCapabilities.updateUserInput(t?f.some(t):f.none)),y.fold((()=>n.currentLens.items),o.identity));return X.itemsLens.set(r,n)}))),this._shortenItDismissEdit=this.actionEvents.pipe(B.h(A.ut.isDismissEdit),L.U((({alertId:e,group:t,itemId:n})=>r=>(0,s.pipe)(this._alertsService.dismissShortenItTransformGroup(e,t),y.map((e=>({newAlert:e,itemId:n}))),y.chainW((({newAlert:e,itemId:t})=>Y.l.update(r.currentLens.items,t,this._checksFeedCapabilities.updateWithAlerts([e])))),y.fold((e=>(this._log.error("Error updating card/alert with dismissed transform groups.",e),r)),(e=>X.itemsLens.set(e,r))))))),this._focusChecksFeedItem=this.actionEvents.pipe(B.h(A.lY.isMiniItemClick),L.U((e=>t=>t.patch({currentLens:(0,s.pipe)(t.currentLens.items.find((t=>t.id===e.id)),f.fold((()=>(this._log.error("Can not switch from non-existing item"),t.currentLens)),(()=>(0,o.unsafeCoerce)((0,s.pipe)(t.currentLens,this._checksFeedCapabilities.selectItemById(e.id,[])))))),switchOrder:"lensOrder",alertSource:I.l$.sidebar})))),this._collapseChecklistItem=this.actionEvents.pipe(B.h(A.lY.isChecklistItemCollapseButtonClick),L.U((()=>e=>e.patch({currentLens:re.nL.hasItems(e)?this._checksFeedCapabilities.unselectItem()(e.currentLens):e.currentLens,switchOrder:"lensOrder",alertSource:I.l$.sidebar})))),this._smartPhrasesFeedback=this.actionEvents.pipe(B.h(A.lY.isSmartPhrasesFeedbackAction),L.U((({cardId:e,alertId:t,feedbackType:n})=>(0,s.pipe)(this._alertsService.changeSmartPhrasesFeedback(t,n),y.map((t=>({newAlert:t,cardId:e})))))),G.b((e=>this._sendSmartPhrasesUpdateStateAction(e))),L.U((e=>this._updateSmartPhrasesCard(e)))),this._smartPhrasesShowMoreIdeas=this.actionEvents.pipe(B.h(A.lY.isSmartPhrasesShowMoreIdeasAction),L.U((({cardId:e,alertId:t})=>(0,s.pipe)(this._alertsService.rotateSmartPhrasesReplacements(t),y.map((t=>({newAlert:t,cardId:e})))))),G.b((e=>this._sendSmartPhrasesUpdateStateAction(e))),L.U((e=>this._updateSmartPhrasesCard(e)))),this._smartPhrasesApply=this.actionEvents.pipe(B.h(A.lY.isSmartPhrasesApplyAction),L.U((({cardId:e,alertId:t,replacementIndex:n})=>(0,s.pipe)(this._alertsService.discardSmartPhrasesReplacement(t,n),y.map((t=>({newAlert:t,cardId:e})))))),G.b((e=>this._sendSmartPhrasesUpdateStateAction(e))),L.U((e=>this._updateSmartPhrasesCard(e)))),this._toneAIChangeToneAlternative=this.actionEvents.pipe(B.h(A.lY.isToneAIChangeToneAlternativeAction),L.U((({itemId:e,alertId:t,selectedToneAlternativeIdx:n})=>(0,s.pipe)(this._alertsService.changeToneAIToneAlternative(t,n),y.map((t=>({newAlert:t,itemId:e})))))),L.U((e=>this._updateToneAICard(e)))),this._synfonyDrilldown=this.actionEvents.pipe(B.h(A.GM.isDrilldown),L.U((({cardId:e,wordIndex:t})=>n=>(0,s.pipe)(Y.l.update(n.currentLens.items,e,(e=>{const n=e;return K.X.changeSynfonySelection((0,s.pipe)(n.synfonySelection,f.getOrElse((()=>[])),(e=>f.some(e.concat([t])))))(n)})),y.fold((()=>n),(e=>re.nL.Prism.getLens().compose(ie.v.Prism.items).set(e,n))))))),this._synfonyBack=this.actionEvents.pipe(B.h(A.GM.isBack),L.U((({cardId:e})=>t=>(0,s.pipe)(Y.l.update(t.currentLens.items,e,(e=>{const t=e;return K.X.changeSynfonySelection((0,s.pipe)(t.synfonySelection,f.map((e=>e.slice(0,-1)))))(t)})),y.fold((()=>t),(e=>re.nL.Prism.getLens().compose(ie.v.Prism.items).set(e,t))))))),this._sendToSignIn=(0,s.pipe)(this._sendToSignInExperiment,f.map((e=>e(this.actionEvents)))),this._sendFeedback=(0,o.flow)(((e,t)=>this._alertsService.applyFeedback(e,Object.assign(Object.assign({},t),{subtype:S.J.getSubTypeFromLens(this._lensState.get().currentLens.id)}),I.l$.sidebar)),y.fold(this._log.handler("error calling alert service to send a feedback").error,o.constVoid)),this._showSurveyForm=new a.xQ,this._showSurveyFormEffect=(0,s.pipe)(this._showSurveyForm,L.U((e=>t=>X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,Object.assign({type:"feedback_form",clockwise:!0,survey:e.survey},e.submitActionType===A.lY.Type.alertApplyFormSubmit?{submitActionType:A.lY.Type.alertApplyFormSubmit,alertApplyActionProps:e.alertApplyActionProps}:{submitActionType:A.lY.Type.alertIgnoreFormSubmit})]]),t)))),this._showMutedAlertSuccessEffect=this.actionEvents.pipe(B.h(A.lY.isMuteCategoryAction),L.U((e=>t=>X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,{type:"muted",clockwise:!0}]]),t)))),this._undoMutedAlertEffect=this.actionEvents.pipe(B.h(A.lY.isUndoMuteCategoryAction),L.U((e=>t=>X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,{type:"focused",clockwise:!0}]]),t)))),this._handleAlertIgnore=(0,o.flow)(se((({alertId:e,drilldownSuggestionIds:t})=>()=>this._sendFeedback(e,{kind:l.PZ.IGNORE,drilldownSuggestionIds:t})),((e,t)=>()=>this._showSurveyForm.next({submitActionType:A.lY.Type.alertIgnoreFormSubmit,id:e.id,survey:t}))),(e=>this.actionEvents.pipe(B.h(A.lY.isAlertIgnoreAction)).subscribe((t=>e(t)())))),this._handleApplyAlerts=(0,o.flow)(se((e=>()=>this._applyAlert(e)),((e,t)=>()=>this._showSurveyForm.next({submitActionType:A.lY.Type.alertApplyFormSubmit,alertApplyActionProps:e,id:e.id,survey:t}))),(e=>this.actionEvents.pipe(B.h(A.lY.isAlertApplyAction)).subscribe((t=>e(t)())))),this._sduiActionsHandler=this.actionEvents.pipe(B.h(A.lY.isSDUICardAction),L.U((({cardId:e,actions:t})=>n=>(this._log.info("sdui card action:",{cardId:e,actions:t}),(0,u.kG)(f.isSome(this._sduiService),"sduiService must be initialized to handle sdui actions"),(0,s.pipe)(t,g.reduce(n,((t,n)=>{switch(n.type){case b.zx.ActionType.notify:return d.unsafeGet(this._sduiService).sendUserAction(n.id,n.userAction),t;case b.zx.ActionType.removeCard:return X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e,{type:"removed",clockwise:!0}]]),t);case b.zx.ActionType.applyAlternative:return(0,s.pipe)(t.currentLens.items.get(e),f.map((e=>e.value)),y.fromOption((()=>new Error(`unknown cardId: ${e}`))),y.chain((e=>this._alertsService.apply(e.activeAlert.id,{alternativeIndex:n.alternativeIndex,source:I.l$.sidebar,feedbackSubtype:S.J.getSubTypeFromLens(t.currentLens.id)}))),y.mapLeft((e=>this._log.error("error in processing applyAlternative action",e))),(()=>t));case b.zx.ActionType.closeCard:return t.patch({currentLens:re.nL.hasItems(t)?this._checksFeedCapabilities.unselectItem()(t.currentLens):t.currentLens,switchOrder:"lensOrder",alertSource:I.l$.sidebar});case b.zx.ActionType.nextCard:case b.zx.ActionType.prevCard:case b.zx.ActionType.transition:case b.zx.ActionType.openSettings:case b.zx.ActionType.openToneDetector:case b.zx.ActionType.upgradeToPremium:case b.zx.ActionType.transition:case b.zx.ActionType.selectAlternative:return t;default:return(0,u.L0)(n),t}}))))))),this.hovered=this.actionEvents.pipe(B.h(A.lY.isHoverAction),G.b((()=>this._ops.flush())),z.R(((e,t)=>"hover"===t.kind?f.some(t.id):(0,s.pipe)(e,f.filter((e=>e!==t.id)))),f.none),H.B()),this.flushTransitionTo=()=>this._flushCompleteTransition.next(),this.flushPositionAnimation=()=>this._flushPositionAnimation.next(),this._subs.push(this._handleAlertFeedbacks(),this._applyTakeawayFeedbacks(),this._sendTakeawayFeedbacks(),this._handleIgnoreFormSubmit(),this._handleApplyFormSubmit(),this._handleAlertIgnore(C),this._handleAlertResolve(),this._handleApplyAlerts(C),this._dismissAlertsBatch(),this._newFeatureSeen(),this._handleSmartPhrasesDone(),this._handleSmartPhrasesApplyLast(),this._handleSentenceLevelBrandTonesFeedback(),this._handleDrilldown(),this._handleSnippetsOpenExternalLink()),(0,s.pipe)(m,d.tap((({model:e,openSuggestionsManagement:t})=>this._subs.push(this._handleCommitMuteCategories(e),this._handleSuggestionsManagementClick(t)))))}_applyStartVSChange(e,t){return t.reduce(((e,[t,n])=>(0,s.pipe)(Y.l.update(e,t,(e=>this._checksFeedCapabilities.transitionTo(n)(e))),y.fold((()=>e),o.identity))),e)}_applyCompleteVSChange(e,t){return t.reduce(((e,[t,n])=>(0,s.pipe)(e.items.get(t),f.map((({value:e})=>e)),f.fold((()=>e),(r=>ne.o.isAnimatable(r)&&"removed"===r.visualState.transition.type?this._checksFeedCapabilities.removeItemById(t)(e):(0,s.pipe)(Y.l.update(e.items,t,(e=>ne.o.isAnimatable(e)&&e.visualState.transitionId===n?this._checksFeedCapabilities.completeTransition(n)(e):e)),y.fold((()=>e),(t=>ie.v.Prism.items.set(t,e)))))))),e)}_handleSentenceLevelBrandTonesFeedback(){return this.actionEvents.pipe(B.h(A.lY.isSentenceLevelBrandTonesFeedbackAction)).subscribe((({alertId:e,feedbackType:t})=>(this._alertsService.changeSentenceLevelBrandTonesFeedback(e,t),this._sendFeedback(e,{kind:t===I.id.accurate?l.fA.EMOTION_SENTENCE_LIKE:l.fA.EMOTION_SENTENCE_DISLIKE}))))}_handleSnippetsOpenExternalLink(){return this.actionEvents.pipe(B.h(A.lY.isSnippetsOpenExternalLink)).subscribe((({externalLink:e})=>this._platformEnvironment.actions.openPopup(new C(e))))}_sendSmartPhrasesUpdateStateAction(e){return(0,s.pipe)(e,y.map((({newAlert:e})=>this.actionEvents.next({type:A.lY.Type.smartPhrasesUpdateState,alertId:e.id,state:e.getAlertState()}))))}_updateSmartPhrasesCard(e){return t=>(0,s.pipe)(e,y.chain((({newAlert:e,cardId:n})=>h.tryCatchError((()=>({newState:X.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[n,{type:"focused",clockwise:!0}]]),t),newAlert:e,cardId:n}))))),y.chainW((({newState:e,newAlert:t,cardId:n})=>(0,s.pipe)(Y.l.update(e.currentLens.items,n,this._checksFeedCapabilities.updateWithAlerts([t])),y.fold(y.left,(t=>y.right({newState:e,items:t})))))),y.fold((e=>(this._log.error("Error updating card with SmartPhrases alert.",e),t)),(({newState:e,items:t})=>re.nL.Prism.getLens().compose(ie.v.Prism.items).set(t,e))))}_updateToneAICard(e){return t=>(0,s.pipe)(e,y.chainW((({newAlert:e,itemId:n})=>Y.l.update(t.currentLens.items,n,this._checksFeedCapabilities.updateWithAlerts([e])))),y.fold((e=>(this._log.error("Error updating card with ToneAI alert.",e),t)),(e=>re.nL.Prism.getLens().compose(ie.v.Prism.items).set(e,t))))}_handleAlertFeedbacks(){return this.actionEvents.pipe(B.h(A.lY.isAlertFeedbackAction)).subscribe((({alertId:e,feedbackType:t})=>this._sendFeedback(e,{kind:t})))}_applyTakeawayFeedbacks(){return this.actionEvents.pipe(B.h(A.lY.isTakeawayDetectionFeedbackOrDoneAction)).subscribe((({alertId:e,type:t})=>this._alertsService.changeTakeawayFeedback(e,t===A.lY.Type.takeawayCorrectlyDetected?I.TO.correctlyDetected:t===A.lY.Type.takeawayCorrectlyDetectedAndDone?I.TO.correctlyDetectedAndDone:t===A.lY.Type.takeawayIncorrectlyDetected?I.TO.incorrectlyDetected:(0,u.vE)(t))))}_sendTakeawayFeedbacks(){return this.actionEvents.pipe(B.h(A.lY.isTakeawayFeedbackAction)).subscribe((e=>{switch(e.type){case A.lY.Type.takeawayCorrectlyDetected:return this._sendFeedback(e.alertId,{kind:l.PZ.ACCEPTED,replacementText:e.takeawayText});case A.lY.Type.takeawayIncorrectlyDetected:return this._sendFeedback(e.alertId,{kind:l.PZ.IGNORE});case A.lY.Type.takeawayDismiss:return this._sendFeedback(e.alertId,{kind:l.PZ.IGNORE,pnameQualifier:e.isLikelyToBeRead?l.N_.likelyToBeReadTakeaway:l.N_.unlikelyToBeReadTakeaway});case A.lY.Type.takeawayResolve:return this._sendFeedback(e.alertId,{kind:l.PZ.ACKNOWLEDGED,pnameQualifier:e.isLikelyToBeRead?l.N_.likelyToBeReadTakeaway:l.N_.unlikelyToBeReadTakeaway});default:(0,u.vE)(e)}}))}_handleSmartPhrasesDone(){return this.actionEvents.pipe(B.h(A.lY.isSmartPhrasesDoneAction)).subscribe((({alertId:e})=>this._sendFeedback(e,{kind:l.PZ.HIDE})))}_handleSmartPhrasesApplyLast(){return this.actionEvents.pipe(B.h(A.lY.isSmartPhrasesUpdateStateAction),B.h((e=>0===e.state.replacementsLength))).subscribe((({alertId:e})=>this.actionEvents.next({type:A.lY.Type.smartPhrasesDone,alertId:e,source:"auto"})))}_handleAlertResolve(){return this.actionEvents.pipe(B.h(A.lY.isAlertResolveAction)).subscribe((({alertId:e})=>this._sendFeedback(e,{kind:l.PZ.ACKNOWLEDGED})))}_handleIgnoreFormSubmit(){return this.actionEvents.pipe(B.h(A.lY.isAlertIgnoreFeedbackFormSubmit)).subscribe((({alertId:e,reason:t})=>this._sendFeedback(e,{kind:l.PZ.IGNORE,reason:t})))}_handleApplyFormSubmit(){return this.actionEvents.pipe(B.h(A.lY.isAlertApplyFeedbackFormSubmit)).subscribe((e=>{this._applyAlert(Object.assign(Object.assign({},e.alertApplyActionProps),{reason:e.reason})),e.alertApplyActionProps.actionsToDispatchAfterSurvey&&e.alertApplyActionProps.actionsToDispatchAfterSurvey.forEach((e=>this.actionEvents.next(e)))}))}_handleCommitMuteCategories(e){return this.actionEvents.pipe(B.h(A.lY.isMutedAlertCardDismissedAction)).subscribe((t=>(0,s.pipe)(e.muteCategories([t.categoryId]),y.fold(this._log.handler("error calling categories model to commit muted category").error,o.constVoid))))}_handleSuggestionsManagementClick(e){return this.actionEvents.pipe(B.h(A.lY.isMutedAlertSuggestionsManagementClick)).subscribe(e)}_applyAlert(e){return(0,s.pipe)(this._alertsService.apply(e.alertId,{alternativeIndex:e.alternativeIndex,source:I.l$.sidebar,feedbackSubtype:S.J.getSubTypeFromLens(this._lensState.get().currentLens.id),drilldownSuggestionIds:e.drilldownSuggestionIds,reason:e.reason}),y.fold(this._log.handler("error calling alert service to apply an alert").error,o.constVoid))}_handleDrilldown(){return this.actionEvents.pipe(B.h(A.GM.isDrilldown)).subscribe((e=>this._sendFeedback(e.alertId,{kind:l.P2.DRILLDOWN,drilldownSuggestionIds:e.drilldownSuggestionIds,alternativeIndex:e.alternativeId})))}_dismissAlertsBatch(){return this.actionEvents.pipe(B.h(A.FG.isDismissAlertsBatchAction)).subscribe((e=>(0,s.pipe)(this._alertsService.dismissBatch(e.alerts,S.J.getSubTypeFromLens(this._lensState.get().currentLens.id)),y.fold(this._log.handler("error calling alert service to dismiss alerts batch").error,o.constVoid))))}_newFeatureSeen(){return this.actionEvents.pipe(B.h(A.lY.isOnboardingClose)).subscribe((e=>(0,s.pipe)(this._markOnboardingAsSeen(e.value))))}getApplicatorEffects(){return(0,s.pipe)([[this._startTransitionStateChanges,"startTransitionStateChanges"],[this._completeTransitionStateChanges,"completeTransitionStateChanges"],[this._changePositionEffect,"changePositionEffect"],[this._transitionEndStateChanges,"transitionEndStateChanges"],[this._switchToNextChanges,"switchToNextChanges"],[this._dismissMuteQuotedAdvice,"dismissMuteQuotedAdvice"],[this._changeUserInput,"changeUserInput"],[this._smartPhrasesFeedback,"smartPhrasesFeedback"],[this._smartPhrasesShowMoreIdeas,"smartPhrasesShowMoreIdeas"],[this._smartPhrasesApply,"smartPhrasesApply"],[this._toneAIChangeToneAlternative,"toneAIChangeToneAlternative"],[this._synfonyDrilldown,"synfonyDrilldown"],[this._synfonyBack,"synfonyBack"],[this._focusChecksFeedItem,"focusChecksFeedItem"],[this._collapseChecklistItem,"collapseChecklistItem"],[this._shortenItDismissEdit,"shortenItDismissEdit"],[this.actionEvents.pipe(B.h(A.lY.isNavigation),G.b(this._navigationEvents),O.c(N.E)),"navigationEvents"],[(0,s.pipe)(this._sendToSignIn,f.fold((()=>N.E),q.y)),"sendToSignIn"],[this._showSurveyFormEffect,"showIgnoreFormEffect"],[this._showMutedAlertSuccessEffect,"showMutedAlertSuccessEffect"],[this._undoMutedAlertEffect,"undoMutedAlertEffect"],[this._sduiActionsHandler,"sduiActions"]],g.map((([e,t])=>({id:`cardsViewModel.effects.${t}`,when:w.R.isWithAlertsId,what:re.nL.Effect.Applicator.create(e)}))))}dispose(){this._subs.dispose()}}!function(e){e.itemsLens=re.nL.Prism.getLens().compose(ie.v.Prism.items);e.Mock=class{constructor(){this.animate=c.h.create(!0),this.clockwise=c.h.create(!0),this.toggleAnimations=()=>this.animate.modify((e=>!e)),this.completePositionAnimation=new a.xQ,this.actionEvents=new a.xQ,this.flushTransitionTo=o.constVoid,this.sideEffect={id:"cardsViewModelMock",when:w.R.isWithAlertsId,what:re.nL.Effect.Applicator.create(N.E)},this.changePosition=new a.xQ,this.dispose=p.ZT}},e.Experiments=r}(X||(X={}));const se=(e,t)=>n=>r=>(0,s.pipe)(r.eligibleForSurvey,i.of,m.p.chain((e=>(0,s.pipe)(n,i.UI((t=>t?f.none:f.some(e)))))),m.p.fold((()=>e(r)),(e=>t(r,e))))},48052:(e,t,n)=>{n.d(t,{$y:()=>$});var r,i=n(71249),o=n(57050),s=n(40327),a=n(36991),c=n(67394),l=n(5114),u=n(95195),d=n(26328),p=n(40018),h=n(22232),m=n(64450),f=n(84966),g=n(95574),y=n(98637);function _(e,{text:t,ops:n}){n.reduce(((t,n,r)=>c.JU.isInsertString(n)?(e.insertString(n.insert,n,r),t):c.JU.isInsertGap(n)?(e.insertGap("",n,r),t):c.JU.isInsert(n)?t:c.JU.isDelete(n)?(e.remove(t.slice(0,n.delete),n,r),t.slice(n.delete)):c.JU.isRetain(n)?(e.retain(t.slice(0,n.retain),n,r),t.slice(n.retain)):(0,h.vE)(n)),t)}function v(e){return 0===e.replace(/ /g,"").length}function b(e,t){(0,s.pipe)(e,i.last,l.fold((()=>{v(t.text)||e.push(t)}),(n=>{n.type===t.type?n.text+=t.text:e.push(t)})))}function E(e,t){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((n=>{const r=[];return _({insertString(t,{type:n}){if(n===c.JU.Type.Main)throw new D("Remove transform contains main insert",e)},insertGap(){throw new D("Remove transform contains gap insert",e)},retain(e,{type:t}){c.JU.isOptionalType(t)||b(r,{type:y.GP.Text,text:e})},remove(e,{type:n}){b(r,{type:n!==c.JU.Type.Main||v(e)&&t?y.GP.Text:y.GP.Delete,text:e})}},n),r})),i.flatten))),u.chain((0,o.flow)(u.fromPredicate((e=>e.length>0),(()=>new D("Remove transform contains no data",e))),u.map((e=>({type:r.Type.Remove,remove:e}))))))}function I(e,t){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((n=>{const r=[];return _({insertString(t,{type:n}){if(n===c.JU.Type.Main)throw new D("Multi-remove transform contains main insert",e)},insertGap(){throw new D("Multi-remove transform contains gap insert",e)},retain(e,{type:t}){c.JU.isOptionalType(t)||b(r,{type:y.GP.Text,text:e})},remove(e,{type:n}){b(r,{type:n!==c.JU.Type.Main||v(e)&&t?y.GP.Text:y.GP.Delete,text:e})}},n),r}))))),u.chain((0,o.flow)(u.fromPredicate((e=>e.length>=2&&e.every((e=>e.length>=2))),(()=>new D("Incomplete multi-remove",e))),u.map((e=>({type:r.Type.RemoveOr,removes:e}))))))}function S(e){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((t=>{const n=[];return _({insertString(e,{type:t}){b(n,{type:c.JU.isOptionalType(t)?y.GP.Text:y.GP.Insert,text:e})},insertGap(){throw new D("Insert transform contains gap insert",e)},retain(e,{type:t}){(!c.JU.isOptionalType(t)||n.length>0)&&b(n,{type:y.GP.Text,text:e})},remove(t,{type:n}){if(n===c.JU.Type.Main)throw new D("Insert transform contains main delete",e)}},t),n}))))),u.chain((0,o.flow)(d.nI,u.fromOption((()=>new D("Incomplete insert",e))),u.map((e=>({type:r.Type.Insert,inserts:e}))))))}function w(e){const{substitutions:t,longestSubstitution:n,inserts:o}=e.reduce(((e,[t,n])=>{const r=t.map((e=>e.text)).join("");return e.substitutions.push(r),e.inserts.push(n),r.length>e.longestSubstitution.length&&(e.longestSubstitution=r),e}),{substitutions:[],inserts:[],longestSubstitution:""}),a=(0,s.pipe)(t,d.UI((e=>n.split(e).join(""))));return(0,s.pipe)(i.zipWith(o,a,((e,t)=>(t&&e.push({type:y.GP.Text,text:t}),e))),d.nI,u.fromOption((()=>new Error("Substitution processing error"))),u.map((e=>({type:r.Type.Substitution,remove:[{type:y.GP.Delete,text:n}],inserts:e}))))}function A(e,t){return(0,s.pipe)(C(e),u.chain((n=>(0,s.pipe)(g.tryCatchError((()=>{(0,h.kG)(t.length>0,"Drilldown transform - empty drilldown tree");return{inserts:(0,s.pipe)(t,d.UI((function e([t,r]){return(0,h.kG)(void 0!==n.inserts[t],"Drilldown transform - alternative insert not found"),{alternativeId:t,label:n.inserts[t],subLabels:r.map(e)}}))),remove:n.remove,type:r.Type.Drilldown}})),u.mapLeft(D.fromError(e))))))}function C(e){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((t=>{const n=[[],[]];return _({insertString(e){b(n[1],{type:y.GP.Insert,text:"\n"===e?"¶ ":e})},insertGap(){throw new D("Substitution transform contains gap insert",e)},remove(e){b(n[0],{type:y.GP.Delete,text:e})},retain(e,{type:t}){if(!c.JU.isOptionalType(t)||0!==n[0].length){const t={type:y.GP.Text,text:e};n[0].push(t),n[1].push(t)}}},t),(0,h.kG)(n[0].length>0,"Substituted part is empty"),(0,h.kG)(n[1].length>0,"Inserts are empty"),n}))))),u.chain(w),u.mapLeft(D.fromError(e)))}function T(e){if(!("list"in e))return l.none;switch(e.list){case"bullet":case"dashed":case"ordered":return l.some({kind:e.list,indent:"number"==typeof e.indent&&Number.isInteger(e.indent)?e.indent:0});default:return l.none}}function k(e){return(0,s.pipe)(e,u.fromPredicate((e=>1===e.length),(()=>new D("Expected full-sentence transform to have 1 alternative",e))),u.map((0,o.flow)(d.YM,(t=>{let n={blockStart:0,ops:[],kind:y._k.PlainText};return _({insertString(e,t){const r=e.split("\n");if(1===r.length)n.ops.push({type:y.GP.Insert,text:e,shouldBeCollapsed:!1});else{const e=(0,s.pipe)(t.attributes,T,l.fold((()=>o.constVoid),(({kind:e,indent:t})=>()=>{n.ops.splice(n.blockStart,1,{type:y.GP.List,kind:e,indent:t}),n={kind:y._k.WithFormatting,ops:n.ops,blockStart:n.blockStart}})));for(let t=0,i=r.length-1;t<=i;t++){const o=r[t];o&&n.ops.push({type:y.GP.Insert,text:o}),t<i&&(e(),n.blockStart=n.ops.length,n.ops.push({type:y.GP.Insert,text:"\n"}))}}},insertGap(){throw new D("Full sentence transform contains gap insert",e)},retain(e,t){n.ops.push({type:y.GP.Text,text:e,shouldBeCollapsed:O(t.type,e)})},remove(e,t){n.ops.push({type:y.GP.Delete,text:e,shouldBeCollapsed:O(t.type,e)})}},t),n}))),u.chain((0,o.flow)(l.fromPredicate((e=>e.ops.length>0)),u.fromOption((()=>new D("Got empty full sentence transform",e))),u.map((({ops:e,kind:t})=>({type:r.Type.FullSentence,ops:e,kind:t}))))))}!function(e){let t;!function(e){e[e.Remove=0]="Remove",e[e.RemoveOr=1]="RemoveOr",e[e.Insert=2]="Insert",e[e.Substitution=3]="Substitution",e[e.Drilldown=4]="Drilldown",e[e.FullSentence=5]="FullSentence",e[e.SmartPhrases=6]="SmartPhrases",e[e.OneGap=7]="OneGap",e[e.ShortenIt=8]="ShortenIt",e[e.ToneAI=9]="ToneAI"}(t=e.Type||(e.Type={})),function(e){e.parse=function(t,n){const r=t[0];if(r.isFullSentence)return e.FullSentence;if(r.isSmartPhrases)return e.SmartPhrases;if(l.isSome(n.drilldown))return e.Drilldown;if(r.isShortenIt)return e.ShortenIt;if(r.isToneAI)return e.ToneAI;switch(r.type){case c.r3.Type.Insert:return e.Insert;case c.r3.Type.Remove:return t.length>1?e.RemoveOr:e.Remove;case c.r3.Type.Substitution:return r.ops.find(c.JU.isInsertGap)?e.OneGap:e.Substitution;default:return(0,h.vE)(r.type)}}}(t=e.Type||(e.Type={})),e.create=function(t){return n=>{const r=e.Type.parse(n,t);switch(r){case e.Type.Remove:return E(n,t.ignoreWhitespaceRemoves);case e.Type.RemoveOr:return I(n,t.ignoreWhitespaceRemoves);case e.Type.Insert:return S(n);case e.Type.Substitution:return C(n);case e.Type.Drilldown:return A(n,(0,s.pipe)(t.drilldown,l.getOrElse((()=>f.H5.empty))));case e.Type.FullSentence:return k(n);case e.Type.SmartPhrases:return N(n);case e.Type.OneGap:return M(n);case e.Type.ShortenIt:return x(n);case e.Type.ToneAI:return R(n);default:return(0,h.vE)(r)}}}}(r||(r={}));const O=(e,t)=>e===c.JU.Type.Optional&&t.length>3;function N(e){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((t=>{const n=a.s.normalizeDelta(new m.Delta(t.ops));if(2!==n.ops.length)throw new D("SmartPhrases transform must contain exactly 2 operations",e);if(!a.s.isRetain(n.ops[0]))throw new D("SmartPhrases transform first operation must be a retain",e);if(!a.s.isInsertString(n.ops[1]))throw new D("SmartPhrases transform second operation must be an insert",e);const r=[];return _({insertString(t,{type:n}){if(n!==c.JU.Type.Main)throw new D("SmartPhrases transform insert operation must be of type MAIN",e);b(r,{type:y.GP.Insert,text:t})},insertGap(){throw new D("SmartPhrases transform contains gap insert",e)},retain(){},remove(){throw new D("SmartPhrases transform contains delete",e)}},t),r}))))),u.chain((0,o.flow)(d.nI,u.fromOption((()=>new D("Incomplete SmartPhrases transform",e))),u.map((e=>({type:r.Type.SmartPhrases,inserts:e}))))))}function M(e){return(0,s.pipe)(g.tryCatchError((()=>((0,h.kG)(1===e.length,"One gap transform does not contain exactly one alternative"),(0,s.pipe)(e,d.YM,(e=>{const t=[],n=[];let r=!1;return _({insertString(e,{type:i}){b(r?n:t,{type:c.JU.isOptionalType(i)?y.GP.Text:y.GP.Insert,text:e})},insertGap(){(0,h.kG)(!r,"One gap transform does not contain exactly one gap insert"),r=!0},retain(e,{type:i}){const o=r?n:t;(!c.JU.isOptionalType(i)||o.length>0)&&b(o,{type:y.GP.Text,text:e})},remove:o.constVoid},e),(0,h.kG)(r,"One gap transform does not contain exactly one gap insert"),(0,h.kG)(t.length>0||n.length>0,"One gap transform does not contain at least one text insert"),{left:t,right:n}}))))),u.bimap(D.fromError(e),(({left:e,right:t})=>({type:r.Type.OneGap,left:e,right:t}))))}function x(e){return(0,s.pipe)(e,u.fromPredicate((e=>1===e.length),(()=>new D("Expected shorten-it transform to have 1 alternative",e))),u.chain(d.fw(u.either)(L)),u.map(d.YM),u.map((e=>({type:r.Type.ShortenIt,ops:e}))))}function R(e){return(0,s.pipe)(g.tryCatchError((()=>(0,s.pipe)(e,d.UI((t=>{const n=[];return _({insertString(e){b(n,{type:y.GP.Insert,text:e})},insertGap(){throw new D("ToneAI transform should not include gap insert",e)},retain(e){b(n,{type:y.GP.Text,text:e})},remove(){}},t),n}))))),u.chain((0,o.flow)(d.nI,u.fromOption((()=>new D("Incomplete ToneAI transform",e))),u.map((e=>({type:r.Type.ToneAI,insertsOrTexts:e}))))))}function L(e){const t=[];return _({insertString(e,{group:n}){t.push({type:y.GP.Insert,text:e,group:n})},insertGap(){throw new D("ShortenIt transform contains gap insert",[e])},retain(e,{group:n}){t.push({type:y.GP.Text,text:e,group:n})},remove(e,{group:n}){t.push({type:y.GP.Delete,text:e,shouldBeCollapsed:!0,group:n})}},e),(0,s.pipe)(t,u.fromPredicate((e=>e.length>0),(()=>new D("Got empty ShortenIt transform",[e]))))}class D extends h.sH{constructor(e,t){super(e),this.alternatives=t}static fromError(e){return t=>{const n=new D(t.message,e);return n.stack=t.stack,n}}toString(){return`Hydration error: ${this.message}\n  ops: ${this.alternatives.map((e=>e.ops.map(c.JU.anonymize)))}`}}var P=n(8125),U=n(81531);const F=(e,t)=>{switch(e.kind){case"replacement":return function(e,t){(0,h.kG)((0,P.Dw)(e),"transforms should have at least one element");const[n]=e;return j(n)>-1?y.nV.create(B(n),e.map(W),t,!0):y.zE.create(e,t)}(e.content.map((e=>[{type:y.GP.Insert,text:e}])),t);case"transform":return function(e,t){(0,h.kG)((0,P.Dw)(e),"transforms should have at least one element");const[n]=e;return j(n)>-1?y.nV.create(B(n),e.map(W),t):function(e){return 2===e.length&&z(e)}(e)?y.fi.create(e[0],e[1],t):z(e)?y.zE.create(e,t):y.n6.create(e,t)}(e.content.map(Y),t);default:return(0,h.vE)(e.kind)}};function j(e){return e.findIndex((e=>"arrow"===e.type))}function B(e){return e.slice(0,j(e))}function W(e){return e.slice(j(e)+1)}function G(e){return e.every((e=>"delete"!==e.type))}function z(e){return e.every(G)}function H(e,t){return{re:new RegExp(`^(${e})([\\s\\S]*)$`),createResult:t}}const q=[H("(?:\\<span class='gr_grammar_del'\\>([\\S\\s]*?)\\</span\\>)",(e=>({type:y.GP.Delete,text:e[2]}))),H("(?:\\<span class='gr_grammar_ins'\\>([\\S\\s]*?)\\</span\\>)",(e=>({type:y.GP.Insert,text:e[2]}))),H("(→)",(e=>({type:y.GP.Arrow}))),H("([^<>→]+)",(e=>({type:y.GP.Text,text:e[1]})))];function Y(e){function t(e){for(const t of q){const n=e.match(t.re);if(null!==n)return[t.createResult(n),n[n.length-1]]}}function n(t){let n=["<span class='gr_grammar_del'>","<span class='gr_grammar_ins'>","→"].map((e=>t.indexOf(e)));if(n.findIndex((e=>0===e))>0)throw new Error(`Couldn't parse transform: ${e}`);if(n=n.filter((e=>e>0)),(0,P.Dw)(n)){const e=Math.min(...n);return[{type:y.GP.Text,text:t.substring(0,e)},t.substring(e)]}return[{type:y.GP.Text,text:t},""]}const r=[];let i,o=e,s=!1,a=0;for(;(0,P.Dw)(o);){const e=t(o);void 0===e&&(s=!0);const[c,l]=e||n(o);i&&i.type===y.GP.Text&&c.type===y.GP.Text?i.text+=c.text:(i&&i.type===y.GP.Delete&&c.type===y.GP.Insert&&(r.push({type:y.GP.Arrow}),a++),r.push(c)),c.type===y.GP.Arrow&&a++,i=r[r.length-1],o=l}return(s||!(0,P.Dw)(r)||a>1)&&U.Monitoring.Logging.getLogger("model.editor.alert_replacement").warn("Bad parsing of transform",{transformHtml:e,transformPartCount:r.length,arrowCount:a}),r}const V={ignoreWhitespaceRemoves:!0},$=(0,o.flow)((function(e,t=V){return n=>(0,s.pipe)(n.alternatives,Q(e,{isFullSentence:p.eT.isFullSentence(n.cardType),isSmartPhrases:p.eT.isSmartPhrases(n.cardType),isShortenIt:p.eT.isShortenIt(n.cardType),isToneAI:p.eT.isToneAI(n.cardType)}),u.chain(r.create(Object.assign(Object.assign({},t),{drilldown:n.drilldown}))))}),(e=>t=>(0,s.pipe)(t.content,u.fold((e=>u.right(F(e,t.todo))),(0,o.flow)(e,u.map((e=>function(e,t){switch(e.type){case r.Type.Drilldown:return y.ey.create(e.remove,e.inserts,t);case r.Type.Substitution:return y.nV.create(e.remove,e.inserts,t);case r.Type.Insert:return 2===e.inserts.length?y.fi.create(e.inserts[0],e.inserts[1],t):y.zE.create(e.inserts,t);case r.Type.Remove:return y.n6.create([e.remove],t);case r.Type.RemoveOr:return y.fz.create(e.removes,t);case r.Type.FullSentence:return function(e,t){switch(e.kind){case y._k.WithFormatting:return y.i3.createWithFormatting(e.ops,t);case y._k.PlainText:return y.i3.createPlainText(e.ops,t);default:return(0,h.vE)(e)}}(e,t);case r.Type.SmartPhrases:return y.zE.create(e.inserts,t);case r.Type.OneGap:return y.G7.create(e,t);case r.Type.ShortenIt:return function(e,t){return{type:y.b$.Type.ShortenIt,tooltipText:t,labels:e.ops}}(e,t);case r.Type.ToneAI:return function(e,t){return{type:y.b$.Type.ToneAI,tooltipText:t,labels:e.insertsOrTexts}}(e,t);default:return(0,h.vE)(e)}}(e,t.todo))))))));function Q(e,t){const n=(0,o.flow)(e,(e=>e.delta.reduce(((e,t)=>a.s.isInsertString(t)?e+t.insert:e),"")));return(0,o.flow)(function(e,{isFullSentence:t,isSmartPhrases:n,isShortenIt:r,isToneAI:o}){return a=>(0,s.pipe)(a,i.filterMap((i=>(0,s.pipe)(i.type,l.map((s=>{if(c.r3.hasOptionalContext(i.ops)){const[a,...l]=i.ops,u=c.JU.length(a);return{text:e(u,i.lengthAffected-u),ops:l,type:s,isFullSentence:t,isSmartPhrases:n,isShortenIt:r,isToneAI:o}}return{text:e(0,i.lengthAffected),ops:i.ops,type:s,isFullSentence:t,isSmartPhrases:n,isShortenIt:r,isToneAI:o}}))))),d.nI)}(n,t),u.fromOption((()=>new Error("Alternative array is empty"))))}},83167:(e,t,n)=>{n.d(t,{Dv:()=>N,VC:()=>M,u0:()=>x,vM:()=>L,Py:()=>D});var r=n(35214),i=n(57050),o=n(40327),s=n(38983),a=n(5114),c=n(22232),l=n(8125),u=n(83078),d=n(95195),p=n(81531),h=n(40018),m=n(66896),f=n(16118),g=n(50628),y=n(77176),_=n(93508),v=n(85985),b=n(66310),E=n(19751),I=n(45586),S=n(24209),w=n(2834),A=n(98403),C=n(41398),T=n(35416),k=n(25975),O=n(73841);const N=(e,t,n,r=(()=>a.none))=>i=>{if(!e(i))return t(i);const{currentLens:s}=i;return s.kind===T._L.abstract?a.none:(0,o.pipe)(a.fromPredicate(T.nL.hasItems)(i),a.chain((e=>n.findNextAlert(e.currentLens))),a.alt((()=>r(i))),a.map(O.l.toLensAlert))},M=(e,t,n,r,i,s=k.v.WithSuccess.State.isInGlobalSuccess(i),c=(()=>!0))=>l=>{const{currentLens:u}=l;return u.kind===T._L.abstract?a.none:u.kind===T._L.persistent?(0,o.pipe)(T.nL.getActiveAlertHighlight(r)(l),a.fold((()=>T.nL.hasItems(l)?i.findNextAlert(l.currentLens):a.none),(t=>e.findNextAlertInTextByLens(t,u.id,k.v.WithPriority.nonPriorityAlertsVisible(l)))),a.alt((()=>c()&&(s(l)||m.R.isOutcomeId(l.currentLens.id)&&e.hasZeroFreeAlerts(n))?e.findPremiumAlert():a.none)),a.map(O.l.toLensAlert)):(0,o.pipe)((s=>(0,o.pipe)(a.fromPredicate(T.nL.hasItems)(s),a.chain((e=>i.findNextAlert(e.currentLens))),a.map(O.l.toLensAlert),a.alt((()=>(0,o.pipe)(T.nL.getActiveAlertHighlight(r)(s),a.fold((()=>t(h.bZ.isRegisteredApplicableAlert,"cursor")),(t=>e.findNextAlertInText(t,h.bZ.isApplicableAlert))),a.map((({alert:e,highlightIndex:t})=>({alert:e,highlightIndex:t,lensId:n.get()}))))))))(l),a.alt((()=>(0,o.pipe)(e.findPremiumAlert(),a.map(O.l.toLensAlert)))))};function x(e,t){return(n,r)=>t.findClosestAlertHighlight(e(r),n)}const R=e=>e.pipe(f.G(),g.P((([e,t])=>"idle"!==e&&"idle"===t)),y.U((()=>{})));class L{constructor(e,t){this._subs=new I.w.Keeper,this.firstOpeningOfDocumentWithAlerts=s.h.create(!1);const n=R(e),r=(e=>(0,o.pipe)(e,v.h((e=>T.nL.hasCards(e)&&a.isSome(T.In.getActiveItem(e.currentLens)))),y.U((()=>{}))))(t);this._subs.push((0,o.pipe)(t,g.P((e=>T.nL.hasCards(e))),b.w((()=>(0,o.pipe)(S.T(r,n),y.U(i.constFalse),_.O(!0)))),w.b(A.wW(this.firstOpeningOfDocumentWithAlerts))).subscribe())}dispose(){this._subs.dispose()}}var D;!function(e){const t=(0,l.HP)(p.Monitoring.Logging.getLogger);e.focusFirstCardAfterBigCheck=(e,n,r,i,s)=>{const c=R(n),l=n.pipe(_.O("idle"),f.G(),g.P((([e,t])=>"idle"===t)),v.h((([e])=>"full"===e)),y.U((()=>{})));const u=((e,t)=>{const n=R(e);return t.bigPaste.pipe(b.w((()=>n)),y.U((()=>{})),E.d({bufferSize:1,refCount:!0}))})(n,i);return(0,o.pipe)(S.T(c,l,u),C.M(e,s,r),v.h((([e,t,n,r])=>r&&!n&&T.nL.hasCards(t)&&a.isNone(T.In.getActiveItem(t.currentLens)))),y.U((()=>T.nL.Effect.FocusBehavior.focusFirst)),w.b((e=>t("AutoFocus.sideEffects.focusFirstCardAfterBigCheck").trace("emit: ",e))))},e.getSideEffect=(e,t)=>{const n=(0,o.pipe)(e,y.U((e=>t=>n=>{switch(t.kind){case T.nL.Effect.FocusBehaviorType.noFocus:return n;case T.nL.Effect.FocusBehaviorType.unFocus:return T.nL.Prism.getLensWithItems().modify(e.unselectItem(),n);case T.nL.Effect.FocusBehaviorType.focusFirst:return(0,o.pipe)(e.findFirstAlert(n.currentLens),a.fold((()=>n),(t=>T.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t,[]),n))));case T.nL.Effect.FocusBehaviorType.focusNext:return(0,o.pipe)(e.findNextAlert(n.currentLens),a.fold((()=>n),(t=>T.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t,[]),n))));case T.nL.Effect.FocusBehaviorType.focusAlert:return T.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t.alertHighlight,[]),n);default:(0,c.vE)(t)}})(t)));return{id:"autoFocusEffect",when:m.R.isWithAlertsId,what:T.nL.Effect.ItemsApplicator.create(n)}},e.whenFirstOpeningDocumentWithAlerts=e=>()=>e.firstOpeningOfDocumentWithAlerts.get(),e.whenShouldVerifyCurrentLens=(e,n)=>r=>{const i="AutoFocus.stateValidator.whenShouldVerifyCurrentLens";return!(!T.nL.hasItems(r)||!n.shouldVerify(r.currentLens))&&((0,o.pipe)(T.nL.getActiveAlert(e)(r),a.filter(h.bZ.isInDuplicatedState),a.fold((()=>t(i).debug("Current alert removed, should verify current lens...")),(e=>t(i).info("Current alert removed as it's a duplicate, should verify current lens...",e.toString())))),!0)},e.whenNoActiveCard=e=>e.currentLens.items.size>0&&a.isNone(T.In.getActiveItem(e.currentLens)),e.behaviorToEffect=e=>n=>r=>(0,o.pipe)(n(r)?e(r):a.none,u.tap((e=>t("AutoFocus.stateValidator").debug(`'behavior triggered: ${e.kind}`)))),e.getDefaultBehavior=(t,n)=>(0,o.pipe)([(0,o.pipe)(e.whenShouldVerifyCurrentLens(t,n),e.behaviorToEffect((()=>a.some(T.nL.Effect.FocusBehavior.focusNext))))],(0,r.fold)((0,r.getFunctionMonoid)(a.getFirstMonoid())())),e.getAlwaysFocusBehavior=()=>(0,o.pipe)([(0,o.pipe)(e.whenNoActiveCard,e.behaviorToEffect((()=>a.some(T.nL.Effect.FocusBehavior.focusNext))))],(0,r.fold)((0,r.getFunctionMonoid)(a.getFirstMonoid())())),e.getFocusFromCacheBehavior=(t,n,s,c,u,d)=>(0,o.pipe)([(0,o.pipe)(e.whenShouldVerifyCurrentLens(c,u),e.behaviorToEffect((()=>a.some(T.nL.Effect.FocusBehavior.focusNext)))),(0,o.pipe)((0,l.W9)((()=>n.get()),(0,l.W9)((0,l.W9)((0,l.W9)(e.whenFirstOpeningDocumentWithAlerts(s),(()=>t)),e.whenNoActiveCard),(0,o.pipe)(d,a.map((e=>(0,i.not)(e.willShowBulkAccept))),a.getOrElse((()=>i.constTrue))))),e.behaviorToEffect((()=>a.some(T.nL.Effect.FocusBehavior.focusFirst))))],(0,r.fold)((0,r.getFunctionMonoid)(a.getFirstMonoid())())),e.getFirstApiAlignmentOverride=function(){const e=s.h.create(!0);return(t,n)=>{let r=n;return e.get()&&n===h.l$.api&&(r=h.l$.text),e.set(!1),r}},e.getShouldAutoFocus=(e,t,n)=>r=>e.get()&&(0,o.pipe)(r,T.nL.getActiveAlert(n),a.chain((({id:e})=>t.getById(e))),a.filter((0,l.Kg)((e=>"APPLIED"===e.state.type&&"ByCard"===e.state.method),h.bZ.isDuplicated)),a.isSome),e.getStateTransformer=(e,n,r,i,s,l,u)=>({state:p,metadata:h})=>{const m=t("AutoFocus.stateTransformer");if(!T.nL.hasCards(p)||!T.nL.hasItems(p))return m.trace("state has no items, returning original state"),d.left({state:p,metadata:h});const f=e(p);if(m.trace("effect: ",{state:p,metadata:h,effect:f}),a.isNone(f))return m.trace("no effect selected, returning original state"),d.left({state:p,metadata:h});if(l(f.value),f.value.kind===T.nL.Effect.FocusBehaviorType.unFocus||f.value.kind===T.nL.Effect.FocusBehaviorType.noFocus)return d.left({state:T.nL.Prism.getLensWithItems().modify(i.unselectItem(),p),metadata:h});const g=s(p);return m.trace("shouldAutoFocus",{alertSource:p.alertSource,shouldAutoFocus:g}),(0,o.pipe)(f,a.chain((e=>{switch(e.kind){case T.nL.Effect.FocusBehaviorType.noFocus:case T.nL.Effect.FocusBehaviorType.unFocus:return a.none;case T.nL.Effect.FocusBehaviorType.focusFirst:return(0,o.pipe)(i.findFirstAlert(p.currentLens),a.map((e=>Object.assign(Object.assign({},e),{lensId:p.currentLens.id}))));case T.nL.Effect.FocusBehaviorType.focusNext:return n(p);case T.nL.Effect.FocusBehaviorType.focusAlert:return a.some(Object.assign(Object.assign({},e.alertHighlight),{lensId:p.currentLens.id}));default:(0,c.vE)(e)}})),a.map((e=>((0,c.kG)(a.isSome(r.getRegistered(e.alert.id)),"lens alert should be in registered state",(()=>e.alert.toString())),e))),a.fold((()=>p.currentLens.kind===T._L.active?d.right(d.right({lensId:u.get(),alertSource:p.alertSource,options:{order:p.switchOrder,toFocus:T.nL.Effect.FocusBehavior.noFocus}})):d.left({state:p,metadata:h})),(({alert:e,highlightIndex:t,lensId:n})=>p.currentLens.meta.filter(e)?d.left(g?{state:T.nL.Prism.getLensWithItems().modify(i.selectItemByAlert({alert:e,highlightIndex:t},[]),p),metadata:{sourceId:"LSM.updateActiveState"}}:{state:p,metadata:h}):d.right(g?d.left({alertHighlight:{alert:e,highlightIndex:t},alertSource:p.alertSource,options:{lensId:n,order:p.switchOrder,toFocus:T.nL.Effect.FocusBehavior.focusFirst}}):d.right({lensId:n,alertSource:p.alertSource,options:{order:p.switchOrder,toFocus:T.nL.Effect.FocusBehavior.noFocus}})))))}}(D||(D={}))},20291:(e,t,n)=>{if(n.d(t,{R7:()=>v,XU:()=>b}),3075==n.j)var r=n(40327);var i=n(5114),o=n(66896),s=n(15646),a=n(48521),c=n(98403),l=n(77176);if(3075==n.j)var u=n(66310);if(3075==n.j)var d=n(85985);if(3075==n.j)var p=n(2834);if(3075==n.j)var h=n(24209);if(3075==n.j)var m=n(598);if(3075==n.j)var f=n(83401);var g=n(35416),y=n(99116);const _={cardsBeyondViewport:5,cardsAroundActive:100},v=(e,t,n,r,u=_,d=c.b2.rafScheduler)=>{const p=e=>!e.positionState.visible&&a.o.isAnimatable(e)&&e.visualState.incomplete?(r.next({type:s.eI.Kind.completeTransitionTo,id:e.id,transitionId:e.visualState.transitionId}),n.completeTransition(e.visualState.transitionId)(e)):e,h=e.pipe(l.U(g.nL.mapper((({currentLens:e,alertSource:t})=>i.some({currentLens:e,alertSource:t}))))),m=(0,y.nM)(n)(h,t.viewport,t.scrollTop,t.paddingTop,d).pipe(l.U((({viewport:e,scrollTop:t,paddingTop:n})=>({viewport:e,scrollTop:t,paddingTop:n,completeTransition:p}))),l.U((0,y.GC)({cardsBeyondViewport:u.cardsBeyondViewport,cardsAroundActive:u.cardsAroundActive,changePosition:n})));return{id:"manageCardsVisibility",when:o.R.isWithAlertsId,what:g.nL.Effect.Applicator.create(m)}},b=(e,t,n)=>{const s=(0,r.pipe)(e,l.U(g.nL.mapper((({currentLens:e,alertSource:t})=>i.some({currentLens:e,alertSource:t})))),(0,y.SW)(n),u.w(c.b2.rafScheduler),d.h((e=>0!==e)),p.b((e=>t.moveCardsBy(e,"freezeActiveCardOnCardsListUpdate"))));return{id:"freezeActiveCardOnCardsListUpdate",when:o.R.isWithAlertsId,what:g.nL.Effect.Applicator.create(h.T(h.T(s).pipe(m.c(f.C))))}}},71841:(e,t,n)=>{n.d(t,{i$:()=>h,YA:()=>m});var r=n(57050),i=n(40327),o=n(5114),s=n(98403),a=n(55935),c=n(93508),l=n(19751),u=n(35416),d=n(74238),p=n(14990);const h=e=>s.Hl(e.scrollTop.pipe(a.T(1)),100,!0).pipe(c.O(!1),l.d({bufferSize:1,refCount:!0})),m=(e,t)=>{const n=new p.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,i.pipe)(e.view(u.nL.getLens).get(),o.chain((({items:e,cardsHeight:t})=>(0,i.pipe)(e.getAt(0),o.map((e=>{const i=(0,r.flow)(d.L.AbsTop.ISO.wrap,n.converters.absTopToViewportTop,n.converters.viewportToWindow)(e.positionState.absTop);return{top:i,bottom:d.r.FromWindowTop.ISO.modify(d.L.concatC(t))(i)}}))))))}},35607:(e,t,n)=>{n.d(t,{o:()=>g});var r=n(40327),i=n(38983),o=n(95195),s=n(8125),a=n(81531),c=n(32952),l=n(44586),u=n(43743),d=n(16118),p=n(77176),h=n(93508),m=n(2834),f=n(74238);class g{constructor(e){this._validateOffset=e,this._log=a.Monitoring.Logging.getLogger("CardsListScrollManager"),this.scrollTop=i.h.create(0),this.paddingTop=i.h.create(0),this.viewport=i.h.create({top:f.r.FromWindowTop.ISO.wrap(0),height:0}),this.scrollOffset=new c.xQ,this.moveCardsBy=(e,t)=>(this._log.debug(`Cards list moved by ${e}, from: ${t}`),this.scrollOffset.next(e),o.right(void 0)),this.moveCardsByAnimated=(e,t)=>(this._log.debug(`Cards list moved by ${e}, from: ${t}`),l.y.create((t=>(0,r.pipe)(this._validateOffset(e,this),o.fold((e=>(t.thrownError(e),s.ZT)),(()=>{const n=2*this.viewport.get().height,r=Math.abs(e)>n?(e>0?1:-1)*n:e,i=e-r,o=u.f.createAnimationObservable(0,r,200).pipe(d.G(),p.U((([e,t])=>t-e)),h.O(i),m.b((e=>this.scrollOffset.next(e)))).subscribe({error:e=>t.error(e),complete:()=>t.complete()});return()=>o.unsubscribe()}))))))}}},74238:(e,t,n)=>{n.d(t,{r:()=>r,L:()=>i});var r,i,o=n(73975),s=n(50479),a=n(64681);!function(e){let t;!function(e){e.ISO=(0,a.k4)()}(t=e.FromWindowTop||(e.FromWindowTop={}))}(r||(r={})),function(e){let t,n,r;!function(e){e.ISO=(0,a.k4)(),e.equals=(0,a.Eh)(o.eqNumber).equals}(t=e.FromViewportTop||(e.FromViewportTop={})),function(e){e.ISO=(0,a.k4)()}(n=e.AbsTop||(e.AbsTop={})),function(e){e.ISO=(0,a.k4)()}(r=e.CardTop||(e.CardTop={})),e.concatC=e=>t=>e+t;const i=e=>new s.aD(e);e.converters=function(t,n,r){const o=i(e.concatC(r)).get,s=i(e.concatC(-t)).get;return{windowToViewport:i(e.concatC(-n)).get,viewportToWindow:i(e.concatC(n)).get,cardTopToViewport:s,viewportToCardTop:i(e.concatC(t)).get,absTopToViewportTop:e=>s(o(e)),absTopToCardTop:o}}}(i||(i={}))},14990:(e,t,n)=>{n.d(t,{Db:()=>i});var r,i,o,s=n(73975),a=n(74238);!function(e){e.above="above",e.below="below",e.hidden="hidden"}(r||(r={})),function(e){e.Impl=class{constructor(e,t,n){this.scrollTop=e,this.viewport=t,this.converters=a.L.converters(e,a.r.FromWindowTop.ISO.unwrap(t.top),n)}}}(i||(i={})),function(e){const t=(0,s.getStructEq)({top:s.eqNumber,height:s.eqNumber});e.eqDimensionsTuple=(0,s.getTupleEq)(t,t)}(o||(o={}))},99116:(e,t,n)=>{if(n.d(t,{Bk:()=>S,v_:()=>A,SW:()=>C,Sd:()=>T,nM:()=>k,GC:()=>O}),3075==n.j)var r=n(17771);if(3075==n.j)var i=n(29909);var o=n(57050),s=n(40327),a=n(83078),c=n(5114),l=n(73975),u=n(89943),d=n(95983),p=n(77176);if(3075==n.j)var h=n(16118);var m=n(85985),f=n(28043),g=n(66310),y=n(98403),_=n(2844),v=n(16892),b=n(35416),E=n(25975),I=n(74238);const S=e=>t=>t.isCardsHeightValid&&(0,s.pipe)(b.In.getActiveItem(t),a.forAll((t=>!e.isScheduledToDispose(t)))),w=e=>t=>t.isCardsHeightValid&&(0,s.pipe)(b.In.getActiveItem(t),a.forAll((t=>!e.isScheduledToDispose(t))));function A({cardTop:e,cardHeight:t,viewportHeight:n,padding:r}){const i=I.L.FromViewportTop.ISO.unwrap(e),o=i+t;return t>n?i:i<0?t+r.before<n?i-r.before:i:o>n?t+r.after<n?o-n+r.after:o-n:i<r.before?t+r.after+r.before<n?i-r.before:t+r.after<n?i-r.after:r.before:n-o<r.after&&t+r.after<n?r.after-(n-o):0}const C=e=>t=>t.pipe(T(e),p.U(c.map((e=>e.currentLens))),h.G(),m.h((([e,t])=>(0,s.pipe)((0,o.tuple)(e,t),(0,o.tupled)(a.map2(((e,t)=>e.id===t.id&&(0,s.pipe)((0,o.tuple)(b.In.getActiveItem(e),e.cardIndex,b.In.getActiveItem(t),t.cardIndex),(0,o.tupled)(r.g(c.option)),c.map((([e,t,n,r])=>e.id===n.id&&t!==r)))))),c.getOrElse((()=>!1))))),p.U((0,o.flow)(i.Pd(c.chain(b.In.getActiveItem),c.chain(b.In.getActiveItem)),(0,o.tupled)(a.map2(((e,t)=>t.positionState.absTop-e.positionState.absTop))),c.getOrElse((()=>0))))),T=e=>t=>t.pipe(p.U(c.filter((({currentLens:t})=>w(e)(t))))),k=e=>(t,n,r,i,o)=>{const a=(e=>c.getEq(l.fromEquals(((t,n)=>{const r=b.In.getActiveItem(t),i=b.In.getActiveItem(n);return c.getEq(e.visualStateEq).equals(r,i)&&t.items.size===n.items.size&&u.compareInPairs(t.items.keys(),n.items.keys(),((e,t)=>e===t))}))))(e);return t.pipe(p.U(c.map((e=>e.currentLens.id))),f.x(l.eqStrict.equals),p.U(c.isSome),g.w(y.Ft(_.aj(n,r,i,T(e)(t).pipe(p.U(c.map((e=>e.currentLens))),f.x(a.equals),g.w(o))))),m.h((([t,n,r,i])=>(0,s.pipe)(i,c.exists(w(e))))),p.U((([e,t,n])=>({viewport:e,scrollTop:t,paddingTop:n}))))},O=({cardsBeyondViewport:e,cardsAroundActive:t,changePosition:n})=>({viewport:r,scrollTop:i,paddingTop:l,completeTransition:u})=>p=>{const h=p.currentLens,m=((e,t,n,r)=>e.size<2||Math.floor(t.height/Math.min(a.unsafeGet(e.getAt(0)).positionState.height,a.unsafeGet(e.getAt(1)).positionState.height))>=e.size?{from:0,to:e.size}:{from:Math.max(0,d.aW.lowerBound(e,(e=>e.positionState.absTop+e.positionState.height<n))-r),to:Math.min(e.size,d.aW.lowerBound(e,(e=>e.positionState.absTop<n+t.height))+r)})(h.items,r,i-l,e);let f=!1;const g=h.items.map(((e,r,i)=>{const a=(0,o.flow)((l=n,d=e.positionState.watched||(e=>m.from<=e&&m.to>e||(0,s.pipe)(h.cardIndex,c.exists((n=>e>=n-t&&e<=n+t))))(i),e=>e.positionState.visible!==d?l.changePosition(v.s.PositionState.changeVisible(e.positionState,d))(e):e),(e=>t=>!t.positionState.visible&&t.positionState.animationInProgress?e.changePosition(v.s.PositionState.changeAnimationInProgress(t.positionState,!1))(t):t)(n),u)(e);var l,d;return a!==e?(f=!0,a):e}));return f?b.nL.Prism.getLens().compose(E.v.Prism.items).set(g,p):p}},33806:(e,t,n)=>{n.d(t,{c:()=>i,E:()=>o});var r=n(86775);class i{constructor(e,t,n,r,i,o){this._checklistItemFactory=e,this._checklistItems=t,this._alertsReader=n,this._lensPredicate=r,this._inner=i,this._itemEq=o}create(e,t){return this._lensPredicate(t)?r.G.create(this._checklistItemFactory,this._checklistItems.get(),this._alertsReader,e,t,this._itemEq):this._inner.create(e,t)}}const o=(e,t,n,i,o,s)=>a=>i(a)?r.G.getAlertsHandler(e,t,n,s):o(a)},11245:(e,t,n)=>{n.d(t,{U:()=>b});var r=n(17889),i=n(40327),o=n(5114),s=n(22232),a=n(40018),c=n(17594),l=n(84313),u=n(55567),d=n(91549),p=n(20594),h=n(48521),m=n(75316),f=n(69345),g=n(40966),y=n(76974),_=n(70100),v=n(47306);function b(e,t,n,v){const b=p.Mq.getCardSelections(t),S=e=>t=>Object.assign(Object.assign({},t),{positionState:e}),w=e=>t=>Object.assign(Object.assign({},t),{visualState:e}),A=p.Mq.getTransitionTo(w,S),C=(e,t,r)=>i=>{const o=m.C.getAlertByIndex(r,e),s=c.$.isApplicableAlert(o)?p.Mq.getApplicableCardMeta(o,i.visualState,n):u.n.empty(void 0);return Object.assign(Object.assign({},i),{meta:s,alerts:e,activeAlert:o,removedAlertsIds:t,activeAlertIndex:r})},T=e=>t=>Object.assign(Object.assign({},t),{cachedTransform:e,transform:(0,i.pipe)(e,o.map((e=>e.labels)))}),k=t=>p.Mq.getCardHydrator((e=>e.cachedTransform),l.X.canHydrate,T,e)(t),O=p.Mq.getSelectByAlert(C,(e=>t=>Object.assign(Object.assign({},t),{userInput:e})),w,S,(e=>t=>Object.assign(Object.assign({},t),{meta:e})),k,t,n),N=p.Mq.getSelectFirstAlert(O),M=p.Mq.getSelectNextAlert(p.Mq.getCardSelections(t),O),x=p.Mq.getUnselectItem(w,S),R=p.Mq.getRemove(C,A),L=p.Mq.getChangeVisualState(w,k),D=e=>p.Mq.getCreate(I(e),o.none,L,(()=>y.of(o.none)),n),P=(e,t)=>p.Mq.getCreate(E(e,t),o.none,L,(()=>y.of(o.none)),n),U=(e,t,r,s,a)=>{const c=_.X.create(e,t,r,f.Z.empty,g.t.initial({type:"rendered",clockwise:!0},!1),p.IG.toCardRenderOptions(n,s,y.of(o.none)));return(0,i.pipe)(a,o.fold((()=>c),(e=>_.X.changeVisualState(e)(c))))};return Object.assign({changePositionState:S,changeVisualState:w,completeTransition:e=>t=>w(h.o.VisualState.complete(t.visualState,e))(t),transitionTo:A,selectByAlert:O,selectFirstAlert:N,selectNextAlert:M,unselect:x,removeAlerts:R,updateWith:e=>t=>{(0,s.kG)(e.every((e=>a.bZ.isRegistered(e))),"cannot add non registered alerts");const n=new Set(e.map((e=>e.id))),r=new Set(t.removedAlertsIds);n.forEach((e=>{r.delete(e)}));const o=t.alerts.filter((e=>!n.has(e.id))).concat(e.map(c.$.fromModel)).sort(v.compare);return(0,i.pipe)(t,C(o,r,m.C.getIndexByAlert(t.activeAlert.id,o)),k)},updateMeta:e=>t=>Object.assign(Object.assign({},t),{itemMeta:e}),createDefault:U,createWithAlerts:(e,t,n,r,o,s,a,c)=>(0,i.pipe)(c?P(t,d.R.getAlertOutcomeBundle(n[0])):D(t),(t=>t(e,n,r,0,o,s,a,v))),createRenderedDefault:(e,t,n,r)=>U(t,n,r,e,o.some(g.t.initial({type:"rendered",clockwise:!0},!1))),createRenderedSingle:(e,t,r,i)=>{const s=h.o.VisualState.initial({type:"rendered",clockwise:!0},!1);return D(r)(t,[i],0,0,p.Mq.getApplicableCardMeta(i,s,n),e,o.some(s),v)},createRenderedBundle:(e,t,r,i,s)=>{const a=h.o.VisualState.initial({type:"rendered",clockwise:!0},!1);return P(r,i)(t,s,0,0,p.Mq.getApplicableCardMeta(s[0],a,n),e,o.some(a),v)},createFocusedDefault:(e,t,n,r)=>U(t,n,r,e,o.some(g.t.initial({type:"focused",clockwise:!0},!0))),createFocusedSingle:(e,t,r,i)=>{const s=h.o.VisualState.initial({type:"focused",clockwise:!0},!0);return D(r)(t,[i],0,0,p.Mq.getApplicableCardMeta(i,s,n),e,o.some(s),v)},createFocusedBundle:(e,t,s,a,c,l)=>(0,i.pipe)(l,o.fold((()=>(0,i.pipe)(c,r.DY(v),(e=>({alerts:e,activeAlertIdx:0})))),(e=>({alerts:c,activeAlertIdx:e}))),(r=>{const i=h.o.VisualState.initial({type:"focused",clockwise:!0},!0);return P(s,a)(t,r.alerts,r.activeAlertIdx,0,p.Mq.getApplicableCardMeta(r.alerts[r.activeAlertIdx],i,n),e,o.some(i),v)}))},b)}const E=(e,t)=>(n,r)=>Object.assign(Object.assign({},S("bundle",e,n,r)),{bundleInfo:t,viewKind:"bundle"}),I=e=>(t,n)=>Object.assign(Object.assign({},S("single",e,t,n)),{viewKind:"single"}),S=(e,t,n,r)=>{const i=new u.n.Impl(r.meta.percentile,r.meta.explanation,r.meta.checking,r.meta.ranges,r.meta.showMuteQuotedAdvice);return v.J.create(n,e,t,r.alerts,r.activeAlertIndex,r.activeHighlightIndex,r.positionState,r.visualState,i,r.lensId,r.renderOptions,r.muteCategory,r.order,r.initialAlertId,r.removedAlertsIds,r.cachedTransform,r.userInput,r.synfonySelection)}},73841:(e,t,n)=>{n.d(t,{l:()=>x});var r=n(31542),i=n(11064),o=n(57050),s=n(40327),a=n(95195),c=n(5114),l=n(22232),u=n(8125),d=n(81531),p=n(46680),h=n(66896),m=n(32952),f=n(77176),g=n(76974),y=n(95300),_=n(24209),v=n(66310),b=n(98403),E=n(69935),I=n(91224),S=n(41398),w=n(2834),A=n(28043),C=n(598),T=n(83401),k=n(17594),O=n(48521),N=n(35416),M=n(89770);class x{constructor(e,t,n,l,u,C,T){this._state=e,this._stateProvider=t,this._alertsReader=n,this._alertsService=l,this._stateSideEffects=u,this._getActiveAlert=C,this._stateTransformer=T,this.focusLens=(e,t,n={toFocus:N.Zz.defaultOptions.focusBehavior})=>{this._log.debug("focusLens "+e),this._switchLensActions.next({lensId:e,alertSource:t,options:n})},this.focusAlert=(e,t,n)=>{this._switchAlertActions.next({alertHighlight:e,alertSource:t,options:{order:n}})},this._log=d.Monitoring.Logging.getLogger("FocusedLensManagerImpl"),this._ts=d.Monitoring.TimeSeries.root.getMetric("lens_state.manager"),this._switchLensActions=new m.xQ,this._switchAlertActions=new m.xQ,this._addMetadata=e=>t=>t.pipe(f.U((t=>({source:t,metadata:e})))),this._focusLensEffect=({lensId:e,alertSource:t,options:{toFocus:n=N.Zz.defaultOptions.focusBehavior,order:r}})=>{if(this._log.debug("_focusLensEffect ",{alertSource:t,lensId:e}),h.R.isClosedId(e))return(0,s.pipe)(g.of(N.nL.Effect.Applicator.Source.override((0,M.T)())),this._addMetadata({sourceId:"LSM.focusLensEffect"}));if(h.R.isDraftAIId(e))return(0,s.pipe)(g.of(N.nL.Effect.Applicator.Source.override((0,M.zc)())),this._addMetadata({sourceId:"LSM.focusLensEffect"}));const i=this._state.get(),o=i.patch({switchOrder:r||i.switchOrder,alertSource:t});return(0,s.pipe)(this._stateProvider.getLensEventsByLensId(o,e,{focusBehavior:n}),this._addMetadata({sourceId:"LSM.focusLensEffect"}))},this._focusAlertEffect=({alertHighlight:e,alertSource:t,options:n})=>{this._log.isEnabled(p.LogLevel.TRACE)&&this._log.trace(`focusAlert(${e.alert})`);const r=this._state.get(),i=r.patch({switchOrder:n.order||r.switchOrder,alertSource:t});return(0,s.pipe)(this._stateProvider.getLensEventsByAlert(i,function(e,t,n){if(e===h.R.SpecialId.Priority||e===h.R.SpecialId.PredictionTakeaways||e===h.R.SpecialId.PredictionEmogenie||e===h.R.SpecialId.RealTimeProofit)return e;if(void 0!==n)return n;if(e===h.R.SpecialId.Closed||e===h.R.SpecialId.AllAlerts)return h.R.SpecialId.AllAlerts;return t}(r.currentLens.id,e.alert.lensId,n.lensId),e),this._addMetadata({sourceId:"LSM.focusAlertEffect"}))};const O=this._state.get(),x=this._stateTransformer,R=new y.X(O);this._effects=_.T(...this._stateSideEffects.map((({when:e,what:t,id:n})=>this._state.view("currentLens","id").view(e).pipe(v.w(b.Ft((0,s.pipe)(this._effectToApplicator(t),this._addMetadata({sourceId:n}))))))),_.T(this._switchAlertActions.pipe(f.U(this._focusAlertEffect)),this._switchLensActions.pipe(f.U(this._focusLensEffect))).pipe(E.B()));const L=this._ts.getTimer("batched.long_state_change");this._subs=[this._effects.pipe(I.K(((e,t)=>(this._log.error("Got error from effects: ",e),t))),S.M(R,(({source:e,metadata:t},n)=>({state:e(n),metadata:t}))),I.K(((e,t)=>(this._log.error("Got error while applying new state: ",e),t))),f.U(x),I.K(((e,t)=>(this._log.error("Got error while transforming state: ",e),t)))).subscribe((e=>(0,s.pipe)(e,a.fold((({state:e,metadata:t})=>{this._log.isEnabled(p.LogLevel.TRACE)&&this._log.trace(`lens state from: ${t.sourceId}`,e),(0,s.pipe)(this._checkState(e),a.fold((t=>this._log.error("incorrect state transition detected",{error:t,state:e})),(()=>R.next(e))))}),a.fold((e=>this._switchAlertActions.next(e)),(e=>this._switchLensActions.next(e))))))),(0,s.pipe)(R,f.U(N.nL.getActiveAlert(this._getActiveAlert)),w.b((e=>this._log.trace("active alert: ",e))),A.x(c.getEq(k.$.eq).equals),v.w(b.aI((e=>(0,s.pipe)(this._alertsService.takeReference(e,"activeCard"),a.mapLeft((e=>this._log.error("can not take alertRef",e))),a.fold(i.of(o.constVoid),(e=>e.dispose))))))).subscribe(),(0,s.pipe)(R,f.U((e=>{const t=performance.now();r.unstable_batchedUpdates((()=>{this._state.set(e)}));const n=performance.now()-t;n>16&&L.recordTime(n)}))).subscribe()],N.nL.hasCards(O)&&(0,s.pipe)(N.nL.getActiveAlertHighlight(this._getActiveAlert)(O),c.filter((e=>this._alertsReader.isRegistered(e.alert.id))),c.fold((()=>this._switchLensActions.next({lensId:O.currentLens.id,alertSource:O.alertSource,options:{order:O.switchOrder,toFocus:N.nL.Effect.FocusBehavior.noFocus}})),(e=>this._switchAlertActions.next({alertHighlight:e,alertSource:O.alertSource,options:{lensId:O.currentLens.id,order:O.switchOrder}}))))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_effectToApplicator(e){switch(e.type){case N.nL.Effect.Type.Applicator:case N.nL.Effect.Type.ItemsApplicator:return e.source;case N.nL.Effect.Type.SwitchLens:return e.source.pipe(w.b((e=>this._switchLensActions.next(e))),C.c(T.C));case N.nL.Effect.Type.SwitchAlert:return e.source.pipe(w.b((e=>this._switchAlertActions.next(e))),C.c(T.C));default:return(0,l.vE)(e)}}_checkState(e){try{if(N.nL.hasCards(e)){const t=e.currentLens.items.filter((0,u.W9)(O.o.isAnimatable,O.o.isFocused));(0,l.kG)(t.size<=1,"cannot have more than one focused card",(()=>JSON.stringify(t)))}}catch(e){return a.left(e)}return a.right(void 0)}}x.toLensAlert=({alert:e,highlightIndex:t})=>({alert:e,highlightIndex:t,lensId:e.lensId})},89770:(e,t,n)=>{n.d(t,{T:()=>x,zc:()=>R,oq:()=>L});var r=n(57050),i=n(40327),o=n(73975),s=n(22232),a=n(92843),c=n(5114),l=n(8125),u=n(83078),d=n(81531),p=n(46680),h=n(51374),m=n(40018),f=n(66896),g=n(4390),y=n(89772),_=n(76974),v=n(85985),b=n(28043),E=n(77176),I=n(24209),S=n(16118),w=n(2834),A=n(66310),C=n(93508),T=n(17594),k=n(35416),O=n(25975),N=n(93265);const M=(0,r.not)(m.bZ.isMuted),x=()=>k.nL.create({alertSource:m.l$.api,switchOrder:"lensOrder",currentLens:O.v.Closed.create(r.constFalse,o.fromEquals(r.constFalse))}),R=()=>k.nL.create({alertSource:m.l$.api,switchOrder:"lensOrder",currentLens:O.v.DraftAI.create()});class L{constructor(e,t,n,r,o,s,a,c,l,u=k.nL.FocusFirstFilter.defaultFilter){this._checkingState=e,this._alertsReader=t,this._lenses=n,this._positionManager=r,this._lensPreviewVM=o,this._lensViewFactory=s,this._alertsHandlerFactory=a,this._capabilities=c,this._alertsFilterService=l,this._focusFirstFilter=u,this._transformAlertsDiffToApplicator=e=>t=>n=>k.nL.hasItems(n)?n.patch({currentLens:e(t,M)(n.currentLens)}):n,this._log=d.Monitoring.Logging.getLogger("FocusedLensManagerImpl"),this._updateMetaSource=e=>t=>n=>e===n.currentLens.id&&k.nL.hasItems(n)?k.nL.Prism.getLensWithItems().modify(this._capabilities.updateMeta(t),n):n,this._lensAlerts=e=>{const t=this._alertsFilterService.alertVisibleInSidebar(e.id);return(0,i.pipe)(this._checkingState.get(),g.p.reduce([],((e,{alert:n})=>t(n)?[...e,n]:e)),(e=>e.sort(m.h$.ord.compare)))}}static _mapByActiveLensId(e,t,n,r){if(f.R.isOutcomeId(e))return r();switch(e){case f.R.SpecialId.Plagiarism:return t();case f.R.SpecialId.Premium:return n();case f.R.SpecialId.AllAlerts:case f.R.SpecialId.Priority:case f.R.SpecialId.PredictionTakeaways:case f.R.SpecialId.PredictionEmogenie:case f.R.SpecialId.RealTimeProofit:return r();default:return(0,s.vE)(e)}}_conditionedApplicator(e,t){return n=>r=>e(r,n)?t(n)(r):r}static _filterALEvents(e,t){return n=>_.of((0,i.pipe)(n,g.p.Diff.filter((t=>e(t.alert))),(e=>(t.isEnabled(p.LogLevel.TRACE)&&t.trace("diff after filter",e),e)))).pipe(v.h((0,r.not)(a.v.isEmpty)))}emptyState(e=f.R.SpecialId.AllAlerts){return k.nL.create({currentLens:this._createLens({lensId:e,initialLens:this._lensPreviewVM.getLens(e).get(),visibleAlerts:[],alertHighlight:c.none,alertSource:m.l$.api}),alertSource:m.l$.api,switchOrder:"lensOrder"})}getLensEventsByLensId(e,t,n={}){const r=this._getActiveLensMeta(t),o=this._lensAlerts(r),s=this._createState(e,c.none,r,t,o),a=n.focusBehavior?this._getAlertToFocus(n.focusBehavior,s):c.none;e.currentLens.id===t&&k.nL.hasItems(e)&&this._capabilities.getActiveAlertsCount(e.currentLens)!==o.length&&this._log.warn("Lens contains inconsistent number of alerts",r.id);const l=k.nL.hasItems(s)?(0,i.pipe)(a,c.fold((()=>s),(n=>this._createState(e,c.some(n),r,t,o)))):s;return this._generateEventsFromState(l,this._alertsHandlerFactory(t))}getLensEventsByAlert(e,t,n){(0,s.kG)(c.isSome(this._alertsReader.getById(n.alert.id)),"Can't focus non existing alert",n.alert.id);const r=this._getActiveLensMeta(t),i=e.currentLens.meta.id===t&&e.currentLens.meta.filter(n.alert)&&k.nL.hasItems(e)?k.nL.Prism.getLensWithItems().modify(this._capabilities.selectItemByAlert(n,[]),e):this._createState(e,c.some(n),r,t,this._lensAlerts(r));return this._generateEventsFromState(i,this._alertsHandlerFactory(t))}findClosestAlertHighlight(e,t){return(0,i.pipe)(this._positionManager.findClosestToPosition(e,(e=>h.P.is(e)&&h.x.isVisible(e)&&!h.x.isApplied(e)&&(0,i.pipe)(this._alertsReader.getRegistered(e.meta.alertId),c.exists((n=>this._alertsFilterService.alertCanBeDisplayed(n)&&t(n)&&n.getHighlightRanges().some((t=>t.meta.id===e.meta.id))))))),c.chain((e=>(0,i.pipe)(this._alertsReader.getRegistered(e.meta.alertId),c.map((t=>{const n={alert:T.$.fromModel(t),highlightIndex:t.getHighlightRanges().findIndex((t=>t.meta.id===e.meta.id))};return n.highlightIndex<0&&(this._log.error("findClosestAlertRange returned a range which doesn't exist in alert.highlightRanges",{alert:n.alert.toString(),range:JSON.stringify(e),positionManagerRanges:JSON.stringify(this._positionManager.findRanges((e=>h.P.is(e)&&e.meta.alertId===t.id))),hasPendingRanges:t.hasNewRangesForUpdate}),n.highlightIndex=0),n}))))))}findNextAlertInText({alert:e,highlightIndex:t},n){const r=e.getHighlightRanges();return(0,s.kG)(t<r.length,"AHI is out of highlightRanges length",`hr length: ${r.length}, ahi: ${t}`),this.findClosestAlertHighlight(r[t].end,n)}findNextAlertInTextByLens(e,t,n){return this.findNextAlertInText(e,this._alertsFilterService.alertVisibleInText(t,n))}findPremiumAlert(){return this._lensPreviewVM.getLens(f.R.SpecialId.Premium).get().count>0?(0,i.pipe)(this._checkingState.get(),g.p.find((0,r.flow)(m.bZ.fromAlertModel,(0,l.W9)(m.bZ.isRegistered,m.bZ.isPremium))),c.map((e=>({alert:T.$.fromModel(e.alert),highlightIndex:0})))):c.none}hasZeroFreeAlerts(e){return 0===this._lensPreviewVM.getLens(e.get()).get().priorityCount}_getMetaChangesObservable(e){return k.nL.hasItems(e)&&e.currentLens.kind===k._L.persistent?this._lensPreviewVM.getLens(e.currentLens.id).view(this._updateMetaSource(e.currentLens.id)):k.nL.hasItems(e)&&e.currentLens.type===k.Nm.lensview?this._lenses.pipe(b.x(y.w.eq.equals),E.U((0,r.flow)(y.w.lookup(e.currentLens.id),c.map(this._updateMetaSource(e.currentLens.id)),c.getOrElse((()=>k.nL.Effect.Applicator.Source.identity))))):k.nL.Effect.Applicator.Source.empty}_generateEventsFromState(e,t){return I.T(this._checkingState.pipe(S.G(),E.U((([e,t])=>g.p.diff(e,t))),w.b((e=>{this._log.isEnabled(p.LogLevel.TRACE)&&this._log.trace("new alerts diff",e)})),A.w(L._filterALEvents(e.currentLens.meta.filter,this._log)),E.U(this._conditionedApplicator(((e,t)=>{const n=this._alertsFilterService.getLensesFilter(e.currentLens.id),o=(0,i.pipe)(t,g.p.Diff.filter((0,r.not)((({alert:e})=>n(e)))));return a.v.isEmpty(o)||this._log.info("tried to send event with alerts that do not fit current lens, skipping",{diff:g.p.Diff.show.show(o)}),a.v.isEmpty(o)}),this._transformAlertsDiffToApplicator(t)))),this._getMetaChangesObservable(e)).pipe(C.O(k.nL.Effect.Applicator.Source.override(e)))}_getActiveLensMeta(e){const t=L._mapByActiveLensId(e,(()=>this._lensPreviewVM.getLens(f.R.SpecialId.Plagiarism).get()),(()=>this._lensPreviewVM.getLens(f.R.SpecialId.Premium).get()),(()=>this._lensPreviewVM.getLens(e).get()));return(0,s.kG)(void 0!==t,`unknown lensId:${e}`),t}_createState({alertSource:e,switchOrder:t},n,r,o,a){(0,s.kG)(u.forAll((({alert:e})=>c.isSome(this._alertsReader.getInteractable(e.id))))(n),"we can create state only with alert in registered state",(()=>(0,i.pipe)(n,c.fold((()=>"null"),(e=>e.toString())))));const l=this._createLens({lensId:o,initialLens:r,visibleAlerts:a,alertHighlight:n,alertSource:e});return k.nL.create({currentLens:l,alertSource:e,switchOrder:t})}_createLens(e){const t=this._focusFirstFilter(e);return N.v.createWithInitialAlerts(this._lensViewFactory,this._alertsHandlerFactory,this._alertsFilterService,M,this._capabilities)(e.lensId,e.initialLens,e.visibleAlerts,t)}_getAlertToFocus(e,t){switch(e.kind){case k.nL.Effect.FocusBehaviorType.noFocus:case k.nL.Effect.FocusBehaviorType.unFocus:return c.none;case k.nL.Effect.FocusBehaviorType.focusFirst:return k.nL.hasItems(t)?this._capabilities.findFirstAlert(t.currentLens):c.none;case k.nL.Effect.FocusBehaviorType.focusNext:return k.nL.hasItems(t)?this._capabilities.findNextAlert(t.currentLens):c.none;case k.nL.Effect.FocusBehaviorType.focusAlert:return c.some(e.alertHighlight);default:(0,s.vE)(e)}}}},39920:(e,t,n)=>{n.d(t,{is:()=>c,kn:()=>l,ad:()=>u,gi:()=>d});var r,i=n(22232),o=n(66896),s=n(35416),a=n(25975);!function(e){e.compose=function(e){return t=>s.CX.compose(e.map((e=>e(t))))},e.map=function(e,t){return n=>t(e(n))}}(r||(r={}));const c=(e,t)=>n=>{if(o.R.isOutcomeId(n))return a.v.WithSuccess.getAlertHandler(e,t);switch(n){case o.R.SpecialId.Premium:return a.v.Premium.getAlertsHandler(e,t);case o.R.SpecialId.AllAlerts:case o.R.SpecialId.Priority:case o.R.SpecialId.PredictionTakeaways:case o.R.SpecialId.PredictionEmogenie:case o.R.SpecialId.RealTimeProofit:return a.v.WithSuccess.getAlertHandler(e,t);default:return(0,i.vE)(n)}},l=(e,t,n,r,i)=>o=>n(o)?a.v.WithBundles.getAlertsHandler(e,t,i):r(o);class u{constructor(e,t,n,r){this._lensPredicate=e,this._inner=t,this._itemEq=n,this._itemOrd=r}create(e,t){return this._lensPredicate(t)?a.v.WithBundles.create(e,t,this._itemEq,this._itemOrd):this._inner.create(e,t)}}class d{constructor(e,t){this._itemEq=e,this._itemOrd=t}create(e,t){const n=()=>a.v.WithSuccess.create(e,t,this._itemEq,this._itemOrd);if(o.R.isOutcomeId(e))return n();switch(e){case o.R.SpecialId.Premium:return a.v.Premium.create(t,this._itemEq,this._itemOrd);case o.R.SpecialId.AllAlerts:case o.R.SpecialId.Priority:case o.R.SpecialId.PredictionTakeaways:case o.R.SpecialId.PredictionEmogenie:case o.R.SpecialId.RealTimeProofit:return n();default:return(0,i.vE)(e)}}}},88772:(e,t,n)=>{n.d(t,{t:()=>r});var r,i=n(95195),o=n(35416);!function(e){e.nothing=i.left,e.liftLensState=function(e){return t=>i.left(Object.assign(Object.assign({},t),{state:e(t.state)}))},e.liftWithItemsState=function(e){return t=>i.left(Object.assign(Object.assign({},t),{state:o.nL.hasItems(t.state)?o.nL.Prism.getLensWithItems().modify(e,t.state):t.state}))},e.liftLensView=function(e){return t=>i.left(Object.assign(Object.assign({},t),{state:o.nL.hasCards(t.state)?o.nL.Prism.getLens().modify(e,t.state):t.state}))}}(r||(r={}))},74364:(e,t,n)=>{n.d(t,{EQ:()=>D,ay:()=>R,$A:()=>L});var r,i=n(57050),o=n(40327),s=n(8125),a=n(95574),c=n(22232),l=n(83078),u=n(5114),d=n(95195),p=n(40018),h=n(66896),m=n(98403),f=n(19751),g=n(60797),y=n(32952),_=n(28043),v=n(66310),b=n(40151),E=n(44586),I=n(78674),S=n(77176),w=n(93508),A=n(598),C=n(83401),T=n(2834),k=n(55935),O=n(85985),N=n(41398),M=n(73975),x=n(71249);!function(e){e.eq=(0,M.getStructEq)({alert:(0,M.contramap)((e=>e.id))(M.eqStrict),highlightIndex:M.eqStrict}),e.getEq=()=>e.eq,e.getHighlightRange=e=>x.lookup(e.highlightIndex)(e.alert.getHighlightRanges())}(r||(r={}));var R,L,D,P=n(35416);!function(e){let t;!function(e){e.AppliedAlertAnimationFinished="AppliedAlertAnimationFinished"}(t=e.Type||(e.Type={}))}(R||(R={})),function(e){e.Mock=class{constructor(){this.events=new y.xQ,this.focusAlertHighlight=()=>d.left(new Error("Method not implemented.")),this.highlightAlertHighlight=()=>d.left(new Error("Method not implemented.")),this.moveCursorToHighlight=s.ZT}ensureAlertHighlightInViewport(){throw new Error("Method not implemented.")}getMarkByAlert(e){throw new Error("Method not implemented.")}getAlertByMark(e){throw new Error("Method not implemented.")}},e.getHighlightIndex=function(e,t){return(0,o.pipe)(t,d.mapLeft((()=>new Error("Mark is collapsed"))),d.chain((t=>a.tryCatchError((()=>{const n=e.getHighlightRanges(),r=n.length>1?n.findIndex((e=>e.start===t.start&&e.end===t.end)):0;return(0,c.kG)(-1!==r,"Could not find highlight index by Range for provided Alert",(()=>JSON.stringify({alertRanges:n,targetRange:t}))),r})))))}}(L||(L={})),function(e){e.getHighlightSubscribtion=(e,t,n)=>e.pipe(_.x(u.getEq(p.h$.ord).equals),v.w((e=>(0,o.pipe)(e,u.fold((()=>b.E),(e=>E.y.create((()=>(n.debug(`highlight mark: ${e.id}`),(0,o.pipe)(t.highlightAlertHighlight(e),d.fold((t=>(n.error(`Cannot highlight mark: ${e.id}`,t),s.ZT)),(t=>()=>{n.debug(`unhighlight mark: ${e.id}`),t.dispose()})))))))))))),e.getHoverAlertHightlightSource=(e,t,n,r)=>(0,o.pipe)(r,I.b(100),S.U((0,i.flow)(u.chain((r=>{const i=e.get();return P.nL.hasCards(i)?i.currentLens.items.find((e=>(0,o.pipe)(t.hasActiveAlert(e),u.exists((t=>e.id===r&&n.isRegistered(t.id)))))):u.none})),u.chain((({value:e})=>t.hasActiveAlert(e))))),_.x(u.getEq(p.h$.ord).equals),S.U(u.map((t=>({alert:t,highlightIndex:0,source:e.get().alertSource})))),w.O(u.none)),e.highlightMarkByHighlightedCard=(t,n,r,s,a,c)=>{const l=e.getHighlightSubscribtion(t.hovered.pipe(I.b(100),S.U((0,i.flow)(u.chain((e=>{const t=n.get();return P.nL.hasCards(t)?t.currentLens.items.find((t=>(0,o.pipe)(a.hasActiveAlert(t),u.exists((n=>t.id===e&&s.isRegistered(n.id)))))):u.none})),u.chain((({value:e})=>a.hasActiveAlert(e)))))),r,c);return{id:"highlightMarkByHighlightedAlert",when:h.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(l.pipe(A.c(C.C)))}},e.getAlertHighlightSource=e=>t=>(0,o.pipe)(t,_.x(u.getEq(p.h$.ord).equals),S.U(u.map((t=>({alert:t,source:e,highlightIndex:0})))),w.O(u.none)),e.getActiveHighlightSource=(e,t,n)=>e.view(P.nL.mapper((({currentLens:e,alertSource:t})=>(0,o.pipe)(n(e),u.map((e=>({alert:e.activeAlert,source:t,highlightIndex:e.activeHighlightIndex}))))))).pipe(v.w(m.b2.rafScheduler),f.$f(u.getEq(r.getEq())),S.U(u.filter((e=>u.isSome(t.getRegistered(e.alert.id)))))),e.focusMarkByActiveAlert=(t,n,r,i,a)=>{const c=(0,o.pipe)(e.getActiveHighlightSource(t,r,i),T.b(l.tap((e=>a.trace("new alert highlight: ",e)))),v.w(u.fold((()=>(a.debug("Nothing to focus"),b.E)),(e=>E.y.create((()=>(a.debug(`Focus mark: ${e.alert.id} | ${e.highlightIndex}`),e.source===p.l$.sidebar&&n.moveCursorToHighlight(e,"start"),(0,o.pipe)(n.focusAlertHighlight(e),d.fold((t=>(a.error("Cannot focus mark",t,{alertId:e.alert.id,highlightIndex:e.highlightIndex}),s.ZT)),(t=>()=>{a.debug(`Unfocus mark: ${e.alert.id} | ${e.highlightIndex}'`),t.dispose()}))))))))));return{id:"focusMarkByActiveAlert",when:h.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(c.pipe(A.c(C.C)))}},e.focusAlertByClickedMark=(e,t)=>({id:"focusAlertByActiveMark",when:P.nL.Effect.When.isSidebarOpen,what:P.nL.Effect.SwitchAlert.create(e.alertClicked.pipe(k.T(1),g.oA,O.h((e=>p.bZ.State.isRegistered(e.alert.state))),N.M(t.pipe(O.h(P.nL.hasCards)),((e,t)=>e)),S.U((({alert:e,highlightIndex:t})=>({alertHighlight:{alert:e,highlightIndex:t},alertSource:p.l$.text,options:{order:"textOrder"}})))))}),e.createOnAlertApplySideEffect=function(e,t){const n=e.pipe(S.U((e=>n=>e.type===R.Type.AppliedAlertAnimationFinished&&n.currentLens.meta.filter(e.alert)&&p.bZ.isApplicableAlert(e.alert)&&P.nL.hasItems(n)?n.patch({currentLens:t.finishApplyAnimation([e.alert])(n.currentLens),alertSource:e.alert.state.source}):n)));return{id:"onAlertApply",when:P.nL.Effect.When.isSidebarOpen,what:P.nL.Effect.Applicator.create(n)}}}(D||(D={}))},64992:(e,t,n)=>{n.d(t,{x:()=>y,O:()=>_});var r=n(45701),i=n(18208),o=n(68983),s=n(66896),a=n(2291);function c(e){return`${e} ${i.pluralize(e,"alert","alerts")}`}const l=e=>(t,n,r,i,o)=>t?c(n.count):e(n,r,i,o),u=(e,t)=>(n,r,i,o)=>{const s=o?n.count:n.priorityCount;return s>0?c(s):i&y.IsDocumentEmpty?e:t},d={description:"Improves spelling, grammar, and punctuation.",stateMessage:l(u("No alerts","Looking good"))},p={description:"Helps make your writing easier to understand.",stateMessage:l(((e,t,n)=>{const i=(0,o.W)(r.lt(a.g.ord))(t);if(n&y.IsDocumentEmpty)return"So far so good";if(e.count>0){if(a.g.isMin(t))return c(e.count);if(i(a.g.fromNumber(20)))return"Unclear";if(i(a.g.fromNumber(70)))return"A bit unclear";if(i(a.g.fromNumber(85)))return"Mostly clear";if(i(a.g.fromNumber(95)))return"Clear"}return"Very clear"}))},h={description:"Helps make your writing more interesting and effective.",stateMessage:l(((e,t,n)=>{const i=n&y.IsFreeUser,s=a.g.isMin(t),l=(0,o.W)(r.lt(a.g.ord))(t);if(n&y.IsDocumentEmpty||i&&s)return"Nothing yet";if(i||e.count>0){if(s)return c(e.count);if(l(a.g.fromNumber(20)))return"Bland";if(l(a.g.fromNumber(80)))return"A bit bland";if(l(a.g.fromNumber(95)))return"Engaging"}return"Very engaging"}))},m={description:"Helps you make the right impression on your reader.",stateMessage:l(((e,t,n)=>{const i=n&y.IsFreeUser,s=a.g.isMin(t),l=(0,o.W)(r.lt(a.g.ord))(t);if(n&y.IsDocumentEmpty||i&&s)return"Nothing yet";if(i||e.count>0){if(s)return c(e.count);if(l(a.g.fromNumber(20)))return"Serious issues";if(l(a.g.fromNumber(40)))return"Very off";if(l(a.g.fromNumber(95)))return"Slightly off"}return"Just right"}))},f={description:"Your organization’s writing guidelines.",stateMessage:l(u("Nothing yet","All good"))},g={[s.R.SpecialId.Correctness]:d,[s.R.SpecialId.CorrectnessPriority]:d,[s.R.SpecialId.Clarity]:p,[s.R.SpecialId.ClarityPriority]:p,[s.R.SpecialId.Engagement]:h,[s.R.SpecialId.EngagementPriority]:h,[s.R.SpecialId.Delivery]:m,[s.R.SpecialId.DeliveryPriority]:m,[s.R.SpecialId.Vox]:f,[s.R.SpecialId.VoxPriority]:f,[s.R.SpecialId.Plagiarism]:{description:"Checks for similarities to published writing.",stateMessage:l(((e,t,n)=>n&y.IsLensVisited&&!(n&y.IsDocumentEmpty)?n&y.IsLensActive?a.g.isMin(t)?"100% original":`${t}% unoriginal`:"Recheck":"Not checked yet"))},[s.R.SpecialId.Premium]:{description:"Offers more suggestions on how to improve your writing.",stateMessage:l(((e,t,n)=>n&y.IsDocumentEmpty?"Advanced checks":`${e.count} more ${i.pluralize(e.count,"alert","alerts")}`))}};var y;function _(e){return g[e]}!function(e){e[e.IsDocumentEmpty=1]="IsDocumentEmpty",e[e.IsLensActive=2]="IsLensActive",e[e.IsLensVisited=4]="IsLensVisited",e[e.IsFreeUser=8]="IsFreeUser"}(y||(y={}))},25970:(e,t,n)=>{n.d(t,{g:()=>a});var r,i=n(57050),o=n(5114),s=n(38983);!function(e){let t,n;!function(e){e[e.CHECKED=0]="CHECKED",e[e.NOT_CHECKED=1]="NOT_CHECKED"}(t=e.PlagiarismCheckingState||(e.PlagiarismCheckingState={})),function(e){e.Mock=class{constructor(){this.downloadStarted=s.h.create(!1),this.beginDownload=i.constVoid,this.tryToInterrupt=i.constVoid,this.generateReport=()=>{throw new Error("Method not implemented.")},this.reportData=s.h.create(o.none),this.dedHTML="",this.dispose=i.constVoid}}}(n=e.ViewModel||(e.ViewModel={}))}(r||(r={}));var a,c=n(76974);!function(e){let t,n;!function(e){let t;!function(e){e[e.ERROR=0]="ERROR",e[e.EMPTY=1]="EMPTY",e[e.LOADING=2]="LOADING",e[e.SHORT_CONTENT=3]="SHORT_CONTENT",e[e.READY=4]="READY"}(t=e.Type||(e.Type={}))}(t=e.State||(e.State={})),function(e){e.Mock=class{constructor(e={type:t.Type.EMPTY},n=o.some(new r.ViewModel.Mock)){this.statisticsState=e,this.reportViewModel=n,this.state=c.of(this.statisticsState),this.onModalClose=i.constVoid}}}(n=e.ViewModel||(e.ViewModel={}))}(a||(a={}))},27125:(e,t,n)=>{if(n.d(t,{L:()=>S,g:()=>i}),3075==n.j)var r=n(40327);var i,o=n(38983);if(3075==n.j)var s=n(84966);if(3075==n.j)var a=n(5114);if(3075==n.j)var c=n(66896);if(3075==n.j)var l=n(35416);if(3075==n.j)var u=n(32952);if(3075==n.j)var d=n(85985);if(3075==n.j)var p=n(77176);if(3075==n.j)var h=n(66310);if(3075==n.j)var m=n(98403);if(3075==n.j)var f=n(93508);if(3075==n.j)var g=n(16118);if(3075==n.j)var y=n(76974);if(3075==n.j)var _=n(50628);if(3075==n.j)var v=n(17343);if(3075==n.j)var b=n(60797);if(3075==n.j)var E=n(2834);if(3075==n.j)var I=n(25975);class S{constructor(e,t,n,y,_,v,b,E=I.v.WithSuccess.State.isInSuccess(y),S){this._state=e,this._documentModel=t,this._trackSuccessStateChanged=n,this._capabilities=y,this.nonPriorityOptions=_,this.mutedAlertsOptions=v,this.hasNonPriorityAlerts=b,this.isInSuccess=E,this._withBirthday=S,this._getTextAmount=e=>0===e?i.TextAmount.zero:e<=s.hD?i.TextAmount.small:i.TextAmount.large,this._subs=[],this.textAmount=o.h.create(this._getTextAmount(this._documentModel.documentLength.get().trimmed)),this.actionEvents=new u.xQ,this.applicatorEffects={id:"successViewModel.effects",when:c.R.isWithAlertsId,what:l.nL.Effect.Applicator.create(this.actionEvents.pipe(d.h((({type:e})=>e===i.ActionType.More)),p.U((()=>e=>{const t=e.patch({currentLens:l.nL.hasItems(e)&&(0,l.yi)(e.currentLens)?this._capabilities.toggleNonPriorityList("expanded")(e.currentLens):e.currentLens});return(0,r.pipe)(l.nL.hasItems(t)?this._capabilities.findFirstAlert(t.currentLens):a.none,a.fold((()=>t),(e=>t.patch({currentLens:l.nL.hasItems(t)?this._capabilities.selectItemByAlert(e,[])(t.currentLens):t.currentLens}))))}))))},this._currentLens=this._state.view((e=>({isSuccess:this.isInSuccess(e),type:e.currentLens.type,nonPriorityAlertsLeft:l.nL.isLensview(e)&&l.nL.hasItems(e)&&0!==this._capabilities.getActiveAlertsCount(e.currentLens),isAllAlerts:c.R.isMainLens(e.currentLens.id)}))),this._listenTextSize=()=>this._currentLens.view((e=>e.isSuccess)).pipe(h.w(m.Ft(this._documentModel.documentLength.view("trimmed"))),p.U(this._getTextAmount)).subscribe(m.wW(this.textAmount)),this._lensSwitch=this._currentLens.pipe(f.O(this._currentLens.get()),g.G(),p.U((([e,t])=>t.isSuccess?a.some({prevLensType:e.type,nonPriorityAlertsLeft:t.nonPriorityAlertsLeft,isAllAlerts:t.isAllAlerts}):a.none))),this._textAmountToSuccessType=e=>e===i.TextAmount.zero?{type:i.SuccessType.zero,showBirthday:this._withBirthday.get()}:e===i.TextAmount.large?{type:i.SuccessType.large}:{type:i.SuccessType.small},this.successState=o.h.create({type:i.SuccessType.zero,showBirthday:this._withBirthday.get()}),this._subs.push(this._listenTextSize(),this._listenSuccessStateChange()),this.priorityList=(0,r.pipe)(_,a.map((e=>({hasNonPriorityAlerts:this._state.view(b),reviewNonPriorityAlerts:()=>{e.trackNonPriorityToggle(),this.actionEvents.next({type:i.ActionType.More})}})))),this.mutedAlerts=(0,r.pipe)(v,a.map((()=>({reviewMutedSuggestions:()=>{},mutedSuggestionsCount:this._state.view((e=>e.currentLens.meta.mutedCount))}))))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_listenSuccessStateChange(){const e=e=>e.type===i.SuccessType.applied||e.type===i.SuccessType.zero?y.of(e):this._documentModel.checkingState.pipe(d.h((e=>"checking"!==e)),_.P(),v.h(e));return this._lensSwitch.pipe(b.cp((t=>this.textAmount.pipe(p.U(this._textAmountToSuccessType),f.O(t.prevLensType===l.Nm.lensview?{type:i.SuccessType.applied,nonPriorityAlertsLeft:t.nonPriorityAlertsLeft,isAllAlerts:t.isAllAlerts}:this._textAmountToSuccessType(this.textAmount.get())),g.G(),p.U((([e,t])=>e.type===i.SuccessType.applied&&t.type!==i.SuccessType.zero?e:t)),h.w(((t,n)=>0===n?y.of(t):e(t))),E.b((e=>{this._trackSuccessStateChanged(e.type===i.SuccessType.applied?"applied":e.type===i.SuccessType.zero?"nothingToCheck":"noIssues")})))))).subscribe(m.wW(this.successState))}}!function(e){let t,n,r;!function(e){e.More="More"}(t=e.ActionType||(e.ActionType={})),function(e){e.zero="zero",e.small="small",e.large="large"}(n=e.TextAmount||(e.TextAmount={})),function(e){e.zero="zero",e.small="small",e.large="large",e.applied="applied",e.premiumOnboardingStart="premiumOnboardingStart",e.premiumOnboardingComplete="premiumOnboardingComplete"}(r=e.SuccessType||(e.SuccessType={}));e.Mock=class{constructor(){this.textAmount=o.h.create(n.zero),this.successState=o.h.create({type:r.zero,showBirthday:!1}),this.mutedSuggestionsCount=o.h.create(0),this.hasNonPriorityAlerts=o.h.create(!1)}reviewMutedSuggestions(){throw new Error("Method not implemented.")}reviewNonPriorityAlerts(){throw new Error("Method not implemented.")}dispose(){throw new Error("Method not implemented.")}}}(i||(i={}))},18955:(e,t,n)=>{n.d(t,{d:()=>T});var r=n(27378),i=n(5739),o=n(38983),s=n(5114),a=n(19962),c=n(81531),l=n(46680),u=n(74238),d=n(45586),p=n(77176),h=n(24209),m=n(18625),f=n(66310),g=n(40151),y=n(85089),_=n(2834),v=n(49708),b=n(93508),E=n(17343),I=n(98403),S=n(76974),w=n(19751),A=n(67434),C=n(57091);class T extends r.Component{constructor(){super(...arguments),this._log=c.Monitoring.Logging.getLogger("CardsListConnectorView",l.LogLevel.DEBUG),this._subs=new d.w.Keeper}componentDidMount(){this.props.isMaster&&this._setMaster()}componentDidUpdate(e){const t=this.props.name;this._log.debug("lensview did update",{wasMaster:e.isMaster,nowMaster:this.props.isMaster,name:t}),this.props.isMaster?!1===e.isMaster?(this._log.info("reuse released view",t),this.forceUpdate((()=>{this._setMaster(),this._log.trace("view force update complete",t)}))):(this._log.trace("set master view",t),this._setMaster()):(this._log.trace("release master view",t),this._clearSubs())}componentWillUnmount(){this._clearSubs()}render(){const{className:e,children:t,height:n}=this.props;return r.createElement(i.F.div,{"data-purpose":"card-list-connector",style:n.pipe(p.U((e=>({height:e})))),className:e},t)}_setMaster(){this._setSubs()}_setSubs(){this._clearSubs(),this._subs.push(this.props.stateSyncListener.subscribe())}_clearSubs(){this._subs.dispose()}}!function(e){let t;!function(e){e.create=()=>o.h.create({scrollProvider:s.none,scrollConsumer:s.none,viewport:s.none,title:s.none})}(t=e.Elements||(e.Elements={})),e.boundedScrollListener=(e,t)=>h.T(m.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(f.w(s.fold((()=>g.E),(e=>y.YC(e).pipe(p.U((t=>Object.assign(Object.assign({},t),{top:e.offsetTop,height:e.offsetHeight}))))))),_.b((t=>e.viewport.set({top:u.r.FromWindowTop.ISO.wrap(t.top),height:t.height})))),t.view("scrollProvider").pipe(f.w(s.fold((()=>g.E),(t=>v.R(t,"scroll").pipe(p.U((()=>t.scrollTop)),b.O(t.scrollTop),_.b((t=>e.scrollTop.set(t))),E.h(I.PU)))))),t.view("title").pipe(f.w(s.fold((()=>S.of(a.Rect.empty)),(e=>y.YC(e)))),p.U((e=>e.height)),w.d({bufferSize:1,refCount:!0}),_.b((t=>e.paddingTop.set(t)))),t.view("scrollConsumer").pipe(f.w(s.fold((()=>g.E),(t=>e.scrollOffset.pipe(_.b((e=>{t.scrollTop+=e})))))))).pipe(E.h(void 0)),e.superScrollListener=(e,t)=>{const n=t.view("title").pipe(f.w(s.fold((()=>S.of(a.Rect.empty)),(e=>y.YC(e)))),p.U((e=>e.height)),w.d({bufferSize:1,refCount:!0}));return h.T(m.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(f.w(s.fold((()=>g.E),(e=>y.YC(e).pipe(p.U((t=>Object.assign(Object.assign({},t),{top:e.offsetTop,height:e.offsetHeight}))))))),_.b((t=>e.viewport.set({top:u.r.FromWindowTop.ISO.wrap(t.top),height:t.height})))),t.view("scrollProvider").pipe(f.w(s.fold((()=>g.E),(t=>v.R(t,"scroll").pipe(p.U((()=>t.scrollTop)),b.O(t.scrollTop),_.b((t=>e.scrollTop.set(t))),E.h(I.PU)))))),t.view("scrollConsumer").pipe(f.w(s.fold((()=>g.E),(t=>e.scrollOffset.pipe(A.R(((e,t)=>e-t),0),_.b((e=>{t.style.transform=`translateY(${e}px)`})))))),C.a(n),_.b((([t,n])=>e.paddingTop.set(t+n))))).pipe(E.h(void 0))}}(T||(T={}))},4948:(e,t,n)=>{n.d(t,{J:()=>c});var r=n(27378),i=n(44060),o=n(63969),s=n(40219);if(3075==n.j)var a=n(7046);const c=e=>r.createElement(a.zx.Animated,Object.assign({},(0,a.L_)(e,d.gray))),l={position:"relative",display:"inline-block",overflow:"hidden",outline:"none",border:0,verticalAlign:"middle",whiteSpace:"nowrap",cursor:"default",userSelect:"none",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{cursor:"pointer"}}},u={overflow:"hidden",padding:`0 ${o.u.rem(.5)}`,borderRadius:o.u.rem(s.fx),backgroundColor:i.Il.CoreNeutral60,color:i.Il.CoreNeutral0,textTransform:"none",letterSpacing:o.u.rem(i.xv.ButtonLetterSpacing),fontSize:o.u.rem(i.xv.ButtonSize),lineHeight:o.u.rem(i.xv.ButtonLineHeight),transitionDuration:o.u.seconds(.2),$nest:{"&[data-active='true'] > i[role='icon'] > svg, &:not([data-disabled='true']):hover > i[role='icon'] > svg, &:not([data-disabled='true'])[data-hovered='true'] > i[role='icon'] > svg":{fill:i.Il.CoreNeutral0},"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:i.Il.CoreNeutral50,color:i.Il.CoreNeutral0},"&:not([data-disabled='true'])[data-active='true']":{backgroundColor:i.Il.CoreNeutral50,color:i.Il.CoreNeutral0,$nest:{"&:hover":{backgroundColor:i.Il.CoreNeutral50,color:i.Il.CoreNeutral0}}},"&[data-disabled='true']":{backgroundColor:i.Il.CoreNeutral60,color:i.Il.CoreNeutral50},".groupSticky &":{padding:`0 ${o.u.rem(.5)}`,borderRight:`2px solid ${i.Il.CoreNeutral0}`,borderRadius:0,backgroundColor:i.Il.CoreNeutral20,$nest:{"&:first-child":{borderRadius:`${o.u.rem(s.fx)} 0 0 ${o.u.rem(s.fx)}`},"&:last-child":{borderRight:"none",borderRadius:`0 ${o.u.rem(s.fx)} ${o.u.rem(s.fx)} 0`}}}}},d=o.u.stylesheet({button:[l],gray:[l,u]})},30543:(e,t,n)=>{n.d(t,{s:()=>x});var r,i,o=n(27378),s=n(5739),a=n(22232),c=n(44060),l=n(35407),u=n(88056),d=n(76024),p=n(19429),h=n(59312),m=n(95195),f=n(69243),g=n(55485);!function(e){e.prod="prod",e.preprod="preprod",e.qa="qa",e.fb="fb",e.dev="dev"}(r||(r={})),function(e){e.american="american",e.british="british",e.canadian="canadian",e.australian="australian"}(i||(i={}));var y,_=f.keyof({".grammarly.com":null,".ppgr.io":null,".qagr.io":null}),v=(0,h.__spreadArrays)(Object.keys(_.keys),["grammarly.io","sumologic.com","microsoft.com","office.com","apple.com","google.com","mozilla.org","mozilla.net"]).map((function(e){return e.startsWith(".")?e.slice(1):e})),b=f.union([f.type({state:f.literal("disabled")}),f.type({state:f.literal("enabled")}),f.type({state:f.literal("test")})]),E=(f.type({version:f.string}),new f.Type("HttpString",f.string.is,(function(e,t){return m.either.chain(f.string.validate(e,t),(function(n){return/^(https?|wss?):\/\/(\w|\d|-|\/|\.|\?|\=|\_|\&)+(:(\d)+)?$/.test(n)?f.success(n):f.failure(e,t,"URL parsing failed ("+n+")")}))}),String)),I=new f.Type("MsStoreUrlString",f.string.is,(function(e,t){return m.either.chain(f.string.validate(e,t),(function(n){return/ms-windows-store:\/\/(\w|\d|-|\/|\.|\?|\=|\_|\&)+(:(\d)+)?$/.test(n)?f.success(n):f.failure(e,t,"Edge URL parsing failed ("+n+")")}))}),String),S=new f.Type("AllowedHttpString",E.is,(function(e,t){return m.either.chain(E.validate(e,t),(function(n){for(var r=n.split("//")[1].split("/")[0].split(":")[0],i=0,o=v;i<o.length;i++){var s=o[i];if(r.endsWith(s))return f.success(n)}var a="Domain ("+r+") is not allowed in "+v.join(", ");return f.failure(e,t,a)}))}),E.encode),w=f.keyof({TRACE:null,DEBUG:null,INFO:null,WARN:null,ERROR:null,FATAL:null,OFF:null}),A=(f.partial({env:g.D.createStringEnum(r,"Environment"),logLevel:w,accumulateCrashLogLevel:w,sendCrashOnLogLevel:w,collectLogs:f.boolean,collectCrashLogs:f.boolean,copyLogsToConsole:f.boolean,crashLogsCacheSize:f.number,debugLogsCacheSize:f.number,tracking:b,alertCache:f.partial({prefix:f.string,version:f.string}),mutedCategoriesCache:f.partial({prefix:f.string,version:f.string}),outcomeScoreCache:f.partial({prefix:f.string,version:f.string}),userSettingsPrefix:f.string,userSettingsVersion:f.string,defaultDialect:g.D.createStringEnum(i,"DialectEnum"),notificationShowTimeMs:f.number,maxNotificationsOnTheScreen:f.number,selfUpdate:f.partial({versionCheckInterval:f.number,selfUpdateDelay:f.number,canReloadCheckInterval:f.number,blockingModalAutoReloadDelay:f.number,retryFailedVersionCheckInterval:f.number,retryFailedVersionCheckLimit:f.number,debugBuildVersion:f.string,versionFilePath:f.string}),pingMaybeGnarDelay:f.number,domains:f.partial({cookie:_,localServer:f.string}),api:f.partial({analyticsUrl:S,authUrl:S,institutionUrl:S,snippetsUrl:S,clientControlsUrl:S,institutionAdminUrl:S,institutionAnalyticsUrl:S,institutionStyleGuideUrl:S,institutionGroupsUrl:S,institutionUserUrl:S,institutionSuggestionsUrl:S,institutionTonesUrl:S,tonesUrl:S,dapiUrl:S,doxUrl:S,irbisUrl:S,subscriptionUrl:S,discountUrl:S,capiWsUrl:S,capiApiUrl:S,gnarApi:f.partial({url:S}),felogUrl:S,felogDebugUrl:S,sumoUrl:S,crashLogUrl:S,onlineTestUrl:f.string,wsTest:S,proofitResultUrl:S,redirect:S,mailApiUrl:S,ssoUrl:S,scimUrl:S,workspaceUrl:S,voxWorkspaceUrl:S,voxInstitutionUrl:S,writingStylesUrl:S}),app:f.partial({nameWeb:f.string,nameDesktop:f.string}),urls:f.partial({free:f.string,account:S}),onlineEditor:f.partial({docId:S}),funnel:f.partial({base:S,resetPassword:S,accountDeleted:S,businessLanding:S,businessStyleguideLanding:S,businessUpgradeLanding:S,subscribe:S,upgrade:S,plans:S,signin:S,socialSignin:S,signup:S,mainPage:S,deleteSocialAccount:S,subscriptionCancellationSurvey:S,keyboardInstall:S,desktopAppInstall:S,claimedUserJoinFallback:S}),officeAddin:f.partial({installURL:S,infoURL:S}),crossPlatformOfficeAddin:f.partial({installURL:S,infoURL:S}),desktop:f.partial({windows:f.partial({installURL:S,infoURL:S}),mac:f.partial({installURL:S,infoURL:S})}),extension:f.partial({chrome:f.partial({installURL:S,infoURL:S}),firefox:f.partial({installURL:S,iconURL:S,infoURL:S}),safari:f.partial({installURL:S}),edge:f.partial({installURL:I,infoURL:S}),edgeChromium:f.partial({installURL:S})}),edu:f.partial({adminPanelURL:S}),support:f.partial({login:S,email:f.string,mainPage:S,newRequest:S,contact:S,connectionTroubleshooting:S,emailExistsKBUrl:S,safariDownloadFilesKBUrl:S,rtfCompatibilityUrl:S,diagnosticTestPath:f.string,documentAcceptTrackedChanges:S}),privacyPolicy:S,termsOfService:S,account:f.partial({customize:S,subscription:S,adminSubscription:S,members:S,styleGuide:S,suggestions:S}),preconnectLinks:f.array(E),ideas:f.partial({galleryURL:S})}),p.VF((function(){return{env:r.prod,logLevel:"INFO",accumulateCrashLogLevel:"DEBUG",sendCrashOnLogLevel:"ERROR",collectLogs:!0,collectCrashLogs:!0,copyLogsToConsole:!1,crashLogsCacheSize:100,debugLogsCacheSize:100,tracking:{state:"enabled"},alertCache:{prefix:"editorTsAlertCache",version:"4"},mutedCategoriesCache:{prefix:"mutedCategoriesCache",version:"0"},outcomeScoreCache:{prefix:"scoreCache",version:"0"},userSettingsPrefix:"userSettings",userSettingsVersion:"1",defaultDialect:i.american,notificationShowTimeMs:7e3,maxNotificationsOnTheScreen:3,selfUpdate:{versionCheckInterval:59*d.MS_IN_MIN,selfUpdateDelay:12*d.MS_IN_HOUR,canReloadCheckInterval:5*d.MS_IN_SEC,blockingModalAutoReloadDelay:1*d.MS_IN_MIN,retryFailedVersionCheckInterval:5*d.MS_IN_MIN,retryFailedVersionCheckLimit:20,debugBuildVersion:"auto",versionFilePath:"/version.json"},pingMaybeGnarDelay:1*d.MS_IN_HOUR,domains:{cookie:".grammarly.com",localServer:"denali-local.grammarly.com"},api:{authUrl:"https://auth.grammarly.com/v3",institutionUrl:"https://institution.grammarly.com/api/institution",snippetsUrl:"https://institution.ppgr.io/api/snippets",clientControlsUrl:"https://goldengate.grammarly.com/client-controls",institutionAdminUrl:"https://institution.grammarly.com/api/institution/admin",institutionStyleGuideUrl:"https://institution.grammarly.com/public/api/styleguides",institutionGroupsUrl:"https://goldengate.grammarly.com/institution/api/groups",institutionUserUrl:"https://institution.grammarly.com/public/api/user",analyticsUrl:"https://goldengate.grammarly.com/analytics/api/institution/statistics",institutionAnalyticsUrl:"https://institution.grammarly.com/public/api/institution/statistics",institutionSuggestionsUrl:"https://institution.grammarly.com/api/institution/settings/suggestions",institutionTonesUrl:"https://institution.grammarly.com/api/institution/settings/tones",tonesUrl:"https://institution.ppgr.io/api/tones",dapiUrl:"https://data.grammarly.com",doxUrl:"https://dox.grammarly.com",irbisUrl:"https://irbis.grammarly.com",subscriptionUrl:"https://subscription.grammarly.com/api/v1",discountUrl:"https://irbis.grammarly.com/api/discounts",capiWsUrl:"wss://capi.grammarly.com/freews",capiApiUrl:"https://capi.grammarly.com/api",gnarApi:{url:"https://gnar.grammarly.com"},felogUrl:"https://f-log-editor.grammarly.io",felogDebugUrl:"https://f-log-editor-debug.grammarly.io",sumoUrl:"https://endpoint2.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0Bxac28IqT2frgzsjX7HEotu8EZEZr07YE9RWLCzrOMGwzO9aL6c_iSiidkEplFOod2igKIxz_7s2CHlXc2u-XuLpetEBK1fV6xjfN2Sw2gA==",crashLogUrl:"https://f-log-editor.grammarly.io/crash",onlineTestUrl:"/online-test.json",wsTest:"wss://wstest.grammarly.com",proofitResultUrl:"https://dox.grammarly.com/documents/_docId_/proofread",redirect:"https://redirect.grammarly.com/redirect",mailApiUrl:"https://g-mail.grammarly.com",ssoUrl:"https://sso.grammarly.com",scimUrl:"https://goldengate.grammarly.com/auth/api/token/scim",workspaceUrl:"https://goldengate.grammarly.com/workspace",voxWorkspaceUrl:"https://goldengate.grammarly.com/vox/v1/workspace",voxInstitutionUrl:"https://goldengate.grammarly.com/vox/v1/institution",writingStylesUrl:"https://goldengate.grammarly.com/writingstyle"},app:{nameWeb:"editor",nameDesktop:"desktopEditor"},urls:{free:"/free",account:"https://account.grammarly.com"},onlineEditor:{docId:"https://app.grammarly.com/ddocs/"},funnel:{base:"https://www.grammarly.com",resetPassword:"https://www.grammarly.com/resetpassword",accountDeleted:"https://www.grammarly.com/account-deleted",businessLanding:"https://www.grammarly.com/business/e",businessStyleguideLanding:"https://www.grammarly.com/business/styleguide",businessUpgradeLanding:"https://www.grammarly.com/upgrade/business/try",subscribe:"https://www.grammarly.com/subscribe",upgrade:"https://www.grammarly.com/upgrade",plans:"https://www.grammarly.com/plans",signin:"https://www.grammarly.com/signin",socialSignin:"https://www.grammarly.com/signin/app/desktop-editor",signup:"https://www.grammarly.com/signup",mainPage:"https://www.grammarly.com/",deleteSocialAccount:"https://www.grammarly.com/social/delete-account",subscriptionCancellationSurvey:"https://www.grammarly.com/subscription-cancellation-survey",keyboardInstall:"https://www.grammarly.com/keyboard",desktopAppInstall:"https://www.grammarly.com/native",claimedUserJoinFallback:"https://redirect.grammarly.com/redirect?business_join=1"},officeAddin:{installURL:"https://download-office.grammarly.com/latest/GrammarlyAddInSetup.exe",infoURL:"https://www.grammarly.com/office-addin/windows"},crossPlatformOfficeAddin:{installURL:"https://appsource.microsoft.com/en-us/product/office/WA200001011?tab=Overview",infoURL:"https://www.grammarly.com/office-addin/mac"},desktop:{windows:{installURL:"https://download-editor.grammarly.com/windows/GrammarlySetup.exe",infoURL:"https://www.grammarly.com/native/windows"},mac:{installURL:"https://download-editor.grammarly.com/osx/Grammarly.dmg",infoURL:"https://www.grammarly.com/native/mac"}},extension:{chrome:{installURL:"https://chrome.google.com/webstore/detail/kbfnbcaeplbcioakkpcpgfkobkghlhen",infoURL:"https://chrome.google.com/webstore/detail/grammarly-spell-checker-g/kbfnbcaeplbcioakkpcpgfkobkghlhen?hl=en"},firefox:{installURL:"https://addons.mozilla.org/firefox/downloads/latest/566314/addon-566314-latest.xpi",iconURL:"https://addons.cdn.mozilla.net/user-media/addon_icons/566/566314-32.png",infoURL:"https://addons.mozilla.org/en-US/firefox/addon/grammarly-1/"},safari:{installURL:"https://apps.apple.com/us/app/grammarly-for-safari/id1462114288?ls=1&mt=12"},edge:{installURL:"ms-windows-store://pdp?ProductId=9p59wxtbhzzm",infoURL:"https://www.microsoft.com/en-us/store/p/grammarly-for-microsoft-edge/9p59wxtbhzzm?rtc=1"},edgeChromium:{installURL:"https://microsoftedge.microsoft.com/addons/detail/grammarly-for-microsoft-e/cnlefmmeadmemmdciolhbnfeacpdfbkd"}},edu:{adminPanelURL:"https://account.grammarly.com/admin"},support:{login:"https://support.grammarly.com/login",email:"support@grammarly.com",mainPage:"https://support.grammarly.com/",newRequest:"https://support.grammarly.com/hc/en-us/requests/new",contact:"https://www.grammarly.com/contact",connectionTroubleshooting:"https://support.grammarly.com/hc/en-us/articles/115000090271-Network-configuration-blocks-Grammarly-services",emailExistsKBUrl:"https://support.grammarly.com/hc/en-us/articles/115000090791-Changing-your-email-to-an-email-that-already-exists",safariDownloadFilesKBUrl:"https://support.grammarly.com/hc/en-us/articles/360001105952",rtfCompatibilityUrl:"https://support.grammarly.com/hc/en-us/articles/115000091512-Preserve-text-formatting",diagnosticTestPath:"/diagnostic-test?origin=editor",documentAcceptTrackedChanges:"https://support.office.com/en-us/article/Accept-tracked-changes-4838d24c-d5d1-4c6c-8e39-78b44bd2b4cc"},privacyPolicy:"https://www.grammarly.com/privacy-policy",termsOfService:"https://www.grammarly.com/terms",account:{customize:"https://redirect.grammarly.com/redirect?profile_dictionary=1",subscription:"https://account.grammarly.com/subscription",adminSubscription:"https://account.grammarly.com/admin/subscription",members:"https://account.grammarly.com/admin/members",styleGuide:"https://account.grammarly.com/admin/style-guide",suggestions:"https://redirect.grammarly.com/redirect?profile_suggestions=1"},preconnectLinks:["https://data.grammarly.com","https://gnar.grammarly.com","https://subscription.grammarly.com","https://auth.grammarly.com","https://f-log-editor.grammarly.com","https://static.institution.grammarly.com"],ideas:{galleryURL:"https://app.grammarly.com/ideas/sales"}}})));!function(e){e.createFromPlatformConfig=l.createFrom(A),e.Context=o.createContext(u.Y.invariantContent("PlatformConfig"))}(y||(y={}));var C=n(81531),T=n(63969),k=n(30763),O=n(7046),N=n(50790),M=n(4948);var x;!function(e){e.UnauthorizedError=({action:e})=>o.createElement(N.DI.TitledContent,{title:"You've Been Logged Out"},"This occurs due to inactivity or logging out on another device.",o.createElement("br",null),o.createElement(M.J,{name:"login",className:D.footerLink,onClick:e},"Log Back In")),e.Offline=({reconnect:e,reconnectTime:t})=>o.createElement(N.DI.TitledContent,{title:"Lost Connection"},"Your Internet session was interrupted. We’ll try to reconnect you in"," ",o.createElement(s.F.span,null,t.view((e=>e)))," seconds.",o.createElement("br",null),o.createElement(M.J,{name:"reconnect",className:D.footerLink,onClick:e},"Reconnect Now")),e.ServerError=()=>{const t=e.withReload(M.J,"UnknownConnectionError");return o.createElement(N.DI.TitledContent,{title:"Sorry, Unexpected Issue"},"A small error has occurred, causing an interruption of service.",o.createElement("br",null),o.createElement(t,{name:"reload-page",className:D.footerLink},"Reload This Page"))},e.ConnectionWSError=()=>{const e=o.useContext(y.Context);return o.createElement(N.DI.TitledContent,{title:"Can’t Connect to Grammarly"},"Your network configuration currently blocks Grammarly services on this computer. ",o.createElement("br",null),o.createElement(M.J,{name:"troubleshoot",className:D.footerLink,href:e.support.diagnosticTestPath,target:"_blank"},"Troubleshoot This Issue"))},e.ClientConnectionError=()=>{const t=e.withReload(M.J,"ClientConnectionErrorNotification");return o.createElement(N.DI.TitledContent,{title:"Your Internet Connection Is Unstable"},"Please check your network stability and then reload this page.",o.createElement("br",null),o.createElement(t,{name:"reload-page",className:D.footerLink},"Reload Page Now"))},e.DocumentNotFoundError=({navigateToDocuments:e})=>o.createElement(N.DI.TitledContent,{title:"Can’t find this document"},"It looks like this document was removed or URL is incorrect.",o.createElement("br",null),o.createElement(M.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.SelfUpdate=()=>{const t=o.useContext(k.m.Context),n=e.withReload(O.zx,"SelfUpdateBlocker");return o.createElement(N.DI.TitledContent,{title:"Grammarly needs to refresh this page"},"Don't worry - your documents have already been saved. Please"," ",o.createElement(n,{name:"reload-page",className:D.link},"reload")," ","the page ",t.hotkeyLabelR,".")},e.DesktopHardUpdate=({reloadMethod:e})=>{const t=o.useContext(k.m.Context).desktopUpdate;return o.createElement(N.DI.TitledContent,{title:t.hardTitle},t.hard,o.createElement("br",null),o.createElement(M.J,{name:"reload-desktop",className:D.footerLink,onClick:e},t.reload))},e.DesktopHardDownload=({downloadMethod:e})=>{const t=o.useContext(k.m.Context).desktopUpdate;return o.createElement(N.DI.TitledContent,{title:t.hardTitle},t.hard,o.createElement("br",null),o.createElement(M.J,{name:"download-desktop",className:D.footerLink,onClick:e},t.download))},e.SlowNetworkError=()=>o.createElement(N.DI.TitledContent,{title:"Your Internet Connection Is Unstable"},"Grammarly may work slower than normal."),e.CheckingIsDownError=()=>o.createElement(N.DI.TitledContent,{title:"Text Checking Is Temporarily Unavailable"},"Grammarly is unable to check your text for errors at this time. We’re working to resolve the issue. Please check back soon."),e.Error=()=>{const e=o.useContext(y.Context);return o.createElement(N.DI.TitledContent,{title:"Sorry, Something Went Wrong"},"Please try again later or"," ",o.createElement(O.zx,{name:"support",className:D.link,href:e.support.login,target:"_blank"},"contact support")," ","now to report the issue.")},e.ProofitPaymentDeclinedError=({paymentMethod:e,navigateToSubscription:t})=>{const n=o.useContext(k.m.Context).proofitPayment,r=function(e,t,n){switch(e){case"creditCard":return t;case"payPal":return n;default:const r=`Unknown payment method: ${e}`;throw C.Monitoring.Logging.getLogger("ProofitView").warn(r),new Error(r)}}(e,n.creditCard,n.payPal);return o.createElement(N.DI.TitledContent,{title:"Order can not be processed"},o.createElement("div",null,r),"Please update your credit card information in the Manage Subscription section.",o.createElement("br",null),o.createElement(M.J,{name:"manage-subscription",className:D.footerLink,onClick:t},"Go to Manage Subscription"))},e.PaymentSuccessMessage=()=>{const e=o.useContext(k.m.Context).proofitOrderModal.card.paymentSuccess;return o.createElement(N.DI.TitledContent,{title:e.title},o.createElement("div",null,e.message))},e.PaymentErrorMessage=()=>{const e=o.useContext(k.m.Context).proofitOrderModal.card.paymentError,t=o.useContext(y.Context);return o.createElement(N.DI.TitledContent,{title:e.title},o.createElement("div",null,e.message(t.support.login)))},e.ProofitEmptyDocumentError=()=>o.createElement(N.DI.TitledContent,{title:"Document is empty"},"The document you are trying to submit is empty. Please write something and try again."),e.ProofitDocumentProofreadError=({navigateToDocuments:e})=>o.createElement(N.DI.TitledContent,{title:"This document is a recent submission"},"The text you are trying to send for human proofreading was reviewed by our team. Please edit your text or select another document before you re-submit.",o.createElement("br",null),o.createElement(M.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.ProofitComplexInternalStructureError=({navigateToDocuments:e})=>o.createElement(N.DI.TitledContent,{title:"This document cannot be corrected"},"The text you are trying to send for human proofreading has complex internal structure. Please edit your text (e.g., remove significantly long tables) or select another document.",o.createElement("br",null),o.createElement(M.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.withReload=(e,t)=>class extends o.Component{render(){return o.createElement(e,Object.assign({},this.props,{onClick:()=>{try{localStorage.setItem("pageReloadReason",JSON.stringify({source:t,location:self.location.href,timestamp:Date.now()}))}catch(e){}self.location.reload()}}))}},e.CopyToClipboardError=()=>{const e=o.useContext(k.m.Context);return o.createElement(N.DI.TitledContent,{title:"Copying Is Not Supported by Your Browser"},"Please use ",e.hotkeyLabelC," instead.")},e.ProofitCancelled=()=>{const e=o.useContext(y.Context);return o.createElement(N.DI.TitledContent,{title:"Your order has been cancelled"},"Your proofreading order has been cancelled and the payment refunded. Please check your email for more information, or contact"," ",o.createElement(M.J,{name:"support",className:D.footerLink,href:e.support.login,target:"_blank"},"Grammarly support"))},e.ProofitCompleted=({documentTitle:e,documentDownloadUrl:t,email:n})=>o.createElement(N.DI.TitledContent,{title:`${e||"Your"} document has been proofread`},"A version of this document with proofreaders’ marks has been emailed to you at ",n," in .docx format.",o.createElement("br",null),o.createElement(M.J,{name:"download",className:D.footerLink,href:t,target:"_blank"},"Download .docx")),e.DenaliFormattingCompatibility=()=>{const e=o.useContext(k.m.Context),t=o.useContext(y.Context);return o.createElement(N.DI.TitledContent,{title:e.rtfCompatibilityModeNotificationTitle},"To preserve your document’s formatting, Grammarly’s formatting tools are temporarily disabled.",o.createElement("br",null),o.createElement(M.J,{name:"support",className:D.footerLink,href:t.support.rtfCompatibilityUrl,target:"_blank"},"Learn more"))},e.DenaliDocumentUploaded=({navigateToDocuments:e})=>{const{denaliDocumentUploadNotification:t}=o.useContext(k.m.Context);return o.createElement(N.DI.TitledContent,{title:t.title},t.text," ",o.createElement(O.zx,{name:"goto-docs",className:D.link,onClick:e},t.link))},e.AlertsNothingFound=()=>o.createElement(N.DI.Content,null,"Grammarly found no critical writing issues in this text. Keep up the great work!"),e.DesktopSoftUpdate=({reloadMethod:e})=>{const t=o.useContext(k.m.Context).desktopUpdate;return o.createElement(N.DI.TitledContent,{title:t.softTitle},t.soft,o.createElement("br",null),o.createElement(M.J,{name:"reload-desktop",className:D.footerLink,onClick:e},t.reload))},e.DesktopSoftDownload=({downloadMethod:e})=>{const t=o.useContext(k.m.Context).desktopUpdate;return o.createElement(N.DI.TitledContent,{title:t.softTitle},t.soft,o.createElement("br",null),o.createElement(M.J,{name:"download-desktop",className:D.footerLink,onClick:e},t.download))},e.ThanksForFeedbackNotification=()=>o.createElement(N.DI.TitledContent,{title:"Your feedback has been sent"},"Thank you for helping make Grammarly better!"),e.DownloadDocumentNotFoundError=()=>{const e=o.useContext(k.m.Context);return o.createElement(N.DI.TitledContent,{"data-name":"document-not-found",title:e.downloadDocumentNotFoundError})},e.ClipboardNotSupported=({hotkey:e})=>{const t=o.useContext(k.m.Context);return o.createElement(N.DI.Content,null,t.hotkeyUnsupported,o.createElement("b",null,e))},e.DocumentSizeExceeded=({os:e,officeAddinUrl:t})=>{const n=o.useContext(k.m.Context).fileSizeExceededNotification;return o.createElement(N.DI.TitledContent,{title:n.title},n.body,"windows"===e&&o.createElement(M.J,{name:"officeAddin",className:D.footerLink,href:t,target:"_blank"},n.link))},e.DocumentUploaded=({navigateToDocument:e})=>{const t=o.useContext(k.m.Context).documentUploaded;return o.createElement(N.DI.Content,null,t.message,o.createElement("br",null),o.createElement(M.J,{name:"goto-doc",className:D.footerLink,onClick:e},t.link))},e.DocumentTypeUnsupported=()=>{const e=o.useContext(k.m.Context);return o.createElement(N.DI.Content,null,"Unsupported file type. ",e.notificationUploadFileText,": Microsoft Word (.doc, .docx), OpenOffice (.odt), TXT and RTF.")},e.DocumentWithTrackedChangesIsUnsupported=({link:e})=>o.createElement(N.DI.Content,null,"Your document contains revisions. Accept all revisions and try uploading again. Click"," ",o.createElement(O.zx,{name:"document-accept-tracked-changes",className:D.link,href:e,target:"_blank"},"here")," ","for details.");const t=(e,t)=>{switch(e){case P.switchToDenali:return t.switchToDenali;case P.feedbackSend:return t.feedbackSend;case P.statisticsError:return t.statisticsError;case P.referenceCopied:return t.referenceCopied;case P.documentCopied:return t.documentCopied;case P.isTemporaryDownloadError:return t.isTemporaryDownloadError;case P.documentUploadGeneralError:return t.documentUploadGeneralError;case P.documentIsEmpty:return t.documentIsEmpty;case P.noFileToUpload:return t.noFileToUpload;case P.oneDocumentIsAllowed:return t.oneDocumentIsAllowed;default:return(0,a.vE)(e)}};e.Generic=({type:e})=>{const n=o.useContext(k.m.Context);return o.createElement(N.DI.TitledContent,{title:t(e,n)})}}(x||(x={}));const R={display:"inline-flex",overflow:"unset",color:c.Il.CoreNeutral0,verticalAlign:"baseline",textDecoration:"underline",fontWeight:"bold",cursor:"pointer"},L={marginTop:T.u.rem(.5),textDecoration:"none"},D=T.u.stylesheet({link:[R],footerLink:[R,L]});var P;!function(e){e.switchToDenali="switchToDenali",e.feedbackSend="feedbackSend",e.statisticsError="statisticsError",e.referenceCopied="referenceCopied",e.documentCopied="documentCopied",e.isTemporaryDownloadError="isTemporaryDownloadError",e.documentUploadGeneralError="documentUploadGeneralError",e.documentIsEmpty="documentIsEmpty",e.noFileToUpload="noFileToUpload",e.oneDocumentIsAllowed="oneDocumentIsAllowed"}(P||(P={}))},32380:(e,t,n)=>{n.d(t,{A:()=>_});var r=n(27378),i=n(18208),o=n(44060),s=n(63969),a=n(30763),c=n(21474),l=n(50790),u=n(4948);const d=(e,t)=>{switch(e.kind){case"ignore":return"Dismissed";case"ignoreAll":return r.createElement(r.Fragment,null,r.createElement("span",null,e.alerts)," ",i.pluralize(e.alerts,"alert has been","alerts have been")," dismissed");case"replace":return"Corrected";case"replaceSynonym":return"Replaced";case"replaceTransform":return r.createElement(r.Fragment,null,e.transform);case"addToDictionary":return r.createElement(r.Fragment,null,r.createElement("b",{className:t&&t.addToDictionary},e.word)," has been added to dictionary");case"report":return"Your report has been sent";case"markAsHelpful":return"Marked as “Will address”";case"markAsNotHelpful":return"Marked as “Not helpful”";default:return""}},p={display:"flex",marginTop:s.u.rem(-1.1),marginBottom:s.u.rem(-.5),alignItems:"center",justifyContent:"space-between"},h={marginTop:s.u.rem(.6),marginRight:s.u.rem(1),color:o.Il.CoreNeutral0,flexGrow:0,flexShrink:0},m={marginTop:s.u.rem(-.25),paddingRight:s.u.rem(.5),minWidth:"auto",minHeight:"auto",justifyContent:"space-between"},f={marginTop:s.u.rem(.6),maxWidth:s.u.rem(14),wordWrap:"break-word",flexBasis:"auto",flexGrow:1},g={marginRight:s.u.rem(1.4)},y=s.u.stylesheet({alertUndoWrapper:[p],alertUndoWrapperFlexible:[p,{flexWrap:"nowrap"}],alertUndoWrapperFullWidth:[p,{flexWrap:"wrap"}],alertUndoBtn:[h],alertUndoIcon:[m],alertUndoContent:[f],alertUndoContentFlexible:[f,g],addToDictionary:[{wordBreak:"break-all"}]});var _;!function(e){const t={wrapper:y.alertUndoWrapperFlexible,content:y.alertUndoContent,icon:y.alertUndoIcon,button:y.alertUndoBtn};e.Standard=({action:n,params:i})=>r.createElement(l.DI.Content,null,r.createElement(e.Content,{action:n,content:d(i),theme:Object.assign(Object.assign({},t),{wrapper:y.alertUndoWrapperFullWidth})})),e.Flexible=({notification:n,onClose:i,action:o,params:s})=>r.createElement(l.SJ.Wrapper,{notification:n,onClose:i},r.createElement(l.DI.Content,null,r.createElement(e.Content,{action:o,content:d(s,{addToDictionary:y.addToDictionary}),theme:Object.assign(Object.assign({},t),{wrapper:y.alertUndoWrapperFlexible,content:y.alertUndoContentFlexible})}))),e.Content=({action:e,content:n,theme:i=t})=>{const o=r.useContext(a.m.Context);return r.createElement("div",{className:i.wrapper},r.createElement("div",{className:i.content},n),r.createElement(u.J,{name:"alertUndoButton",className:i.button,onClick:e},r.createElement(c.JO.Undo,{className:i.icon}),o.undo))}}(_||(_={}))},16595:(e,t,n)=>{n.r(t),n.d(t,{A:()=>i,ArrayUtils:()=>h,Buffer:()=>u,Comparable:()=>l.V3,Cookie:()=>r,CustomError:()=>c.sH,DOM:()=>b,DateUtils:()=>v,E:()=>T,Either:()=>a,Eq:()=>z,Fullstory:()=>_,G:()=>H,IOOption:()=>Re.p,IllegalArgumentError:()=>c.mG,InvariantError:()=>c.ej,Keys:()=>p.R,M:()=>q,MatchingNotExhaustiveError:()=>c.u0,MouseEventUtils:()=>p.T,NEA:()=>Y,NotEmpty:()=>S.G,O:()=>V,ObjectUtils:()=>E,Ord:()=>$,PromiseT:()=>o,R:()=>ae,RD:()=>s,ReactContextUtils:()=>De.Y,RecoverableOperation:()=>Le.T,StringUtils:()=>I,SymmetricDiff:()=>x.v,TE:()=>Me,TH:()=>xe,TangentialPoint:()=>N.A,Version:()=>w,Worker:()=>d,Zipper:()=>O,and:()=>l.xD,andP:()=>l.W9,assertNever:()=>c.vE,assertNeverSilent:()=>c.L0,choose:()=>l.RN,compare:()=>l.qu,curry:()=>M.W,curryFlip:()=>l.PU,decode:()=>l.Jx,delay:()=>l.gw,emailValidation:()=>l.D6,expectNonNull:()=>c.CE,getWebSocket:()=>l.Ib,invariant:()=>c.kG,isClientFetchError:()=>c.$w,isDefined:()=>l.$K,isServerErrorCode:()=>c.J_,isSetsEq:()=>l.As,lazy:()=>l.Vo,memoize:()=>l.HP,nameValidation:()=>l.wD,noop:()=>l.ZT,not:()=>l.ff,notEmpty:()=>l.Dw,or:()=>l.or,orP:()=>l.Kg,rand:()=>l.TN,registerDebugHelper:()=>l.iR,sleep:()=>l._v,sum:()=>l.Sm,throttleByPromise:()=>l.Nk,tick:()=>l.Ky,valueFromEnum:()=>l.CI});var r={};n.r(r),n.d(r,{getCookie:()=>f,setCookie:()=>g,setInstallSourceCookie:()=>y});var i={};n.r(i),n.d(i,{Alt:()=>L.Alt,Alternative:()=>L.Alternative,Applicative:()=>L.Applicative,Compactable:()=>L.Compactable,Do:()=>L.Do,Extend:()=>L.Extend,Filterable:()=>L.Filterable,FilterableWithIndex:()=>L.FilterableWithIndex,Foldable:()=>L.Foldable,FoldableWithIndex:()=>L.FoldableWithIndex,Functor:()=>L.Functor,FunctorWithIndex:()=>L.FunctorWithIndex,Monad:()=>L.Monad,Traversable:()=>L.Traversable,TraversableWithIndex:()=>L.TraversableWithIndex,URI:()=>L.URI,Unfoldable:()=>L.Unfoldable,Witherable:()=>L.Witherable,alt:()=>L.alt,altW:()=>L.altW,ap:()=>L.ap,apFirst:()=>L.apFirst,apS:()=>L.apS,apSecond:()=>L.apSecond,array:()=>L.array,bind:()=>L.bind,bindTo:()=>L.bindTo,chain:()=>L.chain,chainFirst:()=>L.chainFirst,chainWithIndex:()=>L.chainWithIndex,chop:()=>L.chop,chunksOf:()=>L.chunksOf,compact:()=>L.compact,comprehension:()=>G,cons:()=>L.cons,copy:()=>L.copy,deleteAt:()=>L.deleteAt,difference:()=>L.difference,dropLeft:()=>L.dropLeft,dropLeftWhile:()=>L.dropLeftWhile,dropRight:()=>L.dropRight,duplicate:()=>L.duplicate,elem:()=>L.elem,empty:()=>L.empty,every:()=>L.every,extend:()=>L.extend,filter:()=>L.filter,filterMap:()=>L.filterMap,filterMapWithIndex:()=>L.filterMapWithIndex,filterWithIndex:()=>L.filterWithIndex,findFirst:()=>L.findFirst,findFirstMap:()=>L.findFirstMap,findIndex:()=>L.findIndex,findLast:()=>L.findLast,findLastIndex:()=>L.findLastIndex,findLastMap:()=>L.findLastMap,flatten:()=>L.flatten,foldLeft:()=>L.foldLeft,foldMap:()=>L.foldMap,foldMapWithIndex:()=>L.foldMapWithIndex,foldRight:()=>L.foldRight,getEq:()=>L.getEq,getMonoid:()=>L.getMonoid,getOrd:()=>L.getOrd,getShow:()=>L.getShow,head:()=>L.head,init:()=>L.init,insertAt:()=>L.insertAt,intersection:()=>L.intersection,intersperse:()=>L.intersperse,isEmpty:()=>L.isEmpty,isNonEmpty:()=>L.isNonEmpty,isOutOfBound:()=>L.isOutOfBound,last:()=>L.last,lefts:()=>L.lefts,lookup:()=>L.lookup,makeBy:()=>L.makeBy,map:()=>L.map,mapWithIndex:()=>L.mapWithIndex,modifyAt:()=>L.modifyAt,of:()=>L.of,partition:()=>L.partition,partitionMap:()=>L.partitionMap,partitionMapWithIndex:()=>L.partitionMapWithIndex,partitionWithIndex:()=>L.partitionWithIndex,prependToAll:()=>L.prependToAll,range:()=>L.range,reduce:()=>L.reduce,reduceRight:()=>L.reduceRight,reduceRightWithIndex:()=>L.reduceRightWithIndex,reduceWithIndex:()=>L.reduceWithIndex,replicate:()=>L.replicate,reverse:()=>L.reverse,rights:()=>L.rights,rotate:()=>L.rotate,scanLeft:()=>L.scanLeft,scanRight:()=>L.scanRight,seededShuffle:()=>B,separate:()=>L.separate,sequence:()=>L.sequence,snoc:()=>L.snoc,some:()=>L.some,sort:()=>L.sort,sortBy:()=>L.sortBy,spanLeft:()=>L.spanLeft,splitAt:()=>L.splitAt,tail:()=>L.tail,takeLeft:()=>L.takeLeft,takeLeftWhile:()=>L.takeLeftWhile,takeRight:()=>L.takeRight,traverse:()=>L.traverse,traversePairs:()=>W,traverseWithIndex:()=>L.traverseWithIndex,unfold:()=>L.unfold,union:()=>L.union,uniq:()=>L.uniq,unsafeDeleteAt:()=>L.unsafeDeleteAt,unsafeInsertAt:()=>L.unsafeInsertAt,unsafeUpdateAt:()=>L.unsafeUpdateAt,unzip:()=>L.unzip,updateAt:()=>L.updateAt,wilt:()=>L.wilt,wither:()=>L.wither,zero:()=>L.zero,zip:()=>L.zip,zipWith:()=>L.zipWith});var o={};n.r(o),n.d(o,{URI:()=>Q,ap:()=>te,apFirst:()=>ne,apSecond:()=>re,chain:()=>ie,chainFirst:()=>oe,map:()=>se,orElse:()=>X,promise:()=>Z,promiseSeq:()=>K});var s={};n.r(s),n.d(s,{Type:()=>J,URI:()=>le,ap:()=>Ce,apFirst:()=>Te,apSecond:()=>ke,bimap:()=>Oe,chain:()=>we,chainFirst:()=>Ae,error:()=>pe,fatal:()=>he,flatten:()=>Ne,fold:()=>ve,getEq:()=>_e,inProgress:()=>ue,isError:()=>ge,isFatal:()=>ye,isInProgress:()=>me,isSuccess:()=>fe,map:()=>Ie,mapLeft:()=>Se,remoteData:()=>be,success:()=>de});var a,c=n(22232),l=n(8125);!function(e){function t(e){return"left"===e.kind}e.left=function(e){return{kind:"left",value:e}},e.right=function(e){return{kind:"right",value:e}},e.isLeft=t,e.isRight=function(e){return"right"===e.kind},e.flatMap=function(e,n){return t(e)?e:n(e.value)},e.fromPromise=function(t){return t.then((function(t){return e.right(t)})).catch((function(t){return e.left(t)}))}}(a||(a={}));var u,d=function(){function e(e,t,n,r){void 0===r&&(r=20),this._task=e,this._buffer=t,this._run=n,this._batchSize=r,this._sub=null}return e.prototype.put=function(e){this._buffer.put(e),null===this._sub&&this._buffer.nonEmpty&&this._scheduleWork()},e.prototype.order=function(e){this._buffer.order(e)},e.prototype.flush=function(){this._task(this._buffer.take(this._buffer.length))},Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.length},enumerable:!1,configurable:!0}),e.prototype._scheduleWork=function(){var e=this;this._sub=this._run((function(){e._task(e._buffer.take(e._batchSize)),e._sub=null,e._buffer.nonEmpty&&e._scheduleWork()}))},e.prototype.shutdown=function(){this._sub&&(this._sub.unsubscribe(),this._sub=null)},e}();!function(e){var t=function(){function e(e){this._predicate=e,this._queueMap=new Set,this._queue=[]}return e.prototype.put=function(e){var t,n=this,r=new Set,i=e.reduce((function(e,t){return r.has(t.id)||n._queueMap.has(t.id)||!n._predicate(t)||(r.add(t.id),e.push(t)),e}),[]);(t=this._queue).push.apply(t,i),i.forEach((function(e){var t=e.id;return n._queueMap.add(t)}))},e.prototype.take=function(e){for(var t=0,n=[];t<this._queue.length&&n.length<e;){var r=this._queue[t];this._predicate(r)&&n.push(r),this._queueMap.delete(r.id),t++}return this._queue=this._queue.slice(t),n},e.prototype.order=function(e){this._queue.sort(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nonEmpty",{get:function(){return this._queue.length>0},enumerable:!1,configurable:!0}),e}();e.LazyPredicateUniq=t}(u||(u={}));var p=n(25781),h=n(89943),m=n(11066);function f(e){return(0,m.Z)(e)}function g(e,t,n){(0,m.Z)(e,t,n)}function y(e){g("grInstallSource","editor",{domain:e,path:"/",expires:new Date(Date.now()+36e5)})}var _,v=n(76024),b=n(19962),E=n(55415),I=n(18208),S=n(80153);!function(e){function t(){return void 0!==self.FS}e.enable=function(){(0,c.kG)(!t(),"FullStory snippet already loaded");var e=document.createElement("script");e.innerHTML="window['_fs_debug'] = true;\n  window['_fs_host'] = 'fullstory.com';\n  window['_fs_org'] = '76Y20';\n  window['_fs_namespace'] = 'FS';\n  (function(m,n,e,t,l,o,g,y){\n    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window[\"_fs_namespace\"].');} return;}\n    g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];\n    o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';\n    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);\n    g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};\n    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};\n    g.clearUserCookie=function(c,d,i){if(!c || document.cookie.match('fs_uid=[\";\"]*\"[\";\"]*\"[\";\"]*\"')){\n      d=n.domain;while(1){n.cookie='fs_uid=;domain='+d+\n      ';path=/;expires='+new Date(0).toUTCString();i=d.indexOf('.');if(i<0)break;d=d.slice(i+1)}}};\n    })(window,document,window['_fs_namespace'],'script','user');",document.head.appendChild(e)},e.isEnabled=t,e.ignoreClass="fs-hide"}(_||(_={}));var w,A=n(40327),C=n(20279),T=n(95574),k=n(95195);!function(e){e.parse=function(e){return new t(String(e))};var t=function(){function t(e){this.value=k.left(new Error("Version is unset")),this.value=(0,A.pipe)(T.tryCatchError((function(){return new C.SemVer(e.replace(/_/g,"-"))})),k.orElse((function(){return k.fromNullable(new Error("Failed to parse version from "+e))((0,C.coerce)(e))})))}return t.prototype.gte=function(e){return this._test(C.gte,e)},t.prototype.gt=function(e){return this._test(C.gt,e)},t.prototype.lt=function(e){return this._test(C.lt,e)},t.prototype.lte=function(e){return this._test(C.lte,e)},t.prototype.eq=function(e){return this._test(C.eq,e)},t.prototype.toString=function(){return(0,A.pipe)(this.value,k.map((function(e){return e.build.length>0?e.toString()+"+"+e.build.join("-"):e.toString()})),k.getOrElse((function(){return"unknown"})))},t.prototype._test=function(t,n){var r=(0,A.pipe)(e.parse(n.toString()).value,k.getOrElse((function(){return null})));return(0,c.kG)(null!==r,"invalid version provided: "+n),(0,A.pipe)(this.value,k.map((function(e){return t(e,r)})),k.getOrElse((function(){return!1})))},t}()}(w||(w={}));var O,N=n(78738),M=n(68983),x=n(92843),R=n(59312),L=n(71249),D=n(26328),P=n(5114),U=n(64015),F=n(57050);function j(e){return Math.abs((1.3685032914*e+.7230964518)%1)}!function(e){e.make=function(e,t,n){return{lefts:e.slice(),focus:t,rights:n.slice()}},e.fromReadonlyArray=function(t,n){return void 0===n&&(n=0),U.xb(t)||U.dC(n,t)?P.none:P.some(e.make((0,F.pipe)(t.slice(),L.takeLeft(n)),t[n],(0,F.pipe)(t.slice(),L.dropLeft(n+1))))},e.fromArray=e.fromReadonlyArray,e.fromReadonlyNonEmptyArray=function(t){return e.make([],t[0],t.slice(1))},e.fromNonEmptyArray=e.fromReadonlyNonEmptyArray,e.isOutOfBound=function(t,n){return t<0||t>=e.length(n)},e.length=function(e){return e.lefts.length+1+e.rights.length},e.toNonEmptyArray=function(e){return(0,F.pipe)(D.of(e.focus),(function(t){return D.zo(e.lefts,t)}),(function(t){return D.zo(t,e.rights)}))},e.toReadonlyNonEmptyArray=e.toNonEmptyArray,e.toArray=e.toNonEmptyArray,e.update=function(t){return function(n){return e.make(n.lefts,t,n.rights)}},e.modify=function(t){return function(n){return(0,F.pipe)(n,e.update(t(n.focus)))}},e.move=function(t,n){var r=t(n.lefts.length);return e.isOutOfBound(r,n)?P.none:e.fromArray(e.toNonEmptyArray(n),r)},e.findIndex=function(e){return function(t){return(0,F.pipe)(t.lefts,U.cx(e),P.alt((function(){return e(t.focus)?P.some(t.lefts.length):P.none})),P.alt((function(){return(0,F.pipe)(t.rights,U.cx(e),P.map((function(e){return t.lefts.length+1+e})))})))}},e.moveByFindFirst=function(t){return function(n){return(0,F.pipe)(n,e.findIndex(t),P.chain((function(t){return t===n.lefts.length?P.some(n):e.move((function(){return t}),n)})))}},e.up=function(t){return e.move(F.decrement,t)},e.down=function(t){return e.move(F.increment,t)},e.start=function(t){return L.isEmpty(t.lefts)?t:e.make([],t.lefts[0],L.snoc((0,F.pipe)(t.lefts,L.dropLeft(1)),t.focus).concat(t.rights))},e.end=function(t){var n=t.rights.length;return 0===n?t:e.make(L.snoc(t.lefts,t.focus).concat((0,F.pipe)(t.rights,L.takeLeft(n-1))),t.rights[n-1],[])},e.insertLeft=function(t){return function(n){return e.make(n.lefts,t,L.cons(n.focus,n.rights))}},e.insertRight=function(t){return function(n){return e.make(L.snoc(n.lefts,n.focus),t,n.rights)}},e.deleteLeft=function(t){var n=t.lefts.length;return e.fromArray(t.lefts.concat(t.rights),n>0?n-1:0)},e.deleteRight=function(t){var n=t.lefts.length,r=t.rights.length;return e.fromArray(t.lefts.concat(t.rights),r>0?n:n-1)};var t=function(t,n){return e.make(t.lefts.map(n),n(t.focus),t.rights.map(n))},n=function(t,n){var r=t.lefts.length;return e.make(t.lefts.map((function(e,t){return n(t,e)})),n(r,t.focus),t.rights.map((function(e,t){return n(r+1+t,e)})))},r=function(t,n){return e.make(L.array.ap(t.lefts,n.lefts),t.focus(n.focus),L.array.ap(t.rights,n.rights))},i=function(t,n){var r=t.lefts.map((function(r,i){return n(e.make((0,F.pipe)(t.lefts,L.takeLeft(i)),r,L.snoc((0,F.pipe)(t.lefts,L.dropLeft(i+1)),t.focus).concat(t.rights)))})),i=t.rights.map((function(r,i){return n(e.make(L.snoc(t.lefts,t.focus).concat((0,F.pipe)(t.rights,L.takeLeft(i))),r,(0,F.pipe)(t.rights,L.dropLeft(i+1))))}));return e.make(r,n(t),i)},o=function(e,t,n){return e.rights.reduce(n,n(e.lefts.reduce(n,t),e.focus))},s=function(e,t,n){var r=e.rights.reduceRight((function(e,t){return n(t,e)}),t),i=n(e.focus,r);return e.lefts.reduceRight((function(e,t){return n(t,e)}),i)},a=function(e){return function(t,n){var r=t.lefts.reduce((function(t,r){return e.concat(t,n(r))}),e.empty),i=t.rights.reduce((function(t,r){return e.concat(t,n(r))}),e.empty);return e.concat(e.concat(r,n(t.focus)),i)}},c=function(t){var n=L.array.traverse(t);return function(r,i){return t.ap(t.ap(t.map(n(r.lefts,i),(function(t){return function(n){return function(r){return e.make(t,n,r)}}})),i(r.focus)),n(r.rights,i))}};e.map=function(e){return function(n){return t(n,e)}},e.mapWithIndex=function(e){return function(t){return n(t,e)}},e.ap=function(e){return function(t){return r(t,e)}},e.apFirst=function(t){return function(n){return(0,F.pipe)(n,e.map((function(e){return function(t){return e}})),e.ap(t))}},e.apSecond=function(t){return function(n){return(0,F.pipe)(n,e.map((function(){return function(e){return e}})),e.ap(t))}},e.of=function(t){return e.make([],t,[])},e.extend=function(e){return function(t){return i(t,e)}},e.duplicate=e.extend(F.identity),e.foldMap=function(e){return function(t){return function(n){return a(e)(n,t)}}},e.reduce=function(e,t){return function(n){return o(n,e,t)}},e.reduceRight=function(e,t){return function(n){return s(n,e,t)}},e.sequence=function(t){var n=L.array.sequence(t);return function(r){return t.ap(t.ap(t.map(n(r.lefts),(function(t){return function(n){return function(r){return e.make(t,n,r)}}})),r.focus),n(r.rights))}},e.extract=function(e){return e.focus},e.URI="Zipper",e.getShow=function(e){var t=L.getShow(e);return{show:function(n){return"Zipper("+t.show(n.lefts)+", "+e.show(n.focus)+", "+t.show(n.rights)+")"}}},e.getSemigroup=function(t){return{concat:function(n,r){return e.make(n.lefts.concat(r.lefts),t.concat(n.focus,r.focus),n.rights.concat(r.rights))}}},e.getMonoid=function(t){return(0,R.__assign)((0,R.__assign)({},e.getSemigroup(t)),{empty:e.make([],t.empty,[])})},e.Functor={URI:e.URI,map:t},e.FunctorWithIndex={URI:e.URI,map:t,mapWithIndex:n},e.Applicative={URI:e.URI,map:t,ap:r,of:e.of},e.Apply={URI:e.URI,map:t,ap:r},e.Foldable={URI:e.URI,foldMap:a,reduce:o,reduceRight:s},e.Traversable={URI:e.URI,map:t,foldMap:a,reduce:o,reduceRight:s,traverse:c,sequence:e.sequence},e.Comonad={URI:e.URI,map:t,extend:i,extract:e.extract},e.zipper={URI:e.URI,map:t,of:e.of,ap:r,extend:i,extract:e.extract,reduce:o,reduceRight:s,foldMap:a,traverse:c,sequence:e.sequence,mapWithIndex:n}}(O||(O={}));var B=function(e){return function(t){for(var n,r=t.slice(0),i=r.length;i>0;){n=j(e);var o=Math.floor(n*i--),s=r[o];r[o]=r[i],r[i]=s}return r}};function W(e){return function(t){if(t.length<2)return t;for(var n=[],r=0;r<t.length;r++)0===n.length?n.push(t[r]):n.push.apply(n,e(n.pop(),t[r]));return n}}function G(e,t,n){return void 0===n&&(n=function(){return!0}),L.comprehension(e,t,n)}var z=n(20976),H=n(48837),q=n(43675),Y=n(3893),V=n(83078),$=n(4807),Q="Promise",Z={URI:Q,map:function(e,t){return e.then(t)},of:Promise.resolve.bind(Promise),ap:function(e,t){return Promise.all([e,t]).then((function(e){return(0,e[0])(e[1])}))},chain:function(e,t){return e.then(t)},mapLeft:function(e,t){return e.catch((function(e){return Promise.reject(t(e))}))},bimap:function(e,t,n){return e.then(n,(function(e){return Promise.reject(t(e))}))},throwError:function(e){return Promise.reject(e)}};function X(e){return function(t){return t.catch(e)}}var J,K=E.merge(Z,{ap:function(e,t){return e.then((function(e){return t.then(e)}))}}),ee=(0,A.pipeable)(Z),te=ee.ap,ne=ee.apFirst,re=ee.apSecond,ie=ee.chain,oe=ee.chainFirst,se=ee.map,ae=n(35407),ce=n(73975),le="RemoteData";!function(e){e.InProgress="InProgress",e.Success="Success",e.Error="Error",e.Fatal="Fatal"}(J||(J={}));var ue={type:J.InProgress};function de(e){return{type:J.Success,value:e}}function pe(e,t){return{type:J.Error,error:e,status:t}}function he(e){return{type:J.Fatal,error:e}}function me(e){return e.type===J.InProgress}function fe(e){return e.type===J.Success}function ge(e){return e.type===J.Error}function ye(e){return e.type===J.Fatal}function _e(e,t){return(0,ce.fromEquals)((function(n,r){return"InProgress"===n.type&&"InProgress"===r.type||("Success"===n.type&&"Success"===r.type?e.equals(n.value,r.value):("Error"===n.type&&"Error"===r.type||"Fatal"===n.type&&"Fatal"===r.type)&&t.equals(n.error,r.error))}))}function ve(e){return function(t){switch(t.type){case J.InProgress:return e.onInProgress();case J.Success:return e.onSuccess(t.value);case J.Error:return e.onError(t.error);case J.Fatal:return e.onFatal(t.error);default:return(0,c.vE)(t)}}}var be={URI:le,of:de,ap:function(e,t){return fe(e)?fe(t)?de(e.value(t.value)):t:e},map:function(e,t){return fe(e)?de(t(e.value)):e},chain:function(e,t){return fe(e)?t(e.value):e},bimap:function(e,t,n){return me(e)?e:fe(e)?de(n(e.value)):ge(e)?pe(t(e.error),e.status):he(t(e.error))},mapLeft:function(e,t){return be.bimap(e,t,F.identity)}},Ee=(0,A.pipeable)(be),Ie=Ee.map,Se=Ee.mapLeft,we=Ee.chain,Ae=Ee.chainFirst,Ce=Ee.ap,Te=Ee.apFirst,ke=Ee.apSecond,Oe=Ee.bimap,Ne=Ee.flatten,Me=n(51072),xe=n(1065),Re=n(39160),Le=n(81670),De=n(88056)},25781:(e,t,n)=>{var r,i;n.d(t,{R:()=>r,T:()=>i}),function(e){e.ESC_CODE=27}(r||(r={})),function(e){e.isLeftMouseButtom=function(e){return 1===e.which||0===e.button}}(i||(i={}))},35407:(e,t,n)=>{n.r(t),n.d(t,{Applicative:()=>i.g1,Category:()=>i.WD,Choice:()=>i.Lv,Do:()=>i.Do,Functor:()=>i.dO,Monad:()=>i.UA,Profunctor:()=>i.y$,Strong:()=>i.cK,URI:()=>i.ov,ap:()=>i.ap,apFirst:()=>i.N,apS:()=>i.Qt,apSW:()=>i.W5,apSecond:()=>i.a1,apW:()=>i.sL,ask:()=>i.mF,asks:()=>i.VF,bind:()=>i.ak,bindTo:()=>i.YO,bindW:()=>i.NP,chain:()=>i.tS,chainFirst:()=>i.mU,chainW:()=>i.Zl,compose:()=>i.qC,flatten:()=>i.xH,getMonoid:()=>i.uZ,getSemigroup:()=>i.jG,id:()=>i.id,local:()=>i.I_,map:()=>i.UI,of:()=>i.of,promap:()=>i.PY,reader:()=>i.r1,sequenceArray:()=>i.RD,traverseArray:()=>i.uU,traverseArrayWithIndex:()=>i.xW,createFrom:()=>s,composeS:()=>a});var r=n(17771),i=n(19429),o=n(55415),s=function(e){return function(t){return i.r1.map((0,r.g)(i.r1)(e,t),(function(e){var t=e[0],n=e[1];return(0,o.deepUpdate)(t,n)}))}},a=(0,r.Y)(i.r1)},51072:(e,t,n)=>{n.r(t),n.d(t,{Alt:()=>i.Rr,ApplicativePar:()=>i.qA,ApplicativeSeq:()=>i.GI,Bifunctor:()=>i.a_,Do:()=>i.Do,Functor:()=>i.dO,URI:()=>i.ov,alt:()=>i.wp,altW:()=>i.Gk,ap:()=>i.ap,apFirst:()=>i.N,apS:()=>i.Qt,apSW:()=>i.W5,apSecond:()=>i.a1,apW:()=>i.sL,bimap:()=>i.Pd,bind:()=>i.ak,bindTo:()=>i.YO,bindW:()=>i.NP,bracket:()=>i.wk,chainEitherK:()=>i.fX,chainEitherKW:()=>i.$h,chainFirst:()=>i.mU,chainFirstW:()=>i.Z6,chainIOEitherK:()=>i.Vh,chainIOEitherKW:()=>i.er,chainW:()=>i.Zl,filterOrElse:()=>i.Y$,filterOrElseW:()=>i.sf,flatten:()=>i.xH,fold:()=>i.g_,fromEitherK:()=>i.Dj,fromIO:()=>i.tD,fromIOEither:()=>i.fj,fromIOEitherK:()=>i.de,fromOption:()=>i.Yo,fromPredicate:()=>i.DT,fromTask:()=>i.fF,getAltTaskValidation:()=>i.NZ,getApplicativeTaskValidation:()=>i.IH,getApplyMonoid:()=>i.$4,getApplySemigroup:()=>i.gM,getFilterable:()=>i.VU,getOrElse:()=>i.fS,getOrElseW:()=>i.pF,getSemigroup:()=>i.jG,getTaskValidation:()=>i.ey,left:()=>i.t$,leftIO:()=>i.Op,leftTask:()=>i.lk,map:()=>i.UI,mapLeft:()=>i.Vn,of:()=>i.of,orElse:()=>i.vx,right:()=>i.F2,rightIO:()=>i.dk,rightTask:()=>i.QM,sequenceArray:()=>i.RD,sequenceSeqArray:()=>i.mg,swap:()=>i.LF,taskEither:()=>i.Ij,taskEitherSeq:()=>i.dg,taskify:()=>i.K9,throwError:()=>i._y,traverseArray:()=>i.uU,traverseArrayWithIndex:()=>i.xW,traverseSeqArray:()=>i.pE,traverseSeqArrayWithIndex:()=>i.Z9,tryCatch:()=>i.Y3,tryCatchK:()=>i.it,chain:()=>i.tS,fromEither:()=>i.Uo,toPromise:()=>l,flattenLeft:()=>u,flatMap:()=>d,flatMapEither:()=>p,flatMapEither2:()=>h,tryDelay:()=>m,handleError:()=>f});var r=n(99950),i=n(62965),o=n(57050),s=n(40327),a=n(95574),c=n(5114);function l(e){return e().then(a.unsafeGet)}var u=function(e){return i.Ij.chain(e,o.identity)},d=i.tS,p=function(e){return r.map(a.flatMap(e))},h=function(e){return function(t){return(0,s.pipe)(t,(0,i.tS)((function(t){return(0,i.Uo)(e(t))})))}};function m(e,t,n){return(0,s.pipe)(e,(0,i.g_)((function(o){var a=(0,s.pipe)((0,i.t$)(o),r.delay(n));return(0,s.pipe)(t(o),c.fold((function(){return(0,i.t$)(o)}),(function(t){var n=(0,s.pipe)(t,r.chain((function(){return(0,i.F2)(void 0)}))),o=r.getRaceMonoid().concat(a,n);return(0,s.pipe)(o,(0,i.tS)((function(){return e})))})))}),(function(e){return(0,i.F2)(e)})))}var f=function(e){return(0,i.vx)((function(t){return(0,s.pipe)(e(t),(0,i.tS)((function(){return(0,i.t$)(t)})))}))}},39160:(e,t,n)=>{n.d(t,{p:()=>c});var r=n(59312),i=n(11064),o=n(50157);var s=n(5114);function a(e){var t,n,r=(t=e,n=s.Applicative,{map:(0,o.o)(t,n).map,of:function(e){return t.of(n.of(e))},ap:function(e,r){return t.ap(t.map(e,(function(e){return function(t){return n.ap(e,t)}})),r)}}),i=e.of(s.none);return{map:r.map,ap:r.ap,of:r.of,chain:function(t,n){return e.chain(t,(0,s.fold)((function(){return i}),n))},alt:function(t,n){return e.chain(t,(0,s.fold)(n,(function(t){return e.of((0,s.some)(t))})))},fold:function(t,n,r){return e.chain(t,(0,s.fold)(n,r))},getOrElse:function(t,n){return e.chain(t,(0,s.fold)(n,e.of))},fromM:function(t){return e.map(t,s.some)},none:function(){return i}}}var c,l=n(40327);!function(e){var t;e.URI="IOOption",e.ioOption=(0,r.__assign)({URI:e.URI},a(i.io)),t=(0,l.pipeable)(e.ioOption),e.map=t.map,e.chain=t.chain,e.ap=t.ap,e.alt=t.alt,e.apFirst=t.apFirst,e.apSecond=t.apSecond,e.of=e.ioOption.of,e.fold=function(t,n){return function(r){return e.ioOption.fold(r,t,n)}},e.fromM=e.ioOption.fromM}(c||(c={}))},93476:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},18756:(e,t,n)=>{function r(e){return!(!e||"function"!=typeof e.equals||"function"!=typeof e.hashCode)}function i(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){const n=e.valueOf(),r=t.valueOf();if(n===r||n!=n&&r!=r)return!0;if(!n||!r)return!1}return!(!r(e)||!e.equals(t))}n.d(t,{AC:()=>s});function o(e){if("number"==typeof e)return e&e;if("function"==typeof e.valueOf){const t=e.valueOf();if(t!==e)return o(t)}return r(e)?e.hashCode():s(String(e))}function s(e){let t=0;if(null==e||0===e.length)return t;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}class a extends Error{constructor(e){let t="";for(const n of e.slice(0,2)){let e="";e=n instanceof Error?`${n.name}(${n.message})`:`${n}`,t+=", "+e}t=t.slice(2),e.length>2&&(t+=", ..."),super(t),this.name="CompositeError",this.errorsRef=e;this.constructor=a,this.__proto__=a.prototype}errors(){return this.errorsRef.slice()}}Error;class c extends Error{constructor(e){super(e),this.name="NoSuchElementError";this.constructor=c,this.__proto__=c.prototype}}Error;class l extends Error{constructor(e){super(e),this.name="IllegalStateError";this.constructor=l,this.__proto__=l.prototype}}class u extends Error{constructor(e){super(e),this.name="IllegalArgumentError";this.constructor=u,this.__proto__=u.prototype}}class d extends Error{constructor(e){super(e),this.name="NotImplementedError";this.constructor=d,this.__proto__=d.prototype}}class p extends Error{constructor(e){super(e),this.name="TimeoutError";this.constructor=p,this.__proto__=p.prototype}}function h(e){return function(){const t=Array.prototype.slice.call(arguments);return t.push(this),e.apply(void 0,t)}}function m(e,t,n){const r=e,i=r.prototype,o="fantasy-land/",s="equals",a=o+s,c="map",l=o+c,u="ap",d=o+u,p=o+"of",m="chain",f=o+m,g="chainRec",y=o+g;i.equals?i[a]=i.equals:n&&(i[a]=h(n.equals)),i.map?i[l]=i.map:t&&(i[l]=h(t.map)),i.ap?i[d]=i.ap:t&&(i[d]=h(t.ap)),r.pure?r[p]=r.pure:t&&(r[p]=t.of),i.chain?i[f]=i.chain:t&&(i[f]=h(t.chain)),r.chainRec?r[y]=r.chainRec:t&&(r[y]=t.chainRec)}class f{constructor(e,t){this._isRight="right"===t,this.value=e}isLeft(){return!this._isRight}isRight(){return this._isRight}contains(e){return this._isRight&&i(this.value,e)}exists(e){return this._isRight&&e(this.value)}filterOrElse(e,t){return this._isRight?e(this.value)?this:y(t()):this}flatMap(e){return this._isRight?e(this.value):this}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}fold(e,t){return this._isRight?t(this.value):e(this.value)}forAll(e){return!this._isRight||e(this.value)}get(){if(this._isRight)return this.value;throw new c("left.get()")}getOrElse(e){return this._isRight?this.value:e}getOrElseL(e){return this._isRight?this.value:e()}map(e){return this._isRight?v(e(this.value)):this}forEach(e){this._isRight&&e(this.value)}swap(){return this._isRight?y(this.value):v(this.value)}toOption(){return this._isRight?S(this.value):w}equals(e){return null!=e&&(this._isRight===e._isRight&&i(this.value,e.value))}hashCode(){return this._isRight?o(this.value)<<2:o(this.value)<<3}static pure(e){return new _(e)}static left(e){return y(e)}static right(e){return v(e)}static map2(e,t,n){return e.isLeft()?e:t.isLeft()?t:v(n(e.value,t.value))}static map3(e,t,n,r){return e.isLeft()?e:t.isLeft()?t:n.isLeft()?n:v(r(e.value,t.value,n.value))}static map4(e,t,n,r,i){return e.isLeft()?e:t.isLeft()?t:n.isLeft()?n:r.isLeft()?r:v(i(e.value,t.value,n.value,r.value))}static map5(e,t,n,r,i,o){return e.isLeft()?e:t.isLeft()?t:n.isLeft()?n:r.isLeft()?r:i.isLeft()?i:v(o(e.value,t.value,n.value,r.value,i.value))}static map6(e,t,n,r,i,o,s){return e.isLeft()?e:t.isLeft()?t:n.isLeft()?n:r.isLeft()?r:i.isLeft()?i:o.isLeft()?o:v(s(e.value,t.value,n.value,r.value,i.value,o.value))}static tailRecM(e,t){let n=e;for(;;){const e=t(n);if(!e.isRight())return e;const r=e.value;if(r.isRight())return v(r.value);n=r.value}}}class g extends f{constructor(e){super(e,"left")}}function y(e){return new g(e)}class _ extends f{constructor(e){super(e,"right")}}function v(e){return new _(e)}const b={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:f.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>f.tailRecM(t,(t=>e(f.left,f.right,t)))};m(f,b,b);class E{constructor(e,t){this._isEmpty=null!=t?t:null==e,this.value=e}get(){if(!this._isEmpty)return this.value;throw new c("Option.get")}getOrElse(e){return this._isEmpty?e:this.value}orNull(){return this._isEmpty?null:this.value}orUndefined(){return this._isEmpty?void 0:this.value}getOrElseL(e){return this._isEmpty?e():this.value}orElse(e){return this._isEmpty?e:this}orElseL(e){return this._isEmpty?e():this}isEmpty(){return this._isEmpty}nonEmpty(){return!this._isEmpty}map(e){return this._isEmpty?w:S(e(this.value))}flatMap(e){return this._isEmpty?w:e(this.value)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}filter(e){return this._isEmpty||!e(this.value)?w:this}fold(e,t){return this._isEmpty?e():t(this.value)}contains(e){return!this._isEmpty&&i(this.value,e)}exists(e){return!this._isEmpty&&e(this.value)}forAll(e){return this._isEmpty||e(this.value)}forEach(e){this._isEmpty||e(this.value)}equals(e){return null!=e&&(this.nonEmpty()&&e.nonEmpty()?i(this.value,e.value):this.isEmpty()&&e.isEmpty())}hashCode(){return this._isEmpty?2433880:null==this.value?9735524:o(this.value)<<2}static of(e){return null!=e?S(e):w}static some(e){return new E(e,!1)}static none(){return w}static empty(){return w}static pure(e){return S(e)}static map2(e,t,n){return e.nonEmpty()&&t.nonEmpty()?S(n(e.value,t.value)):w}static map3(e,t,n,r){return e.nonEmpty()&&t.nonEmpty()&&n.nonEmpty()?S(r(e.value,t.value,n.value)):w}static map4(e,t,n,r,i){return e.nonEmpty()&&t.nonEmpty()&&n.nonEmpty()&&r.nonEmpty()?S(i(e.value,t.value,n.value,r.value)):w}static map5(e,t,n,r,i,o){return e.nonEmpty()&&t.nonEmpty()&&n.nonEmpty()&&r.nonEmpty()&&i.nonEmpty()?S(o(e.value,t.value,n.value,r.value,i.value)):w}static map6(e,t,n,r,i,o,s){return e.nonEmpty()&&t.nonEmpty()&&n.nonEmpty()&&r.nonEmpty()&&i.nonEmpty()&&o.nonEmpty()?S(s(e.value,t.value,n.value,r.value,i.value,o.value)):w}static tailRecM(e,t){let n=e;for(;;){const e=t(n);if(!e.nonEmpty())return w;{const t=e.value;if(t.isRight())return S(t.value);n=t.value}}}}class I extends E{constructor(e){super(e,!1)}}function S(e){return new I(e)}const w=new class extends E{constructor(){super(void 0,!0)}},A={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:E.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>E.tailRecM(t,(t=>e(f.left,f.right,t)))};m(E,A,A);class C{constructor(e,t){this._isSuccess="success"===t,this.value=e}isSuccess(){return this._isSuccess}isFailure(){return!this._isSuccess}get(){if(!this._isSuccess)throw this.value;return this.value}getOrElse(e){return this._isSuccess?this.value:e}getOrElseL(e){return this._isSuccess?this.value:e()}orNull(){return this._isSuccess?this.value:null}orUndefined(){return this._isSuccess?this.value:void 0}orElse(e){return this._isSuccess?this:e}orElseL(e){return this._isSuccess?this:e()}failed(){return this._isSuccess?N(new c("try.failed()")):k(this.value)}fold(e,t){return this._isSuccess?t(this.value):e(this.value)}filter(e){if(!this._isSuccess)return this;try{return e(this.value)?this:N(new c(`Predicate does not hold for ${this.value}`))}catch(e){return N(e)}}flatMap(e){if(!this._isSuccess)return this;try{return e(this.value)}catch(e){return N(e)}}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}map(e){return this._isSuccess?C.of((()=>e(this.value))):this}forEach(e){this._isSuccess&&e(this.value)}recover(e){return this._isSuccess?this:C.of((()=>e(this.value)))}recoverWith(e){try{return this._isSuccess?this:e(this.value)}catch(e){return N(e)}}toOption(){return this._isSuccess?S(this.value):w}toEither(){return this._isSuccess?v(this.value):y(this.value)}equals(e){return null!=e&&(this._isSuccess?e._isSuccess&&i(this.value,e.value):!e._isSuccess&&i(this.value,e.value))}hashCode(){return this._isSuccess,o(this.value)}static of(e){try{return k(e())}catch(e){return N(e)}}static pure(e){return C.success(e)}static unit(){return x}static success(e){return k(e)}static failure(e){return N(e)}static raise(e){return N(e)}static map2(e,t,n){if(e.isFailure())return e;if(t.isFailure())return t;try{return k(n(e.value,t.value))}catch(e){return N(e)}}static map3(e,t,n,r){if(e.isFailure())return e;if(t.isFailure())return t;if(n.isFailure())return n;try{return k(r(e.value,t.value,n.value))}catch(e){return N(e)}}static map4(e,t,n,r,i){if(e.isFailure())return e;if(t.isFailure())return t;if(n.isFailure())return n;if(r.isFailure())return r;try{return k(i(e.value,t.value,n.value,r.value))}catch(e){return N(e)}}static map5(e,t,n,r,i,o){if(e.isFailure())return e;if(t.isFailure())return t;if(n.isFailure())return n;if(r.isFailure())return r;if(i.isFailure())return i;try{return k(o(e.value,t.value,n.value,r.value,i.value))}catch(e){return N(e)}}static map6(e,t,n,r,i,o,s){if(e.isFailure())return e;if(t.isFailure())return t;if(n.isFailure())return n;if(r.isFailure())return r;if(i.isFailure())return i;if(o.isFailure())return o;try{return k(s(e.value,t.value,n.value,r.value,i.value,o.value))}catch(e){return N(e)}}static tailRecM(e,t){let n=e;for(;;)try{const e=t(n);if(e.isFailure())return e;const r=e.get();if(r.isRight())return k(r.value);n=r.value}catch(e){return N(e)}}}class T extends C{constructor(e){super(e,"success")}}function k(e){return new T(e)}class O extends C{constructor(e){super(e,"failure")}}function N(e){return new O(e)}const M={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:C.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>C.tailRecM(t,(t=>e(f.left,f.right,t)))};m(C,M,M);const x=k(void 0);class R{static of(e){return new L(e)}static empty(){return P}static collection(...e){return new F(e)}static cancelAll(e){let t=null;for(const n of e)try{n.cancel()}catch(e){t?t.push(e):t=[e]}if(t)throw 1===t.length?t[0]:new a(t)}}class L extends R{constructor(e){super(),this.thunk=e}cancel(){if(null!==this.thunk){const e=this.thunk;this.thunk=null,e()}}}class D{constructor(){this._funIsDummy=!0}cancel(){}}const P=new D;class U{static of(e){return new j(e)}static empty(){return new B}static alreadyCanceled(){return W}static collection(...e){return new F(e)}}class F extends U{constructor(e){super(),this._refs=e}isCanceled(){return!this._refs}cancel(){if(this._refs)try{R.cancelAll(this._refs)}finally{delete this._refs}}}class j extends L{isCanceled(){return null===this.thunk}}class B extends U{constructor(){super(...arguments),this.canceled=!1}isCanceled(){return this.canceled}cancel(){this.canceled=!0}}const W=new class extends D{isCanceled(){return!0}};new class extends D{isCanceled(){return!0}cancel(){}update(e){return e.cancel(),this}};class G{constructor(e){this._underlying=e,this._canceled=!1}update(e){return this._canceled?e.cancel():this._underlying=e,this}isCanceled(){return this._canceled}cancel(){this._canceled||(this._canceled=!0,this._underlying&&(this._underlying.cancel(),delete this._underlying))}collapse(){if(this._underlying&&this._underlying instanceof G){const e=this._underlying;this._underlying=e._underlying,this._canceled=e._canceled}return this}clear(){return this._canceled||(this._underlying=void 0),this}static empty(){return new G}static of(e){return new G(R.of(e))}}class z{constructor(e){this._refs=e?e.slice(0):[]}cancel(){if(this._refs)try{R.cancelAll(this._refs)}finally{delete this._refs}}isCanceled(){return!this._refs}push(e){return this._refs?this._refs.push(e):e.cancel(),this}pop(){return this._refs&&this._refs.pop()||R.empty()}static empty(){return new z}static collection(...e){return new z(e)}}class H{constructor(e){this._underlying=e||P,this._chained=!1}update(e){if(!e)throw new u("cannot update to null value");return this._underlying?this._chained?(this._underlying.update(e),this):(this._underlying=e,this):(e.cancel(),this)}cancel(){this._underlying&&(this._underlying.cancel(),this._chained=!1,delete this._underlying)}clear(){this._underlying&&(this._underlying=P,this._chained=!1)}isCanceled(){return!this._underlying||this._chained&&this._underlying.isCanceled()}chainTo(e){if(!e)throw new u("cannot chain to null value");if(e===this)return this;if(!this._underlying)return e.cancel(),this;let t=e,n=!0;for(;t&&n;)if(t._chained){const e=t._underlying;if(e===this)return this;t=e,n=!!e}else t._underlying||(t=void 0),n=!1;if(t){const e=this._underlying;this._underlying=t,this._chained=!0,e instanceof D||t.update(e)}else this.cancel();return this}static empty(){return new H}}class q{toString(){return this.label.toUpperCase()}}const Y=1e3,V=1e6,$=1e3*V,Q=60*$,Z=60*Q,X=24*Z,J=9007199254740992,K=Math.trunc||function(e){return isNaN(e)?NaN:e>0?Math.floor(e):Math.ceil(e)};function ee(e,t,n){return e>n?J:e<-n?-9007199254740992:e*t}const te=new class extends q{constructor(){super(...arguments),this.ord=0,this.label="nanoseconds"}convert(e,t){return t.toNanos(e)}toNanos(e){return e}toMicros(e){return K(e/1e3)}toMillis(e){return K(e/(V/1))}toSeconds(e){return K(e/($/1))}toMinutes(e){return K(e/(Q/1))}toHours(e){return K(e/(Z/1))}toDays(e){return K(e/(X/1))}};const ne=new class extends q{constructor(){super(...arguments),this.ord=1,this.label="microseconds"}convert(e,t){return t.toMicros(e)}toNanos(e){return ee(e,1e3,K(J/1e3))}toMicros(e){return e}toMillis(e){return K(e/1e3)}toSeconds(e){return K(e/($/Y))}toMinutes(e){return K(e/(Q/Y))}toHours(e){return K(e/(Z/Y))}toDays(e){return K(e/(X/Y))}};const re=new class extends q{constructor(){super(...arguments),this.ord=2,this.label="milliseconds"}convert(e,t){return t.toMillis(e)}toNanos(e){return ee(e,V/1,K(J/(V/1)))}toMicros(e){return ee(e,1e3,K(J/1e3))}toMillis(e){return e}toSeconds(e){return K(e/1e3)}toMinutes(e){return K(e/6e4)}toHours(e){return K(e/(Z/V))}toDays(e){return K(e/(X/V))}};const ie=new class extends q{constructor(){super(...arguments),this.ord=3,this.label="seconds"}convert(e,t){return t.toSeconds(e)}toNanos(e){return ee(e,$/1,K(J/($/1)))}toMicros(e){return ee(e,$/Y,K(J/($/Y)))}toMillis(e){return ee(e,1e3,K(J/1e3))}toSeconds(e){return e}toMinutes(e){return K(e/60)}toHours(e){return K(e/3600)}toDays(e){return K(e/86400)}};const oe=new class extends q{constructor(){super(...arguments),this.ord=4,this.label="minutes"}convert(e,t){return t.toMinutes(e)}toNanos(e){return ee(e,Q/1,K(J/(Q/1)))}toMicros(e){return ee(e,Q/Y,K(J/(Q/Y)))}toMillis(e){return ee(e,6e4,K(J/6e4))}toSeconds(e){return ee(e,60,K(J/60))}toMinutes(e){return e}toHours(e){return K(e/60)}toDays(e){return K(e/1440)}};const se=new class extends q{constructor(){super(...arguments),this.ord=5,this.label="hours"}convert(e,t){return t.toHours(e)}toNanos(e){return ee(e,Z/1,K(J/(Z/1)))}toMicros(e){return ee(e,Z/Y,K(J/(Z/Y)))}toMillis(e){return ee(e,Z/V,K(J/(Z/V)))}toSeconds(e){return ee(e,3600,K(J/3600))}toMinutes(e){return ee(e,60,K(J/60))}toHours(e){return e}toDays(e){return K(e/24)}};const ae=new class extends q{constructor(){super(...arguments),this.ord=6,this.label="days"}convert(e,t){return t.toDays(e)}toNanos(e){return ee(e,X/1,K(J/(X/1)))}toMicros(e){return ee(e,X/Y,K(J/(X/Y)))}toMillis(e){return ee(e,X/V,K(J/(X/V)))}toSeconds(e){return ee(e,86400,K(J/86400))}toMinutes(e){return ee(e,1440,K(J/1440))}toHours(e){return ee(e,24,K(J/24))}toDays(e){return e}};class ce{constructor(e,t){if(isNaN(e))throw new u("NaN is not supported for a Duration");this.duration=K(e),this.unit=t}isFinite(){return isFinite(this.duration)}toNanos(){return te.convert(this.duration,this.unit)}toMicros(){return ne.convert(this.duration,this.unit)}toMillis(){return re.convert(this.duration,this.unit)}toSeconds(){return ie.convert(this.duration,this.unit)}toMinutes(){return oe.convert(this.duration,this.unit)}toHours(){return se.convert(this.duration,this.unit)}toDays(){return ae.convert(this.duration,this.unit)}convertTo(e){return new ce(e.convert(this.duration,this.unit),e)}negate(){switch(this.duration){case 1/0:return ce.negInf();case-1/0:return ce.inf();default:return new ce(-this.duration,this.unit)}}plus(e){if(!isFinite(this.duration)){if(!isFinite(e.duration)&&this.duration!==e.duration)throw new u("cannot deal with two infinities with different signs, as that would be a NaN");return this}if(0===e.duration)return this;if(0===this.duration)return e;if(!isFinite(e.duration))return e;let t=this,n=e;return n.unit.ord<t.unit.ord&&(t=e,n=this),n=n.convertTo(t.unit),new ce(t.duration+n.duration,t.unit)}minus(e){return this.plus(e.negate())}equals(e){function t(e,t){return e.unit.convert(t.duration,t.unit)===e.duration}return isFinite(this.duration)?this.unit.ord<=e.unit.ord?t(this,e):t(e,this):!isFinite(e.duration)&&this.duration===e.duration}hashCode(){return this.isFinite()?this.toNanos():this.duration===1/0?7540833725118015:422082410550358}toString(){return this.isFinite()?`${this.duration} ${this.unit.label}`:this.duration>=0?"[end of time]":"[beginning of time]"}static of(e){return"number"==typeof e?ce.millis(e):e}static zero(){return new ce(0,ae)}static inf(){return new ce(1/0,ae)}static negInf(){return new ce(-1/0,ae)}static nanos(e){return new ce(e,te)}static micros(e){return new ce(e,ne)}static millis(e){return new ce(e,re)}static seconds(e){return new ce(e,ie)}static minutes(e){return new ce(e,oe)}static hours(e){return new ce(e,se)}static days(e){return new ce(e,ae)}}class le{constructor(e){this._previous=[],this.get=e}set(e){return this.setL((()=>e))}setL(e){this._previous.push(this.get),this.get=e}revert(){const e=this._previous.pop();e&&(this.get=e)}bind(e,t){return this.bindL((()=>e),t)}bindL(e,t){const n=this.get,r=this._previous.slice(0),i=this;try{return i.get=e,t()}finally{i.get=n,i._previous=r}}static of(e){return new le(e)}}function ue(e){if(!e)return[];if("[object Array]"===Object.prototype.toString.call(e))return e;const t=e[Symbol.iterator](),n=[];for(;;){const e=t.next();if(e.value&&n.push(e.value),e.done)return n}}const de=Math.log(2);function pe(e){if(e<0)throw new u("nr must be positive");const t=Math.ceil(function(e){return Math.log(e)/de}(e));return 1<<(t>30?30:t&t)}class he{constructor(e){switch(this.batchIndex=0,this.executionModel=e,e.type){case"alwaysAsync":this.executeBatched=this.executeAsync;break;case"synchronous":this.executeBatched=this.trampoline;break;case"batched":const t=e.recommendedBatchSize-1;this.executeBatched=e=>{const n=this.batchIndex+1&t;return n?(this.batchIndex=n,this.trampoline(e)):this.executeAsync(e)}}}scheduleWithFixedDelay(e,t,n){const r=(e,i,o)=>i.update(e.scheduleOnce(o,(()=>{n(),r(e,i,t)}))),i=G.empty();return r(this,i,e)}scheduleAtFixedRate(e,t,n){const r=(e,t,i,o)=>t.update(e.scheduleOnce(i,(()=>{const i=e.currentTimeMillis();n();const s=e.currentTimeMillis()-i,a=Math.max(0,o-s);r(e,t,o,a)}))),i=G.empty();return r(this,i,"number"==typeof e?e:e.toMillis(),"number"==typeof t?t:t.toMillis())}}he.global=le.of((()=>ye));class me{constructor(e,t){switch(this.type=e,e){case"synchronous":this.recommendedBatchSize=1073741824;break;case"alwaysAsync":this.recommendedBatchSize=1;break;case"batched":this.recommendedBatchSize=pe(t||128)}}equals(e){return this.type===e.type&&this.recommendedBatchSize===e.recommendedBatchSize}hashCode(){return 47*s(this.type)+this.recommendedBatchSize}static synchronous(){return new me("synchronous")}static alwaysAsync(){return new me("alwaysAsync")}static batched(e){return new me("batched",e)}}me.global=le.of((()=>me.batched()));class fe{constructor(e){this._isActive=!1,this._queue=[],this._reporter=e}execute(e){this._isActive?this._queue.push(e):this.runLoop(e)}runLoop(e){this._isActive=!0;try{let t=e;for(;t;){try{t()}catch(e){this._reporter(e)}t=this._queue.pop()}}finally{this._isActive=!1}}}class ge extends he{constructor(e=!1,t=me.global.get(),n){super(t),n&&(this.reportFailure=n),this._trampoline=new fe(this.reportFailure),this._useSetImmediate=!!e&&"function"==typeof setImmediate,this.executeAsync=this._useSetImmediate?e=>setImmediate(_e(e,this.reportFailure)):e=>setTimeout(_e(e,this.reportFailure))}executeAsync(e){throw new d("Constructor of GlobalScheduler wasn't executed")}trampoline(e){return this._trampoline.execute(e)}reportFailure(e){console.error(e)}currentTimeMillis(){return Date.now()}scheduleOnce(e,t){const n=Math.max(0,ce.of(e).toMillis()),r=setTimeout((()=>{this.batchIndex=0;try{t()}catch(e){this.reportFailure(e)}}),n);return R.of((()=>clearTimeout(r)))}withExecutionModel(e){return new ge(this._useSetImmediate,e)}}const ye=new ge(!0);function _e(e,t){return()=>{try{e()}catch(e){t(e)}}}class ve{transform(e,t){return this.transformWith((t=>ve.pure(e(t),this._scheduler)),(e=>ve.pure(t(e),this._scheduler)))}attempt(){return this.transform(y,v)}flatMap(e){return this.transformWith(ve.raise,e)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}forEach(e){this.onComplete((t=>t.forEach(e)))}map(e){return this.transformWith(ve.raise,(t=>ve.pure(e(t),this._scheduler)))}recoverWith(e){return this.transformWith(e,ve.pure)}recover(e){return this.transformWith((t=>ve.pure(e(t),this._scheduler)),(e=>ve.pure(e,this._scheduler)))}then(e,t){if(!e&&!t)return this;const n=this._scheduler;return this.transformWith(Ce(t,(e=>ve.raise(e,n)),n),Ce(e,(e=>ve.pure(e,n)),n))}toPromise(){return new Promise(((e,t)=>{this.onComplete((n=>n.fold(t,e)))}))}delayResult(e){return this.transformWith((t=>ve.delayedTick(e,this._scheduler).flatMap((()=>ve.raise(t,this._scheduler)))),(t=>ve.delayedTick(e,this._scheduler).map((()=>t))))}timeout(e){const t=ve.raise(new p(ce.of(e).toString()),this._scheduler);return this.timeoutTo(e,(()=>t))}timeoutTo(e,t){const n=[this,ve.delayedTick(e,this._scheduler).flatMap((()=>t()))];return ve.firstCompletedOf(n,this._scheduler)}static of(e,t=he.global.get()){const n=we.empty(t);return t.executeAsync((()=>n.tryComplete(C.of(e)))),n.future()}static pure(e,t=he.global.get()){return new be(k(e),t)}static raise(e,t=he.global.get()){return new be(N(e),t)}static create(e,t=he.global.get()){const n=we.empty(t);try{const t=e(n.complete);return n.future(t||void 0)}catch(e){return ve.raise(e,t)}}static unit(e=he.global.get()){const t=e;let n=t._funCache&&t._funCache.futureUnit;return n||(n=new be(k(void 0),e),t._funCache=t._funCache||{},t._funCache.futureUnit=n),n}static delayedTick(e,t=he.global.get()){return ve.create((n=>t.scheduleOnce(e,(()=>n(k(void 0))))),t)}static tailRecM(e,t,n=he.global.get()){return t(e).flatMap((e=>e.isRight()?ve.pure(e.get(),n):ve.tailRecM(e.swap().get(),t,n)))}static fromPromise(e,t=he.global.get()){return e instanceof ve?e.withScheduler(t):ve.create((t=>{e.then((e=>t(k(e))),(e=>t(N(e))))}),t)}static fromTry(e,t=he.global.get()){return new be(e,t)}static firstCompletedOf(e,t=he.global.get()){return function(e,t){return ve.create((n=>{try{const r=ke(e,t);if(0===r.length)return n(N(new u("empty list of futures")));let i=!1;for(let e=0;e<r.length;e++){const o=e;r[e].onComplete((e=>{i?e.isFailure()&&t.reportFailure(e.failed().get()):(i=!0,Te(r,t,o),n(e))}))}return R.of((()=>Te(r,t)))}catch(e){n(N(e))}}),t)}(e,t)}static traverse(e,t=1/0,n=he.global.get()){return r=>function(e,t,n,r){if(n<=0)throw new u("parallelism <= 0");return ve.of((()=>ue(e)),r).flatMap((e=>Oe(e,t,n,r,0,[])))}(e,r,t,n)}static sequence(e,t=he.global.get()){return function(e,t){return ve.create((n=>{try{const r=ke(e,t);if(0===r.length)return n(k([]));const i=R.of((()=>Te(r,t)));let o=!1,s=0,a=[];for(let e=0;e<r.length;e++){const c=e;r[e].onComplete((e=>{s+=1,e.isSuccess()?o||(a[c]=e.get(),o=s===r.length,o&&n(k(a))):o?t.reportFailure(e.failed().get()):(o=!0,i.cancel(),n(e))}))}return i}catch(e){n(N(e))}}),t)}(e,t)}static map2(e,t,n,r=he.global.get()){return ve.sequence([e,t],r).map((e=>n(e[0],e[1])))}static map3(e,t,n,r,i=he.global.get()){return ve.sequence([e,t,n],i).map((e=>r(e[0],e[1],e[2])))}static map4(e,t,n,r,i,o=he.global.get()){return ve.sequence([e,t,n,r],o).map((e=>i(e[0],e[1],e[2],e[3])))}static map5(e,t,n,r,i,o,s=he.global.get()){return ve.sequence([e,t,n,r,i],s).map((e=>o(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,n,r,i,o,s,a=he.global.get()){return ve.sequence([e,t,n,r,i,o],a).map((e=>s(e[0],e[1],e[2],e[3],e[4],e[5])))}}class be extends ve{constructor(e,t){super(),this._value=e,this._scheduler=t}cancel(){}value(){return S(this._value)}withScheduler(e){return this._scheduler===e?this:new be(this._value,e)}onComplete(e){this._scheduler.executeBatched((()=>e(this._value)))}transformWith(e,t){return Ae(this,e,t,this._scheduler)}toPromise(){return this._value.fold((e=>Promise.reject(e)),(e=>Promise.resolve(e)))}}class Ee{constructor(){this.id=null,this.ref=null}compressedRoot(){let e=this;for(;"chained"===e.id;)e=e.ref,this.ref=e;return e}value(){switch(this.id){case null:return w;case"complete":return S(this.ref);case"chained":return this.compressedRoot().value()}}tryComplete(e,t){switch(this.id){case null:const n=this.ref;if(this.ref=e,this.id="complete",n)for(let r=0;r<n.length;r++)t.executeBatched((()=>n[r](e)));return!0;case"complete":return!1;case"chained":const r=this.ref.compressedRoot(),i=r.tryComplete(e,t);return this.id="complete",this.ref=i?e:r.value().get(),i}}chainTo(e,t){switch(this.id){case null:const n=this.ref;if(this.id="chained",this.ref=e.compressedRoot(),n&&n.length>0)for(let r=0;r<n.length;r++)e.onComplete(n[r],t);break;case"chained":this.compressedRoot().chainTo(e.compressedRoot(),t);break;case"complete":e.tryComplete(this.ref,t)}}onComplete(e,t){switch(this.id){case null:this.ref||(this.ref=[]),this.ref.push(e);break;case"complete":t.executeBatched((()=>e(this.ref)));break;case"chained":this.ref.onComplete(e,t)}}}const Ie={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:ve.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>ve.tailRecM(t,(t=>e(f.left,f.right,t)))};m(ve,Ie);class Se extends ve{constructor(e,t,n){super(),this._state=e,this._scheduler=n,t&&(this._cancelable=t)}value(){return this._state.value()}onComplete(e){return this._state.onComplete(e,this._scheduler)}cancel(){if(this._cancelable)try{this._cancelable.cancel()}finally{delete this._cancelable}}withScheduler(e){return this._scheduler===e?this:new Se(this._state,this._cancelable,e)}transformWith(e,t){return Ae(this,e,t,this._scheduler,this._cancelable)}}class we{constructor(e,t){this.tryComplete=e=>this._state.tryComplete(e,this._scheduler),this.complete=e=>{if(!this.tryComplete(e))throw new l("Cannot complete a FutureMaker twice!")},this._state=e,this._scheduler=t}trySuccess(e){return this.tryComplete(k(e))}success(e){return this.complete(k(e))}tryFailure(e){return this.tryComplete(N(e))}failure(e){return this.complete(N(e))}chainTo(e){this._state.chainTo(e._state,this._scheduler)}future(e){switch(this._state.id){case"complete":return new be(this._state.ref,this._scheduler);default:return new Se(this._state,e,this._scheduler)}}withScheduler(e){return this._scheduler===e?this:new we(this._state,e)}static empty(e=he.global.get()){return new we(new Ee,e)}static completed(e,t=he.global.get()){const n=new Ee;return n.id="complete",n.ref=e,new we(n,t)}}function Ae(e,t,n,r,i){const o=we.empty(r),s=new H(i);return e.onComplete((e=>{let i;try{i=e.fold(t,n)}catch(e){i=ve.raise(e)}if(i.value().isEmpty()){const e=i._cancelable;e&&e instanceof H?e.chainTo(s):!e||e instanceof D||s.update(e)}else s.clear();i instanceof Se?i._state.chainTo(o._state,r):i.onComplete(o.tryComplete)})),o.future(s)}function Ce(e,t,n){return r=>{if("function"!=typeof e)return t(r);const i=e(r);return i?"function"==typeof i.then?ve.fromPromise(i,n):ve.pure(i,n):ve.pure(r,n)}}function Te(e,t,n=-1){const r=[];for(let t=0;t<e.length;t++)if(t!==n)try{e[t].cancel()}catch(e){r.push(e)}if(r.length>0)for(const e of r)t.reportFailure(e)}function ke(e,t){if(!e)return[];if("[object Array]"===Object.prototype.toString.call(e))return e;const n=[];try{const t=e[Symbol.iterator]();for(;;){const e=t.next();if(e.value&&n.push(e.value),e.done)break}return n}catch(e){throw Te(n,t),e}}function Oe(e,t,n,r,i,o){if(i>=e.length)return ve.pure(o,r);let s=[],a=0;try{for(;i<e.length&&a<n;)s.push(t(e[i++])),a+=1;const c=ve.sequence(s,r).map((e=>{for(let t=0;t<e.length;t++)o.push(e[t])}));return i>=e.length?c.map((()=>o)):c.flatMap((()=>Oe(e,t,n,r,i,o)))}catch(e){return Te(s,r),ve.raise(e)}}const Ne={next:()=>({done:!0})};function Me(e){if(!e)return Ne;if("[object Array]"!==Object.prototype.toString.call(e))return e[Symbol.iterator]();const t=e;if(0===t.length)return Ne;let n=0;return{next:()=>{const e=t[n++];return{done:n>=t.length,value:e}}}}class xe{get(){return function(e){let t=e,n=null,r=null;for(;;)switch(t._tag){case"now":const e=t,i=Be(n,r);if(!i)return e.value;n=null,t=i(e.value);break;case"always":case"once":t=new Re(t.get());break;case"suspend":t=t.thunk();break;case"flatMap":n&&(r||(r=[]),r.push(n));const o=t;n=o.f,t=o.source}}(this)}map(e){return new Fe(this,(t=>xe.now(e(t))))}flatMap(e){return new Fe(this,e)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}memoize(){switch(this._tag){case"now":case"once":return this;case"always":return new De(this.get);default:return new De((()=>this.get()))}}forEachL(e){return this.map(e)}forEach(e){this.forEachL(e).get()}static of(e){return xe.always(e)}static pure(e){return xe.now(e)}static now(e){return new Re(e)}static unit(){return Le}static always(e){return new Pe(e)}static once(e){return new De(e)}static suspend(e){return new Ue(e)}static defer(e){return xe.suspend(e)}static tailRecM(e,t){return t(e).flatMap((e=>e.isRight()?xe.now(e.get()):xe.tailRecM(e.swap().get(),t)))}static sequence(e){return function(e){return xe.of((()=>Me(e))).flatMap((e=>We([],e)))}(e)}static map2(e,t,n){return xe.sequence([e,t]).map((e=>n(e[0],e[1])))}static map3(e,t,n,r){return xe.sequence([e,t,n]).map((e=>r(e[0],e[1],e[2])))}static map4(e,t,n,r,i){return xe.sequence([e,t,n,r]).map((e=>i(e[0],e[1],e[2],e[3])))}static map5(e,t,n,r,i,o){return xe.sequence([e,t,n,r,i]).map((e=>o(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,n,r,i,o,s){return xe.sequence([e,t,n,r,i,o]).map((e=>s(e[0],e[1],e[2],e[3],e[4],e[5])))}}class Re extends xe{constructor(e){super(),this.value=e,this._tag="now"}get(){return this.value}toString(){return`Eval.now(${JSON.stringify(this.value)})`}}const Le=new Re(void 0);class De extends xe{constructor(e){super(),this._tag="once",this._thunk=e}get(){if(this._thunk){try{this._cache=this._thunk(),this._isError=!1}catch(e){this._cache=e,this._isError=!0}delete this._thunk}if(this._isError)throw this._cache;return this._cache}toString(){return"Eval.once([thunk])"}}class Pe extends xe{constructor(e){super(),this._tag="always",this.get=e}toString(){return"Eval.always([thunk])"}}class Ue extends xe{constructor(e){super(),this.thunk=e,this._tag="suspend"}toString(){return"Eval.suspend([thunk])"}}class Fe extends xe{constructor(e,t){super(),this.source=e,this.f=t,this._tag="flatMap"}toString(){return`Eval#FlatMap(${String(this.source)}, [function])`}}const je={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:xe.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>xe.tailRecM(t,(t=>e(f.left,f.right,t)))};function Be(e,t){return e||(t&&t.length>0?t.pop():null)}function We(e,t){for(;;){const n=t.next(),r=n.done;if(n.value){return n.value.flatMap((n=>(e.push(n),r?xe.pure(e):We(e,t))))}if(r)return xe.pure(e)}}m(xe,je);class Ge{run(e=he.global.get()){return function(e,t){let n=e,r=null,i=null;const o=t.executionModel.recommendedBatchSize-1;let s=t.batchIndex;for(;;)if(n instanceof C){if(n.isSuccess()){const e=et(r,i);if(!e)return t.batchIndex=s,ve.pure(n.get());try{n=e(n.get())}catch(e){n=new ze(C.failure(e))}}else{const e=n.failed().get(),o=tt(r,i);if(!o)return t.batchIndex=s,ve.raise(e);try{n=o(e)}catch(e){n=new ze(C.failure(e))}}r=null;const e=s+1&o;if(!e)return st(n,t,r,i,!0);s=e}else switch(n._tag){case"pure":n=n.value;break;case"always":n=C.of(n.thunk);break;case"once":n=n.runTry();break;case"flatMap":const e=n;r&&(i||(i=[]),i.push(r)),r=e.g?[e.f,e.g]:e.f,n=e.source;break;case"async":case"memoize":return st(n,t,r,i,!1)}}(this,e)}runOnComplete(e,t=he.global.get()){return ot(this,t,null,e,null,null,null)||R.empty()}attempt(){return this.transform((e=>f.left(e)),f.right)}asyncBoundary(e){return this.flatMap((t=>Ge.shift(e).map((()=>t))))}chain(e){return this.flatMap(e)}delayExecution(e){return Ge.delayedTick(e).flatMap((()=>this))}delayResult(e){return this.transformWith((t=>Ge.delayedTick(e).flatMap((()=>Ge.raise(t)))),(t=>Ge.delayedTick(e).map((()=>t))))}doOnFinish(e){return this.transformWith((t=>e(S(t)).flatMap((()=>Ge.raise(t)))),(t=>e(w).map((()=>t))))}doOnCancel(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.scheduler;r.trampoline((()=>{const i=t.connection;i.push(R.of((()=>e.run(r)))),Ge.unsafeStart(this,t,at(r,i,n))}))}))}executeForked(e){return Ge.fork(this,e)}executeWithModel(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.scheduler.withExecutionModel(e),i=new Ze(r,t.connection,t.options);r.trampoline((()=>Ge.unsafeStart(this,i,n)))}))}executeWithOptions(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.scheduler,i=new Ze(r,t.connection,e);r.trampoline((()=>Ge.unsafeStart(this,i,n)))}))}flatMap(e){return new Ve(this,e)}ap(e){return e.flatMap((e=>this.map(e)))}followedBy(e){return this.flatMap((()=>e))}forEach(e){return this.map(e)}forEffect(e){return this.flatMap((t=>e.map((()=>t))))}map(e){return new Ve(this,(t=>Ge.now(e(t))))}memoize(){switch(this._tag){case"pure":return this;case"always":return new qe(this.thunk,!1);case"memoize":const e=this;return e.onlySuccess?new Qe(this,!1):e;default:return new Qe(this,!1)}}memoizeOnSuccess(){switch(this._tag){case"pure":case"once":case"memoize":return this;case"always":return new qe(this.thunk,!0);default:return new Qe(this,!0)}}recover(e){return this.recoverWith((t=>Ge.now(e(t))))}recoverWith(e){return this.transformWith(e,Ge.now)}timeout(e){const t=Ge.raise(new p(ce.of(e).toString()));return this.timeoutTo(e,t)}timeoutTo(e,t){const n=[this,Ge.delayedTick(e).flatMap((()=>t))];return Ge.firstCompletedOf(n)}transform(e,t){return this.transformWith((t=>Ge.now(e(t))),(e=>Ge.now(t(e))))}transformWith(e,t){return new Ve(this,t,e)}static always(e){return new Ye(e)}static async(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.scheduler,i=t.connection;r.trampoline((()=>{const t=at(r,i,n);try{const n=e(r,t);i.push(n||R.empty())}catch(e){t(N(e))}}))}))}static asyncUnsafe(e){return new $e(e)}static defer(e){return Ge.unit().flatMap((()=>e()))}static deferAction(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.scheduler;let i;try{i=e(r)}catch(e){i=Ge.raise(e)}r.trampoline((()=>Ge.unsafeStart(i,t,n)))}))}static deferFuture(e){return Ge.suspend((()=>Ge.fromFuture(e())))}static deferFutureAction(e){return Ge.deferAction((t=>Ge.fromFuture(e(t))))}static delayedTick(e){return Ge.asyncUnsafe(((t,n)=>{const r=t.connection,i=t.scheduler.scheduleOnce(e,(()=>{r.pop(),n(C.unit())}));r.push(i)}))}static firstCompletedOf(e){return ut(e,ve.firstCompletedOf)}static fromFuture(e){return e.value().isEmpty()?Ge.asyncUnsafe(((t,n)=>{t.connection.push(e),e.onComplete((e=>{t.connection.pop(),n(e)}))})):Ge.fromTry(e.value().get())}static fromTry(e){return new ze(e)}static fork(e,t){return Ge.shift(t).flatMap((()=>e))}static map2(e,t,n){return Ge.sequence([e,t]).map((e=>n(e[0],e[1])))}static map3(e,t,n,r){return Ge.sequence([e,t,n]).map((e=>r(e[0],e[1],e[2])))}static map4(e,t,n,r,i){return Ge.sequence([e,t,n,r]).map((e=>i(e[0],e[1],e[2],e[3])))}static map5(e,t,n,r,i,o){return Ge.sequence([e,t,n,r,i]).map((e=>o(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,n,r,i,o,s){return Ge.sequence([e,t,n,r,i,o]).map((e=>s(e[0],e[1],e[2],e[3],e[4],e[5])))}static now(e){return new ze(k(e))}static of(e){return Ge.always(e)}static once(e){return new qe(e,!1)}static parMap2(e,t,n){return Ge.gather([e,t]).map((e=>n(e[0],e[1])))}static parMap3(e,t,n,r){return Ge.gather([e,t,n]).map((e=>r(e[0],e[1],e[2])))}static parMap4(e,t,n,r,i){return Ge.gather([e,t,n,r]).map((e=>i(e[0],e[1],e[2],e[3])))}static parMap5(e,t,n,r,i,o){return Ge.gather([e,t,n,r,i]).map((e=>o(e[0],e[1],e[2],e[3],e[4])))}static parMap6(e,t,n,r,i,o,s){return Ge.gather([e,t,n,r,i,o]).map((e=>s(e[0],e[1],e[2],e[3],e[4],e[5])))}static pure(e){return Ge.now(e)}static raise(e){return new ze(N(e))}static sequence(e){return function(e){return Ge.of((()=>Me(e))).flatMap((e=>lt([],e)))}(e)}static gather(e){return ut(e,ve.sequence)}static shift(e){return e?Je(e):Ke}static suspend(e){return Ge.unit().flatMap((()=>e()))}static tailRecM(e,t){try{return t(e).flatMap((e=>e.isRight()?Ge.now(e.get()):Ge.tailRecM(e.swap().get(),t)))}catch(e){return Ge.raise(e)}}static unit(){return He}static unsafeStart(e,t,n){return ot(e,t.scheduler,t,n,null,null,null)}}class ze extends Ge{constructor(e){super(),this.value=e,this._tag="pure"}}const He=new ze(C.unit());class qe extends Ge{constructor(e,t){super(),this._tag="once",this._thunk=e,this.onlyOnSuccess=t}memoize(){return this.onlyOnSuccess&&this._thunk?new qe(this._thunk,!1):this}runTry(){if(this._thunk){const e=C.of(this._thunk);return!e.isSuccess()&&this.onlyOnSuccess||(delete this._thunk,delete this.onlyOnSuccess,this.cache=e),e}return this.cache}}class Ye extends Ge{constructor(e){super(),this.thunk=e,this._tag="always"}}class Ve extends Ge{constructor(e,t,n){super(),this.source=e,this.f=t,this.g=n,this._tag="flatMap"}}class $e extends Ge{constructor(e){super(),this.register=e,this._tag="async"}}class Qe extends Ge{constructor(e,t){super(),this._tag="memoize",this.source=e,this.result=null,this.onlySuccess=t}}class Ze{constructor(e,t=new z,n={autoCancelableRunLoops:!1}){this.scheduler=e,this.options=n,this.connection=t,n.autoCancelableRunLoops&&(this.shouldCancel=()=>t.isCanceled())}markAsyncBoundary(){this.scheduler.batchIndex=0}shouldCancel(){return!1}}const Xe={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:Ge.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>Ge.tailRecM(t,(t=>e(f.left,f.right,t)))};function Je(e){return Ge.asyncUnsafe(((t,n)=>{(e||t.scheduler).executeAsync((()=>n(C.unit())))}))}m(Ge,Xe);const Ke=Je();function et(e,t){let n;return e?n=e:t&&t.length>0&&(n=t.pop()),n?"function"==typeof n?n:n[0]:null}function tt(e,t){let n=e;do{if(n&&"function"!=typeof n)return n[1];n=t?t.pop():null}while(n);return null}class nt{constructor(e,t){this.context=e,this.callback=t,this.canCall=!1,this.bFirst=null,this.bRest=null,this.asFunction=this.signal.bind(this)}prepare(e,t){this.bFirst=e,this.bRest=t,this.canCall=!0}signal(e){this.canCall?(this.canCall=!1,ot(new ze(e),this.context.scheduler,this.context,this.callback,this,this.bFirst,this.bRest)):e.isFailure()&&this.context.scheduler.reportFailure(e.failed().get())}}function rt(e,t,n,r,i,o,s){if(!t.shouldCancel()){t.scheduler.batchIndex=s;const a=r||new nt(t,n);a.prepare(i,o),e(t,a.asFunction)}}function it(e,t,n,r,i,o){t.shouldCancel()||t.scheduler.executeAsync((()=>{ot(e,t.scheduler,t,n,r,i,o)}))}function ot(e,t,n,r,i,o,s){let a=e,c=o,l=s;const u=t.executionModel.recommendedBatchSize-1;let d=t.batchIndex;for(;;)if(a instanceof C){if(a.isSuccess()){const e=et(c,l);if(!e)return t.batchIndex=d,r(a);try{a=e(a.get())}catch(e){a=C.failure(e)}}else{const e=tt(c,l);if(!e)return t.batchIndex=d,r(a);try{a=e(a.failed().get())}catch(e){a=C.failure(e)}}c=null;const e=d+1&u;if(!e){const e=n||new Ze(t);return it(a instanceof C?new ze(a):a,e,r,i,c,l),e.connection}d=e}else switch(a._tag){case"pure":a=a.value;break;case"always":a=C.of(a.thunk);break;case"once":a=a.runTry();break;case"flatMap":const e=a;c&&(l||(l=[]),l.push(c)),c=e.g?[e.f,e.g]:e.f,a=e.source;break;case"async":const o=a,s=n||new Ze(t);return rt(o.register,s,r,i,c,l,d),s.connection;case"memoize":return ct(a,t,n,r,c,l,d)}}function st(e,t,n,r,i){return ve.create((o=>{const s=new Ze(t);return i?it(e,s,o,null,n,r):ot(e,t,s,o,null,n,r),s.connection}))}function at(e,t,n){let r=!1;return i=>{r?i.isFailure()&&e.reportFailure(i.failed().get()):(r=!0,e.trampoline((()=>{t.pop(),n(i)})))}}function ct(e,t,n,r,i,o,s){let a;if(t.batchIndex=s,e.result)a=e.result;else{const n=st(e.source,t,null,null,!1);n.value().isEmpty()?(e.result=n,a=n,n.onComplete((t=>{t.isSuccess()||!e.onlySuccess?(e.result=t,delete e.source):e.result=null}))):(a=n.value().get(),!a.isSuccess()&&e.onlySuccess||(e.result=a))}ot(a instanceof C?new ze(a):Ge.fromFuture(a),t,n,r,null,i,o)}function lt(e,t){for(;;){const n=t.next(),r=n.done;if(n.value){return n.value.flatMap((n=>(e.push(n),r?Ge.pure(e):lt(e,t))))}if(r)return Ge.pure(e)}}function ut(e,t){return Ge.asyncUnsafe(((n,r)=>{n.scheduler.trampoline((()=>{let i=!0;try{const o=[],s=ue(e);i=!1;for(let e=0;e<s.length;e++){const t=s[e].run(n.scheduler);o.push(t)}const a=t(o,n.scheduler);n.connection.push(a),a.onComplete(at(n.scheduler,n.connection,r))}catch(e){i?r(N(e)):n.scheduler.reportFailure(e)}}))}))}},20279:(e,t,n)=>{var r,i=n(27061);t=e.exports=h,r="object"==typeof i&&i.env&&i.env.NODE_DEBUG&&/\bsemver\b/i.test(i.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var o=Number.MAX_SAFE_INTEGER||9007199254740991,s=t.re=[],a=t.src=[],c=t.tokens={},l=0;function u(e){c[e]=l++}u("NUMERICIDENTIFIER"),a[c.NUMERICIDENTIFIER]="0|[1-9]\\d*",u("NUMERICIDENTIFIERLOOSE"),a[c.NUMERICIDENTIFIERLOOSE]="[0-9]+",u("NONNUMERICIDENTIFIER"),a[c.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",u("MAINVERSION"),a[c.MAINVERSION]="("+a[c.NUMERICIDENTIFIER]+")\\.("+a[c.NUMERICIDENTIFIER]+")\\.("+a[c.NUMERICIDENTIFIER]+")",u("MAINVERSIONLOOSE"),a[c.MAINVERSIONLOOSE]="("+a[c.NUMERICIDENTIFIERLOOSE]+")\\.("+a[c.NUMERICIDENTIFIERLOOSE]+")\\.("+a[c.NUMERICIDENTIFIERLOOSE]+")",u("PRERELEASEIDENTIFIER"),a[c.PRERELEASEIDENTIFIER]="(?:"+a[c.NUMERICIDENTIFIER]+"|"+a[c.NONNUMERICIDENTIFIER]+")",u("PRERELEASEIDENTIFIERLOOSE"),a[c.PRERELEASEIDENTIFIERLOOSE]="(?:"+a[c.NUMERICIDENTIFIERLOOSE]+"|"+a[c.NONNUMERICIDENTIFIER]+")",u("PRERELEASE"),a[c.PRERELEASE]="(?:-("+a[c.PRERELEASEIDENTIFIER]+"(?:\\."+a[c.PRERELEASEIDENTIFIER]+")*))",u("PRERELEASELOOSE"),a[c.PRERELEASELOOSE]="(?:-?("+a[c.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+a[c.PRERELEASEIDENTIFIERLOOSE]+")*))",u("BUILDIDENTIFIER"),a[c.BUILDIDENTIFIER]="[0-9A-Za-z-]+",u("BUILD"),a[c.BUILD]="(?:\\+("+a[c.BUILDIDENTIFIER]+"(?:\\."+a[c.BUILDIDENTIFIER]+")*))",u("FULL"),u("FULLPLAIN"),a[c.FULLPLAIN]="v?"+a[c.MAINVERSION]+a[c.PRERELEASE]+"?"+a[c.BUILD]+"?",a[c.FULL]="^"+a[c.FULLPLAIN]+"$",u("LOOSEPLAIN"),a[c.LOOSEPLAIN]="[v=\\s]*"+a[c.MAINVERSIONLOOSE]+a[c.PRERELEASELOOSE]+"?"+a[c.BUILD]+"?",u("LOOSE"),a[c.LOOSE]="^"+a[c.LOOSEPLAIN]+"$",u("GTLT"),a[c.GTLT]="((?:<|>)?=?)",u("XRANGEIDENTIFIERLOOSE"),a[c.XRANGEIDENTIFIERLOOSE]=a[c.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",u("XRANGEIDENTIFIER"),a[c.XRANGEIDENTIFIER]=a[c.NUMERICIDENTIFIER]+"|x|X|\\*",u("XRANGEPLAIN"),a[c.XRANGEPLAIN]="[v=\\s]*("+a[c.XRANGEIDENTIFIER]+")(?:\\.("+a[c.XRANGEIDENTIFIER]+")(?:\\.("+a[c.XRANGEIDENTIFIER]+")(?:"+a[c.PRERELEASE]+")?"+a[c.BUILD]+"?)?)?",u("XRANGEPLAINLOOSE"),a[c.XRANGEPLAINLOOSE]="[v=\\s]*("+a[c.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+a[c.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+a[c.XRANGEIDENTIFIERLOOSE]+")(?:"+a[c.PRERELEASELOOSE]+")?"+a[c.BUILD]+"?)?)?",u("XRANGE"),a[c.XRANGE]="^"+a[c.GTLT]+"\\s*"+a[c.XRANGEPLAIN]+"$",u("XRANGELOOSE"),a[c.XRANGELOOSE]="^"+a[c.GTLT]+"\\s*"+a[c.XRANGEPLAINLOOSE]+"$",u("COERCE"),a[c.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",u("COERCERTL"),s[c.COERCERTL]=new RegExp(a[c.COERCE],"g"),u("LONETILDE"),a[c.LONETILDE]="(?:~>?)",u("TILDETRIM"),a[c.TILDETRIM]="(\\s*)"+a[c.LONETILDE]+"\\s+",s[c.TILDETRIM]=new RegExp(a[c.TILDETRIM],"g");u("TILDE"),a[c.TILDE]="^"+a[c.LONETILDE]+a[c.XRANGEPLAIN]+"$",u("TILDELOOSE"),a[c.TILDELOOSE]="^"+a[c.LONETILDE]+a[c.XRANGEPLAINLOOSE]+"$",u("LONECARET"),a[c.LONECARET]="(?:\\^)",u("CARETTRIM"),a[c.CARETTRIM]="(\\s*)"+a[c.LONECARET]+"\\s+",s[c.CARETTRIM]=new RegExp(a[c.CARETTRIM],"g");u("CARET"),a[c.CARET]="^"+a[c.LONECARET]+a[c.XRANGEPLAIN]+"$",u("CARETLOOSE"),a[c.CARETLOOSE]="^"+a[c.LONECARET]+a[c.XRANGEPLAINLOOSE]+"$",u("COMPARATORLOOSE"),a[c.COMPARATORLOOSE]="^"+a[c.GTLT]+"\\s*("+a[c.LOOSEPLAIN]+")$|^$",u("COMPARATOR"),a[c.COMPARATOR]="^"+a[c.GTLT]+"\\s*("+a[c.FULLPLAIN]+")$|^$",u("COMPARATORTRIM"),a[c.COMPARATORTRIM]="(\\s*)"+a[c.GTLT]+"\\s*("+a[c.LOOSEPLAIN]+"|"+a[c.XRANGEPLAIN]+")",s[c.COMPARATORTRIM]=new RegExp(a[c.COMPARATORTRIM],"g");u("HYPHENRANGE"),a[c.HYPHENRANGE]="^\\s*("+a[c.XRANGEPLAIN]+")\\s+-\\s+("+a[c.XRANGEPLAIN]+")\\s*$",u("HYPHENRANGELOOSE"),a[c.HYPHENRANGELOOSE]="^\\s*("+a[c.XRANGEPLAINLOOSE]+")\\s+-\\s+("+a[c.XRANGEPLAINLOOSE]+")\\s*$",u("STAR"),a[c.STAR]="(<|>)?=?\\s*\\*";for(var d=0;d<l;d++)r(d,a[d]),s[d]||(s[d]=new RegExp(a[d]));function p(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?s[c.LOOSE]:s[c.FULL]).test(e))return null;try{return new h(e,t)}catch(e){return null}}function h(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof h))return new h(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var n=e.trim().match(t.loose?s[c.LOOSE]:s[c.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}t.parse=p,t.valid=function(e,t){var n=p(e,t);return n?n.version:null},t.clean=function(e,t){var n=p(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=h,h.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},h.prototype.toString=function(){return this.version},h.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof h||(e=new h(e,this.options)),this.compareMain(e)||this.comparePre(e)},h.prototype.compareMain=function(e){return e instanceof h||(e=new h(e,this.options)),f(this.major,e.major)||f(this.minor,e.minor)||f(this.patch,e.patch)},h.prototype.comparePre=function(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return f(n,i)}while(++t)},h.prototype.compareBuild=function(e){e instanceof h||(e=new h(e,this.options));var t=0;do{var n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return f(n,i)}while(++t)},h.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new h(e,n).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(v(e,t))return null;var n=p(e),r=p(t),i="";if(n.prerelease.length||r.prerelease.length){i="pre";var o="prerelease"}for(var s in n)if(("major"===s||"minor"===s||"patch"===s)&&n[s]!==r[s])return i+s;return o},t.compareIdentifiers=f;var m=/^[0-9]+$/;function f(e,t){var n=m.test(e),r=m.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function g(e,t,n){return new h(e,n).compare(new h(t,n))}function y(e,t,n){return g(e,t,n)>0}function _(e,t,n){return g(e,t,n)<0}function v(e,t,n){return 0===g(e,t,n)}function b(e,t,n){return 0!==g(e,t,n)}function E(e,t,n){return g(e,t,n)>=0}function I(e,t,n){return g(e,t,n)<=0}function S(e,t,n,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return v(e,n,r);case"!=":return b(e,n,r);case">":return y(e,n,r);case">=":return E(e,n,r);case"<":return _(e,n,r);case"<=":return I(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function w(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof w){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof w))return new w(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===A?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return f(t,e)},t.major=function(e,t){return new h(e,t).major},t.minor=function(e,t){return new h(e,t).minor},t.patch=function(e,t){return new h(e,t).patch},t.compare=g,t.compareLoose=function(e,t){return g(e,t,!0)},t.compareBuild=function(e,t,n){var r=new h(e,n),i=new h(t,n);return r.compare(i)||r.compareBuild(i)},t.rcompare=function(e,t,n){return g(t,e,n)},t.sort=function(e,n){return e.sort((function(e,r){return t.compareBuild(e,r,n)}))},t.rsort=function(e,n){return e.sort((function(e,r){return t.compareBuild(r,e,n)}))},t.gt=y,t.lt=_,t.eq=v,t.neq=b,t.gte=E,t.lte=I,t.cmp=S,t.Comparator=w;var A={};function C(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof C)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new C(e.raw,t);if(e instanceof w)return new C(e.value,t);if(!(this instanceof C))return new C(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function T(e,t){for(var n=!0,r=e.slice(),i=r.pop();n&&r.length;)n=r.every((function(e){return i.intersects(e,t)})),i=r.pop();return n}function k(e){return!e||"x"===e.toLowerCase()||"*"===e}function O(e,t,n,r,i,o,s,a,c,l,u,d,p){return((t=k(n)?"":k(r)?">="+n+".0.0":k(i)?">="+n+"."+r+".0":">="+t)+" "+(a=k(c)?"":k(l)?"<"+(+c+1)+".0.0":k(u)?"<"+c+"."+(+l+1)+".0":d?"<="+c+"."+l+"."+u+"-"+d:"<="+a)).trim()}function N(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==A&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function M(e,t,n){try{t=new C(t,n)}catch(e){return!1}return t.test(e)}function x(e,t,n,r){var i,o,s,a,c;switch(e=new h(e,r),t=new C(t,r),n){case">":i=y,o=I,s=_,a=">",c=">=";break;case"<":i=_,o=E,s=y,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(M(e,t,r))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],d=null,p=null;if(u.forEach((function(e){e.semver===A&&(e=new w(">=0.0.0")),d=d||e,p=p||e,i(e.semver,d.semver,r)?d=e:s(e.semver,p.semver,r)&&(p=e)})),d.operator===a||d.operator===c)return!1;if((!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===c&&s(e,p.semver))return!1}return!0}w.prototype.parse=function(e){var t=this.options.loose?s[c.COMPARATORLOOSE]:s[c.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=A},w.prototype.toString=function(){return this.value},w.prototype.test=function(e){if(r("Comparator.test",e,this.options.loose),this.semver===A||e===A)return!0;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}return S(e,this.operator,this.semver,this.options)},w.prototype.intersects=function(e,t){if(!(e instanceof w))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new C(e.value,t),M(this.value,n,t));if(""===e.operator)return""===e.value||(n=new C(this.value,t),M(e.semver,n,t));var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=S(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=S(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||i||o&&s||a||c},t.Range=C,C.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},C.prototype.toString=function(){return this.range},C.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?s[c.HYPHENRANGELOOSE]:s[c.HYPHENRANGE];e=e.replace(n,O),r("hyphen replace",e),e=e.replace(s[c.COMPARATORTRIM],"$1$2$3"),r("comparator trim",e,s[c.COMPARATORTRIM]),e=(e=(e=e.replace(s[c.TILDETRIM],"$1~")).replace(s[c.CARETTRIM],"$1^")).split(/\s+/).join(" ");var i=t?s[c.COMPARATORLOOSE]:s[c.COMPARATOR],o=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?s[c.CARETLOOSE]:s[c.CARET];return e.replace(n,(function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),k(n)?a="":k(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":k(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?s[c.TILDELOOSE]:s[c.TILDE];return e.replace(n,(function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),k(n)?a="":k(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":k(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),a=">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?s[c.XRANGELOOSE]:s[c.XRANGE];return e.replace(n,(function(n,i,o,s,a,c){r("xRange",e,n,i,o,s,a,c);var l=k(o),u=l||k(s),d=u||k(a),p=d;return"="===i&&p&&(i=""),c=t.includePrerelease?"-0":"",l?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&p?(u&&(s=0),a=0,">"===i?(i=">=",u?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):"<="===i&&(i="<",u?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a+c):u?n=">="+o+".0.0"+c+" <"+(+o+1)+".0.0"+c:d&&(n=">="+o+"."+s+".0"+c+" <"+o+"."+(+s+1)+".0"+c),r("xRange return",n),n}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(s[c.STAR],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(i)}))),o=o.map((function(e){return new w(e,this.options)}),this)},C.prototype.intersects=function(e,t){if(!(e instanceof C))throw new TypeError("a Range is required");return this.set.some((function(n){return T(n,t)&&e.set.some((function(e){return T(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new C(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},C.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(N(this.set[t],e,this.options))return!0;return!1},t.satisfies=M,t.maxSatisfying=function(e,t,n){var r=null,i=null;try{var o=new C(t,n)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(r&&-1!==i.compare(e)||(i=new h(r=e,n)))})),r},t.minSatisfying=function(e,t,n){var r=null,i=null;try{var o=new C(t,n)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(r&&1!==i.compare(e)||(i=new h(r=e,n)))})),r},t.minVersion=function(e,t){e=new C(e,t);var n=new h("0.0.0");if(e.test(n))return n;if(n=new h("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r){e.set[r].forEach((function(e){var t=new h(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!y(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n))return n;return null},t.validRange=function(e,t){try{return new C(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return x(e,t,"<",n)},t.gtr=function(e,t,n){return x(e,t,">",n)},t.outside=x,t.prerelease=function(e,t){var n=p(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new C(e,n),t=new C(t,n),e.intersects(t)},t.coerce=function(e,t){if(e instanceof h)return e;"number"==typeof e&&(e=String(e));if("string"!=typeof e)return null;var n=null;if((t=t||{}).rtl){for(var r;(r=s[c.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),s[c.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;s[c.COERCERTL].lastIndex=-1}else n=e.match(s[c.COERCE]);if(null===n)return null;return p(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}}}]);